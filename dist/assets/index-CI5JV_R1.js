function J4(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var Pl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function B0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function oY(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var eU={exports:{}},YS={},tU={exports:{}},qn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $0=Symbol.for("react.element"),aY=Symbol.for("react.portal"),lY=Symbol.for("react.fragment"),cY=Symbol.for("react.strict_mode"),uY=Symbol.for("react.profiler"),dY=Symbol.for("react.provider"),hY=Symbol.for("react.context"),fY=Symbol.for("react.forward_ref"),pY=Symbol.for("react.suspense"),mY=Symbol.for("react.memo"),gY=Symbol.for("react.lazy"),GP=Symbol.iterator;function yY(n){return n===null||typeof n!="object"?null:(n=GP&&n[GP]||n["@@iterator"],typeof n=="function"?n:null)}var nU={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rU=Object.assign,iU={};function og(n,e,t){this.props=n,this.context=e,this.refs=iU,this.updater=t||nU}og.prototype.isReactComponent={};og.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};og.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function sU(){}sU.prototype=og.prototype;function YN(n,e,t){this.props=n,this.context=e,this.refs=iU,this.updater=t||nU}var ZN=YN.prototype=new sU;ZN.constructor=YN;rU(ZN,og.prototype);ZN.isPureReactComponent=!0;var qP=Array.isArray,oU=Object.prototype.hasOwnProperty,QN={current:null},aU={key:!0,ref:!0,__self:!0,__source:!0};function lU(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)oU.call(e,r)&&!aU.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:$0,type:n,key:s,ref:o,props:i,_owner:QN.current}}function vY(n,e){return{$$typeof:$0,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function JN(n){return typeof n=="object"&&n!==null&&n.$$typeof===$0}function xY(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var XP=/\/+/g;function bE(n,e){return typeof n=="object"&&n!==null&&n.key!=null?xY(""+n.key):e.toString(36)}function W1(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case $0:case aY:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+bE(o,0):r,qP(i)?(t="",n!=null&&(t=n.replace(XP,"$&/")+"/"),W1(i,e,t,"",function(c){return c})):i!=null&&(JN(i)&&(i=vY(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(XP,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",qP(n))for(var a=0;a<n.length;a++){s=n[a];var l=r+bE(s,a);o+=W1(s,e,t,l,i)}else if(l=yY(n),typeof l=="function")for(n=l.call(n),a=0;!(s=n.next()).done;)s=s.value,l=r+bE(s,a++),o+=W1(s,e,t,l,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function yw(n,e,t){if(n==null)return n;var r=[],i=0;return W1(n,r,"","",function(s){return e.call(t,s,i++)}),r}function wY(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Js={current:null},H1={transition:null},bY={ReactCurrentDispatcher:Js,ReactCurrentBatchConfig:H1,ReactCurrentOwner:QN};function cU(){throw Error("act(...) is not supported in production builds of React.")}qn.Children={map:yw,forEach:function(n,e,t){yw(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return yw(n,function(){e++}),e},toArray:function(n){return yw(n,function(e){return e})||[]},only:function(n){if(!JN(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};qn.Component=og;qn.Fragment=lY;qn.Profiler=uY;qn.PureComponent=YN;qn.StrictMode=cY;qn.Suspense=pY;qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bY;qn.act=cU;qn.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=rU({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=QN.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)oU.call(e,l)&&!aU.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:$0,type:n.type,key:i,ref:s,props:r,_owner:o}};qn.createContext=function(n){return n={$$typeof:hY,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:dY,_context:n},n.Consumer=n};qn.createElement=lU;qn.createFactory=function(n){var e=lU.bind(null,n);return e.type=n,e};qn.createRef=function(){return{current:null}};qn.forwardRef=function(n){return{$$typeof:fY,render:n}};qn.isValidElement=JN;qn.lazy=function(n){return{$$typeof:gY,_payload:{_status:-1,_result:n},_init:wY}};qn.memo=function(n,e){return{$$typeof:mY,type:n,compare:e===void 0?null:e}};qn.startTransition=function(n){var e=H1.transition;H1.transition={};try{n()}finally{H1.transition=e}};qn.unstable_act=cU;qn.useCallback=function(n,e){return Js.current.useCallback(n,e)};qn.useContext=function(n){return Js.current.useContext(n)};qn.useDebugValue=function(){};qn.useDeferredValue=function(n){return Js.current.useDeferredValue(n)};qn.useEffect=function(n,e){return Js.current.useEffect(n,e)};qn.useId=function(){return Js.current.useId()};qn.useImperativeHandle=function(n,e,t){return Js.current.useImperativeHandle(n,e,t)};qn.useInsertionEffect=function(n,e){return Js.current.useInsertionEffect(n,e)};qn.useLayoutEffect=function(n,e){return Js.current.useLayoutEffect(n,e)};qn.useMemo=function(n,e){return Js.current.useMemo(n,e)};qn.useReducer=function(n,e,t){return Js.current.useReducer(n,e,t)};qn.useRef=function(n){return Js.current.useRef(n)};qn.useState=function(n){return Js.current.useState(n)};qn.useSyncExternalStore=function(n,e,t){return Js.current.useSyncExternalStore(n,e,t)};qn.useTransition=function(){return Js.current.useTransition()};qn.version="18.3.1";tU.exports=qn;var N=tU.exports;const Sr=B0(N),uU=J4({__proto__:null,default:Sr},[N]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SY=N,_Y=Symbol.for("react.element"),EY=Symbol.for("react.fragment"),CY=Object.prototype.hasOwnProperty,TY=SY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,MY={key:!0,ref:!0,__self:!0,__source:!0};function dU(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)CY.call(e,r)&&!MY.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:_Y,type:n,key:s,ref:o,props:i,_owner:TY.current}}YS.Fragment=EY;YS.jsx=dU;YS.jsxs=dU;eU.exports=YS;var w=eU.exports,hU={exports:{}},Yo={},fU={exports:{}},pU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(H,X){var oe=H.length;H.push(X);e:for(;0<oe;){var ve=oe-1>>>1,Te=H[ve];if(0<i(Te,X))H[ve]=X,H[oe]=Te,oe=ve;else break e}}function t(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var X=H[0],oe=H.pop();if(oe!==X){H[0]=oe;e:for(var ve=0,Te=H.length,Xe=Te>>>1;ve<Xe;){var _e=2*(ve+1)-1,Ue=H[_e],Fe=_e+1,Oe=H[Fe];if(0>i(Ue,oe))Fe<Te&&0>i(Oe,Ue)?(H[ve]=Oe,H[Fe]=oe,ve=Fe):(H[ve]=Ue,H[_e]=oe,ve=_e);else if(Fe<Te&&0>i(Oe,oe))H[ve]=Oe,H[Fe]=oe,ve=Fe;else break e}}return X}function i(H,X){var oe=H.sortIndex-X.sortIndex;return oe!==0?oe:H.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,x=!1,v=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(H){for(var X=t(c);X!==null;){if(X.callback===null)r(c);else if(X.startTime<=H)r(c),X.sortIndex=X.expirationTime,e(l,X);else break;X=t(c)}}function _(H){if(x=!1,S(H),!p)if(t(l)!==null)p=!0,Y(T);else{var X=t(c);X!==null&&we(_,X.startTime-H)}}function T(H,X){p=!1,x&&(x=!1,y(P),P=-1),f=!0;var oe=h;try{for(S(X),d=t(l);d!==null&&(!(d.expirationTime>X)||H&&!L());){var ve=d.callback;if(typeof ve=="function"){d.callback=null,h=d.priorityLevel;var Te=ve(d.expirationTime<=X);X=n.unstable_now(),typeof Te=="function"?d.callback=Te:d===t(l)&&r(l),S(X)}else r(l);d=t(l)}if(d!==null)var Xe=!0;else{var _e=t(c);_e!==null&&we(_,_e.startTime-X),Xe=!1}return Xe}finally{d=null,h=oe,f=!1}}var M=!1,k=null,P=-1,z=5,I=-1;function L(){return!(n.unstable_now()-I<z)}function W(){if(k!==null){var H=n.unstable_now();I=H;var X=!0;try{X=k(!0,H)}finally{X?q():(M=!1,k=null)}}else M=!1}var q;if(typeof b=="function")q=function(){b(W)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,ne=$.port2;$.port1.onmessage=W,q=function(){ne.postMessage(null)}}else q=function(){v(W,0)};function Y(H){k=H,M||(M=!0,q())}function we(H,X){P=v(function(){H(n.unstable_now())},X)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_continueExecution=function(){p||f||(p=!0,Y(T))},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(H){switch(h){case 1:case 2:case 3:var X=3;break;default:X=h}var oe=h;h=X;try{return H()}finally{h=oe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(H,X){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var oe=h;h=H;try{return X()}finally{h=oe}},n.unstable_scheduleCallback=function(H,X,oe){var ve=n.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?ve+oe:ve):oe=ve,H){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=oe+Te,H={id:u++,callback:X,priorityLevel:H,startTime:oe,expirationTime:Te,sortIndex:-1},oe>ve?(H.sortIndex=oe,e(c,H),t(l)===null&&H===t(c)&&(x?(y(P),P=-1):x=!0,we(_,oe-ve))):(H.sortIndex=Te,e(l,H),p||f||(p=!0,Y(T))),H},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(H){var X=h;return function(){var oe=h;h=X;try{return H.apply(this,arguments)}finally{h=oe}}}})(pU);fU.exports=pU;var AY=fU.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NY=N,Xo=AY;function ct(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mU=new Set,xv={};function Sf(n,e){Nm(n,e),Nm(n+"Capture",e)}function Nm(n,e){for(xv[n]=e,n=0;n<e.length;n++)mU.add(e[n])}var Oc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),PT=Object.prototype.hasOwnProperty,kY=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,KP={},YP={};function IY(n){return PT.call(YP,n)?!0:PT.call(KP,n)?!1:kY.test(n)?YP[n]=!0:(KP[n]=!0,!1)}function RY(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function PY(n,e,t,r){if(e===null||typeof e>"u"||RY(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function eo(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var as={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){as[n]=new eo(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];as[e]=new eo(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){as[n]=new eo(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){as[n]=new eo(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){as[n]=new eo(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){as[n]=new eo(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){as[n]=new eo(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){as[n]=new eo(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){as[n]=new eo(n,5,!1,n.toLowerCase(),null,!1,!1)});var ek=/[\-:]([a-z])/g;function tk(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(ek,tk);as[e]=new eo(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(ek,tk);as[e]=new eo(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(ek,tk);as[e]=new eo(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){as[n]=new eo(n,1,!1,n.toLowerCase(),null,!1,!1)});as.xlinkHref=new eo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){as[n]=new eo(n,1,!1,n.toLowerCase(),null,!0,!0)});function nk(n,e,t,r){var i=as.hasOwnProperty(e)?as[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(PY(e,t,i,r)&&(t=null),r||i===null?IY(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Yc=NY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,vw=Symbol.for("react.element"),Hp=Symbol.for("react.portal"),Gp=Symbol.for("react.fragment"),rk=Symbol.for("react.strict_mode"),DT=Symbol.for("react.profiler"),gU=Symbol.for("react.provider"),yU=Symbol.for("react.context"),ik=Symbol.for("react.forward_ref"),LT=Symbol.for("react.suspense"),OT=Symbol.for("react.suspense_list"),sk=Symbol.for("react.memo"),Mu=Symbol.for("react.lazy"),vU=Symbol.for("react.offscreen"),ZP=Symbol.iterator;function sy(n){return n===null||typeof n!="object"?null:(n=ZP&&n[ZP]||n["@@iterator"],typeof n=="function"?n:null)}var si=Object.assign,SE;function zy(n){if(SE===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);SE=e&&e[1]||""}return`
`+SE+n}var _E=!1;function EE(n,e){if(!n||_E)return"";_E=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{_E=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?zy(n):""}function DY(n){switch(n.tag){case 5:return zy(n.type);case 16:return zy("Lazy");case 13:return zy("Suspense");case 19:return zy("SuspenseList");case 0:case 2:case 15:return n=EE(n.type,!1),n;case 11:return n=EE(n.type.render,!1),n;case 1:return n=EE(n.type,!0),n;default:return""}}function FT(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Gp:return"Fragment";case Hp:return"Portal";case DT:return"Profiler";case rk:return"StrictMode";case LT:return"Suspense";case OT:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case yU:return(n.displayName||"Context")+".Consumer";case gU:return(n._context.displayName||"Context")+".Provider";case ik:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case sk:return e=n.displayName||null,e!==null?e:FT(n.type)||"Memo";case Mu:e=n._payload,n=n._init;try{return FT(n(e))}catch{}}return null}function LY(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return FT(e);case 8:return e===rk?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function sd(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function xU(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function OY(n){var e=xU(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function xw(n){n._valueTracker||(n._valueTracker=OY(n))}function wU(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=xU(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Tb(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function zT(n,e){var t=e.checked;return si({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function QP(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=sd(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function bU(n,e){e=e.checked,e!=null&&nk(n,"checked",e,!1)}function UT(n,e){bU(n,e);var t=sd(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?BT(n,e.type,t):e.hasOwnProperty("defaultValue")&&BT(n,e.type,sd(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function JP(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function BT(n,e,t){(e!=="number"||Tb(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Uy=Array.isArray;function dm(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+sd(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function $T(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ct(91));return si({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function eD(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ct(92));if(Uy(t)){if(1<t.length)throw Error(ct(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:sd(t)}}function SU(n,e){var t=sd(e.value),r=sd(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function tD(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function _U(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jT(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?_U(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var ww,EU=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(ww=ww||document.createElement("div"),ww.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ww.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function wv(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Zy={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FY=["Webkit","ms","Moz","O"];Object.keys(Zy).forEach(function(n){FY.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Zy[e]=Zy[n]})});function CU(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Zy.hasOwnProperty(n)&&Zy[n]?(""+e).trim():e+"px"}function TU(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=CU(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var zY=si({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function VT(n,e){if(e){if(zY[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ct(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ct(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ct(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ct(62))}}function WT(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var HT=null;function ok(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var GT=null,hm=null,fm=null;function nD(n){if(n=W0(n)){if(typeof GT!="function")throw Error(ct(280));var e=n.stateNode;e&&(e=t_(e),GT(n.stateNode,n.type,e))}}function MU(n){hm?fm?fm.push(n):fm=[n]:hm=n}function AU(){if(hm){var n=hm,e=fm;if(fm=hm=null,nD(n),e)for(n=0;n<e.length;n++)nD(e[n])}}function NU(n,e){return n(e)}function kU(){}var CE=!1;function IU(n,e,t){if(CE)return n(e,t);CE=!0;try{return NU(n,e,t)}finally{CE=!1,(hm!==null||fm!==null)&&(kU(),AU())}}function bv(n,e){var t=n.stateNode;if(t===null)return null;var r=t_(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(ct(231,e,typeof t));return t}var qT=!1;if(Oc)try{var oy={};Object.defineProperty(oy,"passive",{get:function(){qT=!0}}),window.addEventListener("test",oy,oy),window.removeEventListener("test",oy,oy)}catch{qT=!1}function UY(n,e,t,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var Qy=!1,Mb=null,Ab=!1,XT=null,BY={onError:function(n){Qy=!0,Mb=n}};function $Y(n,e,t,r,i,s,o,a,l){Qy=!1,Mb=null,UY.apply(BY,arguments)}function jY(n,e,t,r,i,s,o,a,l){if($Y.apply(this,arguments),Qy){if(Qy){var c=Mb;Qy=!1,Mb=null}else throw Error(ct(198));Ab||(Ab=!0,XT=c)}}function _f(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function RU(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function rD(n){if(_f(n)!==n)throw Error(ct(188))}function VY(n){var e=n.alternate;if(!e){if(e=_f(n),e===null)throw Error(ct(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return rD(i),n;if(s===r)return rD(i),e;s=s.sibling}throw Error(ct(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o)throw Error(ct(189))}}if(t.alternate!==r)throw Error(ct(190))}if(t.tag!==3)throw Error(ct(188));return t.stateNode.current===t?n:e}function PU(n){return n=VY(n),n!==null?DU(n):null}function DU(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=DU(n);if(e!==null)return e;n=n.sibling}return null}var LU=Xo.unstable_scheduleCallback,iD=Xo.unstable_cancelCallback,WY=Xo.unstable_shouldYield,HY=Xo.unstable_requestPaint,vi=Xo.unstable_now,GY=Xo.unstable_getCurrentPriorityLevel,ak=Xo.unstable_ImmediatePriority,OU=Xo.unstable_UserBlockingPriority,Nb=Xo.unstable_NormalPriority,qY=Xo.unstable_LowPriority,FU=Xo.unstable_IdlePriority,ZS=null,Dl=null;function XY(n){if(Dl&&typeof Dl.onCommitFiberRoot=="function")try{Dl.onCommitFiberRoot(ZS,n,void 0,(n.current.flags&128)===128)}catch{}}var Za=Math.clz32?Math.clz32:ZY,KY=Math.log,YY=Math.LN2;function ZY(n){return n>>>=0,n===0?32:31-(KY(n)/YY|0)|0}var bw=64,Sw=4194304;function By(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function kb(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~i;a!==0?r=By(a):(s&=o,s!==0&&(r=By(s)))}else o=t&~i,o!==0?r=By(o):s!==0&&(r=By(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Za(e),i=1<<t,r|=n[t],e&=~i;return r}function QY(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function JY(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-Za(s),a=1<<o,l=i[o];l===-1?(!(a&t)||a&r)&&(i[o]=QY(a,e)):l<=e&&(n.expiredLanes|=a),s&=~a}}function KT(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function zU(){var n=bw;return bw<<=1,!(bw&4194240)&&(bw=64),n}function TE(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function j0(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Za(e),n[e]=t}function eZ(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Za(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function lk(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Za(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var xr=0;function UU(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var BU,ck,$U,jU,VU,YT=!1,_w=[],Bu=null,$u=null,ju=null,Sv=new Map,_v=new Map,ku=[],tZ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sD(n,e){switch(n){case"focusin":case"focusout":Bu=null;break;case"dragenter":case"dragleave":$u=null;break;case"mouseover":case"mouseout":ju=null;break;case"pointerover":case"pointerout":Sv.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_v.delete(e.pointerId)}}function ay(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=W0(e),e!==null&&ck(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function nZ(n,e,t,r,i){switch(e){case"focusin":return Bu=ay(Bu,n,e,t,r,i),!0;case"dragenter":return $u=ay($u,n,e,t,r,i),!0;case"mouseover":return ju=ay(ju,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return Sv.set(s,ay(Sv.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,_v.set(s,ay(_v.get(s)||null,n,e,t,r,i)),!0}return!1}function WU(n){var e=Eh(n.target);if(e!==null){var t=_f(e);if(t!==null){if(e=t.tag,e===13){if(e=RU(t),e!==null){n.blockedOn=e,VU(n.priority,function(){$U(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function G1(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=ZT(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);HT=r,t.target.dispatchEvent(r),HT=null}else return e=W0(t),e!==null&&ck(e),n.blockedOn=t,!1;e.shift()}return!0}function oD(n,e,t){G1(n)&&t.delete(e)}function rZ(){YT=!1,Bu!==null&&G1(Bu)&&(Bu=null),$u!==null&&G1($u)&&($u=null),ju!==null&&G1(ju)&&(ju=null),Sv.forEach(oD),_v.forEach(oD)}function ly(n,e){n.blockedOn===e&&(n.blockedOn=null,YT||(YT=!0,Xo.unstable_scheduleCallback(Xo.unstable_NormalPriority,rZ)))}function Ev(n){function e(i){return ly(i,n)}if(0<_w.length){ly(_w[0],n);for(var t=1;t<_w.length;t++){var r=_w[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Bu!==null&&ly(Bu,n),$u!==null&&ly($u,n),ju!==null&&ly(ju,n),Sv.forEach(e),_v.forEach(e),t=0;t<ku.length;t++)r=ku[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<ku.length&&(t=ku[0],t.blockedOn===null);)WU(t),t.blockedOn===null&&ku.shift()}var pm=Yc.ReactCurrentBatchConfig,Ib=!0;function iZ(n,e,t,r){var i=xr,s=pm.transition;pm.transition=null;try{xr=1,uk(n,e,t,r)}finally{xr=i,pm.transition=s}}function sZ(n,e,t,r){var i=xr,s=pm.transition;pm.transition=null;try{xr=4,uk(n,e,t,r)}finally{xr=i,pm.transition=s}}function uk(n,e,t,r){if(Ib){var i=ZT(n,e,t,r);if(i===null)OE(n,e,r,Rb,t),sD(n,r);else if(nZ(i,n,e,t,r))r.stopPropagation();else if(sD(n,r),e&4&&-1<tZ.indexOf(n)){for(;i!==null;){var s=W0(i);if(s!==null&&BU(s),s=ZT(n,e,t,r),s===null&&OE(n,e,r,Rb,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else OE(n,e,r,null,t)}}var Rb=null;function ZT(n,e,t,r){if(Rb=null,n=ok(r),n=Eh(n),n!==null)if(e=_f(n),e===null)n=null;else if(t=e.tag,t===13){if(n=RU(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Rb=n,null}function HU(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(GY()){case ak:return 1;case OU:return 4;case Nb:case qY:return 16;case FU:return 536870912;default:return 16}default:return 16}}var Lu=null,dk=null,q1=null;function GU(){if(q1)return q1;var n,e=dk,t=e.length,r,i="value"in Lu?Lu.value:Lu.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return q1=i.slice(n,1<r?1-r:void 0)}function X1(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Ew(){return!0}function aD(){return!1}function Zo(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ew:aD,this.isPropagationStopped=aD,this}return si(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Ew)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Ew)},persist:function(){},isPersistent:Ew}),e}var ag={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hk=Zo(ag),V0=si({},ag,{view:0,detail:0}),oZ=Zo(V0),ME,AE,cy,QS=si({},V0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fk,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==cy&&(cy&&n.type==="mousemove"?(ME=n.screenX-cy.screenX,AE=n.screenY-cy.screenY):AE=ME=0,cy=n),ME)},movementY:function(n){return"movementY"in n?n.movementY:AE}}),lD=Zo(QS),aZ=si({},QS,{dataTransfer:0}),lZ=Zo(aZ),cZ=si({},V0,{relatedTarget:0}),NE=Zo(cZ),uZ=si({},ag,{animationName:0,elapsedTime:0,pseudoElement:0}),dZ=Zo(uZ),hZ=si({},ag,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),fZ=Zo(hZ),pZ=si({},ag,{data:0}),cD=Zo(pZ),mZ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gZ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yZ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vZ(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=yZ[n])?!!e[n]:!1}function fk(){return vZ}var xZ=si({},V0,{key:function(n){if(n.key){var e=mZ[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=X1(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?gZ[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fk,charCode:function(n){return n.type==="keypress"?X1(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?X1(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),wZ=Zo(xZ),bZ=si({},QS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),uD=Zo(bZ),SZ=si({},V0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fk}),_Z=Zo(SZ),EZ=si({},ag,{propertyName:0,elapsedTime:0,pseudoElement:0}),CZ=Zo(EZ),TZ=si({},QS,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),MZ=Zo(TZ),AZ=[9,13,27,32],pk=Oc&&"CompositionEvent"in window,Jy=null;Oc&&"documentMode"in document&&(Jy=document.documentMode);var NZ=Oc&&"TextEvent"in window&&!Jy,qU=Oc&&(!pk||Jy&&8<Jy&&11>=Jy),dD=" ",hD=!1;function XU(n,e){switch(n){case"keyup":return AZ.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function KU(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var qp=!1;function kZ(n,e){switch(n){case"compositionend":return KU(e);case"keypress":return e.which!==32?null:(hD=!0,dD);case"textInput":return n=e.data,n===dD&&hD?null:n;default:return null}}function IZ(n,e){if(qp)return n==="compositionend"||!pk&&XU(n,e)?(n=GU(),q1=dk=Lu=null,qp=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return qU&&e.locale!=="ko"?null:e.data;default:return null}}var RZ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fD(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!RZ[n.type]:e==="textarea"}function YU(n,e,t,r){MU(r),e=Pb(e,"onChange"),0<e.length&&(t=new hk("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var ev=null,Cv=null;function PZ(n){aB(n,0)}function JS(n){var e=Yp(n);if(wU(e))return n}function DZ(n,e){if(n==="change")return e}var ZU=!1;if(Oc){var kE;if(Oc){var IE="oninput"in document;if(!IE){var pD=document.createElement("div");pD.setAttribute("oninput","return;"),IE=typeof pD.oninput=="function"}kE=IE}else kE=!1;ZU=kE&&(!document.documentMode||9<document.documentMode)}function mD(){ev&&(ev.detachEvent("onpropertychange",QU),Cv=ev=null)}function QU(n){if(n.propertyName==="value"&&JS(Cv)){var e=[];YU(e,Cv,n,ok(n)),IU(PZ,e)}}function LZ(n,e,t){n==="focusin"?(mD(),ev=e,Cv=t,ev.attachEvent("onpropertychange",QU)):n==="focusout"&&mD()}function OZ(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return JS(Cv)}function FZ(n,e){if(n==="click")return JS(e)}function zZ(n,e){if(n==="input"||n==="change")return JS(e)}function UZ(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var tl=typeof Object.is=="function"?Object.is:UZ;function Tv(n,e){if(tl(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!PT.call(e,i)||!tl(n[i],e[i]))return!1}return!0}function gD(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function yD(n,e){var t=gD(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=gD(t)}}function JU(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?JU(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function eB(){for(var n=window,e=Tb();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Tb(n.document)}return e}function mk(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function BZ(n){var e=eB(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&JU(t.ownerDocument.documentElement,t)){if(r!==null&&mk(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=yD(t,s);var o=yD(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var $Z=Oc&&"documentMode"in document&&11>=document.documentMode,Xp=null,QT=null,tv=null,JT=!1;function vD(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;JT||Xp==null||Xp!==Tb(r)||(r=Xp,"selectionStart"in r&&mk(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),tv&&Tv(tv,r)||(tv=r,r=Pb(QT,"onSelect"),0<r.length&&(e=new hk("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Xp)))}function Cw(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Kp={animationend:Cw("Animation","AnimationEnd"),animationiteration:Cw("Animation","AnimationIteration"),animationstart:Cw("Animation","AnimationStart"),transitionend:Cw("Transition","TransitionEnd")},RE={},tB={};Oc&&(tB=document.createElement("div").style,"AnimationEvent"in window||(delete Kp.animationend.animation,delete Kp.animationiteration.animation,delete Kp.animationstart.animation),"TransitionEvent"in window||delete Kp.transitionend.transition);function e_(n){if(RE[n])return RE[n];if(!Kp[n])return n;var e=Kp[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in tB)return RE[n]=e[t];return n}var nB=e_("animationend"),rB=e_("animationiteration"),iB=e_("animationstart"),sB=e_("transitionend"),oB=new Map,xD="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _d(n,e){oB.set(n,e),Sf(e,[n])}for(var PE=0;PE<xD.length;PE++){var DE=xD[PE],jZ=DE.toLowerCase(),VZ=DE[0].toUpperCase()+DE.slice(1);_d(jZ,"on"+VZ)}_d(nB,"onAnimationEnd");_d(rB,"onAnimationIteration");_d(iB,"onAnimationStart");_d("dblclick","onDoubleClick");_d("focusin","onFocus");_d("focusout","onBlur");_d(sB,"onTransitionEnd");Nm("onMouseEnter",["mouseout","mouseover"]);Nm("onMouseLeave",["mouseout","mouseover"]);Nm("onPointerEnter",["pointerout","pointerover"]);Nm("onPointerLeave",["pointerout","pointerover"]);Sf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Sf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Sf("onBeforeInput",["compositionend","keypress","textInput","paste"]);Sf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Sf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Sf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $y="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WZ=new Set("cancel close invalid load scroll toggle".split(" ").concat($y));function wD(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,jY(r,e,void 0,n),n.currentTarget=null}function aB(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;wD(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;wD(i,a,c),s=l}}}if(Ab)throw n=XT,Ab=!1,XT=null,n}function Br(n,e){var t=e[iM];t===void 0&&(t=e[iM]=new Set);var r=n+"__bubble";t.has(r)||(lB(e,n,2,!1),t.add(r))}function LE(n,e,t){var r=0;e&&(r|=4),lB(t,n,r,e)}var Tw="_reactListening"+Math.random().toString(36).slice(2);function Mv(n){if(!n[Tw]){n[Tw]=!0,mU.forEach(function(t){t!=="selectionchange"&&(WZ.has(t)||LE(t,!1,n),LE(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Tw]||(e[Tw]=!0,LE("selectionchange",!1,e))}}function lB(n,e,t,r){switch(HU(e)){case 1:var i=iZ;break;case 4:i=sZ;break;default:i=uk}t=i.bind(null,e,t,n),i=void 0,!qT||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function OE(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Eh(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}IU(function(){var c=s,u=ok(t),d=[];e:{var h=oB.get(n);if(h!==void 0){var f=hk,p=n;switch(n){case"keypress":if(X1(t)===0)break e;case"keydown":case"keyup":f=wZ;break;case"focusin":p="focus",f=NE;break;case"focusout":p="blur",f=NE;break;case"beforeblur":case"afterblur":f=NE;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=lD;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=lZ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=_Z;break;case nB:case rB:case iB:f=dZ;break;case sB:f=CZ;break;case"scroll":f=oZ;break;case"wheel":f=MZ;break;case"copy":case"cut":case"paste":f=fZ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=uD}var x=(e&4)!==0,v=!x&&n==="scroll",y=x?h!==null?h+"Capture":null:h;x=[];for(var b=c,S;b!==null;){S=b;var _=S.stateNode;if(S.tag===5&&_!==null&&(S=_,y!==null&&(_=bv(b,y),_!=null&&x.push(Av(b,_,S)))),v)break;b=b.return}0<x.length&&(h=new f(h,p,null,t,u),d.push({event:h,listeners:x}))}}if(!(e&7)){e:{if(h=n==="mouseover"||n==="pointerover",f=n==="mouseout"||n==="pointerout",h&&t!==HT&&(p=t.relatedTarget||t.fromElement)&&(Eh(p)||p[Fc]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=t.relatedTarget||t.toElement,f=c,p=p?Eh(p):null,p!==null&&(v=_f(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(x=lD,_="onMouseLeave",y="onMouseEnter",b="mouse",(n==="pointerout"||n==="pointerover")&&(x=uD,_="onPointerLeave",y="onPointerEnter",b="pointer"),v=f==null?h:Yp(f),S=p==null?h:Yp(p),h=new x(_,b+"leave",f,t,u),h.target=v,h.relatedTarget=S,_=null,Eh(u)===c&&(x=new x(y,b+"enter",p,t,u),x.target=S,x.relatedTarget=v,_=x),v=_,f&&p)t:{for(x=f,y=p,b=0,S=x;S;S=sp(S))b++;for(S=0,_=y;_;_=sp(_))S++;for(;0<b-S;)x=sp(x),b--;for(;0<S-b;)y=sp(y),S--;for(;b--;){if(x===y||y!==null&&x===y.alternate)break t;x=sp(x),y=sp(y)}x=null}else x=null;f!==null&&bD(d,h,f,x,!1),p!==null&&v!==null&&bD(d,v,p,x,!0)}}e:{if(h=c?Yp(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var T=DZ;else if(fD(h))if(ZU)T=zZ;else{T=OZ;var M=LZ}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(T=FZ);if(T&&(T=T(n,c))){YU(d,T,t,u);break e}M&&M(n,h,c),n==="focusout"&&(M=h._wrapperState)&&M.controlled&&h.type==="number"&&BT(h,"number",h.value)}switch(M=c?Yp(c):window,n){case"focusin":(fD(M)||M.contentEditable==="true")&&(Xp=M,QT=c,tv=null);break;case"focusout":tv=QT=Xp=null;break;case"mousedown":JT=!0;break;case"contextmenu":case"mouseup":case"dragend":JT=!1,vD(d,t,u);break;case"selectionchange":if($Z)break;case"keydown":case"keyup":vD(d,t,u)}var k;if(pk)e:{switch(n){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else qp?XU(n,t)&&(P="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(P="onCompositionStart");P&&(qU&&t.locale!=="ko"&&(qp||P!=="onCompositionStart"?P==="onCompositionEnd"&&qp&&(k=GU()):(Lu=u,dk="value"in Lu?Lu.value:Lu.textContent,qp=!0)),M=Pb(c,P),0<M.length&&(P=new cD(P,n,null,t,u),d.push({event:P,listeners:M}),k?P.data=k:(k=KU(t),k!==null&&(P.data=k)))),(k=NZ?kZ(n,t):IZ(n,t))&&(c=Pb(c,"onBeforeInput"),0<c.length&&(u=new cD("onBeforeInput","beforeinput",null,t,u),d.push({event:u,listeners:c}),u.data=k))}aB(d,e)})}function Av(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Pb(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=bv(n,t),s!=null&&r.unshift(Av(n,s,i)),s=bv(n,e),s!=null&&r.push(Av(n,s,i))),n=n.return}return r}function sp(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function bD(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=bv(t,s),l!=null&&o.unshift(Av(t,l,a))):i||(l=bv(t,s),l!=null&&o.push(Av(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var HZ=/\r\n?/g,GZ=/\u0000|\uFFFD/g;function SD(n){return(typeof n=="string"?n:""+n).replace(HZ,`
`).replace(GZ,"")}function Mw(n,e,t){if(e=SD(e),SD(n)!==e&&t)throw Error(ct(425))}function Db(){}var eM=null,tM=null;function nM(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var rM=typeof setTimeout=="function"?setTimeout:void 0,qZ=typeof clearTimeout=="function"?clearTimeout:void 0,_D=typeof Promise=="function"?Promise:void 0,XZ=typeof queueMicrotask=="function"?queueMicrotask:typeof _D<"u"?function(n){return _D.resolve(null).then(n).catch(KZ)}:rM;function KZ(n){setTimeout(function(){throw n})}function FE(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),Ev(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);Ev(e)}function Vu(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function ED(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var lg=Math.random().toString(36).slice(2),Tl="__reactFiber$"+lg,Nv="__reactProps$"+lg,Fc="__reactContainer$"+lg,iM="__reactEvents$"+lg,YZ="__reactListeners$"+lg,ZZ="__reactHandles$"+lg;function Eh(n){var e=n[Tl];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Fc]||t[Tl]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=ED(n);n!==null;){if(t=n[Tl])return t;n=ED(n)}return e}n=t,t=n.parentNode}return null}function W0(n){return n=n[Tl]||n[Fc],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Yp(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(ct(33))}function t_(n){return n[Nv]||null}var sM=[],Zp=-1;function Ed(n){return{current:n}}function Vr(n){0>Zp||(n.current=sM[Zp],sM[Zp]=null,Zp--)}function Dr(n,e){Zp++,sM[Zp]=n.current,n.current=e}var od={},As=Ed(od),xo=Ed(!1),Zh=od;function km(n,e){var t=n.type.contextTypes;if(!t)return od;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function wo(n){return n=n.childContextTypes,n!=null}function Lb(){Vr(xo),Vr(As)}function CD(n,e,t){if(As.current!==od)throw Error(ct(168));Dr(As,e),Dr(xo,t)}function cB(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ct(108,LY(n)||"Unknown",i));return si({},t,r)}function Ob(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||od,Zh=As.current,Dr(As,n),Dr(xo,xo.current),!0}function TD(n,e,t){var r=n.stateNode;if(!r)throw Error(ct(169));t?(n=cB(n,e,Zh),r.__reactInternalMemoizedMergedChildContext=n,Vr(xo),Vr(As),Dr(As,n)):Vr(xo),Dr(xo,t)}var wc=null,n_=!1,zE=!1;function uB(n){wc===null?wc=[n]:wc.push(n)}function QZ(n){n_=!0,uB(n)}function Cd(){if(!zE&&wc!==null){zE=!0;var n=0,e=xr;try{var t=wc;for(xr=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}wc=null,n_=!1}catch(i){throw wc!==null&&(wc=wc.slice(n+1)),LU(ak,Cd),i}finally{xr=e,zE=!1}}return null}var Qp=[],Jp=0,Fb=null,zb=0,ma=[],ga=0,Qh=null,Tc=1,Mc="";function lh(n,e){Qp[Jp++]=zb,Qp[Jp++]=Fb,Fb=n,zb=e}function dB(n,e,t){ma[ga++]=Tc,ma[ga++]=Mc,ma[ga++]=Qh,Qh=n;var r=Tc;n=Mc;var i=32-Za(r)-1;r&=~(1<<i),t+=1;var s=32-Za(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Tc=1<<32-Za(e)+i|t<<i|r,Mc=s+n}else Tc=1<<s|t<<i|r,Mc=n}function gk(n){n.return!==null&&(lh(n,1),dB(n,1,0))}function yk(n){for(;n===Fb;)Fb=Qp[--Jp],Qp[Jp]=null,zb=Qp[--Jp],Qp[Jp]=null;for(;n===Qh;)Qh=ma[--ga],ma[ga]=null,Mc=ma[--ga],ma[ga]=null,Tc=ma[--ga],ma[ga]=null}var $o=null,Bo=null,Hr=!1,Va=null;function hB(n,e){var t=va(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function MD(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,$o=n,Bo=Vu(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,$o=n,Bo=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Qh!==null?{id:Tc,overflow:Mc}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=va(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,$o=n,Bo=null,!0):!1;default:return!1}}function oM(n){return(n.mode&1)!==0&&(n.flags&128)===0}function aM(n){if(Hr){var e=Bo;if(e){var t=e;if(!MD(n,e)){if(oM(n))throw Error(ct(418));e=Vu(t.nextSibling);var r=$o;e&&MD(n,e)?hB(r,t):(n.flags=n.flags&-4097|2,Hr=!1,$o=n)}}else{if(oM(n))throw Error(ct(418));n.flags=n.flags&-4097|2,Hr=!1,$o=n}}}function AD(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;$o=n}function Aw(n){if(n!==$o)return!1;if(!Hr)return AD(n),Hr=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!nM(n.type,n.memoizedProps)),e&&(e=Bo)){if(oM(n))throw fB(),Error(ct(418));for(;e;)hB(n,e),e=Vu(e.nextSibling)}if(AD(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ct(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Bo=Vu(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Bo=null}}else Bo=$o?Vu(n.stateNode.nextSibling):null;return!0}function fB(){for(var n=Bo;n;)n=Vu(n.nextSibling)}function Im(){Bo=$o=null,Hr=!1}function vk(n){Va===null?Va=[n]:Va.push(n)}var JZ=Yc.ReactCurrentBatchConfig;function uy(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ct(309));var r=t.stateNode}if(!r)throw Error(ct(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(ct(284));if(!t._owner)throw Error(ct(290,n))}return n}function Nw(n,e){throw n=Object.prototype.toString.call(e),Error(ct(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function ND(n){var e=n._init;return e(n._payload)}function pB(n){function e(y,b){if(n){var S=y.deletions;S===null?(y.deletions=[b],y.flags|=16):S.push(b)}}function t(y,b){if(!n)return null;for(;b!==null;)e(y,b),b=b.sibling;return null}function r(y,b){for(y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function i(y,b){return y=qu(y,b),y.index=0,y.sibling=null,y}function s(y,b,S){return y.index=S,n?(S=y.alternate,S!==null?(S=S.index,S<b?(y.flags|=2,b):S):(y.flags|=2,b)):(y.flags|=1048576,b)}function o(y){return n&&y.alternate===null&&(y.flags|=2),y}function a(y,b,S,_){return b===null||b.tag!==6?(b=HE(S,y.mode,_),b.return=y,b):(b=i(b,S),b.return=y,b)}function l(y,b,S,_){var T=S.type;return T===Gp?u(y,b,S.props.children,_,S.key):b!==null&&(b.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Mu&&ND(T)===b.type)?(_=i(b,S.props),_.ref=uy(y,b,S),_.return=y,_):(_=tb(S.type,S.key,S.props,null,y.mode,_),_.ref=uy(y,b,S),_.return=y,_)}function c(y,b,S,_){return b===null||b.tag!==4||b.stateNode.containerInfo!==S.containerInfo||b.stateNode.implementation!==S.implementation?(b=GE(S,y.mode,_),b.return=y,b):(b=i(b,S.children||[]),b.return=y,b)}function u(y,b,S,_,T){return b===null||b.tag!==7?(b=Uh(S,y.mode,_,T),b.return=y,b):(b=i(b,S),b.return=y,b)}function d(y,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return b=HE(""+b,y.mode,S),b.return=y,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case vw:return S=tb(b.type,b.key,b.props,null,y.mode,S),S.ref=uy(y,null,b),S.return=y,S;case Hp:return b=GE(b,y.mode,S),b.return=y,b;case Mu:var _=b._init;return d(y,_(b._payload),S)}if(Uy(b)||sy(b))return b=Uh(b,y.mode,S,null),b.return=y,b;Nw(y,b)}return null}function h(y,b,S,_){var T=b!==null?b.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return T!==null?null:a(y,b,""+S,_);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case vw:return S.key===T?l(y,b,S,_):null;case Hp:return S.key===T?c(y,b,S,_):null;case Mu:return T=S._init,h(y,b,T(S._payload),_)}if(Uy(S)||sy(S))return T!==null?null:u(y,b,S,_,null);Nw(y,S)}return null}function f(y,b,S,_,T){if(typeof _=="string"&&_!==""||typeof _=="number")return y=y.get(S)||null,a(b,y,""+_,T);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case vw:return y=y.get(_.key===null?S:_.key)||null,l(b,y,_,T);case Hp:return y=y.get(_.key===null?S:_.key)||null,c(b,y,_,T);case Mu:var M=_._init;return f(y,b,S,M(_._payload),T)}if(Uy(_)||sy(_))return y=y.get(S)||null,u(b,y,_,T,null);Nw(b,_)}return null}function p(y,b,S,_){for(var T=null,M=null,k=b,P=b=0,z=null;k!==null&&P<S.length;P++){k.index>P?(z=k,k=null):z=k.sibling;var I=h(y,k,S[P],_);if(I===null){k===null&&(k=z);break}n&&k&&I.alternate===null&&e(y,k),b=s(I,b,P),M===null?T=I:M.sibling=I,M=I,k=z}if(P===S.length)return t(y,k),Hr&&lh(y,P),T;if(k===null){for(;P<S.length;P++)k=d(y,S[P],_),k!==null&&(b=s(k,b,P),M===null?T=k:M.sibling=k,M=k);return Hr&&lh(y,P),T}for(k=r(y,k);P<S.length;P++)z=f(k,y,P,S[P],_),z!==null&&(n&&z.alternate!==null&&k.delete(z.key===null?P:z.key),b=s(z,b,P),M===null?T=z:M.sibling=z,M=z);return n&&k.forEach(function(L){return e(y,L)}),Hr&&lh(y,P),T}function x(y,b,S,_){var T=sy(S);if(typeof T!="function")throw Error(ct(150));if(S=T.call(S),S==null)throw Error(ct(151));for(var M=T=null,k=b,P=b=0,z=null,I=S.next();k!==null&&!I.done;P++,I=S.next()){k.index>P?(z=k,k=null):z=k.sibling;var L=h(y,k,I.value,_);if(L===null){k===null&&(k=z);break}n&&k&&L.alternate===null&&e(y,k),b=s(L,b,P),M===null?T=L:M.sibling=L,M=L,k=z}if(I.done)return t(y,k),Hr&&lh(y,P),T;if(k===null){for(;!I.done;P++,I=S.next())I=d(y,I.value,_),I!==null&&(b=s(I,b,P),M===null?T=I:M.sibling=I,M=I);return Hr&&lh(y,P),T}for(k=r(y,k);!I.done;P++,I=S.next())I=f(k,y,P,I.value,_),I!==null&&(n&&I.alternate!==null&&k.delete(I.key===null?P:I.key),b=s(I,b,P),M===null?T=I:M.sibling=I,M=I);return n&&k.forEach(function(W){return e(y,W)}),Hr&&lh(y,P),T}function v(y,b,S,_){if(typeof S=="object"&&S!==null&&S.type===Gp&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case vw:e:{for(var T=S.key,M=b;M!==null;){if(M.key===T){if(T=S.type,T===Gp){if(M.tag===7){t(y,M.sibling),b=i(M,S.props.children),b.return=y,y=b;break e}}else if(M.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Mu&&ND(T)===M.type){t(y,M.sibling),b=i(M,S.props),b.ref=uy(y,M,S),b.return=y,y=b;break e}t(y,M);break}else e(y,M);M=M.sibling}S.type===Gp?(b=Uh(S.props.children,y.mode,_,S.key),b.return=y,y=b):(_=tb(S.type,S.key,S.props,null,y.mode,_),_.ref=uy(y,b,S),_.return=y,y=_)}return o(y);case Hp:e:{for(M=S.key;b!==null;){if(b.key===M)if(b.tag===4&&b.stateNode.containerInfo===S.containerInfo&&b.stateNode.implementation===S.implementation){t(y,b.sibling),b=i(b,S.children||[]),b.return=y,y=b;break e}else{t(y,b);break}else e(y,b);b=b.sibling}b=GE(S,y.mode,_),b.return=y,y=b}return o(y);case Mu:return M=S._init,v(y,b,M(S._payload),_)}if(Uy(S))return p(y,b,S,_);if(sy(S))return x(y,b,S,_);Nw(y,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,b!==null&&b.tag===6?(t(y,b.sibling),b=i(b,S),b.return=y,y=b):(t(y,b),b=HE(S,y.mode,_),b.return=y,y=b),o(y)):t(y,b)}return v}var Rm=pB(!0),mB=pB(!1),Ub=Ed(null),Bb=null,em=null,xk=null;function wk(){xk=em=Bb=null}function bk(n){var e=Ub.current;Vr(Ub),n._currentValue=e}function lM(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function mm(n,e){Bb=n,xk=em=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(go=!0),n.firstContext=null)}function Ta(n){var e=n._currentValue;if(xk!==n)if(n={context:n,memoizedValue:e,next:null},em===null){if(Bb===null)throw Error(ct(308));em=n,Bb.dependencies={lanes:0,firstContext:n}}else em=em.next=n;return e}var Ch=null;function Sk(n){Ch===null?Ch=[n]:Ch.push(n)}function gB(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,Sk(e)):(t.next=i.next,i.next=t),e.interleaved=t,zc(n,r)}function zc(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Au=!1;function _k(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yB(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Nc(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Wu(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,or&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,zc(n,t)}return i=r.interleaved,i===null?(e.next=e,Sk(r)):(e.next=i.next,i.next=e),r.interleaved=e,zc(n,t)}function K1(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,lk(n,t)}}function kD(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function $b(n,e,t,r){var i=n.updateQueue;Au=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=n.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;o=0,u=c=l=null,a=s;do{var h=a.lane,f=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=n,x=a;switch(h=e,f=t,x.tag){case 1:if(p=x.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=x.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=si({},d,h);break e;case 2:Au=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ef|=o,n.lanes=o,n.memoizedState=d}}function ID(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(ct(191,i));i.call(r)}}}var H0={},Ll=Ed(H0),kv=Ed(H0),Iv=Ed(H0);function Th(n){if(n===H0)throw Error(ct(174));return n}function Ek(n,e){switch(Dr(Iv,e),Dr(kv,n),Dr(Ll,H0),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:jT(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=jT(e,n)}Vr(Ll),Dr(Ll,e)}function Pm(){Vr(Ll),Vr(kv),Vr(Iv)}function vB(n){Th(Iv.current);var e=Th(Ll.current),t=jT(e,n.type);e!==t&&(Dr(kv,n),Dr(Ll,t))}function Ck(n){kv.current===n&&(Vr(Ll),Vr(kv))}var Qr=Ed(0);function jb(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var UE=[];function Tk(){for(var n=0;n<UE.length;n++)UE[n]._workInProgressVersionPrimary=null;UE.length=0}var Y1=Yc.ReactCurrentDispatcher,BE=Yc.ReactCurrentBatchConfig,Jh=0,ii=null,Di=null,Ki=null,Vb=!1,nv=!1,Rv=0,eQ=0;function ps(){throw Error(ct(321))}function Mk(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!tl(n[t],e[t]))return!1;return!0}function Ak(n,e,t,r,i,s){if(Jh=s,ii=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Y1.current=n===null||n.memoizedState===null?iQ:sQ,n=t(r,i),nv){s=0;do{if(nv=!1,Rv=0,25<=s)throw Error(ct(301));s+=1,Ki=Di=null,e.updateQueue=null,Y1.current=oQ,n=t(r,i)}while(nv)}if(Y1.current=Wb,e=Di!==null&&Di.next!==null,Jh=0,Ki=Di=ii=null,Vb=!1,e)throw Error(ct(300));return n}function Nk(){var n=Rv!==0;return Rv=0,n}function Sl(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ki===null?ii.memoizedState=Ki=n:Ki=Ki.next=n,Ki}function Ma(){if(Di===null){var n=ii.alternate;n=n!==null?n.memoizedState:null}else n=Di.next;var e=Ki===null?ii.memoizedState:Ki.next;if(e!==null)Ki=e,Di=n;else{if(n===null)throw Error(ct(310));Di=n,n={memoizedState:Di.memoizedState,baseState:Di.baseState,baseQueue:Di.baseQueue,queue:Di.queue,next:null},Ki===null?ii.memoizedState=Ki=n:Ki=Ki.next=n}return Ki}function Pv(n,e){return typeof e=="function"?e(n):e}function $E(n){var e=Ma(),t=e.queue;if(t===null)throw Error(ct(311));t.lastRenderedReducer=n;var r=Di,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((Jh&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=r):l=l.next=d,ii.lanes|=u,ef|=u}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,tl(r,e.memoizedState)||(go=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,ii.lanes|=s,ef|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function jE(n){var e=Ma(),t=e.queue;if(t===null)throw Error(ct(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);tl(s,e.memoizedState)||(go=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function xB(){}function wB(n,e){var t=ii,r=Ma(),i=e(),s=!tl(r.memoizedState,i);if(s&&(r.memoizedState=i,go=!0),r=r.queue,kk(_B.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||Ki!==null&&Ki.memoizedState.tag&1){if(t.flags|=2048,Dv(9,SB.bind(null,t,r,i,e),void 0,null),Qi===null)throw Error(ct(349));Jh&30||bB(t,e,i)}return i}function bB(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=ii.updateQueue,e===null?(e={lastEffect:null,stores:null},ii.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function SB(n,e,t,r){e.value=t,e.getSnapshot=r,EB(e)&&CB(n)}function _B(n,e,t){return t(function(){EB(e)&&CB(n)})}function EB(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!tl(n,t)}catch{return!0}}function CB(n){var e=zc(n,1);e!==null&&Qa(e,n,1,-1)}function RD(n){var e=Sl();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pv,lastRenderedState:n},e.queue=n,n=n.dispatch=rQ.bind(null,ii,n),[e.memoizedState,n]}function Dv(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=ii.updateQueue,e===null?(e={lastEffect:null,stores:null},ii.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function TB(){return Ma().memoizedState}function Z1(n,e,t,r){var i=Sl();ii.flags|=n,i.memoizedState=Dv(1|e,t,void 0,r===void 0?null:r)}function r_(n,e,t,r){var i=Ma();r=r===void 0?null:r;var s=void 0;if(Di!==null){var o=Di.memoizedState;if(s=o.destroy,r!==null&&Mk(r,o.deps)){i.memoizedState=Dv(e,t,s,r);return}}ii.flags|=n,i.memoizedState=Dv(1|e,t,s,r)}function PD(n,e){return Z1(8390656,8,n,e)}function kk(n,e){return r_(2048,8,n,e)}function MB(n,e){return r_(4,2,n,e)}function AB(n,e){return r_(4,4,n,e)}function NB(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function kB(n,e,t){return t=t!=null?t.concat([n]):null,r_(4,4,NB.bind(null,e,n),t)}function Ik(){}function IB(n,e){var t=Ma();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Mk(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function RB(n,e){var t=Ma();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Mk(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function PB(n,e,t){return Jh&21?(tl(t,e)||(t=zU(),ii.lanes|=t,ef|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,go=!0),n.memoizedState=t)}function tQ(n,e){var t=xr;xr=t!==0&&4>t?t:4,n(!0);var r=BE.transition;BE.transition={};try{n(!1),e()}finally{xr=t,BE.transition=r}}function DB(){return Ma().memoizedState}function nQ(n,e,t){var r=Gu(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},LB(n))OB(e,t);else if(t=gB(n,e,t,r),t!==null){var i=Gs();Qa(t,n,r,i),FB(t,e,r)}}function rQ(n,e,t){var r=Gu(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(LB(n))OB(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(i.hasEagerState=!0,i.eagerState=a,tl(a,o)){var l=e.interleaved;l===null?(i.next=i,Sk(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=gB(n,e,i,r),t!==null&&(i=Gs(),Qa(t,n,r,i),FB(t,e,r))}}function LB(n){var e=n.alternate;return n===ii||e!==null&&e===ii}function OB(n,e){nv=Vb=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function FB(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,lk(n,t)}}var Wb={readContext:Ta,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},iQ={readContext:Ta,useCallback:function(n,e){return Sl().memoizedState=[n,e===void 0?null:e],n},useContext:Ta,useEffect:PD,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Z1(4194308,4,NB.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Z1(4194308,4,n,e)},useInsertionEffect:function(n,e){return Z1(4,2,n,e)},useMemo:function(n,e){var t=Sl();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Sl();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=nQ.bind(null,ii,n),[r.memoizedState,n]},useRef:function(n){var e=Sl();return n={current:n},e.memoizedState=n},useState:RD,useDebugValue:Ik,useDeferredValue:function(n){return Sl().memoizedState=n},useTransition:function(){var n=RD(!1),e=n[0];return n=tQ.bind(null,n[1]),Sl().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=ii,i=Sl();if(Hr){if(t===void 0)throw Error(ct(407));t=t()}else{if(t=e(),Qi===null)throw Error(ct(349));Jh&30||bB(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,PD(_B.bind(null,r,s,n),[n]),r.flags|=2048,Dv(9,SB.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=Sl(),e=Qi.identifierPrefix;if(Hr){var t=Mc,r=Tc;t=(r&~(1<<32-Za(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Rv++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=eQ++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},sQ={readContext:Ta,useCallback:IB,useContext:Ta,useEffect:kk,useImperativeHandle:kB,useInsertionEffect:MB,useLayoutEffect:AB,useMemo:RB,useReducer:$E,useRef:TB,useState:function(){return $E(Pv)},useDebugValue:Ik,useDeferredValue:function(n){var e=Ma();return PB(e,Di.memoizedState,n)},useTransition:function(){var n=$E(Pv)[0],e=Ma().memoizedState;return[n,e]},useMutableSource:xB,useSyncExternalStore:wB,useId:DB,unstable_isNewReconciler:!1},oQ={readContext:Ta,useCallback:IB,useContext:Ta,useEffect:kk,useImperativeHandle:kB,useInsertionEffect:MB,useLayoutEffect:AB,useMemo:RB,useReducer:jE,useRef:TB,useState:function(){return jE(Pv)},useDebugValue:Ik,useDeferredValue:function(n){var e=Ma();return Di===null?e.memoizedState=n:PB(e,Di.memoizedState,n)},useTransition:function(){var n=jE(Pv)[0],e=Ma().memoizedState;return[n,e]},useMutableSource:xB,useSyncExternalStore:wB,useId:DB,unstable_isNewReconciler:!1};function Ba(n,e){if(n&&n.defaultProps){e=si({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function cM(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:si({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var i_={isMounted:function(n){return(n=n._reactInternals)?_f(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Gs(),i=Gu(n),s=Nc(r,i);s.payload=e,t!=null&&(s.callback=t),e=Wu(n,s,i),e!==null&&(Qa(e,n,i,r),K1(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Gs(),i=Gu(n),s=Nc(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Wu(n,s,i),e!==null&&(Qa(e,n,i,r),K1(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Gs(),r=Gu(n),i=Nc(t,r);i.tag=2,e!=null&&(i.callback=e),e=Wu(n,i,r),e!==null&&(Qa(e,n,r,t),K1(e,n,r))}};function DD(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Tv(t,r)||!Tv(i,s):!0}function zB(n,e,t){var r=!1,i=od,s=e.contextType;return typeof s=="object"&&s!==null?s=Ta(s):(i=wo(e)?Zh:As.current,r=e.contextTypes,s=(r=r!=null)?km(n,i):od),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=i_,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function LD(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&i_.enqueueReplaceState(e,e.state,null)}function uM(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},_k(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Ta(s):(s=wo(e)?Zh:As.current,i.context=km(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(cM(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&i_.enqueueReplaceState(i,i.state,null),$b(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Dm(n,e){try{var t="",r=e;do t+=DY(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function VE(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function dM(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var aQ=typeof WeakMap=="function"?WeakMap:Map;function UB(n,e,t){t=Nc(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Gb||(Gb=!0,bM=r),dM(n,e)},t}function BB(n,e,t){t=Nc(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){dM(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){dM(n,e),typeof r!="function"&&(Hu===null?Hu=new Set([this]):Hu.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function OD(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new aQ;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=bQ.bind(null,n,e,t),e.then(n,n))}function FD(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function zD(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Nc(-1,1),e.tag=2,Wu(t,e,1))),t.lanes|=1),n)}var lQ=Yc.ReactCurrentOwner,go=!1;function $s(n,e,t,r){e.child=n===null?mB(e,null,t,r):Rm(e,n.child,t,r)}function UD(n,e,t,r,i){t=t.render;var s=e.ref;return mm(e,i),r=Ak(n,e,t,r,s,i),t=Nk(),n!==null&&!go?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Uc(n,e,i)):(Hr&&t&&gk(e),e.flags|=1,$s(n,e,r,i),e.child)}function BD(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!Uk(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,$B(n,e,s,r,i)):(n=tb(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:Tv,t(o,r)&&n.ref===e.ref)return Uc(n,e,i)}return e.flags|=1,n=qu(s,r),n.ref=e.ref,n.return=e,e.child=n}function $B(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(Tv(s,r)&&n.ref===e.ref)if(go=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(go=!0);else return e.lanes=n.lanes,Uc(n,e,i)}return hM(n,e,t,r,i)}function jB(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dr(nm,Do),Do|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Dr(nm,Do),Do|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,Dr(nm,Do),Do|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,Dr(nm,Do),Do|=r;return $s(n,e,i,t),e.child}function VB(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function hM(n,e,t,r,i){var s=wo(t)?Zh:As.current;return s=km(e,s),mm(e,i),t=Ak(n,e,t,r,s,i),r=Nk(),n!==null&&!go?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Uc(n,e,i)):(Hr&&r&&gk(e),e.flags|=1,$s(n,e,t,i),e.child)}function $D(n,e,t,r,i){if(wo(t)){var s=!0;Ob(e)}else s=!1;if(mm(e,i),e.stateNode===null)Q1(n,e),zB(e,t,r),uM(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=Ta(c):(c=wo(t)?Zh:As.current,c=km(e,c));var u=t.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&LD(e,o,r,c),Au=!1;var h=e.memoizedState;o.state=h,$b(e,r,o,i),l=e.memoizedState,a!==r||h!==l||xo.current||Au?(typeof u=="function"&&(cM(e,t,u,r),l=e.memoizedState),(a=Au||DD(e,t,a,r,h,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,yB(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:Ba(e.type,a),o.props=c,d=e.pendingProps,h=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Ta(l):(l=wo(t)?Zh:As.current,l=km(e,l));var f=t.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&LD(e,o,r,l),Au=!1,h=e.memoizedState,o.state=h,$b(e,r,o,i);var p=e.memoizedState;a!==d||h!==p||xo.current||Au?(typeof f=="function"&&(cM(e,t,f,r),p=e.memoizedState),(c=Au||DD(e,t,c,r,h,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=1024),r=!1)}return fM(n,e,t,r,s,i)}function fM(n,e,t,r,i,s){VB(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&TD(e,t,!1),Uc(n,e,s);r=e.stateNode,lQ.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=Rm(e,n.child,null,s),e.child=Rm(e,null,a,s)):$s(n,e,a,s),e.memoizedState=r.state,i&&TD(e,t,!0),e.child}function WB(n){var e=n.stateNode;e.pendingContext?CD(n,e.pendingContext,e.pendingContext!==e.context):e.context&&CD(n,e.context,!1),Ek(n,e.containerInfo)}function jD(n,e,t,r,i){return Im(),vk(i),e.flags|=256,$s(n,e,t,r),e.child}var pM={dehydrated:null,treeContext:null,retryLane:0};function mM(n){return{baseLanes:n,cachePool:null,transitions:null}}function HB(n,e,t){var r=e.pendingProps,i=Qr.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Dr(Qr,i&1),n===null)return aM(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=a_(o,r,0,null),n=Uh(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=mM(t),e.memoizedState=pM,n):Rk(e,o));if(i=n.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return cQ(n,e,o,r,a,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=qu(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=qu(a,s):(s=Uh(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?mM(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=pM,r}return s=n.child,n=s.sibling,r=qu(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Rk(n,e){return e=a_({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function kw(n,e,t,r){return r!==null&&vk(r),Rm(e,n.child,null,t),n=Rk(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function cQ(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=VE(Error(ct(422))),kw(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=a_({mode:"visible",children:r.children},i,0,null),s=Uh(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Rm(e,n.child,null,o),e.child.memoizedState=mM(o),e.memoizedState=pM,s);if(!(e.mode&1))return kw(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ct(419)),r=VE(s,r,void 0),kw(n,e,o,r)}if(a=(o&n.childLanes)!==0,go||a){if(r=Qi,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,zc(n,i),Qa(r,n,i,-1))}return zk(),r=VE(Error(ct(421))),kw(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=SQ.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,Bo=Vu(i.nextSibling),$o=e,Hr=!0,Va=null,n!==null&&(ma[ga++]=Tc,ma[ga++]=Mc,ma[ga++]=Qh,Tc=n.id,Mc=n.overflow,Qh=e),e=Rk(e,r.children),e.flags|=4096,e)}function VD(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),lM(n.return,e,t)}function WE(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function GB(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if($s(n,e,r.children,t),r=Qr.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&VD(n,t,e);else if(n.tag===19)VD(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Dr(Qr,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&jb(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),WE(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&jb(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}WE(e,!0,t,null,s);break;case"together":WE(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Q1(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Uc(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),ef|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(ct(153));if(e.child!==null){for(n=e.child,t=qu(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=qu(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function uQ(n,e,t){switch(e.tag){case 3:WB(e),Im();break;case 5:vB(e);break;case 1:wo(e.type)&&Ob(e);break;case 4:Ek(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Dr(Ub,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Dr(Qr,Qr.current&1),e.flags|=128,null):t&e.child.childLanes?HB(n,e,t):(Dr(Qr,Qr.current&1),n=Uc(n,e,t),n!==null?n.sibling:null);Dr(Qr,Qr.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return GB(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Dr(Qr,Qr.current),r)break;return null;case 22:case 23:return e.lanes=0,jB(n,e,t)}return Uc(n,e,t)}var qB,gM,XB,KB;qB=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};gM=function(){};XB=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Th(Ll.current);var s=null;switch(t){case"input":i=zT(n,i),r=zT(n,r),s=[];break;case"select":i=si({},i,{value:void 0}),r=si({},r,{value:void 0}),s=[];break;case"textarea":i=$T(n,i),r=$T(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=Db)}VT(t,r);var o;t=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(xv.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(xv.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Br("scroll",n),s||a===l||(s=[])):(s=s||[]).push(c,l))}t&&(s=s||[]).push("style",t);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};KB=function(n,e,t,r){t!==r&&(e.flags|=4)};function dy(n,e){if(!Hr)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function ms(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function dQ(n,e,t){var r=e.pendingProps;switch(yk(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ms(e),null;case 1:return wo(e.type)&&Lb(),ms(e),null;case 3:return r=e.stateNode,Pm(),Vr(xo),Vr(As),Tk(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Aw(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Va!==null&&(EM(Va),Va=null))),gM(n,e),ms(e),null;case 5:Ck(e);var i=Th(Iv.current);if(t=e.type,n!==null&&e.stateNode!=null)XB(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ct(166));return ms(e),null}if(n=Th(Ll.current),Aw(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[Tl]=e,r[Nv]=s,n=(e.mode&1)!==0,t){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(i=0;i<$y.length;i++)Br($y[i],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":QP(r,s),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Br("invalid",r);break;case"textarea":eD(r,s),Br("invalid",r)}VT(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Mw(r.textContent,a,n),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Mw(r.textContent,a,n),i=["children",""+a]):xv.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Br("scroll",r)}switch(t){case"input":xw(r),JP(r,s,!0);break;case"textarea":xw(r),tD(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Db)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=_U(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Tl]=e,n[Nv]=r,qB(n,e,!1,!1),e.stateNode=n;e:{switch(o=WT(t,r),t){case"dialog":Br("cancel",n),Br("close",n),i=r;break;case"iframe":case"object":case"embed":Br("load",n),i=r;break;case"video":case"audio":for(i=0;i<$y.length;i++)Br($y[i],n);i=r;break;case"source":Br("error",n),i=r;break;case"img":case"image":case"link":Br("error",n),Br("load",n),i=r;break;case"details":Br("toggle",n),i=r;break;case"input":QP(n,r),i=zT(n,r),Br("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=si({},r,{value:void 0}),Br("invalid",n);break;case"textarea":eD(n,r),i=$T(n,r),Br("invalid",n);break;default:i=r}VT(t,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?TU(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&EU(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&wv(n,l):typeof l=="number"&&wv(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(xv.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Br("scroll",n):l!=null&&nk(n,s,l,o))}switch(t){case"input":xw(n),JP(n,r,!1);break;case"textarea":xw(n),tD(n);break;case"option":r.value!=null&&n.setAttribute("value",""+sd(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?dm(n,!!r.multiple,s,!1):r.defaultValue!=null&&dm(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Db)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ms(e),null;case 6:if(n&&e.stateNode!=null)KB(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ct(166));if(t=Th(Iv.current),Th(Ll.current),Aw(e)){if(r=e.stateNode,t=e.memoizedProps,r[Tl]=e,(s=r.nodeValue!==t)&&(n=$o,n!==null))switch(n.tag){case 3:Mw(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Mw(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Tl]=e,e.stateNode=r}return ms(e),null;case 13:if(Vr(Qr),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Hr&&Bo!==null&&e.mode&1&&!(e.flags&128))fB(),Im(),e.flags|=98560,s=!1;else if(s=Aw(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(ct(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ct(317));s[Tl]=e}else Im(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ms(e),s=!1}else Va!==null&&(EM(Va),Va=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Qr.current&1?Oi===0&&(Oi=3):zk())),e.updateQueue!==null&&(e.flags|=4),ms(e),null);case 4:return Pm(),gM(n,e),n===null&&Mv(e.stateNode.containerInfo),ms(e),null;case 10:return bk(e.type._context),ms(e),null;case 17:return wo(e.type)&&Lb(),ms(e),null;case 19:if(Vr(Qr),s=e.memoizedState,s===null)return ms(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)dy(s,!1);else{if(Oi!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=jb(n),o!==null){for(e.flags|=128,dy(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Dr(Qr,Qr.current&1|2),e.child}n=n.sibling}s.tail!==null&&vi()>Lm&&(e.flags|=128,r=!0,dy(s,!1),e.lanes=4194304)}else{if(!r)if(n=jb(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),dy(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Hr)return ms(e),null}else 2*vi()-s.renderingStartTime>Lm&&t!==1073741824&&(e.flags|=128,r=!0,dy(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=vi(),e.sibling=null,t=Qr.current,Dr(Qr,r?t&1|2:t&1),e):(ms(e),null);case 22:case 23:return Fk(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Do&1073741824&&(ms(e),e.subtreeFlags&6&&(e.flags|=8192)):ms(e),null;case 24:return null;case 25:return null}throw Error(ct(156,e.tag))}function hQ(n,e){switch(yk(e),e.tag){case 1:return wo(e.type)&&Lb(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Pm(),Vr(xo),Vr(As),Tk(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Ck(e),null;case 13:if(Vr(Qr),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(ct(340));Im()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Vr(Qr),null;case 4:return Pm(),null;case 10:return bk(e.type._context),null;case 22:case 23:return Fk(),null;case 24:return null;default:return null}}var Iw=!1,_s=!1,fQ=typeof WeakSet=="function"?WeakSet:Set,Vt=null;function tm(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){ui(n,e,r)}else t.current=null}function yM(n,e,t){try{t()}catch(r){ui(n,e,r)}}var WD=!1;function pQ(n,e){if(eM=Ib,n=eB(),mk(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=n,h=null;t:for(;;){for(var f;d!==t||i!==0&&d.nodeType!==3||(a=o+i),d!==s||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===n)break t;if(h===t&&++c===i&&(a=o),h===s&&++u===r&&(l=o),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(tM={focusedElem:n,selectionRange:t},Ib=!1,Vt=e;Vt!==null;)if(e=Vt,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Vt=n;else for(;Vt!==null;){e=Vt;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var x=p.memoizedProps,v=p.memoizedState,y=e.stateNode,b=y.getSnapshotBeforeUpdate(e.elementType===e.type?x:Ba(e.type,x),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ct(163))}}catch(_){ui(e,e.return,_)}if(n=e.sibling,n!==null){n.return=e.return,Vt=n;break}Vt=e.return}return p=WD,WD=!1,p}function rv(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&yM(e,t,s)}i=i.next}while(i!==r)}}function s_(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function vM(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function YB(n){var e=n.alternate;e!==null&&(n.alternate=null,YB(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Tl],delete e[Nv],delete e[iM],delete e[YZ],delete e[ZZ])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function ZB(n){return n.tag===5||n.tag===3||n.tag===4}function HD(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||ZB(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function xM(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Db));else if(r!==4&&(n=n.child,n!==null))for(xM(n,e,t),n=n.sibling;n!==null;)xM(n,e,t),n=n.sibling}function wM(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(wM(n,e,t),n=n.sibling;n!==null;)wM(n,e,t),n=n.sibling}var ts=null,ja=!1;function hu(n,e,t){for(t=t.child;t!==null;)QB(n,e,t),t=t.sibling}function QB(n,e,t){if(Dl&&typeof Dl.onCommitFiberUnmount=="function")try{Dl.onCommitFiberUnmount(ZS,t)}catch{}switch(t.tag){case 5:_s||tm(t,e);case 6:var r=ts,i=ja;ts=null,hu(n,e,t),ts=r,ja=i,ts!==null&&(ja?(n=ts,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):ts.removeChild(t.stateNode));break;case 18:ts!==null&&(ja?(n=ts,t=t.stateNode,n.nodeType===8?FE(n.parentNode,t):n.nodeType===1&&FE(n,t),Ev(n)):FE(ts,t.stateNode));break;case 4:r=ts,i=ja,ts=t.stateNode.containerInfo,ja=!0,hu(n,e,t),ts=r,ja=i;break;case 0:case 11:case 14:case 15:if(!_s&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&yM(t,e,o),i=i.next}while(i!==r)}hu(n,e,t);break;case 1:if(!_s&&(tm(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){ui(t,e,a)}hu(n,e,t);break;case 21:hu(n,e,t);break;case 22:t.mode&1?(_s=(r=_s)||t.memoizedState!==null,hu(n,e,t),_s=r):hu(n,e,t);break;default:hu(n,e,t)}}function GD(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new fQ),e.forEach(function(r){var i=_Q.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function Da(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:ts=a.stateNode,ja=!1;break e;case 3:ts=a.stateNode.containerInfo,ja=!0;break e;case 4:ts=a.stateNode.containerInfo,ja=!0;break e}a=a.return}if(ts===null)throw Error(ct(160));QB(s,o,i),ts=null,ja=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){ui(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)JB(e,n),e=e.sibling}function JB(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Da(e,n),xl(n),r&4){try{rv(3,n,n.return),s_(3,n)}catch(x){ui(n,n.return,x)}try{rv(5,n,n.return)}catch(x){ui(n,n.return,x)}}break;case 1:Da(e,n),xl(n),r&512&&t!==null&&tm(t,t.return);break;case 5:if(Da(e,n),xl(n),r&512&&t!==null&&tm(t,t.return),n.flags&32){var i=n.stateNode;try{wv(i,"")}catch(x){ui(n,n.return,x)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&bU(i,s),WT(a,o);var c=WT(a,s);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?TU(i,d):u==="dangerouslySetInnerHTML"?EU(i,d):u==="children"?wv(i,d):nk(i,u,d,c)}switch(a){case"input":UT(i,s);break;case"textarea":SU(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?dm(i,!!s.multiple,f,!1):h!==!!s.multiple&&(s.defaultValue!=null?dm(i,!!s.multiple,s.defaultValue,!0):dm(i,!!s.multiple,s.multiple?[]:"",!1))}i[Nv]=s}catch(x){ui(n,n.return,x)}}break;case 6:if(Da(e,n),xl(n),r&4){if(n.stateNode===null)throw Error(ct(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(x){ui(n,n.return,x)}}break;case 3:if(Da(e,n),xl(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Ev(e.containerInfo)}catch(x){ui(n,n.return,x)}break;case 4:Da(e,n),xl(n);break;case 13:Da(e,n),xl(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Lk=vi())),r&4&&GD(n);break;case 22:if(u=t!==null&&t.memoizedState!==null,n.mode&1?(_s=(c=_s)||u,Da(e,n),_s=c):Da(e,n),xl(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!u&&n.mode&1)for(Vt=n,u=n.child;u!==null;){for(d=Vt=u;Vt!==null;){switch(h=Vt,f=h.child,h.tag){case 0:case 11:case 14:case 15:rv(4,h,h.return);break;case 1:tm(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,t=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(x){ui(r,t,x)}}break;case 5:tm(h,h.return);break;case 22:if(h.memoizedState!==null){XD(d);continue}}f!==null?(f.return=h,Vt=f):XD(d)}u=u.sibling}e:for(u=null,d=n;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=CU("display",o))}catch(x){ui(n,n.return,x)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(x){ui(n,n.return,x)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Da(e,n),xl(n),r&4&&GD(n);break;case 21:break;default:Da(e,n),xl(n)}}function xl(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(ZB(t)){var r=t;break e}t=t.return}throw Error(ct(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(wv(i,""),r.flags&=-33);var s=HD(n);wM(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=HD(n);xM(n,a,o);break;default:throw Error(ct(161))}}catch(l){ui(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function mQ(n,e,t){Vt=n,e$(n)}function e$(n,e,t){for(var r=(n.mode&1)!==0;Vt!==null;){var i=Vt,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Iw;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||_s;a=Iw;var c=_s;if(Iw=o,(_s=l)&&!c)for(Vt=i;Vt!==null;)o=Vt,l=o.child,o.tag===22&&o.memoizedState!==null?KD(i):l!==null?(l.return=o,Vt=l):KD(i);for(;s!==null;)Vt=s,e$(s),s=s.sibling;Vt=i,Iw=a,_s=c}qD(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Vt=s):qD(n)}}function qD(n){for(;Vt!==null;){var e=Vt;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:_s||s_(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!_s)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Ba(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&ID(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}ID(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Ev(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ct(163))}_s||e.flags&512&&vM(e)}catch(h){ui(e,e.return,h)}}if(e===n){Vt=null;break}if(t=e.sibling,t!==null){t.return=e.return,Vt=t;break}Vt=e.return}}function XD(n){for(;Vt!==null;){var e=Vt;if(e===n){Vt=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Vt=t;break}Vt=e.return}}function KD(n){for(;Vt!==null;){var e=Vt;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{s_(4,e)}catch(l){ui(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){ui(e,i,l)}}var s=e.return;try{vM(e)}catch(l){ui(e,s,l)}break;case 5:var o=e.return;try{vM(e)}catch(l){ui(e,o,l)}}}catch(l){ui(e,e.return,l)}if(e===n){Vt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Vt=a;break}Vt=e.return}}var gQ=Math.ceil,Hb=Yc.ReactCurrentDispatcher,Pk=Yc.ReactCurrentOwner,Sa=Yc.ReactCurrentBatchConfig,or=0,Qi=null,ki=null,ss=0,Do=0,nm=Ed(0),Oi=0,Lv=null,ef=0,o_=0,Dk=0,iv=null,mo=null,Lk=0,Lm=1/0,xc=null,Gb=!1,bM=null,Hu=null,Rw=!1,Ou=null,qb=0,sv=0,SM=null,J1=-1,eb=0;function Gs(){return or&6?vi():J1!==-1?J1:J1=vi()}function Gu(n){return n.mode&1?or&2&&ss!==0?ss&-ss:JZ.transition!==null?(eb===0&&(eb=zU()),eb):(n=xr,n!==0||(n=window.event,n=n===void 0?16:HU(n.type)),n):1}function Qa(n,e,t,r){if(50<sv)throw sv=0,SM=null,Error(ct(185));j0(n,t,r),(!(or&2)||n!==Qi)&&(n===Qi&&(!(or&2)&&(o_|=t),Oi===4&&Iu(n,ss)),bo(n,r),t===1&&or===0&&!(e.mode&1)&&(Lm=vi()+500,n_&&Cd()))}function bo(n,e){var t=n.callbackNode;JY(n,e);var r=kb(n,n===Qi?ss:0);if(r===0)t!==null&&iD(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&iD(t),e===1)n.tag===0?QZ(YD.bind(null,n)):uB(YD.bind(null,n)),XZ(function(){!(or&6)&&Cd()}),t=null;else{switch(UU(r)){case 1:t=ak;break;case 4:t=OU;break;case 16:t=Nb;break;case 536870912:t=FU;break;default:t=Nb}t=l$(t,t$.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function t$(n,e){if(J1=-1,eb=0,or&6)throw Error(ct(327));var t=n.callbackNode;if(gm()&&n.callbackNode!==t)return null;var r=kb(n,n===Qi?ss:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Xb(n,r);else{e=r;var i=or;or|=2;var s=r$();(Qi!==n||ss!==e)&&(xc=null,Lm=vi()+500,zh(n,e));do try{xQ();break}catch(a){n$(n,a)}while(!0);wk(),Hb.current=s,or=i,ki!==null?e=0:(Qi=null,ss=0,e=Oi)}if(e!==0){if(e===2&&(i=KT(n),i!==0&&(r=i,e=_M(n,i))),e===1)throw t=Lv,zh(n,0),Iu(n,r),bo(n,vi()),t;if(e===6)Iu(n,r);else{if(i=n.current.alternate,!(r&30)&&!yQ(i)&&(e=Xb(n,r),e===2&&(s=KT(n),s!==0&&(r=s,e=_M(n,s))),e===1))throw t=Lv,zh(n,0),Iu(n,r),bo(n,vi()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(ct(345));case 2:ch(n,mo,xc);break;case 3:if(Iu(n,r),(r&130023424)===r&&(e=Lk+500-vi(),10<e)){if(kb(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){Gs(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=rM(ch.bind(null,n,mo,xc),e);break}ch(n,mo,xc);break;case 4:if(Iu(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-Za(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=vi()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*gQ(r/1960))-r,10<r){n.timeoutHandle=rM(ch.bind(null,n,mo,xc),r);break}ch(n,mo,xc);break;case 5:ch(n,mo,xc);break;default:throw Error(ct(329))}}}return bo(n,vi()),n.callbackNode===t?t$.bind(null,n):null}function _M(n,e){var t=iv;return n.current.memoizedState.isDehydrated&&(zh(n,e).flags|=256),n=Xb(n,e),n!==2&&(e=mo,mo=t,e!==null&&EM(e)),n}function EM(n){mo===null?mo=n:mo.push.apply(mo,n)}function yQ(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!tl(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Iu(n,e){for(e&=~Dk,e&=~o_,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Za(e),r=1<<t;n[t]=-1,e&=~r}}function YD(n){if(or&6)throw Error(ct(327));gm();var e=kb(n,0);if(!(e&1))return bo(n,vi()),null;var t=Xb(n,e);if(n.tag!==0&&t===2){var r=KT(n);r!==0&&(e=r,t=_M(n,r))}if(t===1)throw t=Lv,zh(n,0),Iu(n,e),bo(n,vi()),t;if(t===6)throw Error(ct(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,ch(n,mo,xc),bo(n,vi()),null}function Ok(n,e){var t=or;or|=1;try{return n(e)}finally{or=t,or===0&&(Lm=vi()+500,n_&&Cd())}}function tf(n){Ou!==null&&Ou.tag===0&&!(or&6)&&gm();var e=or;or|=1;var t=Sa.transition,r=xr;try{if(Sa.transition=null,xr=1,n)return n()}finally{xr=r,Sa.transition=t,or=e,!(or&6)&&Cd()}}function Fk(){Do=nm.current,Vr(nm)}function zh(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,qZ(t)),ki!==null)for(t=ki.return;t!==null;){var r=t;switch(yk(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Lb();break;case 3:Pm(),Vr(xo),Vr(As),Tk();break;case 5:Ck(r);break;case 4:Pm();break;case 13:Vr(Qr);break;case 19:Vr(Qr);break;case 10:bk(r.type._context);break;case 22:case 23:Fk()}t=t.return}if(Qi=n,ki=n=qu(n.current,null),ss=Do=e,Oi=0,Lv=null,Dk=o_=ef=0,mo=iv=null,Ch!==null){for(e=0;e<Ch.length;e++)if(t=Ch[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}Ch=null}return n}function n$(n,e){do{var t=ki;try{if(wk(),Y1.current=Wb,Vb){for(var r=ii.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Vb=!1}if(Jh=0,Ki=Di=ii=null,nv=!1,Rv=0,Pk.current=null,t===null||t.return===null){Oi=1,Lv=e,ki=null;break}e:{var s=n,o=t.return,a=t,l=e;if(e=ss,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=FD(o);if(f!==null){f.flags&=-257,zD(f,o,a,s,e),f.mode&1&&OD(s,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var x=new Set;x.add(l),e.updateQueue=x}else p.add(l);break e}else{if(!(e&1)){OD(s,c,e),zk();break e}l=Error(ct(426))}}else if(Hr&&a.mode&1){var v=FD(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),zD(v,o,a,s,e),vk(Dm(l,a));break e}}s=l=Dm(l,a),Oi!==4&&(Oi=2),iv===null?iv=[s]:iv.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=UB(s,l,e);kD(s,y);break e;case 1:a=l;var b=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof b.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Hu===null||!Hu.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var _=BB(s,a,e);kD(s,_);break e}}s=s.return}while(s!==null)}s$(t)}catch(T){e=T,ki===t&&t!==null&&(ki=t=t.return);continue}break}while(!0)}function r$(){var n=Hb.current;return Hb.current=Wb,n===null?Wb:n}function zk(){(Oi===0||Oi===3||Oi===2)&&(Oi=4),Qi===null||!(ef&268435455)&&!(o_&268435455)||Iu(Qi,ss)}function Xb(n,e){var t=or;or|=2;var r=r$();(Qi!==n||ss!==e)&&(xc=null,zh(n,e));do try{vQ();break}catch(i){n$(n,i)}while(!0);if(wk(),or=t,Hb.current=r,ki!==null)throw Error(ct(261));return Qi=null,ss=0,Oi}function vQ(){for(;ki!==null;)i$(ki)}function xQ(){for(;ki!==null&&!WY();)i$(ki)}function i$(n){var e=a$(n.alternate,n,Do);n.memoizedProps=n.pendingProps,e===null?s$(n):ki=e,Pk.current=null}function s$(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=hQ(t,e),t!==null){t.flags&=32767,ki=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Oi=6,ki=null;return}}else if(t=dQ(t,e,Do),t!==null){ki=t;return}if(e=e.sibling,e!==null){ki=e;return}ki=e=n}while(e!==null);Oi===0&&(Oi=5)}function ch(n,e,t){var r=xr,i=Sa.transition;try{Sa.transition=null,xr=1,wQ(n,e,t,r)}finally{Sa.transition=i,xr=r}return null}function wQ(n,e,t,r){do gm();while(Ou!==null);if(or&6)throw Error(ct(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(ct(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(eZ(n,s),n===Qi&&(ki=Qi=null,ss=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Rw||(Rw=!0,l$(Nb,function(){return gm(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=Sa.transition,Sa.transition=null;var o=xr;xr=1;var a=or;or|=4,Pk.current=null,pQ(n,t),JB(t,n),BZ(tM),Ib=!!eM,tM=eM=null,n.current=t,mQ(t),HY(),or=a,xr=o,Sa.transition=s}else n.current=t;if(Rw&&(Rw=!1,Ou=n,qb=i),s=n.pendingLanes,s===0&&(Hu=null),XY(t.stateNode),bo(n,vi()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(Gb)throw Gb=!1,n=bM,bM=null,n;return qb&1&&n.tag!==0&&gm(),s=n.pendingLanes,s&1?n===SM?sv++:(sv=0,SM=n):sv=0,Cd(),null}function gm(){if(Ou!==null){var n=UU(qb),e=Sa.transition,t=xr;try{if(Sa.transition=null,xr=16>n?16:n,Ou===null)var r=!1;else{if(n=Ou,Ou=null,qb=0,or&6)throw Error(ct(331));var i=or;for(or|=4,Vt=n.current;Vt!==null;){var s=Vt,o=s.child;if(Vt.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Vt=c;Vt!==null;){var u=Vt;switch(u.tag){case 0:case 11:case 15:rv(8,u,s)}var d=u.child;if(d!==null)d.return=u,Vt=d;else for(;Vt!==null;){u=Vt;var h=u.sibling,f=u.return;if(YB(u),u===c){Vt=null;break}if(h!==null){h.return=f,Vt=h;break}Vt=f}}}var p=s.alternate;if(p!==null){var x=p.child;if(x!==null){p.child=null;do{var v=x.sibling;x.sibling=null,x=v}while(x!==null)}}Vt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Vt=o;else e:for(;Vt!==null;){if(s=Vt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:rv(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,Vt=y;break e}Vt=s.return}}var b=n.current;for(Vt=b;Vt!==null;){o=Vt;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,Vt=S;else e:for(o=b;Vt!==null;){if(a=Vt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:s_(9,a)}}catch(T){ui(a,a.return,T)}if(a===o){Vt=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,Vt=_;break e}Vt=a.return}}if(or=i,Cd(),Dl&&typeof Dl.onPostCommitFiberRoot=="function")try{Dl.onPostCommitFiberRoot(ZS,n)}catch{}r=!0}return r}finally{xr=t,Sa.transition=e}}return!1}function ZD(n,e,t){e=Dm(t,e),e=UB(n,e,1),n=Wu(n,e,1),e=Gs(),n!==null&&(j0(n,1,e),bo(n,e))}function ui(n,e,t){if(n.tag===3)ZD(n,n,t);else for(;e!==null;){if(e.tag===3){ZD(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Hu===null||!Hu.has(r))){n=Dm(t,n),n=BB(e,n,1),e=Wu(e,n,1),n=Gs(),e!==null&&(j0(e,1,n),bo(e,n));break}}e=e.return}}function bQ(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Gs(),n.pingedLanes|=n.suspendedLanes&t,Qi===n&&(ss&t)===t&&(Oi===4||Oi===3&&(ss&130023424)===ss&&500>vi()-Lk?zh(n,0):Dk|=t),bo(n,e)}function o$(n,e){e===0&&(n.mode&1?(e=Sw,Sw<<=1,!(Sw&130023424)&&(Sw=4194304)):e=1);var t=Gs();n=zc(n,e),n!==null&&(j0(n,e,t),bo(n,t))}function SQ(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),o$(n,t)}function _Q(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(ct(314))}r!==null&&r.delete(e),o$(n,t)}var a$;a$=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||xo.current)go=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return go=!1,uQ(n,e,t);go=!!(n.flags&131072)}else go=!1,Hr&&e.flags&1048576&&dB(e,zb,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Q1(n,e),n=e.pendingProps;var i=km(e,As.current);mm(e,t),i=Ak(null,e,r,n,i,t);var s=Nk();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wo(r)?(s=!0,Ob(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,_k(e),i.updater=i_,e.stateNode=i,i._reactInternals=e,uM(e,r,n,t),e=fM(null,e,r,!0,s,t)):(e.tag=0,Hr&&s&&gk(e),$s(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Q1(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=CQ(r),n=Ba(r,n),i){case 0:e=hM(null,e,r,n,t);break e;case 1:e=$D(null,e,r,n,t);break e;case 11:e=UD(null,e,r,n,t);break e;case 14:e=BD(null,e,r,Ba(r.type,n),t);break e}throw Error(ct(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ba(r,i),hM(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ba(r,i),$D(n,e,r,i,t);case 3:e:{if(WB(e),n===null)throw Error(ct(387));r=e.pendingProps,s=e.memoizedState,i=s.element,yB(n,e),$b(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Dm(Error(ct(423)),e),e=jD(n,e,r,t,i);break e}else if(r!==i){i=Dm(Error(ct(424)),e),e=jD(n,e,r,t,i);break e}else for(Bo=Vu(e.stateNode.containerInfo.firstChild),$o=e,Hr=!0,Va=null,t=mB(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Im(),r===i){e=Uc(n,e,t);break e}$s(n,e,r,t)}e=e.child}return e;case 5:return vB(e),n===null&&aM(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,nM(r,i)?o=null:s!==null&&nM(r,s)&&(e.flags|=32),VB(n,e),$s(n,e,o,t),e.child;case 6:return n===null&&aM(e),null;case 13:return HB(n,e,t);case 4:return Ek(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Rm(e,null,r,t):$s(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ba(r,i),UD(n,e,r,i,t);case 7:return $s(n,e,e.pendingProps,t),e.child;case 8:return $s(n,e,e.pendingProps.children,t),e.child;case 12:return $s(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Dr(Ub,r._currentValue),r._currentValue=o,s!==null)if(tl(s.value,o)){if(s.children===i.children&&!xo.current){e=Uc(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Nc(-1,t&-t),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),lM(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ct(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),lM(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}$s(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,mm(e,t),i=Ta(i),r=r(i),e.flags|=1,$s(n,e,r,t),e.child;case 14:return r=e.type,i=Ba(r,e.pendingProps),i=Ba(r.type,i),BD(n,e,r,i,t);case 15:return $B(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ba(r,i),Q1(n,e),e.tag=1,wo(r)?(n=!0,Ob(e)):n=!1,mm(e,t),zB(e,r,i),uM(e,r,i,t),fM(null,e,r,!0,n,t);case 19:return GB(n,e,t);case 22:return jB(n,e,t)}throw Error(ct(156,e.tag))};function l$(n,e){return LU(n,e)}function EQ(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function va(n,e,t,r){return new EQ(n,e,t,r)}function Uk(n){return n=n.prototype,!(!n||!n.isReactComponent)}function CQ(n){if(typeof n=="function")return Uk(n)?1:0;if(n!=null){if(n=n.$$typeof,n===ik)return 11;if(n===sk)return 14}return 2}function qu(n,e){var t=n.alternate;return t===null?(t=va(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function tb(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")Uk(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Gp:return Uh(t.children,i,s,e);case rk:o=8,i|=8;break;case DT:return n=va(12,t,e,i|2),n.elementType=DT,n.lanes=s,n;case LT:return n=va(13,t,e,i),n.elementType=LT,n.lanes=s,n;case OT:return n=va(19,t,e,i),n.elementType=OT,n.lanes=s,n;case vU:return a_(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case gU:o=10;break e;case yU:o=9;break e;case ik:o=11;break e;case sk:o=14;break e;case Mu:o=16,r=null;break e}throw Error(ct(130,n==null?n:typeof n,""))}return e=va(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function Uh(n,e,t,r){return n=va(7,n,r,e),n.lanes=t,n}function a_(n,e,t,r){return n=va(22,n,r,e),n.elementType=vU,n.lanes=t,n.stateNode={isHidden:!1},n}function HE(n,e,t){return n=va(6,n,null,e),n.lanes=t,n}function GE(n,e,t){return e=va(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function TQ(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=TE(0),this.expirationTimes=TE(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=TE(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bk(n,e,t,r,i,s,o,a,l){return n=new TQ(n,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=va(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},_k(s),n}function MQ(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hp,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function c$(n){if(!n)return od;n=n._reactInternals;e:{if(_f(n)!==n||n.tag!==1)throw Error(ct(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wo(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ct(171))}if(n.tag===1){var t=n.type;if(wo(t))return cB(n,t,e)}return e}function u$(n,e,t,r,i,s,o,a,l){return n=Bk(t,r,!0,n,i,s,o,a,l),n.context=c$(null),t=n.current,r=Gs(),i=Gu(t),s=Nc(r,i),s.callback=e??null,Wu(t,s,i),n.current.lanes=i,j0(n,i,r),bo(n,r),n}function l_(n,e,t,r){var i=e.current,s=Gs(),o=Gu(i);return t=c$(t),e.context===null?e.context=t:e.pendingContext=t,e=Nc(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Wu(i,e,o),n!==null&&(Qa(n,i,o,s),K1(n,i,o)),o}function Kb(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function QD(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function $k(n,e){QD(n,e),(n=n.alternate)&&QD(n,e)}function AQ(){return null}var d$=typeof reportError=="function"?reportError:function(n){console.error(n)};function jk(n){this._internalRoot=n}c_.prototype.render=jk.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(ct(409));l_(n,e,null,null)};c_.prototype.unmount=jk.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;tf(function(){l_(null,n,null,null)}),e[Fc]=null}};function c_(n){this._internalRoot=n}c_.prototype.unstable_scheduleHydration=function(n){if(n){var e=jU();n={blockedOn:null,target:n,priority:e};for(var t=0;t<ku.length&&e!==0&&e<ku[t].priority;t++);ku.splice(t,0,n),t===0&&WU(n)}};function Vk(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u_(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function JD(){}function NQ(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=Kb(o);s.call(c)}}var o=u$(e,r,n,0,null,!1,!1,"",JD);return n._reactRootContainer=o,n[Fc]=o.current,Mv(n.nodeType===8?n.parentNode:n),tf(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=Kb(l);a.call(c)}}var l=Bk(n,0,!1,null,null,!1,!1,"",JD);return n._reactRootContainer=l,n[Fc]=l.current,Mv(n.nodeType===8?n.parentNode:n),tf(function(){l_(e,l,t,r)}),l}function d_(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Kb(o);a.call(l)}}l_(e,o,n,i)}else o=NQ(t,e,n,i,r);return Kb(o)}BU=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=By(e.pendingLanes);t!==0&&(lk(e,t|1),bo(e,vi()),!(or&6)&&(Lm=vi()+500,Cd()))}break;case 13:tf(function(){var r=zc(n,1);if(r!==null){var i=Gs();Qa(r,n,1,i)}}),$k(n,1)}};ck=function(n){if(n.tag===13){var e=zc(n,134217728);if(e!==null){var t=Gs();Qa(e,n,134217728,t)}$k(n,134217728)}};$U=function(n){if(n.tag===13){var e=Gu(n),t=zc(n,e);if(t!==null){var r=Gs();Qa(t,n,e,r)}$k(n,e)}};jU=function(){return xr};VU=function(n,e){var t=xr;try{return xr=n,e()}finally{xr=t}};GT=function(n,e,t){switch(e){case"input":if(UT(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=t_(r);if(!i)throw Error(ct(90));wU(r),UT(r,i)}}}break;case"textarea":SU(n,t);break;case"select":e=t.value,e!=null&&dm(n,!!t.multiple,e,!1)}};NU=Ok;kU=tf;var kQ={usingClientEntryPoint:!1,Events:[W0,Yp,t_,MU,AU,Ok]},hy={findFiberByHostInstance:Eh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},IQ={bundleType:hy.bundleType,version:hy.version,rendererPackageName:hy.rendererPackageName,rendererConfig:hy.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Yc.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=PU(n),n===null?null:n.stateNode},findFiberByHostInstance:hy.findFiberByHostInstance||AQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pw.isDisabled&&Pw.supportsFiber)try{ZS=Pw.inject(IQ),Dl=Pw}catch{}}Yo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kQ;Yo.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vk(e))throw Error(ct(200));return MQ(n,e,null,t)};Yo.createRoot=function(n,e){if(!Vk(n))throw Error(ct(299));var t=!1,r="",i=d$;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Bk(n,1,!1,null,null,t,!1,r,i),n[Fc]=e.current,Mv(n.nodeType===8?n.parentNode:n),new jk(e)};Yo.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(ct(188)):(n=Object.keys(n).join(","),Error(ct(268,n)));return n=PU(e),n=n===null?null:n.stateNode,n};Yo.flushSync=function(n){return tf(n)};Yo.hydrate=function(n,e,t){if(!u_(e))throw Error(ct(200));return d_(null,n,e,!0,t)};Yo.hydrateRoot=function(n,e,t){if(!Vk(n))throw Error(ct(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=d$;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=u$(e,null,n,1,t??null,i,!1,s,o),n[Fc]=e.current,Mv(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new c_(e)};Yo.render=function(n,e,t){if(!u_(e))throw Error(ct(200));return d_(null,n,e,!1,t)};Yo.unmountComponentAtNode=function(n){if(!u_(n))throw Error(ct(40));return n._reactRootContainer?(tf(function(){d_(null,null,n,!1,function(){n._reactRootContainer=null,n[Fc]=null})}),!0):!1};Yo.unstable_batchedUpdates=Ok;Yo.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!u_(t))throw Error(ct(200));if(n==null||n._reactInternals===void 0)throw Error(ct(38));return d_(n,e,t,!1,r)};Yo.version="18.3.1-next-f1338f8080-20240426";function h$(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h$)}catch(n){console.error(n)}}h$(),hU.exports=Yo;var cg=hU.exports;const RQ=B0(cg);var f$,eL=cg;f$=eL.createRoot,eL.hydrateRoot;const PQ=n=>n instanceof Error?n.message+`
`+n.stack:JSON.stringify(n,null,2);let p$=class extends Sr.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}render(){return this.state.hasError?w.jsxs("div",{className:"p-4 border border-red-500 rounded",children:[w.jsx("h2",{className:"text-red-500",children:"Something went wrong."}),w.jsx("pre",{className:"mt-2 text-sm",children:PQ(this.state.error)})]}):this.props.children}};var Wk={};Object.defineProperty(Wk,"__esModule",{value:!0});Wk.parse=BQ;Wk.serialize=$Q;const DQ=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,LQ=/^[\u0021-\u003A\u003C-\u007E]*$/,OQ=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,FQ=/^[\u0020-\u003A\u003D-\u007E]*$/,zQ=Object.prototype.toString,UQ=(()=>{const n=function(){};return n.prototype=Object.create(null),n})();function BQ(n,e){const t=new UQ,r=n.length;if(r<2)return t;const i=(e==null?void 0:e.decode)||jQ;let s=0;do{const o=n.indexOf("=",s);if(o===-1)break;const a=n.indexOf(";",s),l=a===-1?r:a;if(o>l){s=n.lastIndexOf(";",o-1)+1;continue}const c=tL(n,s,o),u=nL(n,o,c),d=n.slice(c,u);if(t[d]===void 0){let h=tL(n,o+1,l),f=nL(n,l,h);const p=i(n.slice(h,f));t[d]=p}s=l+1}while(s<r);return t}function tL(n,e,t){do{const r=n.charCodeAt(e);if(r!==32&&r!==9)return e}while(++e<t);return t}function nL(n,e,t){for(;e>t;){const r=n.charCodeAt(--e);if(r!==32&&r!==9)return e+1}return t}function $Q(n,e,t){const r=(t==null?void 0:t.encode)||encodeURIComponent;if(!DQ.test(n))throw new TypeError(`argument name is invalid: ${n}`);const i=r(e);if(!LQ.test(i))throw new TypeError(`argument val is invalid: ${e}`);let s=n+"="+i;if(!t)return s;if(t.maxAge!==void 0){if(!Number.isInteger(t.maxAge))throw new TypeError(`option maxAge is invalid: ${t.maxAge}`);s+="; Max-Age="+t.maxAge}if(t.domain){if(!OQ.test(t.domain))throw new TypeError(`option domain is invalid: ${t.domain}`);s+="; Domain="+t.domain}if(t.path){if(!FQ.test(t.path))throw new TypeError(`option path is invalid: ${t.path}`);s+="; Path="+t.path}if(t.expires){if(!VQ(t.expires)||!Number.isFinite(t.expires.valueOf()))throw new TypeError(`option expires is invalid: ${t.expires}`);s+="; Expires="+t.expires.toUTCString()}if(t.httpOnly&&(s+="; HttpOnly"),t.secure&&(s+="; Secure"),t.partitioned&&(s+="; Partitioned"),t.priority)switch(typeof t.priority=="string"?t.priority.toLowerCase():void 0){case"low":s+="; Priority=Low";break;case"medium":s+="; Priority=Medium";break;case"high":s+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${t.priority}`)}if(t.sameSite)switch(typeof t.sameSite=="string"?t.sameSite.toLowerCase():t.sameSite){case!0:case"strict":s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"none":s+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${t.sameSite}`)}return s}function jQ(n){if(n.indexOf("%")===-1)return n;try{return decodeURIComponent(n)}catch{return n}}function VQ(n){return zQ.call(n)==="[object Date]"}var rL="popstate";function WQ(n={}){function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return CM("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:Ov(i)}return GQ(e,t,null,n)}function Xr(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function nl(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function HQ(){return Math.random().toString(36).substring(2,10)}function iL(n,e){return{usr:n.state,key:n.key,idx:e}}function CM(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?ug(e):e,state:t,key:e&&e.key||r||HQ()}}function Ov({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function ug(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function GQ(n,e,t,r={}){let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a="POP",l=null,c=u();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function u(){return(o.state||{idx:null}).idx}function d(){a="POP";let v=u(),y=v==null?null:v-c;c=v,l&&l({action:a,location:x.location,delta:y})}function h(v,y){a="PUSH";let b=CM(x.location,v,y);c=u()+1;let S=iL(b,c),_=x.createHref(b);try{o.pushState(S,"",_)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;i.location.assign(_)}s&&l&&l({action:a,location:x.location,delta:1})}function f(v,y){a="REPLACE";let b=CM(x.location,v,y);c=u();let S=iL(b,c),_=x.createHref(b);o.replaceState(S,"",_),s&&l&&l({action:a,location:x.location,delta:0})}function p(v){return qQ(v)}let x={get action(){return a},get location(){return n(i,o)},listen(v){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(rL,d),l=v,()=>{i.removeEventListener(rL,d),l=null}},createHref(v){return e(i,v)},createURL:p,encodeLocation(v){let y=p(v);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:f,go(v){return o.go(v)}};return x}function qQ(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Xr(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Ov(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function m$(n,e,t="/"){return XQ(n,e,t,!1)}function XQ(n,e,t,r){let i=typeof e=="string"?ug(e):e,s=Bc(i.pathname||"/",t);if(s==null)return null;let o=g$(n);KQ(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=oJ(s);a=iJ(o[l],c,r)}return a}function g$(n,e=[],t=[],r=""){let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Xr(l.relativePath.startsWith(r),`Absolute route path "${l.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(r.length));let c=kc([r,l.relativePath]),u=t.concat(l);s.children&&s.children.length>0&&(Xr(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),g$(s.children,e,u,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:nJ(c,s.index),routesMeta:u})};return n.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of y$(s.path))i(s,o,l)}),e}function y$(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=y$(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function KQ(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:rJ(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var YQ=/^:[\w-]+$/,ZQ=3,QQ=2,JQ=1,eJ=10,tJ=-2,sL=n=>n==="*";function nJ(n,e){let t=n.split("/"),r=t.length;return t.some(sL)&&(r+=tJ),e&&(r+=QQ),t.filter(i=>!sL(i)).reduce((i,s)=>i+(YQ.test(s)?ZQ:s===""?JQ:eJ),r)}function rJ(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function iJ(n,e,t=!1){let{routesMeta:r}=n,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=Yb({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d&&c&&t&&!r[r.length-1].route.index&&(d=Yb({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),o.push({params:i,pathname:kc([s,d.pathname]),pathnameBase:uJ(kc([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=kc([s,d.pathnameBase]))}return o}function Yb(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=sJ(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((c,{paramName:u,isOptional:d},h)=>{if(u==="*"){let p=a[h]||"";o=s.slice(0,s.length-p.length).replace(/(.)\/+$/,"$1")}const f=a[h];return d&&!f?c[u]=void 0:c[u]=(f||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:o,pattern:n}}function sJ(n,e=!1,t=!0){nl(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function oJ(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return nl(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Bc(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function aJ(n,e="/"){let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?ug(n):n;return{pathname:t?t.startsWith("/")?t:lJ(t,e):e,search:dJ(r),hash:hJ(i)}}function lJ(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function qE(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function cJ(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Hk(n){let e=cJ(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function Gk(n,e,t,r=!1){let i;typeof n=="string"?i=ug(n):(i={...n},Xr(!i.pathname||!i.pathname.includes("?"),qE("?","pathname","search",i)),Xr(!i.pathname||!i.pathname.includes("#"),qE("#","pathname","hash",i)),Xr(!i.search||!i.search.includes("#"),qE("#","search","hash",i)));let s=n===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=t;else{let d=e.length-1;if(!r&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),d-=1;i.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=aJ(i,a),c=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var kc=n=>n.join("/").replace(/\/\/+/g,"/"),uJ=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),dJ=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,hJ=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function fJ(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var v$=["POST","PUT","PATCH","DELETE"];new Set(v$);var pJ=["GET",...v$];new Set(pJ);var dg=N.createContext(null);dg.displayName="DataRouter";var h_=N.createContext(null);h_.displayName="DataRouterState";var x$=N.createContext({isTransitioning:!1});x$.displayName="ViewTransition";var mJ=N.createContext(new Map);mJ.displayName="Fetchers";var gJ=N.createContext(null);gJ.displayName="Await";var ol=N.createContext(null);ol.displayName="Navigation";var G0=N.createContext(null);G0.displayName="Location";var Na=N.createContext({outlet:null,matches:[],isDataRoute:!1});Na.displayName="Route";var qk=N.createContext(null);qk.displayName="RouteError";function yJ(n,{relative:e}={}){Xr(hg(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=N.useContext(ol),{hash:i,pathname:s,search:o}=q0(n,{relative:e}),a=s;return t!=="/"&&(a=s==="/"?t:kc([t,s])),r.createHref({pathname:a,search:o,hash:i})}function hg(){return N.useContext(G0)!=null}function Yl(){return Xr(hg(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(G0).location}var w$="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function b$(n){N.useContext(ol).static||N.useLayoutEffect(n)}function Zc(){let{isDataRoute:n}=N.useContext(Na);return n?PJ():vJ()}function vJ(){Xr(hg(),"useNavigate() may be used only in the context of a <Router> component.");let n=N.useContext(dg),{basename:e,navigator:t}=N.useContext(ol),{matches:r}=N.useContext(Na),{pathname:i}=Yl(),s=JSON.stringify(Hk(r)),o=N.useRef(!1);return b$(()=>{o.current=!0}),N.useCallback((l,c={})=>{if(nl(o.current,w$),!o.current)return;if(typeof l=="number"){t.go(l);return}let u=Gk(l,JSON.parse(s),i,c.relative==="path");n==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:kc([e,u.pathname])),(c.replace?t.replace:t.push)(u,c.state,c)},[e,t,s,i,n])}var xJ=N.createContext(null);function wJ(n){let e=N.useContext(Na).outlet;return e&&N.createElement(xJ.Provider,{value:n},e)}function bJ(){let{matches:n}=N.useContext(Na),e=n[n.length-1];return e?e.params:{}}function q0(n,{relative:e}={}){let{matches:t}=N.useContext(Na),{pathname:r}=Yl(),i=JSON.stringify(Hk(t));return N.useMemo(()=>Gk(n,JSON.parse(i),r,e==="path"),[n,i,r,e])}function SJ(n,e){return S$(n,e)}function S$(n,e,t,r){var y;Xr(hg(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=N.useContext(ol),{matches:s}=N.useContext(Na),o=s[s.length-1],a=o?o.params:{},l=o?o.pathname:"/",c=o?o.pathnameBase:"/",u=o&&o.route;{let b=u&&u.path||"";_$(l,!u||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let d=Yl(),h;if(e){let b=typeof e=="string"?ug(e):e;Xr(c==="/"||((y=b.pathname)==null?void 0:y.startsWith(c)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${b.pathname}" was given in the \`location\` prop.`),h=b}else h=d;let f=h.pathname||"/",p=f;if(c!=="/"){let b=c.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(b.length).join("/")}let x=m$(n,{pathname:p});nl(u||x!=null,`No routes matched location "${h.pathname}${h.search}${h.hash}" `),nl(x==null||x[x.length-1].route.element!==void 0||x[x.length-1].route.Component!==void 0||x[x.length-1].route.lazy!==void 0,`Matched leaf route at location "${h.pathname}${h.search}${h.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let v=MJ(x&&x.map(b=>Object.assign({},b,{params:Object.assign({},a,b.params),pathname:kc([c,i.encodeLocation?i.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?c:kc([c,i.encodeLocation?i.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),s,t,r);return e&&v?N.createElement(G0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...h},navigationType:"POP"}},v):v}function _J(){let n=RJ(),e=fJ(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=N.createElement(N.Fragment,null,N.createElement("p",null,"💿 Hey developer 👋"),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:s},"ErrorBoundary")," or"," ",N.createElement("code",{style:s},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),t?N.createElement("pre",{style:i},t):null,o)}var EJ=N.createElement(_J,null),CJ=class extends N.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?N.createElement(Na.Provider,{value:this.props.routeContext},N.createElement(qk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function TJ({routeContext:n,match:e,children:t}){let r=N.useContext(dg);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(Na.Provider,{value:n},t)}function MJ(n,e=[],t=null,r=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let i=n,s=t==null?void 0:t.errors;if(s!=null){let l=i.findIndex(c=>c.route.id&&(s==null?void 0:s[c.route.id])!==void 0);Xr(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),i=i.slice(0,Math.min(i.length,l+1))}let o=!1,a=-1;if(t)for(let l=0;l<i.length;l++){let c=i[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=l),c.route.id){let{loaderData:u,errors:d}=t,h=c.route.loader&&!u.hasOwnProperty(c.route.id)&&(!d||d[c.route.id]===void 0);if(c.route.lazy||h){o=!0,a>=0?i=i.slice(0,a+1):i=[i[0]];break}}}return i.reduceRight((l,c,u)=>{let d,h=!1,f=null,p=null;t&&(d=s&&c.route.id?s[c.route.id]:void 0,f=c.route.errorElement||EJ,o&&(a<0&&u===0?(_$("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,p=null):a===u&&(h=!0,p=c.route.hydrateFallbackElement||null)));let x=e.concat(i.slice(0,u+1)),v=()=>{let y;return d?y=f:h?y=p:c.route.Component?y=N.createElement(c.route.Component,null):c.route.element?y=c.route.element:y=l,N.createElement(TJ,{match:c,routeContext:{outlet:l,matches:x,isDataRoute:t!=null},children:y})};return t&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?N.createElement(CJ,{location:t.location,revalidation:t.revalidation,component:f,error:d,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}function Xk(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function AJ(n){let e=N.useContext(dg);return Xr(e,Xk(n)),e}function NJ(n){let e=N.useContext(h_);return Xr(e,Xk(n)),e}function kJ(n){let e=N.useContext(Na);return Xr(e,Xk(n)),e}function Kk(n){let e=kJ(n),t=e.matches[e.matches.length-1];return Xr(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function IJ(){return Kk("useRouteId")}function RJ(){var r;let n=N.useContext(qk),e=NJ("useRouteError"),t=Kk("useRouteError");return n!==void 0?n:(r=e.errors)==null?void 0:r[t]}function PJ(){let{router:n}=AJ("useNavigate"),e=Kk("useNavigate"),t=N.useRef(!1);return b$(()=>{t.current=!0}),N.useCallback(async(i,s={})=>{nl(t.current,w$),t.current&&(typeof i=="number"?n.navigate(i):await n.navigate(i,{fromRouteId:e,...s}))},[n,e])}var oL={};function _$(n,e,t){!e&&!oL[n]&&(oL[n]=!0,nl(!1,t))}N.memo(DJ);function DJ({routes:n,future:e,state:t}){return S$(n,void 0,t,e)}function TM({to:n,replace:e,state:t,relative:r}){Xr(hg(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=N.useContext(ol);nl(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=N.useContext(Na),{pathname:o}=Yl(),a=Zc(),l=Gk(n,Hk(s),o,r==="path"),c=JSON.stringify(l);return N.useEffect(()=>{a(JSON.parse(c),{replace:e,state:t,relative:r})},[a,c,r,e,t]),null}function LJ(n){return wJ(n.context)}function Xi(n){Xr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function OJ({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:i,static:s=!1}){Xr(!hg(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=n.replace(/^\/*/,"/"),a=N.useMemo(()=>({basename:o,navigator:i,static:s,future:{}}),[o,i,s]);typeof t=="string"&&(t=ug(t));let{pathname:l="/",search:c="",hash:u="",state:d=null,key:h="default"}=t,f=N.useMemo(()=>{let p=Bc(l,o);return p==null?null:{location:{pathname:p,search:c,hash:u,state:d,key:h},navigationType:r}},[o,l,c,u,d,h,r]);return nl(f!=null,`<Router basename="${o}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),f==null?null:N.createElement(ol.Provider,{value:a},N.createElement(G0.Provider,{children:e,value:f}))}function FJ({children:n,location:e}){return SJ(MM(n),e)}function MM(n,e=[]){let t=[];return N.Children.forEach(n,(r,i)=>{if(!N.isValidElement(r))return;let s=[...e,i];if(r.type===N.Fragment){t.push.apply(t,MM(r.props.children,s));return}Xr(r.type===Xi,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xr(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=MM(r.props.children,s)),t.push(o)}),t}var nb="get",rb="application/x-www-form-urlencoded";function f_(n){return n!=null&&typeof n.tagName=="string"}function zJ(n){return f_(n)&&n.tagName.toLowerCase()==="button"}function UJ(n){return f_(n)&&n.tagName.toLowerCase()==="form"}function BJ(n){return f_(n)&&n.tagName.toLowerCase()==="input"}function $J(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function jJ(n,e){return n.button===0&&(!e||e==="_self")&&!$J(n)}var Dw=null;function VJ(){if(Dw===null)try{new FormData(document.createElement("form"),0),Dw=!1}catch{Dw=!0}return Dw}var WJ=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function XE(n){return n!=null&&!WJ.has(n)?(nl(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${rb}"`),null):n}function HJ(n,e){let t,r,i,s,o;if(UJ(n)){let a=n.getAttribute("action");r=a?Bc(a,e):null,t=n.getAttribute("method")||nb,i=XE(n.getAttribute("enctype"))||rb,s=new FormData(n)}else if(zJ(n)||BJ(n)&&(n.type==="submit"||n.type==="image")){let a=n.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=n.getAttribute("formaction")||a.getAttribute("action");if(r=l?Bc(l,e):null,t=n.getAttribute("formmethod")||a.getAttribute("method")||nb,i=XE(n.getAttribute("formenctype"))||XE(a.getAttribute("enctype"))||rb,s=new FormData(a,n),!VJ()){let{name:c,type:u,value:d}=n;if(u==="image"){let h=c?`${c}.`:"";s.append(`${h}x`,"0"),s.append(`${h}y`,"0")}else c&&s.append(c,d)}}else{if(f_(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=nb,r=null,i=rb,o=n}return s&&i==="text/plain"&&(o=s,s=void 0),{action:r,method:t.toLowerCase(),encType:i,formData:s,body:o}}function Yk(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}async function GJ(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function qJ(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function XJ(n,e,t){let r=await Promise.all(n.map(async i=>{let s=e.routes[i.route.id];if(s){let o=await GJ(s,t);return o.links?o.links():[]}return[]}));return QJ(r.flat(1).filter(qJ).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function aL(n,e,t,r,i,s){let o=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,a=(l,c)=>{var u;return t[c].pathname!==l.pathname||((u=t[c].route.path)==null?void 0:u.endsWith("*"))&&t[c].params["*"]!==l.params["*"]};return s==="assets"?e.filter((l,c)=>o(l,c)||a(l,c)):s==="data"?e.filter((l,c)=>{var d;let u=r.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(o(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let h=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((d=t[0])==null?void 0:d.params)||{},nextUrl:new URL(n,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function KJ(n,e,{includeHydrateFallback:t}={}){return YJ(n.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function YJ(n){return[...new Set(n)]}function ZJ(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function QJ(n,e){let t=new Set;return new Set(e),n.reduce((r,i)=>{let s=JSON.stringify(ZJ(i));return t.has(s)||(t.add(s),r.push({key:s,link:i})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var JJ=new Set([100,101,204,205]);function eee(n,e){let t=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t.pathname==="/"?t.pathname="_root.data":e&&Bc(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function E$(){let n=N.useContext(dg);return Yk(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function tee(){let n=N.useContext(h_);return Yk(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Zk=N.createContext(void 0);Zk.displayName="FrameworkContext";function C$(){let n=N.useContext(Zk);return Yk(n,"You must render this element inside a <HydratedRouter> element"),n}function nee(n,e){let t=N.useContext(Zk),[r,i]=N.useState(!1),[s,o]=N.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=e,h=N.useRef(null);N.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let x=y=>{y.forEach(b=>{o(b.isIntersecting)})},v=new IntersectionObserver(x,{threshold:.5});return h.current&&v.observe(h.current),()=>{v.disconnect()}}},[n]),N.useEffect(()=>{if(r){let x=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(x)}}},[r]);let f=()=>{i(!0)},p=()=>{i(!1),o(!1)};return t?n!=="intent"?[s,h,{}]:[s,h,{onFocus:fy(a,f),onBlur:fy(l,p),onMouseEnter:fy(c,f),onMouseLeave:fy(u,p),onTouchStart:fy(d,f)}]:[!1,h,{}]}function fy(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function ree({page:n,...e}){let{router:t}=E$(),r=N.useMemo(()=>m$(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?N.createElement(see,{page:n,matches:r,...e}):null}function iee(n){let{manifest:e,routeModules:t}=C$(),[r,i]=N.useState([]);return N.useEffect(()=>{let s=!1;return XJ(n,e,t).then(o=>{s||i(o)}),()=>{s=!0}},[n,e,t]),r}function see({page:n,matches:e,...t}){let r=Yl(),{manifest:i,routeModules:s}=C$(),{basename:o}=E$(),{loaderData:a,matches:l}=tee(),c=N.useMemo(()=>aL(n,e,l,i,r,"data"),[n,e,l,i,r]),u=N.useMemo(()=>aL(n,e,l,i,r,"assets"),[n,e,l,i,r]),d=N.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let p=new Set,x=!1;if(e.forEach(y=>{var S;let b=i.routes[y.route.id];!b||!b.hasLoader||(!c.some(_=>_.route.id===y.route.id)&&y.route.id in a&&((S=s[y.route.id])!=null&&S.shouldRevalidate)||b.hasClientLoader?x=!0:p.add(y.route.id))}),p.size===0)return[];let v=eee(n,o);return x&&p.size>0&&v.searchParams.set("_routes",e.filter(y=>p.has(y.route.id)).map(y=>y.route.id).join(",")),[v.pathname+v.search]},[o,a,r,i,c,e,n,s]),h=N.useMemo(()=>KJ(u,i),[u,i]),f=iee(u);return N.createElement(N.Fragment,null,d.map(p=>N.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...t})),h.map(p=>N.createElement("link",{key:p,rel:"modulepreload",href:p,...t})),f.map(({key:p,link:x})=>N.createElement("link",{key:p,...x})))}function oee(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var T$=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{T$&&(window.__reactRouterVersion="7.6.2")}catch{}function aee({basename:n,children:e,window:t}){let r=N.useRef();r.current==null&&(r.current=WQ({window:t,v5Compat:!0}));let i=r.current,[s,o]=N.useState({action:i.action,location:i.location}),a=N.useCallback(l=>{N.startTransition(()=>o(l))},[o]);return N.useLayoutEffect(()=>i.listen(a),[i,a]),N.createElement(OJ,{basename:n,children:e,location:s.location,navigationType:s.action,navigator:i})}var M$=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xu=N.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:i,reloadDocument:s,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d,...h},f){let{basename:p}=N.useContext(ol),x=typeof c=="string"&&M$.test(c),v,y=!1;if(typeof c=="string"&&x&&(v=c,T$))try{let z=new URL(window.location.href),I=c.startsWith("//")?new URL(z.protocol+c):new URL(c),L=Bc(I.pathname,p);I.origin===z.origin&&L!=null?c=L+I.search+I.hash:y=!0}catch{nl(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=yJ(c,{relative:i}),[S,_,T]=nee(r,h),M=dee(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:i,viewTransition:d});function k(z){e&&e(z),z.defaultPrevented||M(z)}let P=N.createElement("a",{...h,...T,href:v||b,onClick:y||s?e:k,ref:oee(f,_),target:l,"data-discover":!x&&t==="render"?"true":void 0});return S&&!x?N.createElement(N.Fragment,null,P,N.createElement(ree,{page:b})):P});Xu.displayName="Link";var lee=N.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:i=!1,style:s,to:o,viewTransition:a,children:l,...c},u){let d=q0(o,{relative:c.relative}),h=Yl(),f=N.useContext(h_),{navigator:p,basename:x}=N.useContext(ol),v=f!=null&&gee(d)&&a===!0,y=p.encodeLocation?p.encodeLocation(d).pathname:d.pathname,b=h.pathname,S=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;t||(b=b.toLowerCase(),S=S?S.toLowerCase():null,y=y.toLowerCase()),S&&x&&(S=Bc(S,x)||S);const _=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let T=b===y||!i&&b.startsWith(y)&&b.charAt(_)==="/",M=S!=null&&(S===y||!i&&S.startsWith(y)&&S.charAt(y.length)==="/"),k={isActive:T,isPending:M,isTransitioning:v},P=T?e:void 0,z;typeof r=="function"?z=r(k):z=[r,T?"active":null,M?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let I=typeof s=="function"?s(k):s;return N.createElement(Xu,{...c,"aria-current":P,className:z,ref:u,style:I,to:o,viewTransition:a},typeof l=="function"?l(k):l)});lee.displayName="NavLink";var cee=N.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:i,state:s,method:o=nb,action:a,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:d,...h},f)=>{let p=pee(),x=mee(a,{relative:c}),v=o.toLowerCase()==="get"?"get":"post",y=typeof a=="string"&&M$.test(a),b=S=>{if(l&&l(S),S.defaultPrevented)return;S.preventDefault();let _=S.nativeEvent.submitter,T=(_==null?void 0:_.getAttribute("formmethod"))||o;p(_||S.currentTarget,{fetcherKey:e,method:T,navigate:t,replace:i,state:s,relative:c,preventScrollReset:u,viewTransition:d})};return N.createElement("form",{ref:f,method:v,action:x,onSubmit:r?l:b,...h,"data-discover":!y&&n==="render"?"true":void 0})});cee.displayName="Form";function uee(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function A$(n){let e=N.useContext(dg);return Xr(e,uee(n)),e}function dee(n,{target:e,replace:t,state:r,preventScrollReset:i,relative:s,viewTransition:o}={}){let a=Zc(),l=Yl(),c=q0(n,{relative:s});return N.useCallback(u=>{if(jJ(u,e)){u.preventDefault();let d=t!==void 0?t:Ov(l)===Ov(c);a(n,{replace:d,state:r,preventScrollReset:i,relative:s,viewTransition:o})}},[l,a,c,t,r,e,n,i,s,o])}var hee=0,fee=()=>`__${String(++hee)}__`;function pee(){let{router:n}=A$("useSubmit"),{basename:e}=N.useContext(ol),t=IJ();return N.useCallback(async(r,i={})=>{let{action:s,method:o,encType:a,formData:l,body:c}=HJ(r,e);if(i.navigate===!1){let u=i.fetcherKey||fee();await n.fetch(u,t,i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||a,flushSync:i.flushSync})}else await n.navigate(i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[n,e,t])}function mee(n,{relative:e}={}){let{basename:t}=N.useContext(ol),r=N.useContext(Na);Xr(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),s={...q0(n||".",{relative:e})},o=Yl();if(n==null){s.search=o.search;let a=new URLSearchParams(s.search),l=a.getAll("index");if(l.some(u=>u==="")){a.delete("index"),l.filter(d=>d).forEach(d=>a.append("index",d));let u=a.toString();s.search=u?`?${u}`:""}}return(!n||n===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:kc([t,s.pathname])),Ov(s)}function gee(n,e={}){let t=N.useContext(x$);Xr(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=A$("useViewTransitionState"),i=q0(n,{relative:e.relative});if(!t.isTransitioning)return!1;let s=Bc(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=Bc(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Yb(i.pathname,o)!=null||Yb(i.pathname,s)!=null}[...JJ];const N$=N.createContext(void 0),Zl=()=>{const n=N.useContext(N$);if(n===void 0)throw new Error("useAuth должен использоваться внутри AuthProvider");return n},yee=({children:n})=>{const[e,t]=N.useState(null),[r,i]=N.useState(!0);N.useEffect(()=>{const d=localStorage.getItem("craftruv_user");if(d)try{t(JSON.parse(d))}catch(h){console.error("Ошибка загрузки данных пользователя:",h),localStorage.removeItem("craftruv_user")}i(!1)},[]);const s=async(d,h)=>{i(!0);try{if(await new Promise(x=>setTimeout(x,1e3)),d==="admin@craftruv.ru"&&h==="admin123"){const x={id:"admin-user",email:"admin@craftruv.ru",name:"Администратор",avatar:"",role:"admin",createdAt:new Date().toISOString(),subscription:{plan:"enterprise",status:"active",startDate:new Date().toISOString(),endDate:new Date(Date.now()+31536e6).toISOString()},projects:{count:0,limit:-1},usage:{storageUsed:0,storageLimit:-1,aiRequestsUsed:0,aiRequestsLimit:-1}};t(x),localStorage.setItem("craftruv_user",JSON.stringify(x));return}if(d==="demo@craftruv.ru"&&h==="demo123"){const x={id:"demo-user",email:"demo@craftruv.ru",name:"Демо Пользователь",avatar:"",role:"user",createdAt:new Date().toISOString(),subscription:{plan:"pro",status:"active",startDate:new Date().toISOString(),endDate:new Date(Date.now()+2592e6).toISOString()},projects:{count:5,limit:-1},usage:{storageUsed:1024,storageLimit:102400,aiRequestsUsed:150,aiRequestsLimit:1e3}};t(x),localStorage.setItem("craftruv_user",JSON.stringify(x));return}const p=JSON.parse(localStorage.getItem("craftruv_users")||"[]").find(x=>x.email===d&&x.password===h);if(p){const{password:x,...v}=p;t(v),localStorage.setItem("craftruv_user",JSON.stringify(v))}else throw new Error("Неверный email или пароль")}catch(f){throw f}finally{i(!1)}},o=async(d,h,f)=>{i(!0);try{await new Promise(S=>setTimeout(S,1e3));const p=JSON.parse(localStorage.getItem("craftruv_users")||"[]");if(p.find(S=>S.email===d))throw new Error("Пользователь с таким email уже существует");const v=new Date(Date.now()+7*24*60*60*1e3),y={id:crypto.randomUUID(),email:d,name:f,avatar:"",role:"user",createdAt:new Date().toISOString(),subscription:{plan:"free",status:"trial",startDate:new Date().toISOString(),endDate:v.toISOString(),trialEndsAt:v.toISOString()},projects:{count:0,limit:3},usage:{storageUsed:0,storageLimit:1024,aiRequestsUsed:0,aiRequestsLimit:0}},b={...y,password:h};p.push(b),localStorage.setItem("craftruv_users",JSON.stringify(p)),t(y),localStorage.setItem("craftruv_user",JSON.stringify(y))}catch(p){throw p}finally{i(!1)}},a=()=>{t(null),localStorage.removeItem("craftruv_user")},l=d=>{if(!e)return;const h={...e,...d};t(h),localStorage.setItem("craftruv_user",JSON.stringify(h));const f=JSON.parse(localStorage.getItem("craftruv_users")||"[]"),p=f.findIndex(x=>x.id===e.id);p!==-1&&(f[p]={...f[p],...d},localStorage.setItem("craftruv_users",JSON.stringify(f)))},c=d=>{if(!e)return;const h={...e,subscription:d};t(h),localStorage.setItem("craftruv_user",JSON.stringify(h));const f=JSON.parse(localStorage.getItem("craftruv_users")||"[]"),p=f.findIndex(x=>x.id===e.id);p!==-1&&(f[p]={...f[p],subscription:d},localStorage.setItem("craftruv_users",JSON.stringify(f)))},u={user:e,isLoading:r,isAuthenticated:!!e,isAdmin:!!e&&e.role==="admin",login:s,register:o,logout:a,updateProfile:l,updateSubscription:c};return w.jsx(N$.Provider,{value:u,children:n})},k$=N.createContext(void 0),vee=()=>{const n=N.useContext(k$);if(n===void 0)throw new Error("useTheme должен использоваться внутри ThemeProvider");return n},xee=({children:n})=>{const[e,t]=N.useState(()=>{const o=localStorage.getItem("craftruv_theme");return o==="light"||o==="dark"?o:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"});N.useEffect(()=>{const o=document.documentElement;e==="dark"?o.classList.add("dark"):o.classList.remove("dark"),localStorage.setItem("craftruv_theme",e)},[e]);const s={theme:e,toggleTheme:()=>{t(o=>o==="light"?"dark":"light")},setTheme:o=>{t(o)}};return w.jsx(k$.Provider,{value:s,children:n})},I$=N.createContext(void 0),R$=()=>{const n=N.useContext(I$);if(n===void 0)throw new Error("useProjects должен использоваться внутри ProjectProvider");return n},wee=({children:n})=>{const{user:e}=Zl(),[t,r]=N.useState([]),[i,s]=N.useState(null),[o,a]=N.useState(!1);N.useEffect(()=>{e?l():(r([]),s(null))},[e]);const l=()=>{if(!e)return;const S=JSON.parse(localStorage.getItem("craftruv_projects")||"[]").filter(_=>_.userId===e.id);r(S)},c=b=>{const T=[...JSON.parse(localStorage.getItem("craftruv_projects")||"[]").filter(M=>M.userId!==(e==null?void 0:e.id)),...b];localStorage.setItem("craftruv_projects",JSON.stringify(T))},u=async(b,S="")=>{if(!e)throw new Error("Пользователь не авторизован");a(!0);try{const _={id:crypto.randomUUID(),name:b,description:S,thumbnail:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),userId:e.id,isPublic:!1,tags:[],data:{furniture:[],materials:[],scene:{camera:{position:[0,5,10],target:[0,0,0]},lighting:{ambient:.4,directional:.8},environment:"studio"}}},T=[...t,_];return r(T),c(T),_}finally{a(!1)}},d=async(b,S)=>{if(!e)throw new Error("Пользователь не авторизован");a(!0);try{const _=t.map(T=>T.id===b?{...T,...S,updatedAt:new Date().toISOString()}:T);r(_),c(_),i&&i.id===b&&s({...i,...S,updatedAt:new Date().toISOString()})}finally{a(!1)}},y={projects:t,currentProject:i,isLoading:o,createProject:u,updateProject:d,deleteProject:async b=>{if(!e)throw new Error("Пользователь не авторизован");a(!0);try{const S=t.filter(_=>_.id!==b);r(S),c(S),i&&i.id===b&&s(null)}finally{a(!1)}},openProject:b=>{const S=t.find(_=>_.id===b);S&&s(S)},closeProject:()=>{s(null)},saveProject:async()=>{i&&await d(i.id,i)},duplicateProject:async b=>{if(!e)throw new Error("Пользователь не авторизован");const S=t.find(M=>M.id===b);if(!S)throw new Error("Проект не найден");const _={...S,id:crypto.randomUUID(),name:`${S.name} (копия)`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},T=[...t,_];return r(T),c(T),_}};return w.jsx(I$.Provider,{value:y,children:n})};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var bee={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const See=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ot=(n,e)=>{const t=N.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:a="",children:l,...c},u)=>N.createElement("svg",{ref:u,...bee,width:i,height:i,stroke:r,strokeWidth:o?Number(s)*24/Number(i):s,className:["lucide",`lucide-${See(n)}`,a].join(" "),...c},[...e.map(([d,h])=>N.createElement(d,h)),...Array.isArray(l)?l:[l]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ee=Ot("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eee=Ot("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cee=Ot("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tee=Ot("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mee=Ot("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aee=Ot("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qk=Ot("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lL=Ot("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nee=Ot("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P$=Ot("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jk=Ot("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=Ot("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D$=Ot("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kee=Ot("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iee=Ot("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ree=Ot("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pee=Ot("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AM=Ot("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p_=Ot("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dee=Ot("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lee=Ot("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zb=Ot("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KE=Ot("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ym=Ot("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L$=Ot("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cL=Ot("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gh=Ot("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oee=Ot("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O$=Ot("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F$=Ot("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fee=Ot("Layers3",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m6.08 9.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1e5n1m"}],["path",{d:"m6.08 14.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1iwflc"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zee=Ot("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uee=Ot("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z$=Ot("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uL=Ot("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YE=Ot("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U$=Ot("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NM=Ot("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bee=Ot("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ee=Ot("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dL=Ot("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hL=Ot("Move3d",[["path",{d:"M5 3v16h16",key:"1mqmf9"}],["path",{d:"m5 19 6-6",key:"jh6hbb"}],["path",{d:"m2 6 3-3 3 3",key:"tkyvxa"}],["path",{d:"m18 16 3 3-3 3",key:"1d4glt"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=Ot("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B$=Ot("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jee=Ot("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vee=Ot("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Om=Ot("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wee=Ot("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hee=Ot("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gee=Ot("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qee=Ot("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xee=Ot("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fm=Ot("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kee=Ot("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $$=Ot("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kM=Ot("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yee=Ot("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fv=Ot("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qb=Ot("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zee=Ot("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qee=Ot("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zv=Ot("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jee=Ot("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ete=Ot("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jb=Ot("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tte=Ot("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=Ot("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=Ot("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j$=Ot("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V$=Ot("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nte=Ot("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rte=Ot("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);function fL(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function X0(...n){return e=>{let t=!1;const r=n.map(i=>{const s=fL(i,e);return!t&&typeof s=="function"&&(t=!0),s});if(t)return()=>{for(let i=0;i<r.length;i++){const s=r[i];typeof s=="function"?s():fL(n[i],null)}}}}function Gn(...n){return N.useCallback(X0(...n),n)}function nf(n){const e=ste(n),t=N.forwardRef((r,i)=>{const{children:s,...o}=r,a=N.Children.toArray(s),l=a.find(ate);if(l){const c=l.props.children,u=a.map(d=>d===l?N.Children.count(c)>1?N.Children.only(null):N.isValidElement(c)?c.props.children:null:d);return w.jsx(e,{...o,ref:i,children:N.isValidElement(c)?N.cloneElement(c,void 0,u):null})}return w.jsx(e,{...o,ref:i,children:s})});return t.displayName=`${n}.Slot`,t}var ite=nf("Slot");function ste(n){const e=N.forwardRef((t,r)=>{const{children:i,...s}=t;if(N.isValidElement(i)){const o=cte(i),a=lte(s,i.props);return i.type!==N.Fragment&&(a.ref=r?X0(r,o):o),N.cloneElement(i,a)}return N.Children.count(i)>1?N.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var ote=Symbol("radix.slottable");function ate(n){return N.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===ote}function lte(n,e){const t={...e};for(const r in e){const i=n[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?t[r]=(...a)=>{s(...a),i(...a)}:i&&(t[r]=i):r==="style"?t[r]={...i,...s}:r==="className"&&(t[r]=[i,s].filter(Boolean).join(" "))}return{...n,...t}}function cte(n){var r,i;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(i=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function W$(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=W$(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function H$(){for(var n,e,t=0,r="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=W$(n))&&(r&&(r+=" "),r+=e);return r}const pL=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,mL=H$,m_=(n,e)=>t=>{var r;if((e==null?void 0:e.variants)==null)return mL(n,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:i,defaultVariants:s}=e,o=Object.keys(i).map(c=>{const u=t==null?void 0:t[c],d=s==null?void 0:s[c];if(u===null)return null;const h=pL(u)||pL(d);return i[c][h]}),a=t&&Object.entries(t).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:d,className:h,...f}=u;return Object.entries(f).every(p=>{let[x,v]=p;return Array.isArray(v)?v.includes({...s,...a}[x]):{...s,...a}[x]===v})?[...c,d,h]:c},[]);return mL(n,o,l,t==null?void 0:t.class,t==null?void 0:t.className)},iI="-",ute=n=>{const e=hte(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:r}=n;return{getClassGroupId:o=>{const a=o.split(iI);return a[0]===""&&a.length!==1&&a.shift(),G$(a,e)||dte(o)},getConflictingClassGroupIds:(o,a)=>{const l=t[o]||[];return a&&r[o]?[...l,...r[o]]:l}}},G$=(n,e)=>{var o;if(n.length===0)return e.classGroupId;const t=n[0],r=e.nextPart.get(t),i=r?G$(n.slice(1),r):void 0;if(i)return i;if(e.validators.length===0)return;const s=n.join(iI);return(o=e.validators.find(({validator:a})=>a(s)))==null?void 0:o.classGroupId},gL=/^\[(.+)\]$/,dte=n=>{if(gL.test(n)){const e=gL.exec(n)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},hte=n=>{const{theme:e,prefix:t}=n,r={nextPart:new Map,validators:[]};return pte(Object.entries(n.classGroups),t).forEach(([s,o])=>{IM(o,r,s,e)}),r},IM=(n,e,t,r)=>{n.forEach(i=>{if(typeof i=="string"){const s=i===""?e:yL(e,i);s.classGroupId=t;return}if(typeof i=="function"){if(fte(i)){IM(i(r),e,t,r);return}e.validators.push({validator:i,classGroupId:t});return}Object.entries(i).forEach(([s,o])=>{IM(o,yL(e,s),t,r)})})},yL=(n,e)=>{let t=n;return e.split(iI).forEach(r=>{t.nextPart.has(r)||t.nextPart.set(r,{nextPart:new Map,validators:[]}),t=t.nextPart.get(r)}),t},fte=n=>n.isThemeGetter,pte=(n,e)=>e?n.map(([t,r])=>{const i=r.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([o,a])=>[e+o,a])):s);return[t,i]}):n,mte=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,r=new Map;const i=(s,o)=>{t.set(s,o),e++,e>n&&(e=0,r=t,t=new Map)};return{get(s){let o=t.get(s);if(o!==void 0)return o;if((o=r.get(s))!==void 0)return i(s,o),o},set(s,o){t.has(s)?t.set(s,o):i(s,o)}}},q$="!",gte=n=>{const{separator:e,experimentalParseClassName:t}=n,r=e.length===1,i=e[0],s=e.length,o=a=>{const l=[];let c=0,u=0,d;for(let v=0;v<a.length;v++){let y=a[v];if(c===0){if(y===i&&(r||a.slice(v,v+s)===e)){l.push(a.slice(u,v)),u=v+s;continue}if(y==="/"){d=v;continue}}y==="["?c++:y==="]"&&c--}const h=l.length===0?a:a.substring(u),f=h.startsWith(q$),p=f?h.substring(1):h,x=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:x}};return t?a=>t({className:a,parseClassName:o}):o},yte=n=>{if(n.length<=1)return n;const e=[];let t=[];return n.forEach(r=>{r[0]==="["?(e.push(...t.sort(),r),t=[]):t.push(r)}),e.push(...t.sort()),e},vte=n=>({cache:mte(n.cacheSize),parseClassName:gte(n),...ute(n)}),xte=/\s+/,wte=(n,e)=>{const{parseClassName:t,getClassGroupId:r,getConflictingClassGroupIds:i}=e,s=[],o=n.trim().split(xte);let a="";for(let l=o.length-1;l>=0;l-=1){const c=o[l],{modifiers:u,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:f}=t(c);let p=!!f,x=r(p?h.substring(0,f):h);if(!x){if(!p){a=c+(a.length>0?" "+a:a);continue}if(x=r(h),!x){a=c+(a.length>0?" "+a:a);continue}p=!1}const v=yte(u).join(":"),y=d?v+q$:v,b=y+x;if(s.includes(b))continue;s.push(b);const S=i(x,p);for(let _=0;_<S.length;++_){const T=S[_];s.push(y+T)}a=c+(a.length>0?" "+a:a)}return a};function bte(){let n=0,e,t,r="";for(;n<arguments.length;)(e=arguments[n++])&&(t=X$(e))&&(r&&(r+=" "),r+=t);return r}const X$=n=>{if(typeof n=="string")return n;let e,t="";for(let r=0;r<n.length;r++)n[r]&&(e=X$(n[r]))&&(t&&(t+=" "),t+=e);return t};function Ste(n,...e){let t,r,i,s=o;function o(l){const c=e.reduce((u,d)=>d(u),n());return t=vte(c),r=t.cache.get,i=t.cache.set,s=a,a(l)}function a(l){const c=r(l);if(c)return c;const u=wte(l,t);return i(l,u),u}return function(){return s(bte.apply(null,arguments))}}const Ur=n=>{const e=t=>t[n]||[];return e.isThemeGetter=!0,e},K$=/^\[(?:([a-z-]+):)?(.+)\]$/i,_te=/^\d+\/\d+$/,Ete=new Set(["px","full","screen"]),Cte=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Tte=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Mte=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Ate=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Nte=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,uc=n=>vm(n)||Ete.has(n)||_te.test(n),fu=n=>fg(n,"length",Fte),vm=n=>!!n&&!Number.isNaN(Number(n)),ZE=n=>fg(n,"number",vm),py=n=>!!n&&Number.isInteger(Number(n)),kte=n=>n.endsWith("%")&&vm(n.slice(0,-1)),kn=n=>K$.test(n),pu=n=>Cte.test(n),Ite=new Set(["length","size","percentage"]),Rte=n=>fg(n,Ite,Y$),Pte=n=>fg(n,"position",Y$),Dte=new Set(["image","url"]),Lte=n=>fg(n,Dte,Ute),Ote=n=>fg(n,"",zte),my=()=>!0,fg=(n,e,t)=>{const r=K$.exec(n);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):t(r[2]):!1},Fte=n=>Tte.test(n)&&!Mte.test(n),Y$=()=>!1,zte=n=>Ate.test(n),Ute=n=>Nte.test(n),Bte=()=>{const n=Ur("colors"),e=Ur("spacing"),t=Ur("blur"),r=Ur("brightness"),i=Ur("borderColor"),s=Ur("borderRadius"),o=Ur("borderSpacing"),a=Ur("borderWidth"),l=Ur("contrast"),c=Ur("grayscale"),u=Ur("hueRotate"),d=Ur("invert"),h=Ur("gap"),f=Ur("gradientColorStops"),p=Ur("gradientColorStopPositions"),x=Ur("inset"),v=Ur("margin"),y=Ur("opacity"),b=Ur("padding"),S=Ur("saturate"),_=Ur("scale"),T=Ur("sepia"),M=Ur("skew"),k=Ur("space"),P=Ur("translate"),z=()=>["auto","contain","none"],I=()=>["auto","hidden","clip","visible","scroll"],L=()=>["auto",kn,e],W=()=>[kn,e],q=()=>["",uc,fu],$=()=>["auto",vm,kn],ne=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Y=()=>["solid","dashed","dotted","double","none"],we=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],H=()=>["start","end","center","between","around","evenly","stretch"],X=()=>["","0",kn],oe=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ve=()=>[vm,kn];return{cacheSize:500,separator:":",theme:{colors:[my],spacing:[uc,fu],blur:["none","",pu,kn],brightness:ve(),borderColor:[n],borderRadius:["none","","full",pu,kn],borderSpacing:W(),borderWidth:q(),contrast:ve(),grayscale:X(),hueRotate:ve(),invert:X(),gap:W(),gradientColorStops:[n],gradientColorStopPositions:[kte,fu],inset:L(),margin:L(),opacity:ve(),padding:W(),saturate:ve(),scale:ve(),sepia:X(),skew:ve(),space:W(),translate:W()},classGroups:{aspect:[{aspect:["auto","square","video",kn]}],container:["container"],columns:[{columns:[pu]}],"break-after":[{"break-after":oe()}],"break-before":[{"break-before":oe()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ne(),kn]}],overflow:[{overflow:I()}],"overflow-x":[{"overflow-x":I()}],"overflow-y":[{"overflow-y":I()}],overscroll:[{overscroll:z()}],"overscroll-x":[{"overscroll-x":z()}],"overscroll-y":[{"overscroll-y":z()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",py,kn]}],basis:[{basis:L()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",kn]}],grow:[{grow:X()}],shrink:[{shrink:X()}],order:[{order:["first","last","none",py,kn]}],"grid-cols":[{"grid-cols":[my]}],"col-start-end":[{col:["auto",{span:["full",py,kn]},kn]}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":[my]}],"row-start-end":[{row:["auto",{span:[py,kn]},kn]}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",kn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",kn]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...H()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...H(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...H(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",kn,e]}],"min-w":[{"min-w":[kn,e,"min","max","fit"]}],"max-w":[{"max-w":[kn,e,"none","full","min","max","fit","prose",{screen:[pu]},pu]}],h:[{h:[kn,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[kn,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[kn,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[kn,e,"auto","min","max","fit"]}],"font-size":[{text:["base",pu,fu]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ZE]}],"font-family":[{font:[my]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",kn]}],"line-clamp":[{"line-clamp":["none",vm,ZE]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",uc,kn]}],"list-image":[{"list-image":["none",kn]}],"list-style-type":[{list:["none","disc","decimal",kn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Y(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",uc,fu]}],"underline-offset":[{"underline-offset":["auto",uc,kn]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:W()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",kn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",kn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ne(),Pte]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Rte]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Lte]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...Y(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:Y()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...Y()]}],"outline-offset":[{"outline-offset":[uc,kn]}],"outline-w":[{outline:[uc,fu]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[uc,fu]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",pu,Ote]}],"shadow-color":[{shadow:[my]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...we(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":we()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",pu,kn]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[S]}],sepia:[{sepia:[T]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[T]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",kn]}],duration:[{duration:ve()}],ease:[{ease:["linear","in","out","in-out",kn]}],delay:[{delay:ve()}],animate:[{animate:["none","spin","ping","pulse","bounce",kn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[_]}],"scale-x":[{"scale-x":[_]}],"scale-y":[{"scale-y":[_]}],rotate:[{rotate:[py,kn]}],"translate-x":[{"translate-x":[P]}],"translate-y":[{"translate-y":[P]}],"skew-x":[{"skew-x":[M]}],"skew-y":[{"skew-y":[M]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",kn]}],accent:[{accent:["auto",n]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",kn]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":W()}],"scroll-mx":[{"scroll-mx":W()}],"scroll-my":[{"scroll-my":W()}],"scroll-ms":[{"scroll-ms":W()}],"scroll-me":[{"scroll-me":W()}],"scroll-mt":[{"scroll-mt":W()}],"scroll-mr":[{"scroll-mr":W()}],"scroll-mb":[{"scroll-mb":W()}],"scroll-ml":[{"scroll-ml":W()}],"scroll-p":[{"scroll-p":W()}],"scroll-px":[{"scroll-px":W()}],"scroll-py":[{"scroll-py":W()}],"scroll-ps":[{"scroll-ps":W()}],"scroll-pe":[{"scroll-pe":W()}],"scroll-pt":[{"scroll-pt":W()}],"scroll-pr":[{"scroll-pr":W()}],"scroll-pb":[{"scroll-pb":W()}],"scroll-pl":[{"scroll-pl":W()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",kn]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[uc,fu,ZE]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},$te=Ste(Bte);function wn(...n){return $te(H$(n))}const jte=m_("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-zinc-950 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 dark:focus-visible:ring-zinc-300",{variants:{variant:{default:"bg-zinc-900 text-zinc-50 shadow hover:bg-zinc-900/90 dark:bg-zinc-50 dark:text-zinc-900 dark:hover:bg-zinc-50/90",destructive:"bg-red-500 text-zinc-50 shadow-sm hover:bg-red-500/90 dark:bg-red-900 dark:text-zinc-50 dark:hover:bg-red-900/90",outline:"border border-zinc-200 bg-white shadow-sm hover:bg-zinc-100 hover:text-zinc-900 dark:border-zinc-800 dark:bg-zinc-950 dark:hover:bg-zinc-800 dark:hover:text-zinc-50",secondary:"bg-zinc-100 text-zinc-900 shadow-sm hover:bg-zinc-100/80 dark:bg-zinc-800 dark:text-zinc-50 dark:hover:bg-zinc-800/80",ghost:"hover:bg-zinc-100 hover:text-zinc-900 dark:hover:bg-zinc-800 dark:hover:text-zinc-50",link:"text-zinc-900 underline-offset-4 hover:underline dark:text-zinc-50"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),zt=N.forwardRef(({className:n,variant:e,size:t,asChild:r=!1,...i},s)=>{const o=r?ite:"button";return w.jsx(o,{className:wn(jte({variant:e,size:t,className:n})),ref:s,...i})});zt.displayName="Button";function Ft(n,e,{checkForDefaultPrevented:t=!0}={}){return function(i){if(n==null||n(i),t===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function Vte(n,e){const t=N.createContext(e),r=s=>{const{children:o,...a}=s,l=N.useMemo(()=>a,Object.values(a));return w.jsx(t.Provider,{value:l,children:o})};r.displayName=n+"Provider";function i(s){const o=N.useContext(t);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${s}\` must be used within \`${n}\``)}return[r,i]}function Qo(n,e=[]){let t=[];function r(s,o){const a=N.createContext(o),l=t.length;t=[...t,o];const c=d=>{var y;const{scope:h,children:f,...p}=d,x=((y=h==null?void 0:h[n])==null?void 0:y[l])||a,v=N.useMemo(()=>p,Object.values(p));return w.jsx(x.Provider,{value:v,children:f})};c.displayName=s+"Provider";function u(d,h){var x;const f=((x=h==null?void 0:h[n])==null?void 0:x[l])||a,p=N.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[c,u]}const i=()=>{const s=t.map(o=>N.createContext(o));return function(a){const l=(a==null?void 0:a[n])||s;return N.useMemo(()=>({[`__scope${n}`]:{...a,[n]:l}}),[a,l])}};return i.scopeName=n,[r,Wte(i,...e)]}function Wte(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...a,...d}},{});return N.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}function _o(n){const e=N.useRef(n);return N.useEffect(()=>{e.current=n}),N.useMemo(()=>(...t)=>{var r;return(r=e.current)==null?void 0:r.call(e,...t)},[])}function Uv({prop:n,defaultProp:e,onChange:t=()=>{}}){const[r,i]=Hte({defaultProp:e,onChange:t}),s=n!==void 0,o=s?n:r,a=_o(t),l=N.useCallback(c=>{if(s){const d=typeof c=="function"?c(n):c;d!==n&&a(d)}else i(c)},[s,n,i,a]);return[o,l]}function Hte({defaultProp:n,onChange:e}){const t=N.useState(n),[r]=t,i=N.useRef(r),s=_o(e);return N.useEffect(()=>{i.current!==r&&(s(r),i.current=r)},[r,i,s]),t}var Gte=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],rr=Gte.reduce((n,e)=>{const t=nf(`Primitive.${e}`),r=N.forwardRef((i,s)=>{const{asChild:o,...a}=i,l=o?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),w.jsx(l,{...a,ref:s})});return r.displayName=`Primitive.${e}`,{...n,[e]:r}},{});function Z$(n,e){n&&cg.flushSync(()=>n.dispatchEvent(e))}function sI(n){const e=n+"CollectionProvider",[t,r]=Qo(e),[i,s]=t(e,{collectionRef:{current:null},itemMap:new Map}),o=x=>{const{scope:v,children:y}=x,b=Sr.useRef(null),S=Sr.useRef(new Map).current;return w.jsx(i,{scope:v,itemMap:S,collectionRef:b,children:y})};o.displayName=e;const a=n+"CollectionSlot",l=nf(a),c=Sr.forwardRef((x,v)=>{const{scope:y,children:b}=x,S=s(a,y),_=Gn(v,S.collectionRef);return w.jsx(l,{ref:_,children:b})});c.displayName=a;const u=n+"CollectionItemSlot",d="data-radix-collection-item",h=nf(u),f=Sr.forwardRef((x,v)=>{const{scope:y,children:b,...S}=x,_=Sr.useRef(null),T=Gn(v,_),M=s(u,y);return Sr.useEffect(()=>(M.itemMap.set(_,{ref:_,...S}),()=>void M.itemMap.delete(_))),w.jsx(h,{[d]:"",ref:T,children:b})});f.displayName=u;function p(x){const v=s(n+"CollectionConsumer",x);return Sr.useCallback(()=>{const b=v.collectionRef.current;if(!b)return[];const S=Array.from(b.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((M,k)=>S.indexOf(M.ref.current)-S.indexOf(k.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:c,ItemSlot:f},p,r]}var qte=N.createContext(void 0);function pg(n){const e=N.useContext(qte);return n||e||"ltr"}function Xte(n,e=globalThis==null?void 0:globalThis.document){const t=_o(n);N.useEffect(()=>{const r=i=>{i.key==="Escape"&&t(i)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[t,e])}var Kte="DismissableLayer",RM="dismissableLayer.update",Yte="dismissableLayer.pointerDownOutside",Zte="dismissableLayer.focusOutside",vL,Q$=N.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),g_=N.forwardRef((n,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:o,onDismiss:a,...l}=n,c=N.useContext(Q$),[u,d]=N.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=N.useState({}),p=Gn(e,k=>d(k)),x=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=x.indexOf(v),b=u?x.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,_=b>=y,T=ene(k=>{const P=k.target,z=[...c.branches].some(I=>I.contains(P));!_||z||(i==null||i(k),o==null||o(k),k.defaultPrevented||a==null||a())},h),M=tne(k=>{const P=k.target;[...c.branches].some(I=>I.contains(P))||(s==null||s(k),o==null||o(k),k.defaultPrevented||a==null||a())},h);return Xte(k=>{b===c.layers.size-1&&(r==null||r(k),!k.defaultPrevented&&a&&(k.preventDefault(),a()))},h),N.useEffect(()=>{if(u)return t&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(vL=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),xL(),()=>{t&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=vL)}},[u,h,t,c]),N.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),xL())},[u,c]),N.useEffect(()=>{const k=()=>f({});return document.addEventListener(RM,k),()=>document.removeEventListener(RM,k)},[]),w.jsx(rr.div,{...l,ref:p,style:{pointerEvents:S?_?"auto":"none":void 0,...n.style},onFocusCapture:Ft(n.onFocusCapture,M.onFocusCapture),onBlurCapture:Ft(n.onBlurCapture,M.onBlurCapture),onPointerDownCapture:Ft(n.onPointerDownCapture,T.onPointerDownCapture)})});g_.displayName=Kte;var Qte="DismissableLayerBranch",Jte=N.forwardRef((n,e)=>{const t=N.useContext(Q$),r=N.useRef(null),i=Gn(e,r);return N.useEffect(()=>{const s=r.current;if(s)return t.branches.add(s),()=>{t.branches.delete(s)}},[t.branches]),w.jsx(rr.div,{...n,ref:i})});Jte.displayName=Qte;function ene(n,e=globalThis==null?void 0:globalThis.document){const t=_o(n),r=N.useRef(!1),i=N.useRef(()=>{});return N.useEffect(()=>{const s=a=>{if(a.target&&!r.current){let l=function(){J$(Yte,t,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=l,e.addEventListener("click",i.current,{once:!0})):l()}else e.removeEventListener("click",i.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",i.current)}},[e,t]),{onPointerDownCapture:()=>r.current=!0}}function tne(n,e=globalThis==null?void 0:globalThis.document){const t=_o(n),r=N.useRef(!1);return N.useEffect(()=>{const i=s=>{s.target&&!r.current&&J$(Zte,t,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function xL(){const n=new CustomEvent(RM);document.dispatchEvent(n)}function J$(n,e,t,{discrete:r}){const i=t.originalEvent.target,s=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&i.addEventListener(n,e,{once:!0}),r?Z$(i,s):i.dispatchEvent(s)}var QE=0;function oI(){N.useEffect(()=>{const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",n[0]??wL()),document.body.insertAdjacentElement("beforeend",n[1]??wL()),QE++,()=>{QE===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),QE--}},[])}function wL(){const n=document.createElement("span");return n.setAttribute("data-radix-focus-guard",""),n.tabIndex=0,n.style.outline="none",n.style.opacity="0",n.style.position="fixed",n.style.pointerEvents="none",n}var JE="focusScope.autoFocusOnMount",eC="focusScope.autoFocusOnUnmount",bL={bubbles:!1,cancelable:!0},nne="FocusScope",y_=N.forwardRef((n,e)=>{const{loop:t=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...o}=n,[a,l]=N.useState(null),c=_o(i),u=_o(s),d=N.useRef(null),h=Gn(e,x=>l(x)),f=N.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;N.useEffect(()=>{if(r){let x=function(S){if(f.paused||!a)return;const _=S.target;a.contains(_)?d.current=_:Cu(d.current,{select:!0})},v=function(S){if(f.paused||!a)return;const _=S.relatedTarget;_!==null&&(a.contains(_)||Cu(d.current,{select:!0}))},y=function(S){if(document.activeElement===document.body)for(const T of S)T.removedNodes.length>0&&Cu(a)};document.addEventListener("focusin",x),document.addEventListener("focusout",v);const b=new MutationObserver(y);return a&&b.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",v),b.disconnect()}}},[r,a,f.paused]),N.useEffect(()=>{if(a){_L.add(f);const x=document.activeElement;if(!a.contains(x)){const y=new CustomEvent(JE,bL);a.addEventListener(JE,c),a.dispatchEvent(y),y.defaultPrevented||(rne(lne(ej(a)),{select:!0}),document.activeElement===x&&Cu(a))}return()=>{a.removeEventListener(JE,c),setTimeout(()=>{const y=new CustomEvent(eC,bL);a.addEventListener(eC,u),a.dispatchEvent(y),y.defaultPrevented||Cu(x??document.body,{select:!0}),a.removeEventListener(eC,u),_L.remove(f)},0)}}},[a,c,u,f]);const p=N.useCallback(x=>{if(!t&&!r||f.paused)return;const v=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,y=document.activeElement;if(v&&y){const b=x.currentTarget,[S,_]=ine(b);S&&_?!x.shiftKey&&y===_?(x.preventDefault(),t&&Cu(S,{select:!0})):x.shiftKey&&y===S&&(x.preventDefault(),t&&Cu(_,{select:!0})):y===b&&x.preventDefault()}},[t,r,f.paused]);return w.jsx(rr.div,{tabIndex:-1,...o,ref:h,onKeyDown:p})});y_.displayName=nne;function rne(n,{select:e=!1}={}){const t=document.activeElement;for(const r of n)if(Cu(r,{select:e}),document.activeElement!==t)return}function ine(n){const e=ej(n),t=SL(e,n),r=SL(e.reverse(),n);return[t,r]}function ej(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function SL(n,e){for(const t of n)if(!sne(t,{upTo:e}))return t}function sne(n,{upTo:e}){if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(e!==void 0&&n===e)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1}function one(n){return n instanceof HTMLInputElement&&"select"in n}function Cu(n,{select:e=!1}={}){if(n&&n.focus){const t=document.activeElement;n.focus({preventScroll:!0}),n!==t&&one(n)&&e&&n.select()}}var _L=ane();function ane(){let n=[];return{add(e){const t=n[0];e!==t&&(t==null||t.pause()),n=EL(n,e),n.unshift(e)},remove(e){var t;n=EL(n,e),(t=n[0])==null||t.resume()}}}function EL(n,e){const t=[...n],r=t.indexOf(e);return r!==-1&&t.splice(r,1),t}function lne(n){return n.filter(e=>e.tagName!=="A")}var wi=globalThis!=null&&globalThis.document?N.useLayoutEffect:()=>{},cne=uU[" useId ".trim().toString()]||(()=>{}),une=0;function Ja(n){const[e,t]=N.useState(cne());return wi(()=>{t(r=>r??String(une++))},[n]),e?`radix-${e}`:""}const dne=["top","right","bottom","left"],ad=Math.min,Oo=Math.max,eS=Math.round,Lw=Math.floor,Ol=n=>({x:n,y:n}),hne={left:"right",right:"left",bottom:"top",top:"bottom"},fne={start:"end",end:"start"};function PM(n,e,t){return Oo(n,ad(e,t))}function $c(n,e){return typeof n=="function"?n(e):n}function jc(n){return n.split("-")[0]}function mg(n){return n.split("-")[1]}function aI(n){return n==="x"?"y":"x"}function lI(n){return n==="y"?"height":"width"}function ld(n){return["top","bottom"].includes(jc(n))?"y":"x"}function cI(n){return aI(ld(n))}function pne(n,e,t){t===void 0&&(t=!1);const r=mg(n),i=cI(n),s=lI(i);let o=i==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=tS(o)),[o,tS(o)]}function mne(n){const e=tS(n);return[DM(n),e,DM(e)]}function DM(n){return n.replace(/start|end/g,e=>fne[e])}function gne(n,e,t){const r=["left","right"],i=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(n){case"top":case"bottom":return t?e?i:r:e?r:i;case"left":case"right":return e?s:o;default:return[]}}function yne(n,e,t,r){const i=mg(n);let s=gne(jc(n),t==="start",r);return i&&(s=s.map(o=>o+"-"+i),e&&(s=s.concat(s.map(DM)))),s}function tS(n){return n.replace(/left|right|bottom|top/g,e=>hne[e])}function vne(n){return{top:0,right:0,bottom:0,left:0,...n}}function tj(n){return typeof n!="number"?vne(n):{top:n,right:n,bottom:n,left:n}}function nS(n){const{x:e,y:t,width:r,height:i}=n;return{width:r,height:i,top:t,left:e,right:e+r,bottom:t+i,x:e,y:t}}function CL(n,e,t){let{reference:r,floating:i}=n;const s=ld(e),o=cI(e),a=lI(o),l=jc(e),c=s==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,h=r[a]/2-i[a]/2;let f;switch(l){case"top":f={x:u,y:r.y-i.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-i.width,y:d};break;default:f={x:r.x,y:r.y}}switch(mg(e)){case"start":f[o]-=h*(t&&c?-1:1);break;case"end":f[o]+=h*(t&&c?-1:1);break}return f}const xne=async(n,e,t)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=t,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:n,floating:e,strategy:i}),{x:u,y:d}=CL(c,r,l),h=r,f={},p=0;for(let x=0;x<a.length;x++){const{name:v,fn:y}=a[x],{x:b,y:S,data:_,reset:T}=await y({x:u,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:f,rects:c,platform:o,elements:{reference:n,floating:e}});u=b??u,d=S??d,f={...f,[v]:{...f[v],..._}},T&&p<=50&&(p++,typeof T=="object"&&(T.placement&&(h=T.placement),T.rects&&(c=T.rects===!0?await o.getElementRects({reference:n,floating:e,strategy:i}):T.rects),{x:u,y:d}=CL(c,h,l)),x=-1)}return{x:u,y:d,placement:h,strategy:i,middlewareData:f}};async function Bv(n,e){var t;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:o,elements:a,strategy:l}=n,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=$c(e,n),p=tj(f),v=a[h?d==="floating"?"reference":"floating":d],y=nS(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(v)))==null||t?v:v.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),b=d==="floating"?{x:r,y:i,width:o.floating.width,height:o.floating.height}:o.reference,S=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),_=await(s.isElement==null?void 0:s.isElement(S))?await(s.getScale==null?void 0:s.getScale(S))||{x:1,y:1}:{x:1,y:1},T=nS(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:b,offsetParent:S,strategy:l}):b);return{top:(y.top-T.top+p.top)/_.y,bottom:(T.bottom-y.bottom+p.bottom)/_.y,left:(y.left-T.left+p.left)/_.x,right:(T.right-y.right+p.right)/_.x}}const wne=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:r,placement:i,rects:s,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=$c(n,e)||{};if(c==null)return{};const d=tj(u),h={x:t,y:r},f=cI(i),p=lI(f),x=await o.getDimensions(c),v=f==="y",y=v?"top":"left",b=v?"bottom":"right",S=v?"clientHeight":"clientWidth",_=s.reference[p]+s.reference[f]-h[f]-s.floating[p],T=h[f]-s.reference[f],M=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let k=M?M[S]:0;(!k||!await(o.isElement==null?void 0:o.isElement(M)))&&(k=a.floating[S]||s.floating[p]);const P=_/2-T/2,z=k/2-x[p]/2-1,I=ad(d[y],z),L=ad(d[b],z),W=I,q=k-x[p]-L,$=k/2-x[p]/2+P,ne=PM(W,$,q),Y=!l.arrow&&mg(i)!=null&&$!==ne&&s.reference[p]/2-($<W?I:L)-x[p]/2<0,we=Y?$<W?$-W:$-q:0;return{[f]:h[f]+we,data:{[f]:ne,centerOffset:$-ne-we,...Y&&{alignmentOffset:we}},reset:Y}}}),bne=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:i,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:x=!0,...v}=$c(n,e);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const y=jc(i),b=ld(a),S=jc(a)===a,_=await(l.isRTL==null?void 0:l.isRTL(c.floating)),T=h||(S||!x?[tS(a)]:mne(a)),M=p!=="none";!h&&M&&T.push(...yne(a,x,p,_));const k=[a,...T],P=await Bv(e,v),z=[];let I=((r=s.flip)==null?void 0:r.overflows)||[];if(u&&z.push(P[y]),d){const $=pne(i,o,_);z.push(P[$[0]],P[$[1]])}if(I=[...I,{placement:i,overflows:z}],!z.every($=>$<=0)){var L,W;const $=(((L=s.flip)==null?void 0:L.index)||0)+1,ne=k[$];if(ne)return{data:{index:$,overflows:I},reset:{placement:ne}};let Y=(W=I.filter(we=>we.overflows[0]<=0).sort((we,H)=>we.overflows[1]-H.overflows[1])[0])==null?void 0:W.placement;if(!Y)switch(f){case"bestFit":{var q;const we=(q=I.filter(H=>{if(M){const X=ld(H.placement);return X===b||X==="y"}return!0}).map(H=>[H.placement,H.overflows.filter(X=>X>0).reduce((X,oe)=>X+oe,0)]).sort((H,X)=>H[1]-X[1])[0])==null?void 0:q[0];we&&(Y=we);break}case"initialPlacement":Y=a;break}if(i!==Y)return{reset:{placement:Y}}}return{}}}};function TL(n,e){return{top:n.top-e.height,right:n.right-e.width,bottom:n.bottom-e.height,left:n.left-e.width}}function ML(n){return dne.some(e=>n[e]>=0)}const Sne=function(n){return n===void 0&&(n={}),{name:"hide",options:n,async fn(e){const{rects:t}=e,{strategy:r="referenceHidden",...i}=$c(n,e);switch(r){case"referenceHidden":{const s=await Bv(e,{...i,elementContext:"reference"}),o=TL(s,t.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:ML(o)}}}case"escaped":{const s=await Bv(e,{...i,altBoundary:!0}),o=TL(s,t.floating);return{data:{escapedOffsets:o,escaped:ML(o)}}}default:return{}}}}};async function _ne(n,e){const{placement:t,platform:r,elements:i}=n,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),o=jc(t),a=mg(t),l=ld(t)==="y",c=["left","top"].includes(o)?-1:1,u=s&&l?-1:1,d=$c(e,n);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),l?{x:f*u,y:h*c}:{x:h*c,y:f*u}}const Ene=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:i,y:s,placement:o,middlewareData:a}=e,l=await _ne(e,n);return o===((t=a.offset)==null?void 0:t.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:o}}}}},Cne=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:v=>{let{x:y,y:b}=v;return{x:y,y:b}}},...l}=$c(n,e),c={x:t,y:r},u=await Bv(e,l),d=ld(jc(i)),h=aI(d);let f=c[h],p=c[d];if(s){const v=h==="y"?"top":"left",y=h==="y"?"bottom":"right",b=f+u[v],S=f-u[y];f=PM(b,f,S)}if(o){const v=d==="y"?"top":"left",y=d==="y"?"bottom":"right",b=p+u[v],S=p-u[y];p=PM(b,p,S)}const x=a.fn({...e,[h]:f,[d]:p});return{...x,data:{x:x.x-t,y:x.y-r,enabled:{[h]:s,[d]:o}}}}}},Tne=function(n){return n===void 0&&(n={}),{options:n,fn(e){const{x:t,y:r,placement:i,rects:s,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=$c(n,e),u={x:t,y:r},d=ld(i),h=aI(d);let f=u[h],p=u[d];const x=$c(a,e),v=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(l){const S=h==="y"?"height":"width",_=s.reference[h]-s.floating[S]+v.mainAxis,T=s.reference[h]+s.reference[S]-v.mainAxis;f<_?f=_:f>T&&(f=T)}if(c){var y,b;const S=h==="y"?"width":"height",_=["top","left"].includes(jc(i)),T=s.reference[d]-s.floating[S]+(_&&((y=o.offset)==null?void 0:y[d])||0)+(_?0:v.crossAxis),M=s.reference[d]+s.reference[S]+(_?0:((b=o.offset)==null?void 0:b[d])||0)-(_?v.crossAxis:0);p<T?p=T:p>M&&(p=M)}return{[h]:f,[d]:p}}}},Mne=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){var t,r;const{placement:i,rects:s,platform:o,elements:a}=e,{apply:l=()=>{},...c}=$c(n,e),u=await Bv(e,c),d=jc(i),h=mg(i),f=ld(i)==="y",{width:p,height:x}=s.floating;let v,y;d==="top"||d==="bottom"?(v=d,y=h===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(y=d,v=h==="end"?"top":"bottom");const b=x-u.top-u.bottom,S=p-u.left-u.right,_=ad(x-u[v],b),T=ad(p-u[y],S),M=!e.middlewareData.shift;let k=_,P=T;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(P=S),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(k=b),M&&!h){const I=Oo(u.left,0),L=Oo(u.right,0),W=Oo(u.top,0),q=Oo(u.bottom,0);f?P=p-2*(I!==0||L!==0?I+L:Oo(u.left,u.right)):k=x-2*(W!==0||q!==0?W+q:Oo(u.top,u.bottom))}await l({...e,availableWidth:P,availableHeight:k});const z=await o.getDimensions(a.floating);return p!==z.width||x!==z.height?{reset:{rects:!0}}:{}}}};function v_(){return typeof window<"u"}function gg(n){return nj(n)?(n.nodeName||"").toLowerCase():"#document"}function jo(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Ql(n){var e;return(e=(nj(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function nj(n){return v_()?n instanceof Node||n instanceof jo(n).Node:!1}function rl(n){return v_()?n instanceof Element||n instanceof jo(n).Element:!1}function Wl(n){return v_()?n instanceof HTMLElement||n instanceof jo(n).HTMLElement:!1}function AL(n){return!v_()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof jo(n).ShadowRoot}function K0(n){const{overflow:e,overflowX:t,overflowY:r,display:i}=il(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(i)}function Ane(n){return["table","td","th"].includes(gg(n))}function x_(n){return[":popover-open",":modal"].some(e=>{try{return n.matches(e)}catch{return!1}})}function uI(n){const e=dI(),t=rl(n)?il(n):n;return["transform","translate","scale","rotate","perspective"].some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function Nne(n){let e=cd(n);for(;Wl(e)&&!zm(e);){if(uI(e))return e;if(x_(e))return null;e=cd(e)}return null}function dI(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function zm(n){return["html","body","#document"].includes(gg(n))}function il(n){return jo(n).getComputedStyle(n)}function w_(n){return rl(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function cd(n){if(gg(n)==="html")return n;const e=n.assignedSlot||n.parentNode||AL(n)&&n.host||Ql(n);return AL(e)?e.host:e}function rj(n){const e=cd(n);return zm(e)?n.ownerDocument?n.ownerDocument.body:n.body:Wl(e)&&K0(e)?e:rj(e)}function $v(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=rj(n),s=i===((r=n.ownerDocument)==null?void 0:r.body),o=jo(i);if(s){const a=LM(o);return e.concat(o,o.visualViewport||[],K0(i)?i:[],a&&t?$v(a):[])}return e.concat(i,$v(i,[],t))}function LM(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function ij(n){const e=il(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Wl(n),s=i?n.offsetWidth:t,o=i?n.offsetHeight:r,a=eS(t)!==s||eS(r)!==o;return a&&(t=s,r=o),{width:t,height:r,$:a}}function hI(n){return rl(n)?n:n.contextElement}function xm(n){const e=hI(n);if(!Wl(e))return Ol(1);const t=e.getBoundingClientRect(),{width:r,height:i,$:s}=ij(e);let o=(s?eS(t.width):t.width)/r,a=(s?eS(t.height):t.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const kne=Ol(0);function sj(n){const e=jo(n);return!dI()||!e.visualViewport?kne:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Ine(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==jo(n)?!1:e}function rf(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=n.getBoundingClientRect(),s=hI(n);let o=Ol(1);e&&(r?rl(r)&&(o=xm(r)):o=xm(n));const a=Ine(s,t,r)?sj(s):Ol(0);let l=(i.left+a.x)/o.x,c=(i.top+a.y)/o.y,u=i.width/o.x,d=i.height/o.y;if(s){const h=jo(s),f=r&&rl(r)?jo(r):r;let p=h,x=LM(p);for(;x&&r&&f!==p;){const v=xm(x),y=x.getBoundingClientRect(),b=il(x),S=y.left+(x.clientLeft+parseFloat(b.paddingLeft))*v.x,_=y.top+(x.clientTop+parseFloat(b.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,d*=v.y,l+=S,c+=_,p=jo(x),x=LM(p)}}return nS({width:u,height:d,x:l,y:c})}function fI(n,e){const t=w_(n).scrollLeft;return e?e.left+t:rf(Ql(n)).left+t}function oj(n,e,t){t===void 0&&(t=!1);const r=n.getBoundingClientRect(),i=r.left+e.scrollLeft-(t?0:fI(n,r)),s=r.top+e.scrollTop;return{x:i,y:s}}function Rne(n){let{elements:e,rect:t,offsetParent:r,strategy:i}=n;const s=i==="fixed",o=Ql(r),a=e?x_(e.floating):!1;if(r===o||a&&s)return t;let l={scrollLeft:0,scrollTop:0},c=Ol(1);const u=Ol(0),d=Wl(r);if((d||!d&&!s)&&((gg(r)!=="body"||K0(o))&&(l=w_(r)),Wl(r))){const f=rf(r);c=xm(r),u.x=f.x+r.clientLeft,u.y=f.y+r.clientTop}const h=o&&!d&&!s?oj(o,l,!0):Ol(0);return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:t.y*c.y-l.scrollTop*c.y+u.y+h.y}}function Pne(n){return Array.from(n.getClientRects())}function Dne(n){const e=Ql(n),t=w_(n),r=n.ownerDocument.body,i=Oo(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=Oo(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-t.scrollLeft+fI(n);const a=-t.scrollTop;return il(r).direction==="rtl"&&(o+=Oo(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:o,y:a}}function Lne(n,e){const t=jo(n),r=Ql(n),i=t.visualViewport;let s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;const c=dI();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a,y:l}}function One(n,e){const t=rf(n,!0,e==="fixed"),r=t.top+n.clientTop,i=t.left+n.clientLeft,s=Wl(n)?xm(n):Ol(1),o=n.clientWidth*s.x,a=n.clientHeight*s.y,l=i*s.x,c=r*s.y;return{width:o,height:a,x:l,y:c}}function NL(n,e,t){let r;if(e==="viewport")r=Lne(n,t);else if(e==="document")r=Dne(Ql(n));else if(rl(e))r=One(e,t);else{const i=sj(n);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return nS(r)}function aj(n,e){const t=cd(n);return t===e||!rl(t)||zm(t)?!1:il(t).position==="fixed"||aj(t,e)}function Fne(n,e){const t=e.get(n);if(t)return t;let r=$v(n,[],!1).filter(a=>rl(a)&&gg(a)!=="body"),i=null;const s=il(n).position==="fixed";let o=s?cd(n):n;for(;rl(o)&&!zm(o);){const a=il(o),l=uI(o);!l&&a.position==="fixed"&&(i=null),(s?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||K0(o)&&!l&&aj(n,o))?r=r.filter(u=>u!==o):i=a,o=cd(o)}return e.set(n,r),r}function zne(n){let{element:e,boundary:t,rootBoundary:r,strategy:i}=n;const o=[...t==="clippingAncestors"?x_(e)?[]:Fne(e,this._c):[].concat(t),r],a=o[0],l=o.reduce((c,u)=>{const d=NL(e,u,i);return c.top=Oo(d.top,c.top),c.right=ad(d.right,c.right),c.bottom=ad(d.bottom,c.bottom),c.left=Oo(d.left,c.left),c},NL(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Une(n){const{width:e,height:t}=ij(n);return{width:e,height:t}}function Bne(n,e,t){const r=Wl(e),i=Ql(e),s=t==="fixed",o=rf(n,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=Ol(0);if(r||!r&&!s)if((gg(e)!=="body"||K0(i))&&(a=w_(e)),r){const h=rf(e,!0,s,e);l.x=h.x+e.clientLeft,l.y=h.y+e.clientTop}else i&&(l.x=fI(i));const c=i&&!r&&!s?oj(i,a):Ol(0),u=o.left+a.scrollLeft-l.x-c.x,d=o.top+a.scrollTop-l.y-c.y;return{x:u,y:d,width:o.width,height:o.height}}function tC(n){return il(n).position==="static"}function kL(n,e){if(!Wl(n)||il(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return Ql(n)===t&&(t=t.ownerDocument.body),t}function lj(n,e){const t=jo(n);if(x_(n))return t;if(!Wl(n)){let i=cd(n);for(;i&&!zm(i);){if(rl(i)&&!tC(i))return i;i=cd(i)}return t}let r=kL(n,e);for(;r&&Ane(r)&&tC(r);)r=kL(r,e);return r&&zm(r)&&tC(r)&&!uI(r)?t:r||Nne(n)||t}const $ne=async function(n){const e=this.getOffsetParent||lj,t=this.getDimensions,r=await t(n.floating);return{reference:Bne(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function jne(n){return il(n).direction==="rtl"}const Vne={convertOffsetParentRelativeRectToViewportRelativeRect:Rne,getDocumentElement:Ql,getClippingRect:zne,getOffsetParent:lj,getElementRects:$ne,getClientRects:Pne,getDimensions:Une,getScale:xm,isElement:rl,isRTL:jne};function cj(n,e){return n.x===e.x&&n.y===e.y&&n.width===e.width&&n.height===e.height}function Wne(n,e){let t=null,r;const i=Ql(n);function s(){var a;clearTimeout(r),(a=t)==null||a.disconnect(),t=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const c=n.getBoundingClientRect(),{left:u,top:d,width:h,height:f}=c;if(a||e(),!h||!f)return;const p=Lw(d),x=Lw(i.clientWidth-(u+h)),v=Lw(i.clientHeight-(d+f)),y=Lw(u),S={rootMargin:-p+"px "+-x+"px "+-v+"px "+-y+"px",threshold:Oo(0,ad(1,l))||1};let _=!0;function T(M){const k=M[0].intersectionRatio;if(k!==l){if(!_)return o();k?o(!1,k):r=setTimeout(()=>{o(!1,1e-7)},1e3)}k===1&&!cj(c,n.getBoundingClientRect())&&o(),_=!1}try{t=new IntersectionObserver(T,{...S,root:i.ownerDocument})}catch{t=new IntersectionObserver(T,S)}t.observe(n)}return o(!0),s}function Hne(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=hI(n),u=i||s?[...c?$v(c):[],...$v(e)]:[];u.forEach(y=>{i&&y.addEventListener("scroll",t,{passive:!0}),s&&y.addEventListener("resize",t)});const d=c&&a?Wne(c,t):null;let h=-1,f=null;o&&(f=new ResizeObserver(y=>{let[b]=y;b&&b.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var S;(S=f)==null||S.observe(e)})),t()}),c&&!l&&f.observe(c),f.observe(e));let p,x=l?rf(n):null;l&&v();function v(){const y=rf(n);x&&!cj(x,y)&&t(),x=y,p=requestAnimationFrame(v)}return t(),()=>{var y;u.forEach(b=>{i&&b.removeEventListener("scroll",t),s&&b.removeEventListener("resize",t)}),d==null||d(),(y=f)==null||y.disconnect(),f=null,l&&cancelAnimationFrame(p)}}const Gne=Ene,qne=Cne,Xne=bne,Kne=Mne,Yne=Sne,IL=wne,Zne=Tne,Qne=(n,e,t)=>{const r=new Map,i={platform:Vne,...t},s={...i.platform,_c:r};return xne(n,e,{...i,platform:s})};var ib=typeof document<"u"?N.useLayoutEffect:N.useEffect;function rS(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,i;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!rS(n[r],e[r]))return!1;return!0}if(i=Object.keys(n),t=i.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=t;r--!==0;){const s=i[r];if(!(s==="_owner"&&n.$$typeof)&&!rS(n[s],e[s]))return!1}return!0}return n!==n&&e!==e}function uj(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function RL(n,e){const t=uj(n);return Math.round(e*t)/t}function nC(n){const e=N.useRef(n);return ib(()=>{e.current=n}),e}function Jne(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:i,elements:{reference:s,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=n,[u,d]=N.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[h,f]=N.useState(r);rS(h,r)||f(r);const[p,x]=N.useState(null),[v,y]=N.useState(null),b=N.useCallback(H=>{H!==M.current&&(M.current=H,x(H))},[]),S=N.useCallback(H=>{H!==k.current&&(k.current=H,y(H))},[]),_=s||p,T=o||v,M=N.useRef(null),k=N.useRef(null),P=N.useRef(u),z=l!=null,I=nC(l),L=nC(i),W=nC(c),q=N.useCallback(()=>{if(!M.current||!k.current)return;const H={placement:e,strategy:t,middleware:h};L.current&&(H.platform=L.current),Qne(M.current,k.current,H).then(X=>{const oe={...X,isPositioned:W.current!==!1};$.current&&!rS(P.current,oe)&&(P.current=oe,cg.flushSync(()=>{d(oe)}))})},[h,e,t,L,W]);ib(()=>{c===!1&&P.current.isPositioned&&(P.current.isPositioned=!1,d(H=>({...H,isPositioned:!1})))},[c]);const $=N.useRef(!1);ib(()=>($.current=!0,()=>{$.current=!1}),[]),ib(()=>{if(_&&(M.current=_),T&&(k.current=T),_&&T){if(I.current)return I.current(_,T,q);q()}},[_,T,q,I,z]);const ne=N.useMemo(()=>({reference:M,floating:k,setReference:b,setFloating:S}),[b,S]),Y=N.useMemo(()=>({reference:_,floating:T}),[_,T]),we=N.useMemo(()=>{const H={position:t,left:0,top:0};if(!Y.floating)return H;const X=RL(Y.floating,u.x),oe=RL(Y.floating,u.y);return a?{...H,transform:"translate("+X+"px, "+oe+"px)",...uj(Y.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:X,top:oe}},[t,a,Y.floating,u.x,u.y]);return N.useMemo(()=>({...u,update:q,refs:ne,elements:Y,floatingStyles:we}),[u,q,ne,Y,we])}const ere=n=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:n,fn(t){const{element:r,padding:i}=typeof n=="function"?n(t):n;return r&&e(r)?r.current!=null?IL({element:r.current,padding:i}).fn(t):{}:r?IL({element:r,padding:i}).fn(t):{}}}},tre=(n,e)=>({...Gne(n),options:[n,e]}),nre=(n,e)=>({...qne(n),options:[n,e]}),rre=(n,e)=>({...Zne(n),options:[n,e]}),ire=(n,e)=>({...Xne(n),options:[n,e]}),sre=(n,e)=>({...Kne(n),options:[n,e]}),ore=(n,e)=>({...Yne(n),options:[n,e]}),are=(n,e)=>({...ere(n),options:[n,e]});var lre="Arrow",dj=N.forwardRef((n,e)=>{const{children:t,width:r=10,height:i=5,...s}=n;return w.jsx(rr.svg,{...s,ref:e,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:n.asChild?t:w.jsx("polygon",{points:"0,0 30,0 15,10"})})});dj.displayName=lre;var cre=dj;function hj(n){const[e,t]=N.useState(void 0);return wi(()=>{if(n){t({width:n.offsetWidth,height:n.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let o,a;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=n.offsetWidth,a=n.offsetHeight;t({width:o,height:a})});return r.observe(n,{box:"border-box"}),()=>r.unobserve(n)}else t(void 0)},[n]),e}var pI="Popper",[fj,b_]=Qo(pI),[ure,pj]=fj(pI),mj=n=>{const{__scopePopper:e,children:t}=n,[r,i]=N.useState(null);return w.jsx(ure,{scope:e,anchor:r,onAnchorChange:i,children:t})};mj.displayName=pI;var gj="PopperAnchor",yj=N.forwardRef((n,e)=>{const{__scopePopper:t,virtualRef:r,...i}=n,s=pj(gj,t),o=N.useRef(null),a=Gn(e,o);return N.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:w.jsx(rr.div,{...i,ref:a})});yj.displayName=gj;var mI="PopperContent",[dre,hre]=fj(mI),vj=N.forwardRef((n,e)=>{var Oe,nt,rt,ut,Qe,ae;const{__scopePopper:t,side:r="bottom",sideOffset:i=0,align:s="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:f="optimized",onPlaced:p,...x}=n,v=pj(mI,t),[y,b]=N.useState(null),S=Gn(e,ze=>b(ze)),[_,T]=N.useState(null),M=hj(_),k=(M==null?void 0:M.width)??0,P=(M==null?void 0:M.height)??0,z=r+(s!=="center"?"-"+s:""),I=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},L=Array.isArray(c)?c:[c],W=L.length>0,q={padding:I,boundary:L.filter(pre),altBoundary:W},{refs:$,floatingStyles:ne,placement:Y,isPositioned:we,middlewareData:H}=Jne({strategy:"fixed",placement:z,whileElementsMounted:(...ze)=>Hne(...ze,{animationFrame:f==="always"}),elements:{reference:v.anchor},middleware:[tre({mainAxis:i+P,alignmentAxis:o}),l&&nre({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?rre():void 0,...q}),l&&ire({...q}),sre({...q,apply:({elements:ze,rects:Re,availableWidth:Je,availableHeight:Ge})=>{const{width:Et,height:pt}=Re.reference,Q=ze.floating.style;Q.setProperty("--radix-popper-available-width",`${Je}px`),Q.setProperty("--radix-popper-available-height",`${Ge}px`),Q.setProperty("--radix-popper-anchor-width",`${Et}px`),Q.setProperty("--radix-popper-anchor-height",`${pt}px`)}}),_&&are({element:_,padding:a}),mre({arrowWidth:k,arrowHeight:P}),h&&ore({strategy:"referenceHidden",...q})]}),[X,oe]=bj(Y),ve=_o(p);wi(()=>{we&&(ve==null||ve())},[we,ve]);const Te=(Oe=H.arrow)==null?void 0:Oe.x,Xe=(nt=H.arrow)==null?void 0:nt.y,_e=((rt=H.arrow)==null?void 0:rt.centerOffset)!==0,[Ue,Fe]=N.useState();return wi(()=>{y&&Fe(window.getComputedStyle(y).zIndex)},[y]),w.jsx("div",{ref:$.setFloating,"data-radix-popper-content-wrapper":"",style:{...ne,transform:we?ne.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Ue,"--radix-popper-transform-origin":[(ut=H.transformOrigin)==null?void 0:ut.x,(Qe=H.transformOrigin)==null?void 0:Qe.y].join(" "),...((ae=H.hide)==null?void 0:ae.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:n.dir,children:w.jsx(dre,{scope:t,placedSide:X,onArrowChange:T,arrowX:Te,arrowY:Xe,shouldHideArrow:_e,children:w.jsx(rr.div,{"data-side":X,"data-align":oe,...x,ref:S,style:{...x.style,animation:we?void 0:"none"}})})})});vj.displayName=mI;var xj="PopperArrow",fre={top:"bottom",right:"left",bottom:"top",left:"right"},wj=N.forwardRef(function(e,t){const{__scopePopper:r,...i}=e,s=hre(xj,r),o=fre[s.placedSide];return w.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:w.jsx(cre,{...i,ref:t,style:{...i.style,display:"block"}})})});wj.displayName=xj;function pre(n){return n!==null}var mre=n=>({name:"transformOrigin",options:n,fn(e){var v,y,b;const{placement:t,rects:r,middlewareData:i}=e,o=((v=i.arrow)==null?void 0:v.centerOffset)!==0,a=o?0:n.arrowWidth,l=o?0:n.arrowHeight,[c,u]=bj(t),d={start:"0%",center:"50%",end:"100%"}[u],h=(((y=i.arrow)==null?void 0:y.x)??0)+a/2,f=(((b=i.arrow)==null?void 0:b.y)??0)+l/2;let p="",x="";return c==="bottom"?(p=o?d:`${h}px`,x=`${-l}px`):c==="top"?(p=o?d:`${h}px`,x=`${r.floating.height+l}px`):c==="right"?(p=`${-l}px`,x=o?d:`${f}px`):c==="left"&&(p=`${r.floating.width+l}px`,x=o?d:`${f}px`),{data:{x:p,y:x}}}});function bj(n){const[e,t="center"]=n.split("-");return[e,t]}var Sj=mj,_j=yj,Ej=vj,Cj=wj,gre="Portal",S_=N.forwardRef((n,e)=>{var a;const{container:t,...r}=n,[i,s]=N.useState(!1);wi(()=>s(!0),[]);const o=t||i&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?RQ.createPortal(w.jsx(rr.div,{...r,ref:e}),o):null});S_.displayName=gre;function yre(n,e){return N.useReducer((t,r)=>e[t][r]??t,n)}var Td=n=>{const{present:e,children:t}=n,r=vre(e),i=typeof t=="function"?t({present:r.isPresent}):N.Children.only(t),s=Gn(r.ref,xre(i));return typeof t=="function"||r.isPresent?N.cloneElement(i,{ref:s}):null};Td.displayName="Presence";function vre(n){const[e,t]=N.useState(),r=N.useRef({}),i=N.useRef(n),s=N.useRef("none"),o=n?"mounted":"unmounted",[a,l]=yre(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return N.useEffect(()=>{const c=Ow(r.current);s.current=a==="mounted"?c:"none"},[a]),wi(()=>{const c=r.current,u=i.current;if(u!==n){const h=s.current,f=Ow(c);n?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==f?"ANIMATION_OUT":"UNMOUNT"),i.current=n}},[n,l]),wi(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=f=>{const x=Ow(r.current).includes(f.animationName);if(f.target===e&&x&&(l("ANIMATION_END"),!i.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},h=f=>{f.target===e&&(s.current=Ow(r.current))};return e.addEventListener("animationstart",h),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",h),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:N.useCallback(c=>{c&&(r.current=getComputedStyle(c)),t(c)},[])}}function Ow(n){return(n==null?void 0:n.animationName)||"none"}function xre(n){var r,i;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(i=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var rC="rovingFocusGroup.onEntryFocus",wre={bubbles:!1,cancelable:!0},__="RovingFocusGroup",[OM,Tj,bre]=sI(__),[Sre,Mj]=Qo(__,[bre]),[_re,Ere]=Sre(__),Aj=N.forwardRef((n,e)=>w.jsx(OM.Provider,{scope:n.__scopeRovingFocusGroup,children:w.jsx(OM.Slot,{scope:n.__scopeRovingFocusGroup,children:w.jsx(Cre,{...n,ref:e})})}));Aj.displayName=__;var Cre=N.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,orientation:r,loop:i=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=n,h=N.useRef(null),f=Gn(e,h),p=pg(s),[x=null,v]=Uv({prop:o,defaultProp:a,onChange:l}),[y,b]=N.useState(!1),S=_o(c),_=Tj(t),T=N.useRef(!1),[M,k]=N.useState(0);return N.useEffect(()=>{const P=h.current;if(P)return P.addEventListener(rC,S),()=>P.removeEventListener(rC,S)},[S]),w.jsx(_re,{scope:t,orientation:r,dir:p,loop:i,currentTabStopId:x,onItemFocus:N.useCallback(P=>v(P),[v]),onItemShiftTab:N.useCallback(()=>b(!0),[]),onFocusableItemAdd:N.useCallback(()=>k(P=>P+1),[]),onFocusableItemRemove:N.useCallback(()=>k(P=>P-1),[]),children:w.jsx(rr.div,{tabIndex:y||M===0?-1:0,"data-orientation":r,...d,ref:f,style:{outline:"none",...n.style},onMouseDown:Ft(n.onMouseDown,()=>{T.current=!0}),onFocus:Ft(n.onFocus,P=>{const z=!T.current;if(P.target===P.currentTarget&&z&&!y){const I=new CustomEvent(rC,wre);if(P.currentTarget.dispatchEvent(I),!I.defaultPrevented){const L=_().filter(Y=>Y.focusable),W=L.find(Y=>Y.active),q=L.find(Y=>Y.id===x),ne=[W,q,...L].filter(Boolean).map(Y=>Y.ref.current);Ij(ne,u)}}T.current=!1}),onBlur:Ft(n.onBlur,()=>b(!1))})})}),Nj="RovingFocusGroupItem",kj=N.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,focusable:r=!0,active:i=!1,tabStopId:s,...o}=n,a=Ja(),l=s||a,c=Ere(Nj,t),u=c.currentTabStopId===l,d=Tj(t),{onFocusableItemAdd:h,onFocusableItemRemove:f}=c;return N.useEffect(()=>{if(r)return h(),()=>f()},[r,h,f]),w.jsx(OM.ItemSlot,{scope:t,id:l,focusable:r,active:i,children:w.jsx(rr.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...o,ref:e,onMouseDown:Ft(n.onMouseDown,p=>{r?c.onItemFocus(l):p.preventDefault()}),onFocus:Ft(n.onFocus,()=>c.onItemFocus(l)),onKeyDown:Ft(n.onKeyDown,p=>{if(p.key==="Tab"&&p.shiftKey){c.onItemShiftTab();return}if(p.target!==p.currentTarget)return;const x=Are(p,c.orientation,c.dir);if(x!==void 0){if(p.metaKey||p.ctrlKey||p.altKey||p.shiftKey)return;p.preventDefault();let y=d().filter(b=>b.focusable).map(b=>b.ref.current);if(x==="last")y.reverse();else if(x==="prev"||x==="next"){x==="prev"&&y.reverse();const b=y.indexOf(p.currentTarget);y=c.loop?Nre(y,b+1):y.slice(b+1)}setTimeout(()=>Ij(y))}})})})});kj.displayName=Nj;var Tre={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Mre(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function Are(n,e,t){const r=Mre(n.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Tre[r]}function Ij(n,e=!1){const t=document.activeElement;for(const r of n)if(r===t||(r.focus({preventScroll:e}),document.activeElement!==t))return}function Nre(n,e){return n.map((t,r)=>n[(e+r)%n.length])}var kre=Aj,Ire=kj,Rre=function(n){if(typeof document>"u")return null;var e=Array.isArray(n)?n[0]:n;return e.ownerDocument.body},op=new WeakMap,Fw=new WeakMap,zw={},iC=0,Rj=function(n){return n&&(n.host||Rj(n.parentNode))},Pre=function(n,e){return e.map(function(t){if(n.contains(t))return t;var r=Rj(t);return r&&n.contains(r)?r:(console.error("aria-hidden",t,"in not contained inside",n,". Doing nothing"),null)}).filter(function(t){return!!t})},Dre=function(n,e,t,r){var i=Pre(e,Array.isArray(n)?n:[n]);zw[t]||(zw[t]=new WeakMap);var s=zw[t],o=[],a=new Set,l=new Set(i),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};i.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))u(h);else try{var f=h.getAttribute(r),p=f!==null&&f!=="false",x=(op.get(h)||0)+1,v=(s.get(h)||0)+1;op.set(h,x),s.set(h,v),o.push(h),x===1&&p&&Fw.set(h,!0),v===1&&h.setAttribute(t,"true"),p||h.setAttribute(r,"true")}catch(y){console.error("aria-hidden: cannot operate on ",h,y)}})};return u(e),a.clear(),iC++,function(){o.forEach(function(d){var h=op.get(d)-1,f=s.get(d)-1;op.set(d,h),s.set(d,f),h||(Fw.has(d)||d.removeAttribute(r),Fw.delete(d)),f||d.removeAttribute(t)}),iC--,iC||(op=new WeakMap,op=new WeakMap,Fw=new WeakMap,zw={})}},gI=function(n,e,t){t===void 0&&(t="data-aria-hidden");var r=Array.from(Array.isArray(n)?n:[n]),i=Rre(n);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),Dre(r,i,t,"aria-hidden")):function(){return null}},Ml=function(){return Ml=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Ml.apply(this,arguments)};function Pj(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function Ef(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})}function Lre(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))}var sb="right-scroll-bar-position",ob="width-before-scroll-bar",Ore="with-scroll-bars-hidden",Fre="--removed-body-scroll-bar-size";function sC(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function zre(n,e){var t=N.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(r){var i=t.value;i!==r&&(t.value=r,t.callback(r,i))}}}})[0];return t.callback=e,t.facade}var Ure=typeof window<"u"?N.useLayoutEffect:N.useEffect,PL=new WeakMap;function Bre(n,e){var t=zre(null,function(r){return n.forEach(function(i){return sC(i,r)})});return Ure(function(){var r=PL.get(t);if(r){var i=new Set(r),s=new Set(n),o=t.current;i.forEach(function(a){s.has(a)||sC(a,null)}),s.forEach(function(a){i.has(a)||sC(a,o)})}PL.set(t,n)},[n]),t}function $re(n){return n}function jre(n,e){e===void 0&&(e=$re);var t=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(s){var o=e(s,r);return t.push(o),function(){t=t.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(r=!0;t.length;){var o=t;t=[],o.forEach(s)}t={push:function(a){return s(a)},filter:function(){return t}}},assignMedium:function(s){r=!0;var o=[];if(t.length){var a=t;t=[],a.forEach(s),o=t}var l=function(){var u=o;o=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),t={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),t}}}};return i}function Vre(n){n===void 0&&(n={});var e=jre(null);return e.options=Ml({async:!0,ssr:!1},n),e}var Dj=function(n){var e=n.sideCar,t=Pj(n,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return N.createElement(r,Ml({},t))};Dj.isSideCarExport=!0;function Wre(n,e){return n.useMedium(e),Dj}var Lj=Vre(),oC=function(){},E_=N.forwardRef(function(n,e){var t=N.useRef(null),r=N.useState({onScrollCapture:oC,onWheelCapture:oC,onTouchMoveCapture:oC}),i=r[0],s=r[1],o=n.forwardProps,a=n.children,l=n.className,c=n.removeScrollBar,u=n.enabled,d=n.shards,h=n.sideCar,f=n.noIsolation,p=n.inert,x=n.allowPinchZoom,v=n.as,y=v===void 0?"div":v,b=n.gapMode,S=Pj(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=h,T=Bre([t,e]),M=Ml(Ml({},S),i);return N.createElement(N.Fragment,null,u&&N.createElement(_,{sideCar:Lj,removeScrollBar:c,shards:d,noIsolation:f,inert:p,setCallbacks:s,allowPinchZoom:!!x,lockRef:t,gapMode:b}),o?N.cloneElement(N.Children.only(a),Ml(Ml({},M),{ref:T})):N.createElement(y,Ml({},M,{className:l,ref:T}),a))});E_.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};E_.classNames={fullWidth:ob,zeroRight:sb};var Hre=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Gre(){if(!document)return null;var n=document.createElement("style");n.type="text/css";var e=Hre();return e&&n.setAttribute("nonce",e),n}function qre(n,e){n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}function Xre(n){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(n)}var Kre=function(){var n=0,e=null;return{add:function(t){n==0&&(e=Gre())&&(qre(e,t),Xre(e)),n++},remove:function(){n--,!n&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Yre=function(){var n=Kre();return function(e,t){N.useEffect(function(){return n.add(e),function(){n.remove()}},[e&&t])}},Oj=function(){var n=Yre(),e=function(t){var r=t.styles,i=t.dynamic;return n(r,i),null};return e},Zre={left:0,top:0,right:0,gap:0},aC=function(n){return parseInt(n||"",10)||0},Qre=function(n){var e=window.getComputedStyle(document.body),t=e[n==="padding"?"paddingLeft":"marginLeft"],r=e[n==="padding"?"paddingTop":"marginTop"],i=e[n==="padding"?"paddingRight":"marginRight"];return[aC(t),aC(r),aC(i)]},Jre=function(n){if(n===void 0&&(n="margin"),typeof window>"u")return Zre;var e=Qre(n),t=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-t+e[2]-e[0])}},eie=Oj(),wm="data-scroll-locked",tie=function(n,e,t,r){var i=n.left,s=n.top,o=n.right,a=n.gap;return t===void 0&&(t="margin"),`
  .`.concat(Ore,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(wm,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),t==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),t==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(sb,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(ob,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(sb," .").concat(sb,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(ob," .").concat(ob,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(wm,`] {
    `).concat(Fre,": ").concat(a,`px;
  }
`)},DL=function(){var n=parseInt(document.body.getAttribute(wm)||"0",10);return isFinite(n)?n:0},nie=function(){N.useEffect(function(){return document.body.setAttribute(wm,(DL()+1).toString()),function(){var n=DL()-1;n<=0?document.body.removeAttribute(wm):document.body.setAttribute(wm,n.toString())}},[])},rie=function(n){var e=n.noRelative,t=n.noImportant,r=n.gapMode,i=r===void 0?"margin":r;nie();var s=N.useMemo(function(){return Jre(i)},[i]);return N.createElement(eie,{styles:tie(s,!e,i,t?"":"!important")})},FM=!1;if(typeof window<"u")try{var Uw=Object.defineProperty({},"passive",{get:function(){return FM=!0,!0}});window.addEventListener("test",Uw,Uw),window.removeEventListener("test",Uw,Uw)}catch{FM=!1}var ap=FM?{passive:!1}:!1,iie=function(n){return n.tagName==="TEXTAREA"},Fj=function(n,e){if(!(n instanceof Element))return!1;var t=window.getComputedStyle(n);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!iie(n)&&t[e]==="visible")},sie=function(n){return Fj(n,"overflowY")},oie=function(n){return Fj(n,"overflowX")},LL=function(n,e){var t=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=zj(n,r);if(i){var s=Uj(n,r),o=s[1],a=s[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==t.body);return!1},aie=function(n){var e=n.scrollTop,t=n.scrollHeight,r=n.clientHeight;return[e,t,r]},lie=function(n){var e=n.scrollLeft,t=n.scrollWidth,r=n.clientWidth;return[e,t,r]},zj=function(n,e){return n==="v"?sie(e):oie(e)},Uj=function(n,e){return n==="v"?aie(e):lie(e)},cie=function(n,e){return n==="h"&&e==="rtl"?-1:1},uie=function(n,e,t,r,i){var s=cie(n,window.getComputedStyle(e).direction),o=s*r,a=t.target,l=e.contains(a),c=!1,u=o>0,d=0,h=0;do{var f=Uj(n,a),p=f[0],x=f[1],v=f[2],y=x-v-s*p;(p||y)&&zj(n,a)&&(d+=y,h+=p),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&Math.abs(d)<1||!u&&Math.abs(h)<1)&&(c=!0),c},Bw=function(n){return"changedTouches"in n?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0]},OL=function(n){return[n.deltaX,n.deltaY]},FL=function(n){return n&&"current"in n?n.current:n},die=function(n,e){return n[0]===e[0]&&n[1]===e[1]},hie=function(n){return`
  .block-interactivity-`.concat(n,` {pointer-events: none;}
  .allow-interactivity-`).concat(n,` {pointer-events: all;}
`)},fie=0,lp=[];function pie(n){var e=N.useRef([]),t=N.useRef([0,0]),r=N.useRef(),i=N.useState(fie++)[0],s=N.useState(Oj)[0],o=N.useRef(n);N.useEffect(function(){o.current=n},[n]),N.useEffect(function(){if(n.inert){document.body.classList.add("block-interactivity-".concat(i));var x=Lre([n.lockRef.current],(n.shards||[]).map(FL),!0).filter(Boolean);return x.forEach(function(v){return v.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),x.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(i))})}}},[n.inert,n.lockRef.current,n.shards]);var a=N.useCallback(function(x,v){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!o.current.allowPinchZoom;var y=Bw(x),b=t.current,S="deltaX"in x?x.deltaX:b[0]-y[0],_="deltaY"in x?x.deltaY:b[1]-y[1],T,M=x.target,k=Math.abs(S)>Math.abs(_)?"h":"v";if("touches"in x&&k==="h"&&M.type==="range")return!1;var P=LL(k,M);if(!P)return!0;if(P?T=k:(T=k==="v"?"h":"v",P=LL(k,M)),!P)return!1;if(!r.current&&"changedTouches"in x&&(S||_)&&(r.current=T),!T)return!0;var z=r.current||T;return uie(z,v,x,z==="h"?S:_)},[]),l=N.useCallback(function(x){var v=x;if(!(!lp.length||lp[lp.length-1]!==s)){var y="deltaY"in v?OL(v):Bw(v),b=e.current.filter(function(T){return T.name===v.type&&(T.target===v.target||v.target===T.shadowParent)&&die(T.delta,y)})[0];if(b&&b.should){v.cancelable&&v.preventDefault();return}if(!b){var S=(o.current.shards||[]).map(FL).filter(Boolean).filter(function(T){return T.contains(v.target)}),_=S.length>0?a(v,S[0]):!o.current.noIsolation;_&&v.cancelable&&v.preventDefault()}}},[]),c=N.useCallback(function(x,v,y,b){var S={name:x,delta:v,target:y,should:b,shadowParent:mie(y)};e.current.push(S),setTimeout(function(){e.current=e.current.filter(function(_){return _!==S})},1)},[]),u=N.useCallback(function(x){t.current=Bw(x),r.current=void 0},[]),d=N.useCallback(function(x){c(x.type,OL(x),x.target,a(x,n.lockRef.current))},[]),h=N.useCallback(function(x){c(x.type,Bw(x),x.target,a(x,n.lockRef.current))},[]);N.useEffect(function(){return lp.push(s),n.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,ap),document.addEventListener("touchmove",l,ap),document.addEventListener("touchstart",u,ap),function(){lp=lp.filter(function(x){return x!==s}),document.removeEventListener("wheel",l,ap),document.removeEventListener("touchmove",l,ap),document.removeEventListener("touchstart",u,ap)}},[]);var f=n.removeScrollBar,p=n.inert;return N.createElement(N.Fragment,null,p?N.createElement(s,{styles:hie(i)}):null,f?N.createElement(rie,{gapMode:n.gapMode}):null)}function mie(n){for(var e=null;n!==null;)n instanceof ShadowRoot&&(e=n.host,n=n.host),n=n.parentNode;return e}const gie=Wre(Lj,pie);var C_=N.forwardRef(function(n,e){return N.createElement(E_,Ml({},n,{ref:e,sideCar:gie}))});C_.classNames=E_.classNames;var zM=["Enter"," "],yie=["ArrowDown","PageUp","Home"],Bj=["ArrowUp","PageDown","End"],vie=[...yie,...Bj],xie={ltr:[...zM,"ArrowRight"],rtl:[...zM,"ArrowLeft"]},wie={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Y0="Menu",[jv,bie,Sie]=sI(Y0),[Cf,$j]=Qo(Y0,[Sie,b_,Mj]),T_=b_(),jj=Mj(),[_ie,Tf]=Cf(Y0),[Eie,Z0]=Cf(Y0),Vj=n=>{const{__scopeMenu:e,open:t=!1,children:r,dir:i,onOpenChange:s,modal:o=!0}=n,a=T_(e),[l,c]=N.useState(null),u=N.useRef(!1),d=_o(s),h=pg(i);return N.useEffect(()=>{const f=()=>{u.current=!0,document.addEventListener("pointerdown",p,{capture:!0,once:!0}),document.addEventListener("pointermove",p,{capture:!0,once:!0})},p=()=>u.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",p,{capture:!0}),document.removeEventListener("pointermove",p,{capture:!0})}},[]),w.jsx(Sj,{...a,children:w.jsx(_ie,{scope:e,open:t,onOpenChange:d,content:l,onContentChange:c,children:w.jsx(Eie,{scope:e,onClose:N.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:o,children:r})})})};Vj.displayName=Y0;var Cie="MenuAnchor",yI=N.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n,i=T_(t);return w.jsx(_j,{...i,...r,ref:e})});yI.displayName=Cie;var vI="MenuPortal",[Tie,Wj]=Cf(vI,{forceMount:void 0}),Hj=n=>{const{__scopeMenu:e,forceMount:t,children:r,container:i}=n,s=Tf(vI,e);return w.jsx(Tie,{scope:e,forceMount:t,children:w.jsx(Td,{present:t||s.open,children:w.jsx(S_,{asChild:!0,container:i,children:r})})})};Hj.displayName=vI;var _a="MenuContent",[Mie,xI]=Cf(_a),Gj=N.forwardRef((n,e)=>{const t=Wj(_a,n.__scopeMenu),{forceMount:r=t.forceMount,...i}=n,s=Tf(_a,n.__scopeMenu),o=Z0(_a,n.__scopeMenu);return w.jsx(jv.Provider,{scope:n.__scopeMenu,children:w.jsx(Td,{present:r||s.open,children:w.jsx(jv.Slot,{scope:n.__scopeMenu,children:o.modal?w.jsx(Aie,{...i,ref:e}):w.jsx(Nie,{...i,ref:e})})})})}),Aie=N.forwardRef((n,e)=>{const t=Tf(_a,n.__scopeMenu),r=N.useRef(null),i=Gn(e,r);return N.useEffect(()=>{const s=r.current;if(s)return gI(s)},[]),w.jsx(wI,{...n,ref:i,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:Ft(n.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),Nie=N.forwardRef((n,e)=>{const t=Tf(_a,n.__scopeMenu);return w.jsx(wI,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),kie=nf("MenuContent.ScrollLock"),wI=N.forwardRef((n,e)=>{const{__scopeMenu:t,loop:r=!1,trapFocus:i,onOpenAutoFocus:s,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:f,disableOutsideScroll:p,...x}=n,v=Tf(_a,t),y=Z0(_a,t),b=T_(t),S=jj(t),_=bie(t),[T,M]=N.useState(null),k=N.useRef(null),P=Gn(e,k,v.onContentChange),z=N.useRef(0),I=N.useRef(""),L=N.useRef(0),W=N.useRef(null),q=N.useRef("right"),$=N.useRef(0),ne=p?C_:N.Fragment,Y=p?{as:kie,allowPinchZoom:!0}:void 0,we=X=>{var Oe,nt;const oe=I.current+X,ve=_().filter(rt=>!rt.disabled),Te=document.activeElement,Xe=(Oe=ve.find(rt=>rt.ref.current===Te))==null?void 0:Oe.textValue,_e=ve.map(rt=>rt.textValue),Ue=jie(_e,oe,Xe),Fe=(nt=ve.find(rt=>rt.textValue===Ue))==null?void 0:nt.ref.current;(function rt(ut){I.current=ut,window.clearTimeout(z.current),ut!==""&&(z.current=window.setTimeout(()=>rt(""),1e3))})(oe),Fe&&setTimeout(()=>Fe.focus())};N.useEffect(()=>()=>window.clearTimeout(z.current),[]),oI();const H=N.useCallback(X=>{var ve,Te;return q.current===((ve=W.current)==null?void 0:ve.side)&&Wie(X,(Te=W.current)==null?void 0:Te.area)},[]);return w.jsx(Mie,{scope:t,searchRef:I,onItemEnter:N.useCallback(X=>{H(X)&&X.preventDefault()},[H]),onItemLeave:N.useCallback(X=>{var oe;H(X)||((oe=k.current)==null||oe.focus(),M(null))},[H]),onTriggerLeave:N.useCallback(X=>{H(X)&&X.preventDefault()},[H]),pointerGraceTimerRef:L,onPointerGraceIntentChange:N.useCallback(X=>{W.current=X},[]),children:w.jsx(ne,{...Y,children:w.jsx(y_,{asChild:!0,trapped:i,onMountAutoFocus:Ft(s,X=>{var oe;X.preventDefault(),(oe=k.current)==null||oe.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:w.jsx(g_,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:f,children:w.jsx(kre,{asChild:!0,...S,dir:y.dir,orientation:"vertical",loop:r,currentTabStopId:T,onCurrentTabStopIdChange:M,onEntryFocus:Ft(l,X=>{y.isUsingKeyboardRef.current||X.preventDefault()}),preventScrollOnEntryFocus:!0,children:w.jsx(Ej,{role:"menu","aria-orientation":"vertical","data-state":lV(v.open),"data-radix-menu-content":"",dir:y.dir,...b,...x,ref:P,style:{outline:"none",...x.style},onKeyDown:Ft(x.onKeyDown,X=>{const ve=X.target.closest("[data-radix-menu-content]")===X.currentTarget,Te=X.ctrlKey||X.altKey||X.metaKey,Xe=X.key.length===1;ve&&(X.key==="Tab"&&X.preventDefault(),!Te&&Xe&&we(X.key));const _e=k.current;if(X.target!==_e||!vie.includes(X.key))return;X.preventDefault();const Fe=_().filter(Oe=>!Oe.disabled).map(Oe=>Oe.ref.current);Bj.includes(X.key)&&Fe.reverse(),Bie(Fe)}),onBlur:Ft(n.onBlur,X=>{X.currentTarget.contains(X.target)||(window.clearTimeout(z.current),I.current="")}),onPointerMove:Ft(n.onPointerMove,Vv(X=>{const oe=X.target,ve=$.current!==X.clientX;if(X.currentTarget.contains(oe)&&ve){const Te=X.clientX>$.current?"right":"left";q.current=Te,$.current=X.clientX}}))})})})})})})});Gj.displayName=_a;var Iie="MenuGroup",bI=N.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n;return w.jsx(rr.div,{role:"group",...r,ref:e})});bI.displayName=Iie;var Rie="MenuLabel",qj=N.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n;return w.jsx(rr.div,{...r,ref:e})});qj.displayName=Rie;var iS="MenuItem",zL="menu.itemSelect",M_=N.forwardRef((n,e)=>{const{disabled:t=!1,onSelect:r,...i}=n,s=N.useRef(null),o=Z0(iS,n.__scopeMenu),a=xI(iS,n.__scopeMenu),l=Gn(e,s),c=N.useRef(!1),u=()=>{const d=s.current;if(!t&&d){const h=new CustomEvent(zL,{bubbles:!0,cancelable:!0});d.addEventListener(zL,f=>r==null?void 0:r(f),{once:!0}),Z$(d,h),h.defaultPrevented?c.current=!1:o.onClose()}};return w.jsx(Xj,{...i,ref:l,disabled:t,onClick:Ft(n.onClick,u),onPointerDown:d=>{var h;(h=n.onPointerDown)==null||h.call(n,d),c.current=!0},onPointerUp:Ft(n.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:Ft(n.onKeyDown,d=>{const h=a.searchRef.current!=="";t||h&&d.key===" "||zM.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});M_.displayName=iS;var Xj=N.forwardRef((n,e)=>{const{__scopeMenu:t,disabled:r=!1,textValue:i,...s}=n,o=xI(iS,t),a=jj(t),l=N.useRef(null),c=Gn(e,l),[u,d]=N.useState(!1),[h,f]=N.useState("");return N.useEffect(()=>{const p=l.current;p&&f((p.textContent??"").trim())},[s.children]),w.jsx(jv.ItemSlot,{scope:t,disabled:r,textValue:i??h,children:w.jsx(Ire,{asChild:!0,...a,focusable:!r,children:w.jsx(rr.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...s,ref:c,onPointerMove:Ft(n.onPointerMove,Vv(p=>{r?o.onItemLeave(p):(o.onItemEnter(p),p.defaultPrevented||p.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Ft(n.onPointerLeave,Vv(p=>o.onItemLeave(p))),onFocus:Ft(n.onFocus,()=>d(!0)),onBlur:Ft(n.onBlur,()=>d(!1))})})})}),Pie="MenuCheckboxItem",Kj=N.forwardRef((n,e)=>{const{checked:t=!1,onCheckedChange:r,...i}=n;return w.jsx(eV,{scope:n.__scopeMenu,checked:t,children:w.jsx(M_,{role:"menuitemcheckbox","aria-checked":sS(t)?"mixed":t,...i,ref:e,"data-state":_I(t),onSelect:Ft(i.onSelect,()=>r==null?void 0:r(sS(t)?!0:!t),{checkForDefaultPrevented:!1})})})});Kj.displayName=Pie;var Yj="MenuRadioGroup",[Die,Lie]=Cf(Yj,{value:void 0,onValueChange:()=>{}}),Zj=N.forwardRef((n,e)=>{const{value:t,onValueChange:r,...i}=n,s=_o(r);return w.jsx(Die,{scope:n.__scopeMenu,value:t,onValueChange:s,children:w.jsx(bI,{...i,ref:e})})});Zj.displayName=Yj;var Qj="MenuRadioItem",Jj=N.forwardRef((n,e)=>{const{value:t,...r}=n,i=Lie(Qj,n.__scopeMenu),s=t===i.value;return w.jsx(eV,{scope:n.__scopeMenu,checked:s,children:w.jsx(M_,{role:"menuitemradio","aria-checked":s,...r,ref:e,"data-state":_I(s),onSelect:Ft(r.onSelect,()=>{var o;return(o=i.onValueChange)==null?void 0:o.call(i,t)},{checkForDefaultPrevented:!1})})})});Jj.displayName=Qj;var SI="MenuItemIndicator",[eV,Oie]=Cf(SI,{checked:!1}),tV=N.forwardRef((n,e)=>{const{__scopeMenu:t,forceMount:r,...i}=n,s=Oie(SI,t);return w.jsx(Td,{present:r||sS(s.checked)||s.checked===!0,children:w.jsx(rr.span,{...i,ref:e,"data-state":_I(s.checked)})})});tV.displayName=SI;var Fie="MenuSeparator",nV=N.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n;return w.jsx(rr.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});nV.displayName=Fie;var zie="MenuArrow",rV=N.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n,i=T_(t);return w.jsx(Cj,{...i,...r,ref:e})});rV.displayName=zie;var Uie="MenuSub",[wBe,iV]=Cf(Uie),jy="MenuSubTrigger",sV=N.forwardRef((n,e)=>{const t=Tf(jy,n.__scopeMenu),r=Z0(jy,n.__scopeMenu),i=iV(jy,n.__scopeMenu),s=xI(jy,n.__scopeMenu),o=N.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=s,c={__scopeMenu:n.__scopeMenu},u=N.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return N.useEffect(()=>u,[u]),N.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),l(null)}},[a,l]),w.jsx(yI,{asChild:!0,...c,children:w.jsx(Xj,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":i.contentId,"data-state":lV(t.open),...n,ref:X0(e,i.onTriggerChange),onClick:d=>{var h;(h=n.onClick)==null||h.call(n,d),!(n.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:Ft(n.onPointerMove,Vv(d=>{s.onItemEnter(d),!d.defaultPrevented&&!n.disabled&&!t.open&&!o.current&&(s.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{t.onOpenChange(!0),u()},100))})),onPointerLeave:Ft(n.onPointerLeave,Vv(d=>{var f,p;u();const h=(f=t.content)==null?void 0:f.getBoundingClientRect();if(h){const x=(p=t.content)==null?void 0:p.dataset.side,v=x==="right",y=v?-5:5,b=h[v?"left":"right"],S=h[v?"right":"left"];s.onPointerGraceIntentChange({area:[{x:d.clientX+y,y:d.clientY},{x:b,y:h.top},{x:S,y:h.top},{x:S,y:h.bottom},{x:b,y:h.bottom}],side:x}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(d),d.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:Ft(n.onKeyDown,d=>{var f;const h=s.searchRef.current!=="";n.disabled||h&&d.key===" "||xie[r.dir].includes(d.key)&&(t.onOpenChange(!0),(f=t.content)==null||f.focus(),d.preventDefault())})})})});sV.displayName=jy;var oV="MenuSubContent",aV=N.forwardRef((n,e)=>{const t=Wj(_a,n.__scopeMenu),{forceMount:r=t.forceMount,...i}=n,s=Tf(_a,n.__scopeMenu),o=Z0(_a,n.__scopeMenu),a=iV(oV,n.__scopeMenu),l=N.useRef(null),c=Gn(e,l);return w.jsx(jv.Provider,{scope:n.__scopeMenu,children:w.jsx(Td,{present:r||s.open,children:w.jsx(jv.Slot,{scope:n.__scopeMenu,children:w.jsx(wI,{id:a.contentId,"aria-labelledby":a.triggerId,...i,ref:c,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;o.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Ft(n.onFocusOutside,u=>{u.target!==a.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:Ft(n.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:Ft(n.onKeyDown,u=>{var f;const d=u.currentTarget.contains(u.target),h=wie[o.dir].includes(u.key);d&&h&&(s.onOpenChange(!1),(f=a.trigger)==null||f.focus(),u.preventDefault())})})})})})});aV.displayName=oV;function lV(n){return n?"open":"closed"}function sS(n){return n==="indeterminate"}function _I(n){return sS(n)?"indeterminate":n?"checked":"unchecked"}function Bie(n){const e=document.activeElement;for(const t of n)if(t===e||(t.focus(),document.activeElement!==e))return}function $ie(n,e){return n.map((t,r)=>n[(e+r)%n.length])}function jie(n,e,t){const i=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,s=t?n.indexOf(t):-1;let o=$ie(n,Math.max(s,0));i.length===1&&(o=o.filter(c=>c!==t));const l=o.find(c=>c.toLowerCase().startsWith(i.toLowerCase()));return l!==t?l:void 0}function Vie(n,e){const{x:t,y:r}=n;let i=!1;for(let s=0,o=e.length-1;s<e.length;o=s++){const a=e[s].x,l=e[s].y,c=e[o].x,u=e[o].y;l>r!=u>r&&t<(c-a)*(r-l)/(u-l)+a&&(i=!i)}return i}function Wie(n,e){if(!e)return!1;const t={x:n.clientX,y:n.clientY};return Vie(t,e)}function Vv(n){return e=>e.pointerType==="mouse"?n(e):void 0}var Hie=Vj,Gie=yI,qie=Hj,Xie=Gj,Kie=bI,Yie=qj,Zie=M_,Qie=Kj,Jie=Zj,ese=Jj,tse=tV,nse=nV,rse=rV,ise=sV,sse=aV,EI="DropdownMenu",[ose,bBe]=Qo(EI,[$j]),to=$j(),[ase,cV]=ose(EI),uV=n=>{const{__scopeDropdownMenu:e,children:t,dir:r,open:i,defaultOpen:s,onOpenChange:o,modal:a=!0}=n,l=to(e),c=N.useRef(null),[u=!1,d]=Uv({prop:i,defaultProp:s,onChange:o});return w.jsx(ase,{scope:e,triggerId:Ja(),triggerRef:c,contentId:Ja(),open:u,onOpenChange:d,onOpenToggle:N.useCallback(()=>d(h=>!h),[d]),modal:a,children:w.jsx(Hie,{...l,open:u,onOpenChange:d,dir:r,modal:a,children:t})})};uV.displayName=EI;var dV="DropdownMenuTrigger",hV=N.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,disabled:r=!1,...i}=n,s=cV(dV,t),o=to(t);return w.jsx(Gie,{asChild:!0,...o,children:w.jsx(rr.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...i,ref:X0(e,s.triggerRef),onPointerDown:Ft(n.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(s.onOpenToggle(),s.open||a.preventDefault())}),onKeyDown:Ft(n.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&s.onOpenToggle(),a.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});hV.displayName=dV;var lse="DropdownMenuPortal",fV=n=>{const{__scopeDropdownMenu:e,...t}=n,r=to(e);return w.jsx(qie,{...r,...t})};fV.displayName=lse;var pV="DropdownMenuContent",mV=N.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=cV(pV,t),s=to(t),o=N.useRef(!1);return w.jsx(Xie,{id:i.contentId,"aria-labelledby":i.triggerId,...s,...r,ref:e,onCloseAutoFocus:Ft(n.onCloseAutoFocus,a=>{var l;o.current||(l=i.triggerRef.current)==null||l.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:Ft(n.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!i.modal||u)&&(o.current=!0)}),style:{...n.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});mV.displayName=pV;var cse="DropdownMenuGroup",use=N.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=to(t);return w.jsx(Kie,{...i,...r,ref:e})});use.displayName=cse;var dse="DropdownMenuLabel",gV=N.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=to(t);return w.jsx(Yie,{...i,...r,ref:e})});gV.displayName=dse;var hse="DropdownMenuItem",yV=N.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=to(t);return w.jsx(Zie,{...i,...r,ref:e})});yV.displayName=hse;var fse="DropdownMenuCheckboxItem",vV=N.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=to(t);return w.jsx(Qie,{...i,...r,ref:e})});vV.displayName=fse;var pse="DropdownMenuRadioGroup",mse=N.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=to(t);return w.jsx(Jie,{...i,...r,ref:e})});mse.displayName=pse;var gse="DropdownMenuRadioItem",xV=N.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=to(t);return w.jsx(ese,{...i,...r,ref:e})});xV.displayName=gse;var yse="DropdownMenuItemIndicator",wV=N.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=to(t);return w.jsx(tse,{...i,...r,ref:e})});wV.displayName=yse;var vse="DropdownMenuSeparator",bV=N.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=to(t);return w.jsx(nse,{...i,...r,ref:e})});bV.displayName=vse;var xse="DropdownMenuArrow",wse=N.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=to(t);return w.jsx(rse,{...i,...r,ref:e})});wse.displayName=xse;var bse="DropdownMenuSubTrigger",SV=N.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=to(t);return w.jsx(ise,{...i,...r,ref:e})});SV.displayName=bse;var Sse="DropdownMenuSubContent",_V=N.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=to(t);return w.jsx(sse,{...i,...r,ref:e,style:{...n.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});_V.displayName=Sse;var _se=uV,Ese=hV,Cse=fV,EV=mV,CV=gV,TV=yV,MV=vV,AV=xV,NV=wV,kV=bV,IV=SV,RV=_V;const UM=_se,BM=Ese,Tse=N.forwardRef(({className:n,inset:e,children:t,...r},i)=>w.jsxs(IV,{ref:i,className:wn("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-zinc-100 data-[state=open]:bg-zinc-100 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 dark:focus:bg-zinc-800 dark:data-[state=open]:bg-zinc-800",e&&"pl-8",n),...r,children:[t,w.jsx(kee,{className:"ml-auto"})]}));Tse.displayName=IV.displayName;const Mse=N.forwardRef(({className:n,...e},t)=>w.jsx(RV,{ref:t,className:wn("z-50 min-w-[8rem] overflow-hidden rounded-md border border-zinc-200 bg-white p-1 text-zinc-950 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50",n),...e}));Mse.displayName=RV.displayName;const oS=N.forwardRef(({className:n,sideOffset:e=4,...t},r)=>w.jsx(Cse,{children:w.jsx(EV,{ref:r,sideOffset:e,className:wn("z-50 min-w-[8rem] overflow-hidden rounded-md border border-zinc-200 bg-white p-1 text-zinc-950 shadow-md dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...t})}));oS.displayName=EV.displayName;const js=N.forwardRef(({className:n,inset:e,...t},r)=>w.jsx(TV,{ref:r,className:wn("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-zinc-100 focus:text-zinc-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0 dark:focus:bg-zinc-800 dark:focus:text-zinc-50",e&&"pl-8",n),...t}));js.displayName=TV.displayName;const Ase=N.forwardRef(({className:n,children:e,checked:t,...r},i)=>w.jsxs(MV,{ref:i,className:wn("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-zinc-100 focus:text-zinc-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-zinc-800 dark:focus:text-zinc-50",n),checked:t,...r,children:[w.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:w.jsx(NV,{children:w.jsx(eI,{className:"h-4 w-4"})})}),e]}));Ase.displayName=MV.displayName;const Nse=N.forwardRef(({className:n,children:e,...t},r)=>w.jsxs(AV,{ref:r,className:wn("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-zinc-100 focus:text-zinc-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-zinc-800 dark:focus:text-zinc-50",n),...t,children:[w.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:w.jsx(NV,{children:w.jsx(Ree,{className:"h-2 w-2 fill-current"})})}),e]}));Nse.displayName=AV.displayName;const kse=N.forwardRef(({className:n,inset:e,...t},r)=>w.jsx(CV,{ref:r,className:wn("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",n),...t}));kse.displayName=CV.displayName;const Bh=N.forwardRef(({className:n,...e},t)=>w.jsx(kV,{ref:t,className:wn("-mx-1 my-1 h-px bg-zinc-100 dark:bg-zinc-800",n),...e}));Bh.displayName=kV.displayName;const bl=()=>{const[n,e]=N.useState(!1),{user:t,isAuthenticated:r,isAdmin:i,logout:s}=Zl(),{theme:o,toggleTheme:a}=vee(),l=Yl(),c=Zc(),u=[{name:"Главная",href:"/",icon:O$},{name:"Проекты",href:"/dashboard",icon:cL,authRequired:!0},{name:"Редактор",href:"/editor",icon:Fv,authRequired:!0},{name:"Материалы",href:"/materials",icon:B$},{name:"AI Помощник",href:"/ai-assistant",icon:Qk,authRequired:!0},{name:"Тарифы",href:"/pricing",icon:Lee}],d=()=>{s(),c("/"),e(!1)},h=u.filter(f=>!f.authRequired||r);return w.jsx("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:w.jsxs("div",{className:"container mx-auto px-4",children:[w.jsxs("div",{className:"flex h-16 items-center justify-between",children:[w.jsxs(Xu,{to:"/",className:"flex items-center space-x-2",children:[w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:w.jsx(Fv,{className:"w-4 h-4 text-white"})}),w.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-gradient-to-br from-orange-400 to-red-500 rounded-full"})]}),w.jsx("span",{className:"font-bold text-xl bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"CraftRuv"})]}),w.jsx("nav",{className:"hidden md:flex items-center space-x-1",children:h.map(f=>{const p=l.pathname===f.href||f.href!=="/"&&l.pathname.startsWith(f.href);return w.jsxs(Xu,{to:f.href,className:`
                    flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors
                    ${p?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-accent"}
                  `,children:[w.jsx(f.icon,{className:"w-4 h-4"}),w.jsx("span",{children:f.name})]},f.name)})}),w.jsxs("div",{className:"flex items-center space-x-2",children:[w.jsx(zt,{variant:"ghost",size:"sm",onClick:a,className:"w-9 h-9 p-0",children:o==="dark"?w.jsx(Qee,{className:"w-4 h-4"}):w.jsx($ee,{className:"w-4 h-4"})}),r?w.jsxs(UM,{children:[w.jsx(BM,{asChild:!0,children:w.jsxs(zt,{variant:"ghost",size:"sm",className:"flex items-center space-x-2",children:[w.jsx("div",{className:"w-6 h-6 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center",children:w.jsx(nI,{className:"w-3 h-3 text-white"})}),w.jsx("span",{className:"hidden sm:inline text-sm",children:t==null?void 0:t.name})]})}),w.jsxs(oS,{align:"end",className:"w-56",children:[w.jsxs("div",{className:"flex flex-col space-y-1 p-2",children:[w.jsx("p",{className:"text-sm font-medium",children:t==null?void 0:t.name}),w.jsx("p",{className:"text-xs text-muted-foreground",children:t==null?void 0:t.email})]}),w.jsx(Bh,{}),w.jsxs(js,{onClick:()=>c("/dashboard"),children:[w.jsx(cL,{className:"w-4 h-4 mr-2"}),"Мои проекты"]}),w.jsxs(js,{onClick:()=>c("/billing"),children:[w.jsx(p_,{className:"w-4 h-4 mr-2"}),"Подписка и оплата"]}),w.jsxs(js,{children:[w.jsx($$,{className:"w-4 h-4 mr-2"}),"Настройки"]}),i&&w.jsxs(w.Fragment,{children:[w.jsx(Bh,{}),w.jsxs(js,{onClick:()=>c("/admin"),children:[w.jsx(Yee,{className:"w-4 h-4 mr-2"}),"Админ-панель"]})]}),w.jsx(Bh,{}),w.jsxs(js,{onClick:d,children:[w.jsx(U$,{className:"w-4 h-4 mr-2"}),"Выйти"]})]})]}):w.jsx(zt,{onClick:()=>c("/auth"),size:"sm",className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700",children:"Войти"}),w.jsx(zt,{variant:"ghost",size:"sm",className:"md:hidden w-9 h-9 p-0",onClick:()=>e(!n),children:n?w.jsx(j$,{className:"w-4 h-4"}):w.jsx(Bee,{className:"w-4 h-4"})})]})]}),n&&w.jsx("div",{className:"md:hidden py-4 border-t",children:w.jsxs("nav",{className:"flex flex-col space-y-1",children:[h.map(f=>{const p=l.pathname===f.href||f.href!=="/"&&l.pathname.startsWith(f.href);return w.jsxs(Xu,{to:f.href,onClick:()=>e(!1),className:`
                      flex items-center space-x-3 px-3 py-2 rounded-md text-sm font-medium transition-colors
                      ${p?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-accent"}
                    `,children:[w.jsx(f.icon,{className:"w-4 h-4"}),w.jsx("span",{children:f.name})]},f.name)}),!r&&w.jsx(zt,{onClick:()=>{c("/auth"),e(!1)},className:"mt-4 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700",children:"Войти в систему"})]})})]})})},Yd=({children:n,adminOnly:e=!1})=>{const{user:t,isAuthenticated:r,isAdmin:i,isLoading:s}=Zl();return s?w.jsx("div",{className:"min-h-screen flex items-center justify-center",children:w.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-600"})}):r?e&&!i?w.jsx(TM,{to:"/dashboard",replace:!0}):w.jsx(w.Fragment,{children:n}):w.jsx(TM,{to:"/auth",replace:!0})},Ise=()=>{const{user:n,isAdmin:e,logout:t}=Zl(),r=Yl();if(!n||!e)return w.jsx(TM,{to:"/auth",replace:!0});const i=[{name:"Дашборд",href:"/admin",icon:zee},{name:"Материалы",href:"/admin/materials",icon:F$},{name:"Мебель",href:"/admin/furniture",icon:tI},{name:"Пользователи",href:"/admin/users",icon:rI},{name:"Подписки",href:"/admin/subscriptions",icon:p_},{name:"Настройки",href:"/admin/settings",icon:$$}],s=o=>o==="/admin"?r.pathname==="/admin":r.pathname.startsWith(o);return w.jsxs("div",{className:"flex h-screen bg-gray-100",children:[w.jsxs("div",{className:"flex flex-col w-64 bg-white shadow-lg",children:[w.jsx("div",{className:"flex items-center justify-center h-16 bg-purple-600 text-white",children:w.jsx("h1",{className:"text-xl font-bold",children:"CraftRuv Admin"})}),w.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2",children:i.map(o=>{const a=o.icon;return w.jsxs(Xu,{to:o.href,className:wn("flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors",s(o.href)?"bg-purple-100 text-purple-700":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"),children:[w.jsx(a,{className:"mr-3 h-5 w-5"}),o.name]},o.name)})}),w.jsxs("div",{className:"p-4 border-t border-gray-200",children:[w.jsx(Xu,{to:"/",children:w.jsxs(zt,{variant:"outline",className:"w-full mb-2",size:"sm",children:[w.jsx(O$,{className:"mr-2 h-4 w-4"}),"Вернуться на сайт"]})}),w.jsxs(zt,{variant:"outline",className:"w-full",size:"sm",onClick:t,children:[w.jsx(U$,{className:"mr-2 h-4 w-4"}),"Выйти"]})]}),w.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:w.jsxs("div",{className:"flex items-center",children:[w.jsx("div",{className:"w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center text-white text-sm font-medium",children:n.name.charAt(0)}),w.jsxs("div",{className:"ml-3",children:[w.jsx("p",{className:"text-sm font-medium text-gray-900",children:n.name}),w.jsx("p",{className:"text-xs text-gray-500",children:"Администратор"})]})]})})]}),w.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[w.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:w.jsx("div",{className:"px-6 py-4",children:w.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Панель администратора"})})}),w.jsx("main",{className:"flex-1 overflow-y-auto",children:w.jsx(LJ,{})})]})]})},ti=N.forwardRef(({className:n,...e},t)=>w.jsx("div",{ref:t,className:wn("rounded-xl border border-zinc-200 bg-white text-zinc-950 shadow dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50",n),...e}));ti.displayName="Card";const ns=N.forwardRef(({className:n,...e},t)=>w.jsx("div",{ref:t,className:wn("flex flex-col space-y-1.5 p-6",n),...e}));ns.displayName="CardHeader";const rs=N.forwardRef(({className:n,...e},t)=>w.jsx("div",{ref:t,className:wn("font-semibold leading-none tracking-tight",n),...e}));rs.displayName="CardTitle";const So=N.forwardRef(({className:n,...e},t)=>w.jsx("div",{ref:t,className:wn("text-sm text-zinc-500 dark:text-zinc-400",n),...e}));So.displayName="CardDescription";const $r=N.forwardRef(({className:n,...e},t)=>w.jsx("div",{ref:t,className:wn("p-6 pt-0",n),...e}));$r.displayName="CardContent";const Rse=N.forwardRef(({className:n,...e},t)=>w.jsx("div",{ref:t,className:wn("flex items-center p-6 pt-0",n),...e}));Rse.displayName="CardFooter";const Pse=()=>{const{isAuthenticated:n}=Zl(),e=Zc(),t=[{icon:Fee,title:"3D Редактор",description:"Создавайте мебель в интерактивном 3D пространстве с профессиональными инструментами",gradient:"from-blue-500 to-cyan-500"},{icon:Qk,title:"AI Помощник РУВ",description:"Получайте умные рекомендации по дизайну и материалам от нашего ИИ-ассистента",gradient:"from-purple-500 to-pink-500"},{icon:B$,title:"Библиотека Материалов",description:"Обширная коллекция текстур, цветов и материалов для реалистичной визуализации",gradient:"from-green-500 to-emerald-500"},{icon:Fv,title:"AR Визуализация",description:"Просматривайте свои проекты в дополненной реальности прямо в вашем пространстве",gradient:"from-orange-500 to-red-500"}],r=["Интуитивно понятный интерфейс","Профессиональные инструменты","Облачное хранение проектов","Экспорт в различные форматы","Команная работа над проектами","Техническая поддержка 24/7"];return w.jsxs("div",{className:"min-h-screen",children:[w.jsxs("section",{className:"relative overflow-hidden bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-900 dark:via-blue-900/20 dark:to-purple-900/20",children:[w.jsx("div",{className:"absolute inset-0 bg-grid-slate-100 [mask-image:linear-gradient(0deg,white,rgba(255,255,255,0.6))] dark:bg-grid-slate-700/25 dark:[mask-image:linear-gradient(0deg,rgba(255,255,255,0.1),rgba(255,255,255,0.5))]"}),w.jsx("div",{className:"relative container mx-auto px-4 py-20 lg:py-32",children:w.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[w.jsx("div",{className:"flex justify-center mb-8",children:w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-2xl",children:w.jsx(Fv,{className:"w-10 h-10 text-white"})}),w.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-gradient-to-br from-orange-400 to-red-500 rounded-full"})]})}),w.jsxs("h1",{className:"text-4xl lg:text-6xl font-bold mb-6",children:[w.jsx("span",{className:"bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent",children:"CraftRuv"}),w.jsx("br",{}),w.jsx("span",{className:"text-gray-900 dark:text-white",children:"Проектирование мебели нового поколения"})]}),w.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300 mb-8 max-w-2xl mx-auto",children:"Создавайте, визуализируйте и воплощайте свои идеи в жизнь с помощью мощного 3D редактора и умного AI помощника РУВ"}),w.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[w.jsxs(zt,{size:"lg",className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white px-8 py-6 text-lg",onClick:()=>e(n?"/dashboard":"/auth"),children:[n?"Открыть проекты":"Начать создавать",w.jsx(Tee,{className:"ml-2 w-5 h-5"})]}),w.jsx(zt,{variant:"outline",size:"lg",className:"px-8 py-6 text-lg border-2",onClick:()=>e("/materials"),children:"Посмотреть материалы"})]})]})})]}),w.jsx("section",{className:"py-20 bg-white dark:bg-gray-900",children:w.jsxs("div",{className:"container mx-auto px-4",children:[w.jsxs("div",{className:"text-center mb-16",children:[w.jsx("h2",{className:"text-3xl lg:text-4xl font-bold mb-4",children:"Почему выбирают CraftRuv?"}),w.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto",children:"Мощные инструменты для профессиональных дизайнеров и любителей"})]}),w.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:t.map((i,s)=>w.jsxs(ti,{className:"relative overflow-hidden group hover:shadow-xl transition-all duration-300",children:[w.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${i.gradient} opacity-0 group-hover:opacity-5 transition-opacity`}),w.jsxs(ns,{children:[w.jsx("div",{className:`w-12 h-12 rounded-lg bg-gradient-to-br ${i.gradient} flex items-center justify-center mb-4`,children:w.jsx(i.icon,{className:"w-6 h-6 text-white"})}),w.jsx(rs,{className:"text-xl",children:i.title})]}),w.jsx($r,{children:w.jsx(So,{className:"text-gray-600 dark:text-gray-300",children:i.description})})]},s))})]})}),w.jsx("section",{className:"py-20 bg-gray-50 dark:bg-gray-800",children:w.jsx("div",{className:"container mx-auto px-4",children:w.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:[w.jsxs("div",{children:[w.jsx("h2",{className:"text-3xl lg:text-4xl font-bold mb-6",children:"Всё что нужно для создания идеальной мебели"}),w.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 mb-8",children:"CraftRuv объединяет передовые технологии 3D моделирования, искусственный интеллект и обширную библиотеку материалов в одной платформе."}),w.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:r.map((i,s)=>w.jsxs("div",{className:"flex items-center space-x-3",children:[w.jsx(Jk,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),w.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:i})]},s))})]}),w.jsx("div",{className:"relative",children:w.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl p-8 text-white",children:[w.jsxs("div",{className:"flex items-center mb-6",children:[w.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center mr-4",children:w.jsx(rI,{className:"w-6 h-6"})}),w.jsxs("div",{children:[w.jsx("h3",{className:"text-2xl font-bold",children:"10,000+"}),w.jsx("p",{className:"text-blue-100",children:"Довольных пользователей"})]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"text-3xl font-bold mb-2",children:"500+"}),w.jsx("div",{className:"text-blue-100",children:"Готовых шаблонов"})]}),w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"text-3xl font-bold mb-2",children:"1000+"}),w.jsx("div",{className:"text-blue-100",children:"Материалов"})]})]})]})})]})})}),w.jsx("section",{className:"py-20 bg-gradient-to-r from-blue-600 to-purple-600 text-white",children:w.jsxs("div",{className:"container mx-auto px-4 text-center",children:[w.jsx("h2",{className:"text-3xl lg:text-4xl font-bold mb-4",children:"Готовы начать создавать?"}),w.jsx("p",{className:"text-xl mb-8 opacity-90 max-w-2xl mx-auto",children:"Присоединяйтесь к тысячам дизайнеров, которые уже создают потрясающую мебель с CraftRuv"}),w.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[w.jsxs(zt,{size:"lg",variant:"secondary",className:"px-8 py-6 text-lg bg-white text-blue-600 hover:bg-gray-100",onClick:()=>e(n?"/dashboard":"/auth"),children:[w.jsx(V$,{className:"mr-2 w-5 h-5"}),n?"Начать проект":"Регистрация бесплатно"]}),w.jsx(zt,{variant:"outline",size:"lg",className:"px-8 py-6 text-lg border-white text-white hover:bg-white/10",onClick:()=>e("/materials"),children:"Попробовать демо"})]})]})})]})};var Q0=n=>n.type==="checkbox",Mh=n=>n instanceof Date,Vs=n=>n==null;const PV=n=>typeof n=="object";var xi=n=>!Vs(n)&&!Array.isArray(n)&&PV(n)&&!Mh(n),Dse=n=>xi(n)&&n.target?Q0(n.target)?n.target.checked:n.target.value:n,Lse=n=>n.substring(0,n.search(/\.\d+(\.|$)/))||n,Ose=(n,e)=>n.has(Lse(e)),Fse=n=>{const e=n.constructor&&n.constructor.prototype;return xi(e)&&e.hasOwnProperty("isPrototypeOf")},CI=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function bs(n){let e;const t=Array.isArray(n),r=typeof FileList<"u"?n instanceof FileList:!1;if(n instanceof Date)e=new Date(n);else if(n instanceof Set)e=new Set(n);else if(!(CI&&(n instanceof Blob||r))&&(t||xi(n)))if(e=t?[]:{},!t&&!Fse(n))e=n;else for(const i in n)n.hasOwnProperty(i)&&(e[i]=bs(n[i]));else return n;return e}var A_=n=>Array.isArray(n)?n.filter(Boolean):[],Mi=n=>n===void 0,qt=(n,e,t)=>{if(!e||!xi(n))return t;const r=A_(e.split(/[,[\].]+?/)).reduce((i,s)=>Vs(i)?i:i[s],n);return Mi(r)||r===n?Mi(n[e])?t:n[e]:r},El=n=>typeof n=="boolean",TI=n=>/^\w*$/.test(n),DV=n=>A_(n.replace(/["|']|\]/g,"").split(/\.|\[/)),br=(n,e,t)=>{let r=-1;const i=TI(e)?[e]:DV(e),s=i.length,o=s-1;for(;++r<s;){const a=i[r];let l=t;if(r!==o){const c=n[a];l=xi(c)||Array.isArray(c)?c:isNaN(+i[r+1])?{}:[]}if(a==="__proto__"||a==="constructor"||a==="prototype")return;n[a]=l,n=n[a]}};const UL={BLUR:"blur",FOCUS_OUT:"focusout"},qa={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},dc={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};Sr.createContext(null);var zse=(n,e,t,r=!0)=>{const i={defaultValues:e._defaultValues};for(const s in n)Object.defineProperty(i,s,{get:()=>{const o=s;return e._proxyFormState[o]!==qa.all&&(e._proxyFormState[o]=!r||qa.all),n[o]}});return i},Al=n=>typeof n=="string",Use=(n,e,t,r,i)=>Al(n)?(r&&e.watch.add(n),qt(t,n,i)):Array.isArray(n)?n.map(s=>(r&&e.watch.add(s),qt(t,s))):(r&&(e.watchAll=!0),t),LV=(n,e,t,r,i)=>e?{...t[n],types:{...t[n]&&t[n].types?t[n].types:{},[r]:i||!0}}:{},ov=n=>Array.isArray(n)?n:[n],BL=()=>{let n=[];return{get observers(){return n},next:i=>{for(const s of n)s.next&&s.next(i)},subscribe:i=>(n.push(i),{unsubscribe:()=>{n=n.filter(s=>s!==i)}}),unsubscribe:()=>{n=[]}}},$M=n=>Vs(n)||!PV(n);function Ru(n,e){if($M(n)||$M(e))return n===e;if(Mh(n)&&Mh(e))return n.getTime()===e.getTime();const t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(const i of t){const s=n[i];if(!r.includes(i))return!1;if(i!=="ref"){const o=e[i];if(Mh(s)&&Mh(o)||xi(s)&&xi(o)||Array.isArray(s)&&Array.isArray(o)?!Ru(s,o):s!==o)return!1}}return!0}var Bs=n=>xi(n)&&!Object.keys(n).length,MI=n=>n.type==="file",Xa=n=>typeof n=="function",aS=n=>{if(!CI)return!1;const e=n?n.ownerDocument:0;return n instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},OV=n=>n.type==="select-multiple",AI=n=>n.type==="radio",Bse=n=>AI(n)||Q0(n),lC=n=>aS(n)&&n.isConnected;function $se(n,e){const t=e.slice(0,-1).length;let r=0;for(;r<t;)n=Mi(n)?r++:n[e[r++]];return n}function jse(n){for(const e in n)if(n.hasOwnProperty(e)&&!Mi(n[e]))return!1;return!0}function Pi(n,e){const t=Array.isArray(e)?e:TI(e)?[e]:DV(e),r=t.length===1?n:$se(n,t),i=t.length-1,s=t[i];return r&&delete r[s],i!==0&&(xi(r)&&Bs(r)||Array.isArray(r)&&jse(r))&&Pi(n,t.slice(0,-1)),n}var FV=n=>{for(const e in n)if(Xa(n[e]))return!0;return!1};function lS(n,e={}){const t=Array.isArray(n);if(xi(n)||t)for(const r in n)Array.isArray(n[r])||xi(n[r])&&!FV(n[r])?(e[r]=Array.isArray(n[r])?[]:{},lS(n[r],e[r])):Vs(n[r])||(e[r]=!0);return e}function zV(n,e,t){const r=Array.isArray(n);if(xi(n)||r)for(const i in n)Array.isArray(n[i])||xi(n[i])&&!FV(n[i])?Mi(e)||$M(t[i])?t[i]=Array.isArray(n[i])?lS(n[i],[]):{...lS(n[i])}:zV(n[i],Vs(e)?{}:e[i],t[i]):t[i]=!Ru(n[i],e[i]);return t}var gy=(n,e)=>zV(n,e,lS(e));const $L={value:!1,isValid:!1},jL={value:!0,isValid:!0};var UV=n=>{if(Array.isArray(n)){if(n.length>1){const e=n.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return n[0].checked&&!n[0].disabled?n[0].attributes&&!Mi(n[0].attributes.value)?Mi(n[0].value)||n[0].value===""?jL:{value:n[0].value,isValid:!0}:jL:$L}return $L},BV=(n,{valueAsNumber:e,valueAsDate:t,setValueAs:r})=>Mi(n)?n:e?n===""?NaN:n&&+n:t&&Al(n)?new Date(n):r?r(n):n;const VL={isValid:!1,value:null};var $V=n=>Array.isArray(n)?n.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,VL):VL;function WL(n){const e=n.ref;return MI(e)?e.files:AI(e)?$V(n.refs).value:OV(e)?[...e.selectedOptions].map(({value:t})=>t):Q0(e)?UV(n.refs).value:BV(Mi(e.value)?n.ref.value:e.value,n)}var Vse=(n,e,t,r)=>{const i={};for(const s of n){const o=qt(e,s);o&&br(i,s,o._f)}return{criteriaMode:t,names:[...n],fields:i,shouldUseNativeValidation:r}},cS=n=>n instanceof RegExp,yy=n=>Mi(n)?n:cS(n)?n.source:xi(n)?cS(n.value)?n.value.source:n.value:n,HL=n=>({isOnSubmit:!n||n===qa.onSubmit,isOnBlur:n===qa.onBlur,isOnChange:n===qa.onChange,isOnAll:n===qa.all,isOnTouch:n===qa.onTouched});const GL="AsyncFunction";var Wse=n=>!!n&&!!n.validate&&!!(Xa(n.validate)&&n.validate.constructor.name===GL||xi(n.validate)&&Object.values(n.validate).find(e=>e.constructor.name===GL)),Hse=n=>n.mount&&(n.required||n.min||n.max||n.maxLength||n.minLength||n.pattern||n.validate),qL=(n,e,t)=>!t&&(e.watchAll||e.watch.has(n)||[...e.watch].some(r=>n.startsWith(r)&&/^\.\w+/.test(n.slice(r.length))));const av=(n,e,t,r)=>{for(const i of t||Object.keys(n)){const s=qt(n,i);if(s){const{_f:o,...a}=s;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],i)&&!r)return!0;if(o.ref&&e(o.ref,o.name)&&!r)return!0;if(av(a,e))break}else if(xi(a)&&av(a,e))break}}};function XL(n,e,t){const r=qt(n,t);if(r||TI(t))return{error:r,name:t};const i=t.split(".");for(;i.length;){const s=i.join("."),o=qt(e,s),a=qt(n,s);if(o&&!Array.isArray(o)&&t!==s)return{name:t};if(a&&a.type)return{name:s,error:a};i.pop()}return{name:t}}var Gse=(n,e,t,r)=>{t(n);const{name:i,...s}=n;return Bs(s)||Object.keys(s).length>=Object.keys(e).length||Object.keys(s).find(o=>e[o]===(!r||qa.all))},qse=(n,e,t)=>!n||!e||n===e||ov(n).some(r=>r&&(t?r===e:r.startsWith(e)||e.startsWith(r))),Xse=(n,e,t,r,i)=>i.isOnAll?!1:!t&&i.isOnTouch?!(e||n):(t?r.isOnBlur:i.isOnBlur)?!n:(t?r.isOnChange:i.isOnChange)?n:!0,Kse=(n,e)=>!A_(qt(n,e)).length&&Pi(n,e),Yse=(n,e,t)=>{const r=ov(qt(n,t));return br(r,"root",e[t]),br(n,t,r),n},ab=n=>Al(n);function KL(n,e,t="validate"){if(ab(n)||Array.isArray(n)&&n.every(ab)||El(n)&&!n)return{type:t,message:ab(n)?n:"",ref:e}}var cp=n=>xi(n)&&!cS(n)?n:{value:n,message:""},YL=async(n,e,t,r,i,s)=>{const{ref:o,refs:a,required:l,maxLength:c,minLength:u,min:d,max:h,pattern:f,validate:p,name:x,valueAsNumber:v,mount:y}=n._f,b=qt(t,x);if(!y||e.has(x))return{};const S=a?a[0]:o,_=W=>{i&&S.reportValidity&&(S.setCustomValidity(El(W)?"":W||""),S.reportValidity())},T={},M=AI(o),k=Q0(o),P=M||k,z=(v||MI(o))&&Mi(o.value)&&Mi(b)||aS(o)&&o.value===""||b===""||Array.isArray(b)&&!b.length,I=LV.bind(null,x,r,T),L=(W,q,$,ne=dc.maxLength,Y=dc.minLength)=>{const we=W?q:$;T[x]={type:W?ne:Y,message:we,ref:o,...I(W?ne:Y,we)}};if(s?!Array.isArray(b)||!b.length:l&&(!P&&(z||Vs(b))||El(b)&&!b||k&&!UV(a).isValid||M&&!$V(a).isValid)){const{value:W,message:q}=ab(l)?{value:!!l,message:l}:cp(l);if(W&&(T[x]={type:dc.required,message:q,ref:S,...I(dc.required,q)},!r))return _(q),T}if(!z&&(!Vs(d)||!Vs(h))){let W,q;const $=cp(h),ne=cp(d);if(!Vs(b)&&!isNaN(b)){const Y=o.valueAsNumber||b&&+b;Vs($.value)||(W=Y>$.value),Vs(ne.value)||(q=Y<ne.value)}else{const Y=o.valueAsDate||new Date(b),we=oe=>new Date(new Date().toDateString()+" "+oe),H=o.type=="time",X=o.type=="week";Al($.value)&&b&&(W=H?we(b)>we($.value):X?b>$.value:Y>new Date($.value)),Al(ne.value)&&b&&(q=H?we(b)<we(ne.value):X?b<ne.value:Y<new Date(ne.value))}if((W||q)&&(L(!!W,$.message,ne.message,dc.max,dc.min),!r))return _(T[x].message),T}if((c||u)&&!z&&(Al(b)||s&&Array.isArray(b))){const W=cp(c),q=cp(u),$=!Vs(W.value)&&b.length>+W.value,ne=!Vs(q.value)&&b.length<+q.value;if(($||ne)&&(L($,W.message,q.message),!r))return _(T[x].message),T}if(f&&!z&&Al(b)){const{value:W,message:q}=cp(f);if(cS(W)&&!b.match(W)&&(T[x]={type:dc.pattern,message:q,ref:o,...I(dc.pattern,q)},!r))return _(q),T}if(p){if(Xa(p)){const W=await p(b,t),q=KL(W,S);if(q&&(T[x]={...q,...I(dc.validate,q.message)},!r))return _(q.message),T}else if(xi(p)){let W={};for(const q in p){if(!Bs(W)&&!r)break;const $=KL(await p[q](b,t),S,q);$&&(W={...$,...I(q,$.message)},_($.message),r&&(T[x]=W))}if(!Bs(W)&&(T[x]={ref:S,...W},!r))return T}}return _(!0),T};const Zse={mode:qa.onSubmit,reValidateMode:qa.onChange,shouldFocusError:!0};function Qse(n={}){let e={...Zse,...n},t={submitCount:0,isDirty:!1,isLoading:Xa(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1};const r={};let i=xi(e.defaultValues)||xi(e.values)?bs(e.values||e.defaultValues)||{}:{},s=e.shouldUnregister?{}:bs(i),o={action:!1,mount:!1,watch:!1},a={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},l,c=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let d={...u};const h={array:BL(),state:BL()},f=HL(e.mode),p=HL(e.reValidateMode),x=e.criteriaMode===qa.all,v=J=>he=>{clearTimeout(c),c=setTimeout(J,he)},y=async J=>{if(!e.disabled&&(u.isValid||d.isValid||J)){const he=e.resolver?Bs((await z()).errors):await L(r,!0);he!==t.isValid&&h.state.next({isValid:he})}},b=(J,he)=>{!e.disabled&&(u.isValidating||u.validatingFields||d.isValidating||d.validatingFields)&&((J||Array.from(a.mount)).forEach(ee=>{ee&&(he?br(t.validatingFields,ee,he):Pi(t.validatingFields,ee))}),h.state.next({validatingFields:t.validatingFields,isValidating:!Bs(t.validatingFields)}))},S=(J,he=[],ee,Ee,Me=!0,Ae=!0)=>{if(Ee&&ee&&!e.disabled){if(o.action=!0,Ae&&Array.isArray(qt(r,J))){const Be=ee(qt(r,J),Ee.argA,Ee.argB);Me&&br(r,J,Be)}if(Ae&&Array.isArray(qt(t.errors,J))){const Be=ee(qt(t.errors,J),Ee.argA,Ee.argB);Me&&br(t.errors,J,Be),Kse(t.errors,J)}if((u.touchedFields||d.touchedFields)&&Ae&&Array.isArray(qt(t.touchedFields,J))){const Be=ee(qt(t.touchedFields,J),Ee.argA,Ee.argB);Me&&br(t.touchedFields,J,Be)}(u.dirtyFields||d.dirtyFields)&&(t.dirtyFields=gy(i,s)),h.state.next({name:J,isDirty:q(J,he),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else br(s,J,he)},_=(J,he)=>{br(t.errors,J,he),h.state.next({errors:t.errors})},T=J=>{t.errors=J,h.state.next({errors:t.errors,isValid:!1})},M=(J,he,ee,Ee)=>{const Me=qt(r,J);if(Me){const Ae=qt(s,J,Mi(ee)?qt(i,J):ee);Mi(Ae)||Ee&&Ee.defaultChecked||he?br(s,J,he?Ae:WL(Me._f)):Y(J,Ae),o.mount&&y()}},k=(J,he,ee,Ee,Me)=>{let Ae=!1,Be=!1;const dt={name:J};if(!e.disabled){if(!ee||Ee){(u.isDirty||d.isDirty)&&(Be=t.isDirty,t.isDirty=dt.isDirty=q(),Ae=Be!==dt.isDirty);const We=Ru(qt(i,J),he);Be=!!qt(t.dirtyFields,J),We?Pi(t.dirtyFields,J):br(t.dirtyFields,J,!0),dt.dirtyFields=t.dirtyFields,Ae=Ae||(u.dirtyFields||d.dirtyFields)&&Be!==!We}if(ee){const We=qt(t.touchedFields,J);We||(br(t.touchedFields,J,ee),dt.touchedFields=t.touchedFields,Ae=Ae||(u.touchedFields||d.touchedFields)&&We!==ee)}Ae&&Me&&h.state.next(dt)}return Ae?dt:{}},P=(J,he,ee,Ee)=>{const Me=qt(t.errors,J),Ae=(u.isValid||d.isValid)&&El(he)&&t.isValid!==he;if(e.delayError&&ee?(l=v(()=>_(J,ee)),l(e.delayError)):(clearTimeout(c),l=null,ee?br(t.errors,J,ee):Pi(t.errors,J)),(ee?!Ru(Me,ee):Me)||!Bs(Ee)||Ae){const Be={...Ee,...Ae&&El(he)?{isValid:he}:{},errors:t.errors,name:J};t={...t,...Be},h.state.next(Be)}},z=async J=>{b(J,!0);const he=await e.resolver(s,e.context,Vse(J||a.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return b(J),he},I=async J=>{const{errors:he}=await z(J);if(J)for(const ee of J){const Ee=qt(he,ee);Ee?br(t.errors,ee,Ee):Pi(t.errors,ee)}else t.errors=he;return he},L=async(J,he,ee={valid:!0})=>{for(const Ee in J){const Me=J[Ee];if(Me){const{_f:Ae,...Be}=Me;if(Ae){const dt=a.array.has(Ae.name),We=Me._f&&Wse(Me._f);We&&u.validatingFields&&b([Ee],!0);const Kt=await YL(Me,a.disabled,s,x,e.shouldUseNativeValidation&&!he,dt);if(We&&u.validatingFields&&b([Ee]),Kt[Ae.name]&&(ee.valid=!1,he))break;!he&&(qt(Kt,Ae.name)?dt?Yse(t.errors,Kt,Ae.name):br(t.errors,Ae.name,Kt[Ae.name]):Pi(t.errors,Ae.name))}!Bs(Be)&&await L(Be,he,ee)}}return ee.valid},W=()=>{for(const J of a.unMount){const he=qt(r,J);he&&(he._f.refs?he._f.refs.every(ee=>!lC(ee)):!lC(he._f.ref))&&rt(J)}a.unMount=new Set},q=(J,he)=>!e.disabled&&(J&&he&&br(s,J,he),!Ru(Te(),i)),$=(J,he,ee)=>Use(J,a,{...o.mount?s:Mi(he)?i:Al(J)?{[J]:he}:he},ee,he),ne=J=>A_(qt(o.mount?s:i,J,e.shouldUnregister?qt(i,J,[]):[])),Y=(J,he,ee={})=>{const Ee=qt(r,J);let Me=he;if(Ee){const Ae=Ee._f;Ae&&(!Ae.disabled&&br(s,J,BV(he,Ae)),Me=aS(Ae.ref)&&Vs(he)?"":he,OV(Ae.ref)?[...Ae.ref.options].forEach(Be=>Be.selected=Me.includes(Be.value)):Ae.refs?Q0(Ae.ref)?Ae.refs.length>1?Ae.refs.forEach(Be=>(!Be.defaultChecked||!Be.disabled)&&(Be.checked=Array.isArray(Me)?!!Me.find(dt=>dt===Be.value):Me===Be.value)):Ae.refs[0]&&(Ae.refs[0].checked=!!Me):Ae.refs.forEach(Be=>Be.checked=Be.value===Me):MI(Ae.ref)?Ae.ref.value="":(Ae.ref.value=Me,Ae.ref.type||h.state.next({name:J,values:bs(s)})))}(ee.shouldDirty||ee.shouldTouch)&&k(J,Me,ee.shouldTouch,ee.shouldDirty,!0),ee.shouldValidate&&ve(J)},we=(J,he,ee)=>{for(const Ee in he){const Me=he[Ee],Ae=`${J}.${Ee}`,Be=qt(r,Ae);(a.array.has(J)||xi(Me)||Be&&!Be._f)&&!Mh(Me)?we(Ae,Me,ee):Y(Ae,Me,ee)}},H=(J,he,ee={})=>{const Ee=qt(r,J),Me=a.array.has(J),Ae=bs(he);br(s,J,Ae),Me?(h.array.next({name:J,values:bs(s)}),(u.isDirty||u.dirtyFields||d.isDirty||d.dirtyFields)&&ee.shouldDirty&&h.state.next({name:J,dirtyFields:gy(i,s),isDirty:q(J,Ae)})):Ee&&!Ee._f&&!Vs(Ae)?we(J,Ae,ee):Y(J,Ae,ee),qL(J,a)&&h.state.next({...t}),h.state.next({name:o.mount?J:void 0,values:bs(s)})},X=async J=>{o.mount=!0;const he=J.target;let ee=he.name,Ee=!0;const Me=qt(r,ee),Ae=Be=>{Ee=Number.isNaN(Be)||Mh(Be)&&isNaN(Be.getTime())||Ru(Be,qt(s,ee,Be))};if(Me){let Be,dt;const We=he.type?WL(Me._f):Dse(J),Kt=J.type===UL.BLUR||J.type===UL.FOCUS_OUT,cn=!Hse(Me._f)&&!e.resolver&&!qt(t.errors,ee)&&!Me._f.deps||Xse(Kt,qt(t.touchedFields,ee),t.isSubmitted,p,f),jt=qL(ee,a,Kt);br(s,ee,We),Kt?(Me._f.onBlur&&Me._f.onBlur(J),l&&l(0)):Me._f.onChange&&Me._f.onChange(J);const wt=k(ee,We,Kt),Mt=!Bs(wt)||jt;if(!Kt&&h.state.next({name:ee,type:J.type,values:bs(s)}),cn)return(u.isValid||d.isValid)&&(e.mode==="onBlur"?Kt&&y():Kt||y()),Mt&&h.state.next({name:ee,...jt?{}:wt});if(!Kt&&jt&&h.state.next({...t}),e.resolver){const{errors:ye}=await z([ee]);if(Ae(We),Ee){const He=XL(t.errors,r,ee),st=XL(ye,r,He.name||ee);Be=st.error,ee=st.name,dt=Bs(ye)}}else b([ee],!0),Be=(await YL(Me,a.disabled,s,x,e.shouldUseNativeValidation))[ee],b([ee]),Ae(We),Ee&&(Be?dt=!1:(u.isValid||d.isValid)&&(dt=await L(r,!0)));Ee&&(Me._f.deps&&ve(Me._f.deps),P(ee,dt,Be,wt))}},oe=(J,he)=>{if(qt(t.errors,he)&&J.focus)return J.focus(),1},ve=async(J,he={})=>{let ee,Ee;const Me=ov(J);if(e.resolver){const Ae=await I(Mi(J)?J:Me);ee=Bs(Ae),Ee=J?!Me.some(Be=>qt(Ae,Be)):ee}else J?(Ee=(await Promise.all(Me.map(async Ae=>{const Be=qt(r,Ae);return await L(Be&&Be._f?{[Ae]:Be}:Be)}))).every(Boolean),!(!Ee&&!t.isValid)&&y()):Ee=ee=await L(r);return h.state.next({...!Al(J)||(u.isValid||d.isValid)&&ee!==t.isValid?{}:{name:J},...e.resolver||!J?{isValid:ee}:{},errors:t.errors}),he.shouldFocus&&!Ee&&av(r,oe,J?Me:a.mount),Ee},Te=J=>{const he={...o.mount?s:i};return Mi(J)?he:Al(J)?qt(he,J):J.map(ee=>qt(he,ee))},Xe=(J,he)=>({invalid:!!qt((he||t).errors,J),isDirty:!!qt((he||t).dirtyFields,J),error:qt((he||t).errors,J),isValidating:!!qt(t.validatingFields,J),isTouched:!!qt((he||t).touchedFields,J)}),_e=J=>{J&&ov(J).forEach(he=>Pi(t.errors,he)),h.state.next({errors:J?t.errors:{}})},Ue=(J,he,ee)=>{const Ee=(qt(r,J,{_f:{}})._f||{}).ref,Me=qt(t.errors,J)||{},{ref:Ae,message:Be,type:dt,...We}=Me;br(t.errors,J,{...We,...he,ref:Ee}),h.state.next({name:J,errors:t.errors,isValid:!1}),ee&&ee.shouldFocus&&Ee&&Ee.focus&&Ee.focus()},Fe=(J,he)=>Xa(J)?h.state.subscribe({next:ee=>J($(void 0,he),ee)}):$(J,he,!0),Oe=J=>h.state.subscribe({next:he=>{qse(J.name,he.name,J.exact)&&Gse(he,J.formState||u,Q,J.reRenderRoot)&&J.callback({values:{...s},...t,...he})}}).unsubscribe,nt=J=>(o.mount=!0,d={...d,...J.formState},Oe({...J,formState:d})),rt=(J,he={})=>{for(const ee of J?ov(J):a.mount)a.mount.delete(ee),a.array.delete(ee),he.keepValue||(Pi(r,ee),Pi(s,ee)),!he.keepError&&Pi(t.errors,ee),!he.keepDirty&&Pi(t.dirtyFields,ee),!he.keepTouched&&Pi(t.touchedFields,ee),!he.keepIsValidating&&Pi(t.validatingFields,ee),!e.shouldUnregister&&!he.keepDefaultValue&&Pi(i,ee);h.state.next({values:bs(s)}),h.state.next({...t,...he.keepDirty?{isDirty:q()}:{}}),!he.keepIsValid&&y()},ut=({disabled:J,name:he})=>{(El(J)&&o.mount||J||a.disabled.has(he))&&(J?a.disabled.add(he):a.disabled.delete(he))},Qe=(J,he={})=>{let ee=qt(r,J);const Ee=El(he.disabled)||El(e.disabled);return br(r,J,{...ee||{},_f:{...ee&&ee._f?ee._f:{ref:{name:J}},name:J,mount:!0,...he}}),a.mount.add(J),ee?ut({disabled:El(he.disabled)?he.disabled:e.disabled,name:J}):M(J,!0,he.value),{...Ee?{disabled:he.disabled||e.disabled}:{},...e.progressive?{required:!!he.required,min:yy(he.min),max:yy(he.max),minLength:yy(he.minLength),maxLength:yy(he.maxLength),pattern:yy(he.pattern)}:{},name:J,onChange:X,onBlur:X,ref:Me=>{if(Me){Qe(J,he),ee=qt(r,J);const Ae=Mi(Me.value)&&Me.querySelectorAll&&Me.querySelectorAll("input,select,textarea")[0]||Me,Be=Bse(Ae),dt=ee._f.refs||[];if(Be?dt.find(We=>We===Ae):Ae===ee._f.ref)return;br(r,J,{_f:{...ee._f,...Be?{refs:[...dt.filter(lC),Ae,...Array.isArray(qt(i,J))?[{}]:[]],ref:{type:Ae.type,name:J}}:{ref:Ae}}}),M(J,!1,void 0,Ae)}else ee=qt(r,J,{}),ee._f&&(ee._f.mount=!1),(e.shouldUnregister||he.shouldUnregister)&&!(Ose(a.array,J)&&o.action)&&a.unMount.add(J)}}},ae=()=>e.shouldFocusError&&av(r,oe,a.mount),ze=J=>{El(J)&&(h.state.next({disabled:J}),av(r,(he,ee)=>{const Ee=qt(r,ee);Ee&&(he.disabled=Ee._f.disabled||J,Array.isArray(Ee._f.refs)&&Ee._f.refs.forEach(Me=>{Me.disabled=Ee._f.disabled||J}))},0,!1))},Re=(J,he)=>async ee=>{let Ee;ee&&(ee.preventDefault&&ee.preventDefault(),ee.persist&&ee.persist());let Me=bs(s);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:Ae,values:Be}=await z();t.errors=Ae,Me=Be}else await L(r);if(a.disabled.size)for(const Ae of a.disabled)br(Me,Ae,void 0);if(Pi(t.errors,"root"),Bs(t.errors)){h.state.next({errors:{}});try{await J(Me,ee)}catch(Ae){Ee=Ae}}else he&&await he({...t.errors},ee),ae(),setTimeout(ae);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Bs(t.errors)&&!Ee,submitCount:t.submitCount+1,errors:t.errors}),Ee)throw Ee},Je=(J,he={})=>{qt(r,J)&&(Mi(he.defaultValue)?H(J,bs(qt(i,J))):(H(J,he.defaultValue),br(i,J,bs(he.defaultValue))),he.keepTouched||Pi(t.touchedFields,J),he.keepDirty||(Pi(t.dirtyFields,J),t.isDirty=he.defaultValue?q(J,bs(qt(i,J))):q()),he.keepError||(Pi(t.errors,J),u.isValid&&y()),h.state.next({...t}))},Ge=(J,he={})=>{const ee=J?bs(J):i,Ee=bs(ee),Me=Bs(J),Ae=Me?i:Ee;if(he.keepDefaultValues||(i=ee),!he.keepValues){if(he.keepDirtyValues){const Be=new Set([...a.mount,...Object.keys(gy(i,s))]);for(const dt of Array.from(Be))qt(t.dirtyFields,dt)?br(Ae,dt,qt(s,dt)):H(dt,qt(Ae,dt))}else{if(CI&&Mi(J))for(const Be of a.mount){const dt=qt(r,Be);if(dt&&dt._f){const We=Array.isArray(dt._f.refs)?dt._f.refs[0]:dt._f.ref;if(aS(We)){const Kt=We.closest("form");if(Kt){Kt.reset();break}}}}for(const Be of a.mount)H(Be,qt(Ae,Be))}s=bs(Ae),h.array.next({values:{...Ae}}),h.state.next({values:{...Ae}})}a={mount:he.keepDirtyValues?a.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!u.isValid||!!he.keepIsValid||!!he.keepDirtyValues,o.watch=!!e.shouldUnregister,h.state.next({submitCount:he.keepSubmitCount?t.submitCount:0,isDirty:Me?!1:he.keepDirty?t.isDirty:!!(he.keepDefaultValues&&!Ru(J,i)),isSubmitted:he.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:Me?{}:he.keepDirtyValues?he.keepDefaultValues&&s?gy(i,s):t.dirtyFields:he.keepDefaultValues&&J?gy(i,J):he.keepDirty?t.dirtyFields:{},touchedFields:he.keepTouched?t.touchedFields:{},errors:he.keepErrors?t.errors:{},isSubmitSuccessful:he.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1})},Et=(J,he)=>Ge(Xa(J)?J(s):J,he),pt=(J,he={})=>{const ee=qt(r,J),Ee=ee&&ee._f;if(Ee){const Me=Ee.refs?Ee.refs[0]:Ee.ref;Me.focus&&(Me.focus(),he.shouldSelect&&Xa(Me.select)&&Me.select())}},Q=J=>{t={...t,...J}},ke={control:{register:Qe,unregister:rt,getFieldState:Xe,handleSubmit:Re,setError:Ue,_subscribe:Oe,_runSchema:z,_getWatch:$,_getDirty:q,_setValid:y,_setFieldArray:S,_setDisabledField:ut,_setErrors:T,_getFieldArray:ne,_reset:Ge,_resetDefaultValues:()=>Xa(e.defaultValues)&&e.defaultValues().then(J=>{Et(J,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:W,_disableForm:ze,_subjects:h,_proxyFormState:u,get _fields(){return r},get _formValues(){return s},get _state(){return o},set _state(J){o=J},get _defaultValues(){return i},get _names(){return a},set _names(J){a=J},get _formState(){return t},get _options(){return e},set _options(J){e={...e,...J}}},subscribe:nt,trigger:ve,register:Qe,handleSubmit:Re,watch:Fe,setValue:H,getValues:Te,reset:Et,resetField:Je,clearErrors:_e,unregister:rt,setError:Ue,setFocus:pt,getFieldState:Xe};return{...ke,formControl:ke}}function ZL(n={}){const e=Sr.useRef(void 0),t=Sr.useRef(void 0),[r,i]=Sr.useState({isDirty:!1,isValidating:!1,isLoading:Xa(n.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1,defaultValues:Xa(n.defaultValues)?void 0:n.defaultValues});e.current||(e.current={...n.formControl?n.formControl:Qse(n),formState:r},n.formControl&&n.defaultValues&&!Xa(n.defaultValues)&&n.formControl.reset(n.defaultValues,n.resetOptions));const s=e.current.control;return s._options=n,Sr.useLayoutEffect(()=>s._subscribe({formState:s._proxyFormState,callback:()=>i({...s._formState}),reRenderRoot:!0}),[s]),Sr.useEffect(()=>s._disableForm(n.disabled),[s,n.disabled]),Sr.useEffect(()=>{if(s._proxyFormState.isDirty){const o=s._getDirty();o!==r.isDirty&&s._subjects.state.next({isDirty:o})}},[s,r.isDirty]),Sr.useEffect(()=>{n.values&&!Ru(n.values,t.current)?(s._reset(n.values,s._options.resetOptions),t.current=n.values,i(o=>({...o}))):s._resetDefaultValues()},[n.values,s]),Sr.useEffect(()=>{n.errors&&!Bs(n.errors)&&s._setErrors(n.errors)},[n.errors,s]),Sr.useEffect(()=>{s._state.mount||(s._setValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),Sr.useEffect(()=>{n.shouldUnregister&&s._subjects.state.next({values:s._getWatch()})},[n.shouldUnregister,s]),e.current.formState=zse(r,s),e.current}const QL=(n,e,t)=>{if(n&&"reportValidity"in n){const r=qt(t,e);n.setCustomValidity(r&&r.message||""),n.reportValidity()}},jV=(n,e)=>{for(const t in e.fields){const r=e.fields[t];r&&r.ref&&"reportValidity"in r.ref?QL(r.ref,t,n):r.refs&&r.refs.forEach(i=>QL(i,t,n))}},Jse=(n,e)=>{e.shouldUseNativeValidation&&jV(n,e);const t={};for(const r in n){const i=qt(e.fields,r),s=Object.assign(n[r]||{},{ref:i&&i.ref});if(eoe(e.names||Object.keys(n),r)){const o=Object.assign({},qt(t,r));br(o,"root",s),br(t,r,o)}else br(t,r,s)}return t},eoe=(n,e)=>n.some(t=>t.startsWith(e+"."));var toe=function(n,e){for(var t={};n.length;){var r=n[0],i=r.code,s=r.message,o=r.path.join(".");if(!t[o])if("unionErrors"in r){var a=r.unionErrors[0].errors[0];t[o]={message:a.message,type:a.code}}else t[o]={message:s,type:i};if("unionErrors"in r&&r.unionErrors.forEach(function(u){return u.errors.forEach(function(d){return n.push(d)})}),e){var l=t[o].types,c=l&&l[r.code];t[o]=LV(o,e,t,i,c?[].concat(c,r.message):r.message)}n.shift()}return t},JL=function(n,e,t){return t===void 0&&(t={}),function(r,i,s){try{return Promise.resolve(function(o,a){try{var l=Promise.resolve(n[t.mode==="sync"?"parse":"parseAsync"](r,e)).then(function(c){return s.shouldUseNativeValidation&&jV({},s),{errors:{},values:t.raw?r:c}})}catch(c){return a(c)}return l&&l.then?l.then(void 0,a):l}(0,function(o){if(function(a){return Array.isArray(a==null?void 0:a.errors)}(o))return{values:{},errors:Jse(toe(o.errors,!s.shouldUseNativeValidation&&s.criteriaMode==="all"),s)};throw o}))}catch(o){return Promise.reject(o)}}},nr;(function(n){n.assertEqual=i=>i;function e(i){}n.assertIs=e;function t(i){throw new Error}n.assertNever=t,n.arrayToEnum=i=>{const s={};for(const o of i)s[o]=o;return s},n.getValidEnumValues=i=>{const s=n.objectKeys(i).filter(a=>typeof i[i[a]]!="number"),o={};for(const a of s)o[a]=i[a];return n.objectValues(o)},n.objectValues=i=>n.objectKeys(i).map(function(s){return i[s]}),n.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&s.push(o);return s},n.find=(i,s)=>{for(const o of i)if(s(o))return o},n.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function r(i,s=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}n.joinValues=r,n.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(nr||(nr={}));var jM;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(jM||(jM={}));const $t=nr.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),bc=n=>{switch(typeof n){case"undefined":return $t.undefined;case"string":return $t.string;case"number":return isNaN(n)?$t.nan:$t.number;case"boolean":return $t.boolean;case"function":return $t.function;case"bigint":return $t.bigint;case"symbol":return $t.symbol;case"object":return Array.isArray(n)?$t.array:n===null?$t.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?$t.promise:typeof Map<"u"&&n instanceof Map?$t.map:typeof Set<"u"&&n instanceof Set?$t.set:typeof Date<"u"&&n instanceof Date?$t.date:$t.object;default:return $t.unknown}},at=nr.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),noe=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:");class Vo extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(s){return s.message},r={_errors:[]},i=s=>{for(const o of s.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)r._errors.push(t(o));else{let a=r,l=0;for(;l<o.path.length;){const c=o.path[l];l===o.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(t(o))):a[c]=a[c]||{_errors:[]},a=a[c],l++}}};return i(this),r}static assert(e){if(!(e instanceof Vo))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,nr.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const i of this.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):r.push(e(i));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}Vo.create=n=>new Vo(n);const Um=(n,e)=>{let t;switch(n.code){case at.invalid_type:n.received===$t.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case at.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,nr.jsonStringifyReplacer)}`;break;case at.unrecognized_keys:t=`Unrecognized key(s) in object: ${nr.joinValues(n.keys,", ")}`;break;case at.invalid_union:t="Invalid input";break;case at.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${nr.joinValues(n.options)}`;break;case at.invalid_enum_value:t=`Invalid enum value. Expected ${nr.joinValues(n.options)}, received '${n.received}'`;break;case at.invalid_arguments:t="Invalid function arguments";break;case at.invalid_return_type:t="Invalid function return type";break;case at.invalid_date:t="Invalid date";break;case at.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:nr.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case at.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case at.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case at.custom:t="Invalid input";break;case at.invalid_intersection_types:t="Intersection results could not be merged";break;case at.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case at.not_finite:t="Number must be finite";break;default:t=e.defaultError,nr.assertNever(n)}return{message:t}};let VV=Um;function roe(n){VV=n}function uS(){return VV}const dS=n=>{const{data:e,path:t,errorMaps:r,issueData:i}=n,s=[...t,...i.path||[]],o={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let a="";const l=r.filter(c=>!!c).slice().reverse();for(const c of l)a=c(o,{data:e,defaultError:a}).message;return{...i,path:s,message:a}},ioe=[];function kt(n,e){const t=uS(),r=dS({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===Um?void 0:Um].filter(i=>!!i)});n.common.issues.push(r)}class Ns{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const i of t){if(i.status==="aborted")return gn;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const i of t){const s=await i.key,o=await i.value;r.push({key:s,value:o})}return Ns.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const i of t){const{key:s,value:o}=i;if(s.status==="aborted"||o.status==="aborted")return gn;s.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(r[s.value]=o.value)}return{status:e.value,value:r}}}const gn=Object.freeze({status:"aborted"}),rm=n=>({status:"dirty",value:n}),Ks=n=>({status:"valid",value:n}),VM=n=>n.status==="aborted",WM=n=>n.status==="dirty",sf=n=>n.status==="valid",Wv=n=>typeof Promise<"u"&&n instanceof Promise;function hS(n,e,t,r){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(n)}function WV(n,e,t,r,i){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,t),t}var Jt;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Jt||(Jt={}));var Vy,Wy;class Hl{constructor(e,t,r,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const eO=(n,e)=>{if(sf(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Vo(n.common.issues);return this._error=t,this._error}}};function An(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:i}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(o,a)=>{var l,c;const{message:u}=n;return o.code==="invalid_enum_value"?{message:u??a.defaultError}:typeof a.data>"u"?{message:(l=u??r)!==null&&l!==void 0?l:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(c=u??t)!==null&&c!==void 0?c:a.defaultError}},description:i}}class Fn{get description(){return this._def.description}_getType(e){return bc(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:bc(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ns,ctx:{common:e.parent.common,data:e.data,parsedType:bc(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Wv(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const i={common:{issues:[],async:(r=t==null?void 0:t.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:bc(e)},s=this._parseSync({data:e,path:i.path,parent:i});return eO(i,s)}"~validate"(e){var t,r;const i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:bc(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:i});return sf(s)?{value:s.value}:{issues:i.common.issues}}catch(s){!((r=(t=s==null?void 0:s.message)===null||t===void 0?void 0:t.toLowerCase())===null||r===void 0)&&r.includes("encountered")&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:i}).then(s=>sf(s)?{value:s.value}:{issues:i.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:bc(e)},i=this._parse({data:e,path:r.path,parent:r}),s=await(Wv(i)?i:Promise.resolve(i));return eO(r,s)}refine(e,t){const r=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,s)=>{const o=e(i),a=()=>s.addIssue({code:at.custom,...r(i)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof t=="function"?t(r,i):t),!1))}_refinement(e){return new sl({schema:this,typeName:mn.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Fl.create(this,this._def)}nullable(){return fd.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return el.create(this)}promise(){return $m.create(this,this._def)}or(e){return Xv.create([this,e],this._def)}and(e){return Kv.create(this,e,this._def)}transform(e){return new sl({...An(this._def),schema:this,typeName:mn.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new e0({...An(this._def),innerType:this,defaultValue:t,typeName:mn.ZodDefault})}brand(){return new NI({typeName:mn.ZodBranded,type:this,...An(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new t0({...An(this._def),innerType:this,catchValue:t,typeName:mn.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return J0.create(this,e)}readonly(){return n0.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const soe=/^c[^\s-]{8,}$/i,ooe=/^[0-9a-z]+$/,aoe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,loe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,coe=/^[a-z0-9_-]{21}$/i,uoe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,doe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,hoe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,foe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let cC;const poe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,moe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,goe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,yoe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,voe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,xoe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,HV="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",woe=new RegExp(`^${HV}$`);function GV(n){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`),e}function boe(n){return new RegExp(`^${GV(n)}$`)}function qV(n){let e=`${HV}T${GV(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Soe(n,e){return!!((e==="v4"||!e)&&poe.test(n)||(e==="v6"||!e)&&goe.test(n))}function _oe(n,e){if(!uoe.test(n))return!1;try{const[t]=n.split("."),r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||!i.typ||!i.alg||e&&i.alg!==e)}catch{return!1}}function Eoe(n,e){return!!((e==="v4"||!e)&&moe.test(n)||(e==="v6"||!e)&&yoe.test(n))}class Ya extends Fn{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==$t.string){const s=this._getOrReturnCtx(e);return kt(s,{code:at.invalid_type,expected:$t.string,received:s.parsedType}),gn}const r=new Ns;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),kt(i,{code:at.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),kt(i,{code:at.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){const o=e.data.length>s.value,a=e.data.length<s.value;(o||a)&&(i=this._getOrReturnCtx(e,i),o?kt(i,{code:at.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&kt(i,{code:at.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")hoe.test(e.data)||(i=this._getOrReturnCtx(e,i),kt(i,{validation:"email",code:at.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")cC||(cC=new RegExp(foe,"u")),cC.test(e.data)||(i=this._getOrReturnCtx(e,i),kt(i,{validation:"emoji",code:at.invalid_string,message:s.message}),r.dirty());else if(s.kind==="uuid")loe.test(e.data)||(i=this._getOrReturnCtx(e,i),kt(i,{validation:"uuid",code:at.invalid_string,message:s.message}),r.dirty());else if(s.kind==="nanoid")coe.test(e.data)||(i=this._getOrReturnCtx(e,i),kt(i,{validation:"nanoid",code:at.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")soe.test(e.data)||(i=this._getOrReturnCtx(e,i),kt(i,{validation:"cuid",code:at.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")ooe.test(e.data)||(i=this._getOrReturnCtx(e,i),kt(i,{validation:"cuid2",code:at.invalid_string,message:s.message}),r.dirty());else if(s.kind==="ulid")aoe.test(e.data)||(i=this._getOrReturnCtx(e,i),kt(i,{validation:"ulid",code:at.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),kt(i,{validation:"url",code:at.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),kt(i,{validation:"regex",code:at.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),kt(i,{code:at.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),kt(i,{code:at.invalid_string,validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),kt(i,{code:at.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?qV(s).test(e.data)||(i=this._getOrReturnCtx(e,i),kt(i,{code:at.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="date"?woe.test(e.data)||(i=this._getOrReturnCtx(e,i),kt(i,{code:at.invalid_string,validation:"date",message:s.message}),r.dirty()):s.kind==="time"?boe(s).test(e.data)||(i=this._getOrReturnCtx(e,i),kt(i,{code:at.invalid_string,validation:"time",message:s.message}),r.dirty()):s.kind==="duration"?doe.test(e.data)||(i=this._getOrReturnCtx(e,i),kt(i,{validation:"duration",code:at.invalid_string,message:s.message}),r.dirty()):s.kind==="ip"?Soe(e.data,s.version)||(i=this._getOrReturnCtx(e,i),kt(i,{validation:"ip",code:at.invalid_string,message:s.message}),r.dirty()):s.kind==="jwt"?_oe(e.data,s.alg)||(i=this._getOrReturnCtx(e,i),kt(i,{validation:"jwt",code:at.invalid_string,message:s.message}),r.dirty()):s.kind==="cidr"?Eoe(e.data,s.version)||(i=this._getOrReturnCtx(e,i),kt(i,{validation:"cidr",code:at.invalid_string,message:s.message}),r.dirty()):s.kind==="base64"?voe.test(e.data)||(i=this._getOrReturnCtx(e,i),kt(i,{validation:"base64",code:at.invalid_string,message:s.message}),r.dirty()):s.kind==="base64url"?xoe.test(e.data)||(i=this._getOrReturnCtx(e,i),kt(i,{validation:"base64url",code:at.invalid_string,message:s.message}),r.dirty()):nr.assertNever(s);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(i=>e.test(i),{validation:t,code:at.invalid_string,...Jt.errToObj(r)})}_addCheck(e){return new Ya({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Jt.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Jt.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Jt.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Jt.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Jt.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Jt.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Jt.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Jt.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Jt.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Jt.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Jt.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Jt.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Jt.errToObj(e)})}datetime(e){var t,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,local:(r=e==null?void 0:e.local)!==null&&r!==void 0?r:!1,...Jt.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Jt.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Jt.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Jt.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...Jt.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Jt.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Jt.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Jt.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Jt.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Jt.errToObj(t)})}nonempty(e){return this.min(1,Jt.errToObj(e))}trim(){return new Ya({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ya({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ya({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Ya.create=n=>{var e;return new Ya({checks:[],typeName:mn.ZodString,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...An(n)})};function Coe(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=t>r?t:r,s=parseInt(n.toFixed(i).replace(".","")),o=parseInt(e.toFixed(i).replace(".",""));return s%o/Math.pow(10,i)}class ud extends Fn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==$t.number){const s=this._getOrReturnCtx(e);return kt(s,{code:at.invalid_type,expected:$t.number,received:s.parsedType}),gn}let r;const i=new Ns;for(const s of this._def.checks)s.kind==="int"?nr.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),kt(r,{code:at.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),kt(r,{code:at.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),kt(r,{code:at.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?Coe(e.data,s.value)!==0&&(r=this._getOrReturnCtx(e,r),kt(r,{code:at.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),kt(r,{code:at.not_finite,message:s.message}),i.dirty()):nr.assertNever(s);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Jt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Jt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Jt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Jt.toString(t))}setLimit(e,t,r,i){return new ud({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Jt.toString(i)}]})}_addCheck(e){return new ud({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Jt.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Jt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Jt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Jt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Jt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Jt.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Jt.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Jt.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Jt.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&nr.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}ud.create=n=>new ud({checks:[],typeName:mn.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...An(n)});class dd extends Fn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==$t.bigint)return this._getInvalidInput(e);let r;const i=new Ns;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),kt(r,{code:at.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),kt(r,{code:at.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),kt(r,{code:at.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):nr.assertNever(s);return{status:i.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return kt(t,{code:at.invalid_type,expected:$t.bigint,received:t.parsedType}),gn}gte(e,t){return this.setLimit("min",e,!0,Jt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Jt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Jt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Jt.toString(t))}setLimit(e,t,r,i){return new dd({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Jt.toString(i)}]})}_addCheck(e){return new dd({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Jt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Jt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Jt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Jt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Jt.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}dd.create=n=>{var e;return new dd({checks:[],typeName:mn.ZodBigInt,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...An(n)})};class Hv extends Fn{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==$t.boolean){const r=this._getOrReturnCtx(e);return kt(r,{code:at.invalid_type,expected:$t.boolean,received:r.parsedType}),gn}return Ks(e.data)}}Hv.create=n=>new Hv({typeName:mn.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...An(n)});class of extends Fn{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==$t.date){const s=this._getOrReturnCtx(e);return kt(s,{code:at.invalid_type,expected:$t.date,received:s.parsedType}),gn}if(isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return kt(s,{code:at.invalid_date}),gn}const r=new Ns;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),kt(i,{code:at.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),kt(i,{code:at.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):nr.assertNever(s);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new of({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Jt.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Jt.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}of.create=n=>new of({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:mn.ZodDate,...An(n)});class fS extends Fn{_parse(e){if(this._getType(e)!==$t.symbol){const r=this._getOrReturnCtx(e);return kt(r,{code:at.invalid_type,expected:$t.symbol,received:r.parsedType}),gn}return Ks(e.data)}}fS.create=n=>new fS({typeName:mn.ZodSymbol,...An(n)});class Gv extends Fn{_parse(e){if(this._getType(e)!==$t.undefined){const r=this._getOrReturnCtx(e);return kt(r,{code:at.invalid_type,expected:$t.undefined,received:r.parsedType}),gn}return Ks(e.data)}}Gv.create=n=>new Gv({typeName:mn.ZodUndefined,...An(n)});class qv extends Fn{_parse(e){if(this._getType(e)!==$t.null){const r=this._getOrReturnCtx(e);return kt(r,{code:at.invalid_type,expected:$t.null,received:r.parsedType}),gn}return Ks(e.data)}}qv.create=n=>new qv({typeName:mn.ZodNull,...An(n)});class Bm extends Fn{constructor(){super(...arguments),this._any=!0}_parse(e){return Ks(e.data)}}Bm.create=n=>new Bm({typeName:mn.ZodAny,...An(n)});class $h extends Fn{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ks(e.data)}}$h.create=n=>new $h({typeName:mn.ZodUnknown,...An(n)});class Vc extends Fn{_parse(e){const t=this._getOrReturnCtx(e);return kt(t,{code:at.invalid_type,expected:$t.never,received:t.parsedType}),gn}}Vc.create=n=>new Vc({typeName:mn.ZodNever,...An(n)});class pS extends Fn{_parse(e){if(this._getType(e)!==$t.undefined){const r=this._getOrReturnCtx(e);return kt(r,{code:at.invalid_type,expected:$t.void,received:r.parsedType}),gn}return Ks(e.data)}}pS.create=n=>new pS({typeName:mn.ZodVoid,...An(n)});class el extends Fn{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),i=this._def;if(t.parsedType!==$t.array)return kt(t,{code:at.invalid_type,expected:$t.array,received:t.parsedType}),gn;if(i.exactLength!==null){const o=t.data.length>i.exactLength.value,a=t.data.length<i.exactLength.value;(o||a)&&(kt(t,{code:o?at.too_big:at.too_small,minimum:a?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&t.data.length<i.minLength.value&&(kt(t,{code:at.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&t.data.length>i.maxLength.value&&(kt(t,{code:at.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>i.type._parseAsync(new Hl(t,o,t.path,a)))).then(o=>Ns.mergeArray(r,o));const s=[...t.data].map((o,a)=>i.type._parseSync(new Hl(t,o,t.path,a)));return Ns.mergeArray(r,s)}get element(){return this._def.type}min(e,t){return new el({...this._def,minLength:{value:e,message:Jt.toString(t)}})}max(e,t){return new el({...this._def,maxLength:{value:e,message:Jt.toString(t)}})}length(e,t){return new el({...this._def,exactLength:{value:e,message:Jt.toString(t)}})}nonempty(e){return this.min(1,e)}}el.create=(n,e)=>new el({type:n,minLength:null,maxLength:null,exactLength:null,typeName:mn.ZodArray,...An(e)});function Fp(n){if(n instanceof Zr){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=Fl.create(Fp(r))}return new Zr({...n._def,shape:()=>e})}else return n instanceof el?new el({...n._def,type:Fp(n.element)}):n instanceof Fl?Fl.create(Fp(n.unwrap())):n instanceof fd?fd.create(Fp(n.unwrap())):n instanceof Gl?Gl.create(n.items.map(e=>Fp(e))):n}class Zr extends Fn{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=nr.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==$t.object){const c=this._getOrReturnCtx(e);return kt(c,{code:at.invalid_type,expected:$t.object,received:c.parsedType}),gn}const{status:r,ctx:i}=this._processInputParams(e),{shape:s,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Vc&&this._def.unknownKeys==="strip"))for(const c in i.data)o.includes(c)||a.push(c);const l=[];for(const c of o){const u=s[c],d=i.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Hl(i,d,i.path,c)),alwaysSet:c in i.data})}if(this._def.catchall instanceof Vc){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of a)l.push({key:{status:"valid",value:u},value:{status:"valid",value:i.data[u]}});else if(c==="strict")a.length>0&&(kt(i,{code:at.unrecognized_keys,keys:a}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of a){const d=i.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Hl(i,d,i.path,u)),alwaysSet:u in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>Ns.mergeObjectSync(r,c)):Ns.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return Jt.errToObj,new Zr({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{var i,s,o,a;const l=(o=(s=(i=this._def).errorMap)===null||s===void 0?void 0:s.call(i,t,r).message)!==null&&o!==void 0?o:r.defaultError;return t.code==="unrecognized_keys"?{message:(a=Jt.errToObj(e).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new Zr({...this._def,unknownKeys:"strip"})}passthrough(){return new Zr({...this._def,unknownKeys:"passthrough"})}extend(e){return new Zr({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Zr({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:mn.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Zr({...this._def,catchall:e})}pick(e){const t={};return nr.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new Zr({...this._def,shape:()=>t})}omit(e){const t={};return nr.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new Zr({...this._def,shape:()=>t})}deepPartial(){return Fp(this)}partial(e){const t={};return nr.objectKeys(this.shape).forEach(r=>{const i=this.shape[r];e&&!e[r]?t[r]=i:t[r]=i.optional()}),new Zr({...this._def,shape:()=>t})}required(e){const t={};return nr.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof Fl;)s=s._def.innerType;t[r]=s}}),new Zr({...this._def,shape:()=>t})}keyof(){return XV(nr.objectKeys(this.shape))}}Zr.create=(n,e)=>new Zr({shape:()=>n,unknownKeys:"strip",catchall:Vc.create(),typeName:mn.ZodObject,...An(e)});Zr.strictCreate=(n,e)=>new Zr({shape:()=>n,unknownKeys:"strict",catchall:Vc.create(),typeName:mn.ZodObject,...An(e)});Zr.lazycreate=(n,e)=>new Zr({shape:n,unknownKeys:"strip",catchall:Vc.create(),typeName:mn.ZodObject,...An(e)});class Xv extends Fn{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function i(s){for(const a of s)if(a.result.status==="valid")return a.result;for(const a of s)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;const o=s.map(a=>new Vo(a.ctx.common.issues));return kt(t,{code:at.invalid_union,unionErrors:o}),gn}if(t.common.async)return Promise.all(r.map(async s=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await s._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(i);{let s;const o=[];for(const l of r){const c={...t,common:{...t.common,issues:[]},parent:null},u=l._parseSync({data:t.data,path:t.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!s&&(s={result:u,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(s)return t.common.issues.push(...s.ctx.common.issues),s.result;const a=o.map(l=>new Vo(l));return kt(t,{code:at.invalid_union,unionErrors:a}),gn}}get options(){return this._def.options}}Xv.create=(n,e)=>new Xv({options:n,typeName:mn.ZodUnion,...An(e)});const vc=n=>n instanceof Zv?vc(n.schema):n instanceof sl?vc(n.innerType()):n instanceof Qv?[n.value]:n instanceof hd?n.options:n instanceof Jv?nr.objectValues(n.enum):n instanceof e0?vc(n._def.innerType):n instanceof Gv?[void 0]:n instanceof qv?[null]:n instanceof Fl?[void 0,...vc(n.unwrap())]:n instanceof fd?[null,...vc(n.unwrap())]:n instanceof NI||n instanceof n0?vc(n.unwrap()):n instanceof t0?vc(n._def.innerType):[];class N_ extends Fn{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==$t.object)return kt(t,{code:at.invalid_type,expected:$t.object,received:t.parsedType}),gn;const r=this.discriminator,i=t.data[r],s=this.optionsMap.get(i);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(kt(t,{code:at.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),gn)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const i=new Map;for(const s of t){const o=vc(s.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(i.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);i.set(a,s)}}return new N_({typeName:mn.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...An(r)})}}function HM(n,e){const t=bc(n),r=bc(e);if(n===e)return{valid:!0,data:n};if(t===$t.object&&r===$t.object){const i=nr.objectKeys(e),s=nr.objectKeys(n).filter(a=>i.indexOf(a)!==-1),o={...n,...e};for(const a of s){const l=HM(n[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(t===$t.array&&r===$t.array){if(n.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<n.length;s++){const o=n[s],a=e[s],l=HM(o,a);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return t===$t.date&&r===$t.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class Kv extends Fn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),i=(s,o)=>{if(VM(s)||VM(o))return gn;const a=HM(s.value,o.value);return a.valid?((WM(s)||WM(o))&&t.dirty(),{status:t.value,value:a.data}):(kt(r,{code:at.invalid_intersection_types}),gn)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,o])=>i(s,o)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Kv.create=(n,e,t)=>new Kv({left:n,right:e,typeName:mn.ZodIntersection,...An(t)});class Gl extends Fn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==$t.array)return kt(r,{code:at.invalid_type,expected:$t.array,received:r.parsedType}),gn;if(r.data.length<this._def.items.length)return kt(r,{code:at.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),gn;!this._def.rest&&r.data.length>this._def.items.length&&(kt(r,{code:at.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const s=[...r.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new Hl(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(s).then(o=>Ns.mergeArray(t,o)):Ns.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new Gl({...this._def,rest:e})}}Gl.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Gl({items:n,typeName:mn.ZodTuple,rest:null,...An(e)})};class Yv extends Fn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==$t.object)return kt(r,{code:at.invalid_type,expected:$t.object,received:r.parsedType}),gn;const i=[],s=this._def.keyType,o=this._def.valueType;for(const a in r.data)i.push({key:s._parse(new Hl(r,a,r.path,a)),value:o._parse(new Hl(r,r.data[a],r.path,a)),alwaysSet:a in r.data});return r.common.async?Ns.mergeObjectAsync(t,i):Ns.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof Fn?new Yv({keyType:e,valueType:t,typeName:mn.ZodRecord,...An(r)}):new Yv({keyType:Ya.create(),valueType:e,typeName:mn.ZodRecord,...An(t)})}}class mS extends Fn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==$t.map)return kt(r,{code:at.invalid_type,expected:$t.map,received:r.parsedType}),gn;const i=this._def.keyType,s=this._def.valueType,o=[...r.data.entries()].map(([a,l],c)=>({key:i._parse(new Hl(r,a,r.path,[c,"key"])),value:s._parse(new Hl(r,l,r.path,[c,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const l of o){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return gn;(c.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(c.value,u.value)}return{status:t.value,value:a}})}else{const a=new Map;for(const l of o){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return gn;(c.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(c.value,u.value)}return{status:t.value,value:a}}}}mS.create=(n,e,t)=>new mS({valueType:e,keyType:n,typeName:mn.ZodMap,...An(t)});class af extends Fn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==$t.set)return kt(r,{code:at.invalid_type,expected:$t.set,received:r.parsedType}),gn;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(kt(r,{code:at.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(kt(r,{code:at.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const s=this._def.valueType;function o(l){const c=new Set;for(const u of l){if(u.status==="aborted")return gn;u.status==="dirty"&&t.dirty(),c.add(u.value)}return{status:t.value,value:c}}const a=[...r.data.values()].map((l,c)=>s._parse(new Hl(r,l,r.path,c)));return r.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,t){return new af({...this._def,minSize:{value:e,message:Jt.toString(t)}})}max(e,t){return new af({...this._def,maxSize:{value:e,message:Jt.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}af.create=(n,e)=>new af({valueType:n,minSize:null,maxSize:null,typeName:mn.ZodSet,...An(e)});class bm extends Fn{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==$t.function)return kt(t,{code:at.invalid_type,expected:$t.function,received:t.parsedType}),gn;function r(a,l){return dS({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,uS(),Um].filter(c=>!!c),issueData:{code:at.invalid_arguments,argumentsError:l}})}function i(a,l){return dS({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,uS(),Um].filter(c=>!!c),issueData:{code:at.invalid_return_type,returnTypeError:l}})}const s={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof $m){const a=this;return Ks(async function(...l){const c=new Vo([]),u=await a._def.args.parseAsync(l,s).catch(f=>{throw c.addIssue(r(l,f)),c}),d=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(d,s).catch(f=>{throw c.addIssue(i(d,f)),c})})}else{const a=this;return Ks(function(...l){const c=a._def.args.safeParse(l,s);if(!c.success)throw new Vo([r(l,c.error)]);const u=Reflect.apply(o,this,c.data),d=a._def.returns.safeParse(u,s);if(!d.success)throw new Vo([i(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new bm({...this._def,args:Gl.create(e).rest($h.create())})}returns(e){return new bm({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new bm({args:e||Gl.create([]).rest($h.create()),returns:t||$h.create(),typeName:mn.ZodFunction,...An(r)})}}class Zv extends Fn{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Zv.create=(n,e)=>new Zv({getter:n,typeName:mn.ZodLazy,...An(e)});class Qv extends Fn{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return kt(t,{received:t.data,code:at.invalid_literal,expected:this._def.value}),gn}return{status:"valid",value:e.data}}get value(){return this._def.value}}Qv.create=(n,e)=>new Qv({value:n,typeName:mn.ZodLiteral,...An(e)});function XV(n,e){return new hd({values:n,typeName:mn.ZodEnum,...An(e)})}class hd extends Fn{constructor(){super(...arguments),Vy.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return kt(t,{expected:nr.joinValues(r),received:t.parsedType,code:at.invalid_type}),gn}if(hS(this,Vy)||WV(this,Vy,new Set(this._def.values)),!hS(this,Vy).has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return kt(t,{received:t.data,code:at.invalid_enum_value,options:r}),gn}return Ks(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return hd.create(e,{...this._def,...t})}exclude(e,t=this._def){return hd.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}Vy=new WeakMap;hd.create=XV;class Jv extends Fn{constructor(){super(...arguments),Wy.set(this,void 0)}_parse(e){const t=nr.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==$t.string&&r.parsedType!==$t.number){const i=nr.objectValues(t);return kt(r,{expected:nr.joinValues(i),received:r.parsedType,code:at.invalid_type}),gn}if(hS(this,Wy)||WV(this,Wy,new Set(nr.getValidEnumValues(this._def.values))),!hS(this,Wy).has(e.data)){const i=nr.objectValues(t);return kt(r,{received:r.data,code:at.invalid_enum_value,options:i}),gn}return Ks(e.data)}get enum(){return this._def.values}}Wy=new WeakMap;Jv.create=(n,e)=>new Jv({values:n,typeName:mn.ZodNativeEnum,...An(e)});class $m extends Fn{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==$t.promise&&t.common.async===!1)return kt(t,{code:at.invalid_type,expected:$t.promise,received:t.parsedType}),gn;const r=t.parsedType===$t.promise?t.data:Promise.resolve(t.data);return Ks(r.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}}$m.create=(n,e)=>new $m({type:n,typeName:mn.ZodPromise,...An(e)});class sl extends Fn{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===mn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:o=>{kt(r,o),o.fatal?t.abort():t.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const o=i.transform(r.data,s);if(r.common.async)return Promise.resolve(o).then(async a=>{if(t.value==="aborted")return gn;const l=await this._def.schema._parseAsync({data:a,path:r.path,parent:r});return l.status==="aborted"?gn:l.status==="dirty"||t.value==="dirty"?rm(l.value):l});{if(t.value==="aborted")return gn;const a=this._def.schema._parseSync({data:o,path:r.path,parent:r});return a.status==="aborted"?gn:a.status==="dirty"||t.value==="dirty"?rm(a.value):a}}if(i.type==="refinement"){const o=a=>{const l=i.refinement(a,s);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?gn:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?gn:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(i.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!sf(o))return o;const a=i.transform(o.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>sf(o)?Promise.resolve(i.transform(o.value,s)).then(a=>({status:t.value,value:a})):o);nr.assertNever(i)}}sl.create=(n,e,t)=>new sl({schema:n,typeName:mn.ZodEffects,effect:e,...An(t)});sl.createWithPreprocess=(n,e,t)=>new sl({schema:e,effect:{type:"preprocess",transform:n},typeName:mn.ZodEffects,...An(t)});class Fl extends Fn{_parse(e){return this._getType(e)===$t.undefined?Ks(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Fl.create=(n,e)=>new Fl({innerType:n,typeName:mn.ZodOptional,...An(e)});class fd extends Fn{_parse(e){return this._getType(e)===$t.null?Ks(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}fd.create=(n,e)=>new fd({innerType:n,typeName:mn.ZodNullable,...An(e)});class e0 extends Fn{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===$t.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}e0.create=(n,e)=>new e0({innerType:n,typeName:mn.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...An(e)});class t0 extends Fn{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Wv(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Vo(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Vo(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}t0.create=(n,e)=>new t0({innerType:n,typeName:mn.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...An(e)});class gS extends Fn{_parse(e){if(this._getType(e)!==$t.nan){const r=this._getOrReturnCtx(e);return kt(r,{code:at.invalid_type,expected:$t.nan,received:r.parsedType}),gn}return{status:"valid",value:e.data}}}gS.create=n=>new gS({typeName:mn.ZodNaN,...An(n)});const Toe=Symbol("zod_brand");class NI extends Fn{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class J0 extends Fn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?gn:s.status==="dirty"?(t.dirty(),rm(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?gn:i.status==="dirty"?(t.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,t){return new J0({in:e,out:t,typeName:mn.ZodPipeline})}}class n0 extends Fn{_parse(e){const t=this._def.innerType._parse(e),r=i=>(sf(i)&&(i.value=Object.freeze(i.value)),i);return Wv(t)?t.then(i=>r(i)):r(t)}unwrap(){return this._def.innerType}}n0.create=(n,e)=>new n0({innerType:n,typeName:mn.ZodReadonly,...An(e)});function tO(n,e){const t=typeof n=="function"?n(e):typeof n=="string"?{message:n}:n;return typeof t=="string"?{message:t}:t}function KV(n,e={},t){return n?Bm.create().superRefine((r,i)=>{var s,o;const a=n(r);if(a instanceof Promise)return a.then(l=>{var c,u;if(!l){const d=tO(e,r),h=(u=(c=d.fatal)!==null&&c!==void 0?c:t)!==null&&u!==void 0?u:!0;i.addIssue({code:"custom",...d,fatal:h})}});if(!a){const l=tO(e,r),c=(o=(s=l.fatal)!==null&&s!==void 0?s:t)!==null&&o!==void 0?o:!0;i.addIssue({code:"custom",...l,fatal:c})}}):Bm.create()}const Moe={object:Zr.lazycreate};var mn;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(mn||(mn={}));const Aoe=(n,e={message:`Input not instance of ${n.name}`})=>KV(t=>t instanceof n,e),YV=Ya.create,ZV=ud.create,Noe=gS.create,koe=dd.create,QV=Hv.create,Ioe=of.create,Roe=fS.create,Poe=Gv.create,Doe=qv.create,Loe=Bm.create,Ooe=$h.create,Foe=Vc.create,zoe=pS.create,Uoe=el.create,Boe=Zr.create,$oe=Zr.strictCreate,joe=Xv.create,Voe=N_.create,Woe=Kv.create,Hoe=Gl.create,Goe=Yv.create,qoe=mS.create,Xoe=af.create,Koe=bm.create,Yoe=Zv.create,Zoe=Qv.create,Qoe=hd.create,Joe=Jv.create,eae=$m.create,nO=sl.create,tae=Fl.create,nae=fd.create,rae=sl.createWithPreprocess,iae=J0.create,sae=()=>YV().optional(),oae=()=>ZV().optional(),aae=()=>QV().optional(),lae={string:n=>Ya.create({...n,coerce:!0}),number:n=>ud.create({...n,coerce:!0}),boolean:n=>Hv.create({...n,coerce:!0}),bigint:n=>dd.create({...n,coerce:!0}),date:n=>of.create({...n,coerce:!0})},cae=gn;var Pu=Object.freeze({__proto__:null,defaultErrorMap:Um,setErrorMap:roe,getErrorMap:uS,makeIssue:dS,EMPTY_PATH:ioe,addIssueToContext:kt,ParseStatus:Ns,INVALID:gn,DIRTY:rm,OK:Ks,isAborted:VM,isDirty:WM,isValid:sf,isAsync:Wv,get util(){return nr},get objectUtil(){return jM},ZodParsedType:$t,getParsedType:bc,ZodType:Fn,datetimeRegex:qV,ZodString:Ya,ZodNumber:ud,ZodBigInt:dd,ZodBoolean:Hv,ZodDate:of,ZodSymbol:fS,ZodUndefined:Gv,ZodNull:qv,ZodAny:Bm,ZodUnknown:$h,ZodNever:Vc,ZodVoid:pS,ZodArray:el,ZodObject:Zr,ZodUnion:Xv,ZodDiscriminatedUnion:N_,ZodIntersection:Kv,ZodTuple:Gl,ZodRecord:Yv,ZodMap:mS,ZodSet:af,ZodFunction:bm,ZodLazy:Zv,ZodLiteral:Qv,ZodEnum:hd,ZodNativeEnum:Jv,ZodPromise:$m,ZodEffects:sl,ZodTransformer:sl,ZodOptional:Fl,ZodNullable:fd,ZodDefault:e0,ZodCatch:t0,ZodNaN:gS,BRAND:Toe,ZodBranded:NI,ZodPipeline:J0,ZodReadonly:n0,custom:KV,Schema:Fn,ZodSchema:Fn,late:Moe,get ZodFirstPartyTypeKind(){return mn},coerce:lae,any:Loe,array:Uoe,bigint:koe,boolean:QV,date:Ioe,discriminatedUnion:Voe,effect:nO,enum:Qoe,function:Koe,instanceof:Aoe,intersection:Woe,lazy:Yoe,literal:Zoe,map:qoe,nan:Noe,nativeEnum:Joe,never:Foe,null:Doe,nullable:nae,number:ZV,object:Boe,oboolean:aae,onumber:oae,optional:tae,ostring:sae,pipeline:iae,preprocess:rae,promise:eae,record:Goe,set:Xoe,strictObject:$oe,string:YV,symbol:Roe,transformer:nO,tuple:Hoe,undefined:Poe,union:joe,unknown:Ooe,void:zoe,NEVER:cae,ZodIssueCode:at,quotelessJson:noe,ZodError:Vo});const Jr=N.forwardRef(({className:n,type:e,...t},r)=>w.jsx("input",{type:e,className:wn("flex h-9 w-full rounded-md border border-zinc-200 bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-zinc-950 placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-zinc-950 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm dark:border-zinc-800 dark:file:text-zinc-50 dark:placeholder:text-zinc-400 dark:focus-visible:ring-zinc-300",n),ref:r,...t}));Jr.displayName="Input";var uae="Label",JV=N.forwardRef((n,e)=>w.jsx(rr.label,{...n,ref:e,onMouseDown:t=>{var i;t.target.closest("button, input, select, textarea")||((i=n.onMouseDown)==null||i.call(n,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));JV.displayName=uae;var e5=JV;const dae=m_("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),tr=N.forwardRef(({className:n,...e},t)=>w.jsx(e5,{ref:t,className:wn(dae(),n),...e}));tr.displayName=e5.displayName;const hae=m_("relative w-full rounded-lg border border-zinc-200 px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-zinc-950 [&>svg~*]:pl-7 dark:border-zinc-800 dark:[&>svg]:text-zinc-50",{variants:{variant:{default:"bg-white text-zinc-950 dark:bg-zinc-950 dark:text-zinc-50",destructive:"border-red-500/50 text-red-500 dark:border-red-500 [&>svg]:text-red-500 dark:border-red-900/50 dark:text-red-900 dark:dark:border-red-900 dark:[&>svg]:text-red-900"}},defaultVariants:{variant:"default"}}),GM=N.forwardRef(({className:n,variant:e,...t},r)=>w.jsx("div",{ref:r,role:"alert",className:wn(hae({variant:e}),n),...t}));GM.displayName="Alert";const fae=N.forwardRef(({className:n,...e},t)=>w.jsx("h5",{ref:t,className:wn("mb-1 font-medium leading-none tracking-tight",n),...e}));fae.displayName="AlertTitle";const qM=N.forwardRef(({className:n,...e},t)=>w.jsx("div",{ref:t,className:wn("text-sm [&_p]:leading-relaxed",n),...e}));qM.displayName="AlertDescription";const pae=Pu.object({email:Pu.string().email("Введите корректный email"),password:Pu.string().min(6,"Пароль должен содержать минимум 6 символов")}),mae=Pu.object({name:Pu.string().min(2,"Имя должно содержать минимум 2 символа"),email:Pu.string().email("Введите корректный email"),password:Pu.string().min(6,"Пароль должен содержать минимум 6 символов"),confirmPassword:Pu.string()}).refine(n=>n.password===n.confirmPassword,{message:"Пароли не совпадают",path:["confirmPassword"]}),gae=()=>{const[n,e]=N.useState(!0),[t,r]=N.useState(!1),[i,s]=N.useState(!1),[o,a]=N.useState(""),{login:l,register:c,isAuthenticated:u}=Zl(),d=Zc();N.useEffect(()=>{u&&d("/dashboard")},[u,d]);const h=ZL({resolver:JL(pae),defaultValues:{email:"",password:""}}),f=ZL({resolver:JL(mae),defaultValues:{name:"",email:"",password:"",confirmPassword:""}}),p=async S=>{try{a(""),await l(S.email,S.password),d("/dashboard")}catch(_){a(_ instanceof Error?_.message:"Ошибка входа")}},x=async S=>{try{a(""),await c(S.email,S.password,S.name),d("/dashboard")}catch(_){a(_ instanceof Error?_.message:"Ошибка регистрации")}},v=()=>{e(!0),a(""),f.reset()},y=()=>{e(!1),a(""),h.reset()},b=h.formState.isSubmitting||f.formState.isSubmitting;return w.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-900 dark:via-blue-900/20 dark:to-purple-900/20 flex items-center justify-center p-4",children:w.jsxs("div",{className:"w-full max-w-md",children:[w.jsx("div",{className:"text-center mb-8",children:w.jsxs(Xu,{to:"/",className:"inline-flex items-center space-x-2",children:[w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center",children:w.jsx(Fv,{className:"w-6 h-6 text-white"})}),w.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-gradient-to-br from-orange-400 to-red-500 rounded-full"})]}),w.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"CraftRuv"})]})}),w.jsxs(ti,{className:"shadow-2xl border-0 bg-white/90 dark:bg-gray-900/90 backdrop-blur",children:[w.jsxs(ns,{className:"text-center",children:[w.jsx(rs,{className:"text-2xl font-bold",children:n?"Добро пожаловать!":"Создать аккаунт"}),w.jsx(So,{children:n?"Войдите в свой аккаунт для работы с проектами":"Зарегистрируйтесь для начала работы с CraftRuv"})]}),w.jsxs($r,{className:"space-y-6",children:[o&&w.jsx(GM,{variant:"destructive",children:w.jsx(qM,{children:o})}),n&&w.jsx(GM,{children:w.jsxs(qM,{children:[w.jsx("strong",{children:"Демо аккаунт:"})," demo@craftruv.ru / demo123"]})}),n?w.jsxs("form",{onSubmit:h.handleSubmit(p),className:"space-y-4",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx(tr,{htmlFor:"email",children:"Email"}),w.jsxs("div",{className:"relative",children:[w.jsx(NM,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),w.jsx(Jr,{id:"email",type:"email",placeholder:"your@email.com",className:"pl-10",...h.register("email")})]}),h.formState.errors.email&&w.jsx("p",{className:"text-sm text-red-500",children:h.formState.errors.email.message})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(tr,{htmlFor:"password",children:"Пароль"}),w.jsxs("div",{className:"relative",children:[w.jsx(YE,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),w.jsx(Jr,{id:"password",type:t?"text":"password",placeholder:"••••••••",className:"pl-10 pr-10",...h.register("password")}),w.jsx("button",{type:"button",onClick:()=>r(!t),className:"absolute right-3 top-3 h-4 w-4 text-muted-foreground hover:text-foreground",children:t?w.jsx(KE,{className:"h-4 w-4"}):w.jsx(ym,{className:"h-4 w-4"})})]}),h.formState.errors.password&&w.jsx("p",{className:"text-sm text-red-500",children:h.formState.errors.password.message})]}),w.jsxs(zt,{type:"submit",className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700",disabled:b,children:[b&&w.jsx(uL,{className:"mr-2 h-4 w-4 animate-spin"}),"Войти"]})]}):w.jsxs("form",{onSubmit:f.handleSubmit(x),className:"space-y-4",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx(tr,{htmlFor:"name",children:"Имя"}),w.jsxs("div",{className:"relative",children:[w.jsx(nI,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),w.jsx(Jr,{id:"name",type:"text",placeholder:"Ваше имя",className:"pl-10",...f.register("name")})]}),f.formState.errors.name&&w.jsx("p",{className:"text-sm text-red-500",children:f.formState.errors.name.message})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(tr,{htmlFor:"email",children:"Email"}),w.jsxs("div",{className:"relative",children:[w.jsx(NM,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),w.jsx(Jr,{id:"email",type:"email",placeholder:"your@email.com",className:"pl-10",...f.register("email")})]}),f.formState.errors.email&&w.jsx("p",{className:"text-sm text-red-500",children:f.formState.errors.email.message})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(tr,{htmlFor:"password",children:"Пароль"}),w.jsxs("div",{className:"relative",children:[w.jsx(YE,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),w.jsx(Jr,{id:"password",type:t?"text":"password",placeholder:"••••••••",className:"pl-10 pr-10",...f.register("password")}),w.jsx("button",{type:"button",onClick:()=>r(!t),className:"absolute right-3 top-3 h-4 w-4 text-muted-foreground hover:text-foreground",children:t?w.jsx(KE,{className:"h-4 w-4"}):w.jsx(ym,{className:"h-4 w-4"})})]}),f.formState.errors.password&&w.jsx("p",{className:"text-sm text-red-500",children:f.formState.errors.password.message})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(tr,{htmlFor:"confirmPassword",children:"Подтвердите пароль"}),w.jsxs("div",{className:"relative",children:[w.jsx(YE,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),w.jsx(Jr,{id:"confirmPassword",type:i?"text":"password",placeholder:"••••••••",className:"pl-10 pr-10",...f.register("confirmPassword")}),w.jsx("button",{type:"button",onClick:()=>s(!i),className:"absolute right-3 top-3 h-4 w-4 text-muted-foreground hover:text-foreground",children:i?w.jsx(KE,{className:"h-4 w-4"}):w.jsx(ym,{className:"h-4 w-4"})})]}),f.formState.errors.confirmPassword&&w.jsx("p",{className:"text-sm text-red-500",children:f.formState.errors.confirmPassword.message})]}),w.jsxs(zt,{type:"submit",className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700",disabled:b,children:[b&&w.jsx(uL,{className:"mr-2 h-4 w-4 animate-spin"}),"Зарегистрироваться"]})]}),w.jsx("div",{className:"text-center",children:w.jsxs("p",{className:"text-muted-foreground",children:[n?"Нет аккаунта?":"Уже есть аккаунт?"," ",w.jsx("button",{type:"button",onClick:n?y:v,className:"text-blue-600 hover:text-blue-500 font-medium",children:n?"Зарегистрироваться":"Войти"})]})})]})]})]})})},yae=m_("inline-flex items-center rounded-md border border-zinc-200 px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-zinc-950 focus:ring-offset-2 dark:border-zinc-800 dark:focus:ring-zinc-300",{variants:{variant:{default:"border-transparent bg-zinc-900 text-zinc-50 shadow hover:bg-zinc-900/80 dark:bg-zinc-50 dark:text-zinc-900 dark:hover:bg-zinc-50/80",secondary:"border-transparent bg-zinc-100 text-zinc-900 hover:bg-zinc-100/80 dark:bg-zinc-800 dark:text-zinc-50 dark:hover:bg-zinc-800/80",destructive:"border-transparent bg-red-500 text-zinc-50 shadow hover:bg-red-500/80 dark:bg-red-900 dark:text-zinc-50 dark:hover:bg-red-900/80",outline:"text-zinc-950 dark:text-zinc-50"}},defaultVariants:{variant:"default"}});function yo({className:n,variant:e,...t}){return w.jsx("div",{className:wn(yae({variant:e}),n),...t})}const vae=()=>{const{user:n,updateSubscription:e}=Zl(),t=Zc(),[r,i]=N.useState(null),s=[{id:"free",name:"Free",price:0,period:"7 дней пробный",description:"Идеально для знакомства с платформой",icon:w.jsx(Zee,{className:"h-6 w-6"}),features:["До 3 проектов","Базовая библиотека материалов","Основные инструменты дизайна","1 ГБ облачного хранилища","Экспорт в стандартном качестве"],limitations:["Нет AI помощника","Ограниченная библиотека мебели","Базовая поддержка"]},{id:"basic",name:"Basic",price:9.99,period:"в месяц",description:"Для индивидуальных дизайнеров",icon:w.jsx(V$,{className:"h-6 w-6"}),features:["До 10 проектов","Полная библиотека материалов","Расширенные инструменты дизайна","10 ГБ облачного хранилища","Экспорт в высоком качестве","Приоритетная поддержка"],limitations:["Нет AI помощника","Ограниченное количество проектов"]},{id:"pro",name:"Pro",price:19.99,period:"в месяц",description:"Для профессиональных дизайнеров",icon:w.jsx(Dee,{className:"h-6 w-6"}),features:["Неограниченное количество проектов","Полная библиотека материалов и мебели","AI помощник для дизайна","Продвинутые инструменты освещения","100 ГБ облачного хранилища","1000 AI запросов в месяц","Экспорт в профессиональном качестве","Приоритетная поддержка","Совместная работа (до 3 человек)"],limitations:[],popular:!0,recommended:!0},{id:"enterprise",name:"Enterprise",price:49.99,period:"в месяц",description:"Для команд и студий",icon:w.jsx(Nee,{className:"h-6 w-6"}),features:["Все функции Pro","Неограниченное облачное хранилище","Неограниченные AI запросы","Командная работа (неограниченно)","Кастомная библиотека материалов","API доступ","Персональный менеджер","SLA 99.9%","Кастомные интеграции","Обучение команды"],limitations:[]}],o=async l=>{if(!n){t("/auth");return}i(l);try{if(await new Promise(u=>setTimeout(u,2e3)),s.find(u=>u.id===l)){const u=new Date,d=new Date(u.getTime()+30*24*60*60*1e3);e({plan:l,status:"active",startDate:u.toISOString(),endDate:d.toISOString()}),t("/dashboard")}}catch(c){console.error("Ошибка при обновлении подписки:",c)}finally{i(null)}},a=l=>(n==null?void 0:n.subscription.plan)===l;return w.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-white to-blue-50",children:w.jsxs("div",{className:"container mx-auto px-4 py-16",children:[w.jsxs("div",{className:"text-center mb-16",children:[w.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-4",children:"Выберите подходящий план"}),w.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Создавайте потрясающие интерьеры с помощью нашей платформы. Начните с бесплатного пробного периода и выберите план, который подходит именно вам."})]}),w.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8 max-w-7xl mx-auto",children:s.map(l=>w.jsxs(ti,{className:`relative overflow-hidden transition-all duration-300 hover:shadow-xl ${l.popular?"ring-2 ring-purple-500 shadow-lg scale-105":"hover:scale-105"}`,children:[l.popular&&w.jsx("div",{className:"absolute top-0 left-0 right-0 bg-gradient-to-r from-purple-500 to-blue-500 text-white text-center py-2 text-sm font-semibold",children:"Самый популярный"}),w.jsxs(ns,{className:`text-center ${l.popular?"pt-12":"pt-6"}`,children:[w.jsx("div",{className:"flex justify-center mb-4",children:w.jsx("div",{className:`p-3 rounded-full ${l.id==="free"?"bg-gray-100 text-gray-600":l.id==="basic"?"bg-blue-100 text-blue-600":l.id==="pro"?"bg-purple-100 text-purple-600":"bg-yellow-100 text-yellow-600"}`,children:l.icon})}),w.jsx(rs,{className:"text-2xl font-bold",children:l.name}),w.jsx(So,{className:"text-sm text-gray-600 mt-2",children:l.description}),w.jsxs("div",{className:"mt-4",children:[w.jsxs("span",{className:"text-4xl font-bold text-gray-900",children:["$",l.price]}),w.jsxs("span",{className:"text-gray-600 ml-1",children:["/",l.period]})]}),l.recommended&&w.jsx(yo,{className:"mt-2 bg-green-100 text-green-800 hover:bg-green-100",children:"Рекомендуется"})]}),w.jsxs($r,{className:"p-6",children:[w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("h4",{className:"font-semibold text-green-700 mb-2",children:"Включено:"}),w.jsx("ul",{className:"space-y-2",children:l.features.map((c,u)=>w.jsxs("li",{className:"flex items-start",children:[w.jsx(eI,{className:"h-4 w-4 text-green-500 mr-2 mt-0.5 flex-shrink-0"}),w.jsx("span",{className:"text-sm text-gray-700",children:c})]},u))})]}),l.limitations.length>0&&w.jsxs("div",{children:[w.jsx("h4",{className:"font-semibold text-gray-500 mb-2",children:"Ограничения:"}),w.jsx("ul",{className:"space-y-1",children:l.limitations.map((c,u)=>w.jsxs("li",{className:"text-sm text-gray-500",children:["• ",c]},u))})]})]}),w.jsx(zt,{className:`w-full mt-6 ${l.popular?"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white":l.id==="enterprise"?"bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white":""}`,variant:a(l.id)?"outline":"default",disabled:a(l.id)||r===l.id,onClick:()=>o(l.id),children:r===l.id?"Обработка...":a(l.id)?"Текущий план":l.id==="free"?"Начать пробный период":`Выбрать ${l.name}`})]})]},l.id))}),w.jsxs("div",{className:"mt-16 text-center",children:[w.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Часто задаваемые вопросы"}),w.jsxs("div",{className:"max-w-4xl mx-auto grid md:grid-cols-2 gap-8",children:[w.jsxs("div",{className:"text-left",children:[w.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Можно ли изменить план в любое время?"}),w.jsx("p",{className:"text-gray-600",children:"Да, вы можете повысить или понизить свой план в любое время. Изменения вступают в силу немедленно."})]}),w.jsxs("div",{className:"text-left",children:[w.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Что происходит после окончания пробного периода?"}),w.jsx("p",{className:"text-gray-600",children:"После 7-дневного пробного периода вам нужно будет выбрать платный план или ваш аккаунт перейдет в режим только для просмотра."})]}),w.jsxs("div",{className:"text-left",children:[w.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Есть ли возврат средств?"}),w.jsx("p",{className:"text-gray-600",children:"Мы предлагаем 30-дневную гарантию возврата средств для всех планов. Никаких вопросов не задаем."})]}),w.jsxs("div",{className:"text-left",children:[w.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Нужна помощь в выборе плана?"}),w.jsx("p",{className:"text-gray-600",children:"Свяжитесь с нашей командой поддержки, и мы поможем вам выбрать идеальный план для ваших потребностей."})]})]})]})]})})};var kI="Dialog",[t5,SBe]=Qo(kI),[xae,al]=t5(kI),n5=n=>{const{__scopeDialog:e,children:t,open:r,defaultOpen:i,onOpenChange:s,modal:o=!0}=n,a=N.useRef(null),l=N.useRef(null),[c=!1,u]=Uv({prop:r,defaultProp:i,onChange:s});return w.jsx(xae,{scope:e,triggerRef:a,contentRef:l,contentId:Ja(),titleId:Ja(),descriptionId:Ja(),open:c,onOpenChange:u,onOpenToggle:N.useCallback(()=>u(d=>!d),[u]),modal:o,children:t})};n5.displayName=kI;var r5="DialogTrigger",i5=N.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=al(r5,t),s=Gn(e,i.triggerRef);return w.jsx(rr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":PI(i.open),...r,ref:s,onClick:Ft(n.onClick,i.onOpenToggle)})});i5.displayName=r5;var II="DialogPortal",[wae,s5]=t5(II,{forceMount:void 0}),o5=n=>{const{__scopeDialog:e,forceMount:t,children:r,container:i}=n,s=al(II,e);return w.jsx(wae,{scope:e,forceMount:t,children:N.Children.map(r,o=>w.jsx(Td,{present:t||s.open,children:w.jsx(S_,{asChild:!0,container:i,children:o})}))})};o5.displayName=II;var yS="DialogOverlay",a5=N.forwardRef((n,e)=>{const t=s5(yS,n.__scopeDialog),{forceMount:r=t.forceMount,...i}=n,s=al(yS,n.__scopeDialog);return s.modal?w.jsx(Td,{present:r||s.open,children:w.jsx(Sae,{...i,ref:e})}):null});a5.displayName=yS;var bae=nf("DialogOverlay.RemoveScroll"),Sae=N.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=al(yS,t);return w.jsx(C_,{as:bae,allowPinchZoom:!0,shards:[i.contentRef],children:w.jsx(rr.div,{"data-state":PI(i.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),lf="DialogContent",l5=N.forwardRef((n,e)=>{const t=s5(lf,n.__scopeDialog),{forceMount:r=t.forceMount,...i}=n,s=al(lf,n.__scopeDialog);return w.jsx(Td,{present:r||s.open,children:s.modal?w.jsx(_ae,{...i,ref:e}):w.jsx(Eae,{...i,ref:e})})});l5.displayName=lf;var _ae=N.forwardRef((n,e)=>{const t=al(lf,n.__scopeDialog),r=N.useRef(null),i=Gn(e,t.contentRef,r);return N.useEffect(()=>{const s=r.current;if(s)return gI(s)},[]),w.jsx(c5,{...n,ref:i,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ft(n.onCloseAutoFocus,s=>{var o;s.preventDefault(),(o=t.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Ft(n.onPointerDownOutside,s=>{const o=s.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&s.preventDefault()}),onFocusOutside:Ft(n.onFocusOutside,s=>s.preventDefault())})}),Eae=N.forwardRef((n,e)=>{const t=al(lf,n.__scopeDialog),r=N.useRef(!1),i=N.useRef(!1);return w.jsx(c5,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o,a;(o=n.onCloseAutoFocus)==null||o.call(n,s),s.defaultPrevented||(r.current||(a=t.triggerRef.current)==null||a.focus(),s.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:s=>{var l,c;(l=n.onInteractOutside)==null||l.call(n,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const o=s.target;((c=t.triggerRef.current)==null?void 0:c.contains(o))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&i.current&&s.preventDefault()}})}),c5=N.forwardRef((n,e)=>{const{__scopeDialog:t,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:s,...o}=n,a=al(lf,t),l=N.useRef(null),c=Gn(e,l);return oI(),w.jsxs(w.Fragment,{children:[w.jsx(y_,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:s,children:w.jsx(g_,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":PI(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),w.jsxs(w.Fragment,{children:[w.jsx(Cae,{titleId:a.titleId}),w.jsx(Mae,{contentRef:l,descriptionId:a.descriptionId})]})]})}),RI="DialogTitle",u5=N.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=al(RI,t);return w.jsx(rr.h2,{id:i.titleId,...r,ref:e})});u5.displayName=RI;var d5="DialogDescription",h5=N.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=al(d5,t);return w.jsx(rr.p,{id:i.descriptionId,...r,ref:e})});h5.displayName=d5;var f5="DialogClose",p5=N.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=al(f5,t);return w.jsx(rr.button,{type:"button",...r,ref:e,onClick:Ft(n.onClick,()=>i.onOpenChange(!1))})});p5.displayName=f5;function PI(n){return n?"open":"closed"}var m5="DialogTitleWarning",[_Be,g5]=Vte(m5,{contentName:lf,titleName:RI,docsSlug:"dialog"}),Cae=({titleId:n})=>{const e=g5(m5),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return N.useEffect(()=>{n&&(document.getElementById(n)||console.error(t))},[t,n]),null},Tae="DialogDescriptionWarning",Mae=({contentRef:n,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${g5(Tae).contentName}}.`;return N.useEffect(()=>{var s;const i=(s=n.current)==null?void 0:s.getAttribute("aria-describedby");e&&i&&(document.getElementById(e)||console.warn(r))},[r,n,e]),null},Aae=n5,Nae=i5,kae=o5,y5=a5,v5=l5,x5=u5,w5=h5,Iae=p5;const ex=Aae,tx=Nae,Rae=kae,b5=N.forwardRef(({className:n,...e},t)=>w.jsx(y5,{ref:t,className:wn("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...e}));b5.displayName=y5.displayName;const yg=N.forwardRef(({className:n,children:e,...t},r)=>w.jsxs(Rae,{children:[w.jsx(b5,{}),w.jsxs(v5,{ref:r,className:wn("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-zinc-200 bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg dark:border-zinc-800 dark:bg-zinc-950",n),...t,children:[e,w.jsxs(Iae,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-zinc-950 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-zinc-100 data-[state=open]:text-zinc-500 dark:ring-offset-zinc-950 dark:focus:ring-zinc-300 dark:data-[state=open]:bg-zinc-800 dark:data-[state=open]:text-zinc-400",children:[w.jsx(j$,{className:"h-4 w-4"}),w.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));yg.displayName=v5.displayName;const vg=({className:n,...e})=>w.jsx("div",{className:wn("flex flex-col space-y-1.5 text-center sm:text-left",n),...e});vg.displayName="DialogHeader";const nx=({className:n,...e})=>w.jsx("div",{className:wn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",n),...e});nx.displayName="DialogFooter";const xg=N.forwardRef(({className:n,...e},t)=>w.jsx(x5,{ref:t,className:wn("text-lg font-semibold leading-none tracking-tight",n),...e}));xg.displayName=x5.displayName;const wg=N.forwardRef(({className:n,...e},t)=>w.jsx(w5,{ref:t,className:wn("text-sm text-zinc-500 dark:text-zinc-400",n),...e}));wg.displayName=w5.displayName;const k_=N.forwardRef(({className:n,...e},t)=>w.jsx("textarea",{className:wn("flex min-h-[60px] w-full rounded-md border border-zinc-200 bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-zinc-950 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm dark:border-zinc-800 dark:placeholder:text-zinc-400 dark:focus-visible:ring-zinc-300",n),ref:t,...e}));k_.displayName="Textarea";const Pae=()=>{const{user:n}=Zl(),{projects:e,createProject:t,deleteProject:r,duplicateProject:i,isLoading:s}=R$(),o=Zc(),[a,l]=N.useState(""),[c,u]=N.useState("grid"),[d,h]=N.useState(!1),[f,p]=N.useState(""),[x,v]=N.useState(""),y=e.filter(k=>k.name.toLowerCase().includes(a.toLowerCase())||k.description.toLowerCase().includes(a.toLowerCase())),b=async()=>{if(f.trim())try{const k=await t(f,x);h(!1),p(""),v(""),o(`/editor/${k.id}`)}catch(k){console.error("Ошибка создания проекта:",k)}},S=k=>{o(`/editor/${k}`)},_=async k=>{try{await i(k)}catch(P){console.error("Ошибка дублирования проекта:",P)}},T=async k=>{if(window.confirm("Вы уверены, что хотите удалить этот проект?"))try{await r(k)}catch(P){console.error("Ошибка удаления проекта:",P)}},M=k=>new Date(k).toLocaleDateString("ru-RU",{day:"numeric",month:"short",year:"numeric"});return w.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:w.jsxs("div",{className:"container mx-auto px-4 py-8",children:[w.jsxs("div",{className:"mb-8",children:[w.jsxs("div",{className:"flex items-center justify-between mb-6",children:[w.jsxs("div",{children:[w.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:["Добро пожаловать, ",n==null?void 0:n.name,"!"]}),w.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Управляйте своими проектами и создавайте новые идеи"})]}),w.jsxs(ex,{open:d,onOpenChange:h,children:[w.jsx(tx,{asChild:!0,children:w.jsxs(zt,{className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700",children:[w.jsx(Om,{className:"w-4 h-4 mr-2"}),"Новый проект"]})}),w.jsxs(yg,{children:[w.jsxs(vg,{children:[w.jsx(xg,{children:"Создать новый проект"}),w.jsx(wg,{children:"Дайте название и описание вашему новому проекту мебели"})]}),w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx(tr,{htmlFor:"name",children:"Название проекта"}),w.jsx(Jr,{id:"name",value:f,onChange:k=>p(k.target.value),placeholder:"Мой новый проект"})]}),w.jsxs("div",{children:[w.jsx(tr,{htmlFor:"description",children:"Описание (опционально)"}),w.jsx(k_,{id:"description",value:x,onChange:k=>v(k.target.value),placeholder:"Краткое описание проекта...",rows:3})]})]}),w.jsxs(nx,{children:[w.jsx(zt,{variant:"outline",onClick:()=>h(!1),children:"Отмена"}),w.jsx(zt,{onClick:b,disabled:!f.trim()||s,children:"Создать проект"})]})]})]})]}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[w.jsx(ti,{children:w.jsx($r,{className:"p-6",children:w.jsxs("div",{className:"flex items-center",children:[w.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center mr-4",children:w.jsx(gh,{className:"w-6 h-6 text-white"})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-2xl font-bold",children:e.length}),w.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Проектов"})]})]})})}),w.jsx(ti,{children:w.jsx($r,{className:"p-6",children:w.jsxs("div",{className:"flex items-center",children:[w.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center mr-4",children:w.jsx(P$,{className:"w-6 h-6 text-white"})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-2xl font-bold",children:e.filter(k=>(Date.now()-new Date(k.updatedAt).getTime())/864e5<=7).length}),w.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"За неделю"})]})]})})}),w.jsx(ti,{children:w.jsx($r,{className:"p-6",children:w.jsxs("div",{className:"flex items-center",children:[w.jsx("div",{className:"w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center mr-4",children:w.jsx(kM,{className:"w-6 h-6 text-white"})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-2xl font-bold",children:e.filter(k=>k.isPublic).length}),w.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Публичных"})]})]})})}),w.jsx(ti,{children:w.jsx($r,{className:"p-6",children:w.jsxs("div",{className:"flex items-center",children:[w.jsx("div",{className:"w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center mr-4",children:w.jsx(Pee,{className:"w-6 h-6 text-white"})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-2xl font-bold",children:e.length>0?M(Math.max(...e.map(k=>new Date(k.updatedAt).getTime())).toString()):"Нет"}),w.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Последний"})]})]})})})]})]}),w.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[w.jsx("div",{className:"flex-1",children:w.jsxs("div",{className:"relative",children:[w.jsx(Fm,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),w.jsx(Jr,{placeholder:"Поиск проектов...",value:a,onChange:k=>l(k.target.value),className:"pl-10"})]})}),w.jsxs("div",{className:"flex gap-2",children:[w.jsxs(zt,{variant:"outline",size:"sm",children:[w.jsx(L$,{className:"w-4 h-4 mr-2"}),"Фильтры"]}),w.jsxs("div",{className:"flex border rounded-lg",children:[w.jsx(zt,{variant:c==="grid"?"default":"ghost",size:"sm",onClick:()=>u("grid"),className:"rounded-r-none",children:w.jsx(gh,{className:"w-4 h-4"})}),w.jsx(zt,{variant:c==="list"?"default":"ghost",size:"sm",onClick:()=>u("list"),className:"rounded-l-none",children:w.jsx(z$,{className:"w-4 h-4"})})]})]})]}),y.length===0?w.jsxs("div",{className:"text-center py-16",children:[w.jsx("div",{className:"w-24 h-24 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4",children:w.jsx(gh,{className:"w-12 h-12 text-gray-400"})}),w.jsx("h3",{className:"text-xl font-semibold mb-2",children:a?"Проекты не найдены":"Нет проектов"}),w.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:a?"Попробуйте изменить поисковый запрос":"Создайте свой первый проект мебели"}),!a&&w.jsxs(zt,{onClick:()=>h(!0),className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700",children:[w.jsx(Om,{className:"w-4 h-4 mr-2"}),"Создать проект"]})]}):w.jsx("div",{className:c==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6":"space-y-4",children:y.map(k=>w.jsx(ti,{className:"group hover:shadow-lg transition-all duration-300",children:c==="grid"?w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"h-48 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 rounded-t-lg flex items-center justify-center",children:w.jsx(gh,{className:"w-16 h-16 text-gray-400"})}),w.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:w.jsxs(UM,{children:[w.jsx(BM,{asChild:!0,children:w.jsx(zt,{size:"sm",variant:"secondary",className:"w-8 h-8 p-0",children:w.jsx(dL,{className:"w-4 h-4"})})}),w.jsxs(oS,{align:"end",children:[w.jsxs(js,{onClick:()=>S(k.id),children:[w.jsx(ym,{className:"w-4 h-4 mr-2"}),"Открыть"]}),w.jsxs(js,{children:[w.jsx(Qb,{className:"w-4 h-4 mr-2"}),"Переименовать"]}),w.jsxs(js,{onClick:()=>_(k.id),children:[w.jsx(AM,{className:"w-4 h-4 mr-2"}),"Дублировать"]}),w.jsx(Bh,{}),w.jsxs(js,{children:[w.jsx(kM,{className:"w-4 h-4 mr-2"}),"Поделиться"]}),w.jsxs(js,{children:[w.jsx(Zb,{className:"w-4 h-4 mr-2"}),"Экспорт"]}),w.jsx(Bh,{}),w.jsxs(js,{onClick:()=>T(k.id),className:"text-red-600 dark:text-red-400",children:[w.jsx(zv,{className:"w-4 h-4 mr-2"}),"Удалить"]})]})]})})]}),w.jsxs(ns,{className:"pb-2",children:[w.jsx(rs,{className:"text-lg line-clamp-1",children:k.name}),w.jsx(So,{className:"line-clamp-2",children:k.description||"Без описания"})]}),w.jsxs($r,{className:"pt-0",children:[w.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400",children:[w.jsxs("span",{children:["Обновлен ",M(k.updatedAt)]}),k.isPublic&&w.jsx("span",{className:"text-green-600 dark:text-green-400",children:"Публичный"})]}),w.jsx(zt,{className:"w-full mt-4",onClick:()=>S(k.id),children:"Открыть проект"})]})]}):w.jsx($r,{className:"p-4",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center space-x-4",children:[w.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 rounded-lg flex items-center justify-center",children:w.jsx(gh,{className:"w-6 h-6 text-gray-400"})}),w.jsxs("div",{children:[w.jsx("h3",{className:"font-semibold",children:k.name}),w.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:k.description||"Без описания"}),w.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Обновлен ",M(k.updatedAt)]})]})]}),w.jsxs("div",{className:"flex items-center space-x-2",children:[w.jsx(zt,{size:"sm",onClick:()=>S(k.id),children:"Открыть"}),w.jsxs(UM,{children:[w.jsx(BM,{asChild:!0,children:w.jsx(zt,{size:"sm",variant:"ghost",className:"w-8 h-8 p-0",children:w.jsx(dL,{className:"w-4 h-4"})})}),w.jsxs(oS,{align:"end",children:[w.jsxs(js,{children:[w.jsx(Qb,{className:"w-4 h-4 mr-2"}),"Переименовать"]}),w.jsxs(js,{onClick:()=>_(k.id),children:[w.jsx(AM,{className:"w-4 h-4 mr-2"}),"Дублировать"]}),w.jsx(Bh,{}),w.jsxs(js,{onClick:()=>T(k.id),className:"text-red-600 dark:text-red-400",children:[w.jsx(zv,{className:"w-4 h-4 mr-2"}),"Удалить"]})]})]})]})]})})},k.id))})]})})};function XM(n){const e=Dae(n),t=N.forwardRef((r,i)=>{const{children:s,...o}=r,a=N.Children.toArray(s),l=a.find(Oae);if(l){const c=l.props.children,u=a.map(d=>d===l?N.Children.count(c)>1?N.Children.only(null):N.isValidElement(c)?c.props.children:null:d);return w.jsx(e,{...o,ref:i,children:N.isValidElement(c)?N.cloneElement(c,void 0,u):null})}return w.jsx(e,{...o,ref:i,children:s})});return t.displayName=`${n}.Slot`,t}function Dae(n){const e=N.forwardRef((t,r)=>{const{children:i,...s}=t;if(N.isValidElement(i)){const o=zae(i),a=Fae(s,i.props);return i.type!==N.Fragment&&(a.ref=r?X0(r,o):o),N.cloneElement(i,a)}return N.Children.count(i)>1?N.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var Lae=Symbol("radix.slottable");function Oae(n){return N.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===Lae}function Fae(n,e){const t={...e};for(const r in e){const i=n[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?t[r]=(...a)=>{const l=s(...a);return i(...a),l}:i&&(t[r]=i):r==="style"?t[r]={...i,...s}:r==="className"&&(t[r]=[i,s].filter(Boolean).join(" "))}return{...n,...t}}function zae(n){var r,i;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(i=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var Uae=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ls=Uae.reduce((n,e)=>{const t=XM(`Primitive.${e}`),r=N.forwardRef((i,s)=>{const{asChild:o,...a}=i,l=o?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),w.jsx(l,{...a,ref:s})});return r.displayName=`Primitive.${e}`,{...n,[e]:r}},{}),Bae="Separator",rO="horizontal",$ae=["horizontal","vertical"],S5=N.forwardRef((n,e)=>{const{decorative:t,orientation:r=rO,...i}=n,s=jae(r)?r:rO,a=t?{role:"none"}:{"aria-orientation":s==="vertical"?s:void 0,role:"separator"};return w.jsx(ls.div,{"data-orientation":s,...a,...i,ref:e})});S5.displayName=Bae;function jae(n){return $ae.includes(n)}var _5=S5;const Tu=N.forwardRef(({className:n,orientation:e="horizontal",decorative:t=!0,...r},i)=>w.jsx(_5,{ref:i,decorative:t,orientation:e,className:wn("shrink-0 bg-zinc-200 dark:bg-zinc-800",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",n),...r}));Tu.displayName=_5.displayName;function E5(n){const e=n+"CollectionProvider",[t,r]=Qo(e),[i,s]=t(e,{collectionRef:{current:null},itemMap:new Map}),o=x=>{const{scope:v,children:y}=x,b=Sr.useRef(null),S=Sr.useRef(new Map).current;return w.jsx(i,{scope:v,itemMap:S,collectionRef:b,children:y})};o.displayName=e;const a=n+"CollectionSlot",l=XM(a),c=Sr.forwardRef((x,v)=>{const{scope:y,children:b}=x,S=s(a,y),_=Gn(v,S.collectionRef);return w.jsx(l,{ref:_,children:b})});c.displayName=a;const u=n+"CollectionItemSlot",d="data-radix-collection-item",h=XM(u),f=Sr.forwardRef((x,v)=>{const{scope:y,children:b,...S}=x,_=Sr.useRef(null),T=Gn(v,_),M=s(u,y);return Sr.useEffect(()=>(M.itemMap.set(_,{ref:_,...S}),()=>void M.itemMap.delete(_))),w.jsx(h,{[d]:"",ref:T,children:b})});f.displayName=u;function p(x){const v=s(n+"CollectionConsumer",x);return Sr.useCallback(()=>{const b=v.collectionRef.current;if(!b)return[];const S=Array.from(b.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((M,k)=>S.indexOf(M.ref.current)-S.indexOf(k.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:c,ItemSlot:f},p,r]}var Vae=uU[" useInsertionEffect ".trim().toString()]||wi;function DI({prop:n,defaultProp:e,onChange:t=()=>{},caller:r}){const[i,s,o]=Wae({defaultProp:e,onChange:t}),a=n!==void 0,l=a?n:i;{const u=N.useRef(n!==void 0);N.useEffect(()=>{const d=u.current;d!==a&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,r])}const c=N.useCallback(u=>{var d;if(a){const h=Hae(u)?u(n):u;h!==n&&((d=o.current)==null||d.call(o,h))}else s(u)},[a,n,s,o]);return[l,c]}function Wae({defaultProp:n,onChange:e}){const[t,r]=N.useState(n),i=N.useRef(t),s=N.useRef(e);return Vae(()=>{s.current=e},[e]),N.useEffect(()=>{var o;i.current!==t&&((o=s.current)==null||o.call(s,t),i.current=t)},[t,i]),[t,r,s]}function Hae(n){return typeof n=="function"}var uC="rovingFocusGroup.onEntryFocus",Gae={bubbles:!1,cancelable:!0},rx="RovingFocusGroup",[KM,C5,qae]=E5(rx),[Xae,T5]=Qo(rx,[qae]),[Kae,Yae]=Xae(rx),M5=N.forwardRef((n,e)=>w.jsx(KM.Provider,{scope:n.__scopeRovingFocusGroup,children:w.jsx(KM.Slot,{scope:n.__scopeRovingFocusGroup,children:w.jsx(Zae,{...n,ref:e})})}));M5.displayName=rx;var Zae=N.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,orientation:r,loop:i=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=n,h=N.useRef(null),f=Gn(e,h),p=pg(s),[x,v]=DI({prop:o,defaultProp:a??null,onChange:l,caller:rx}),[y,b]=N.useState(!1),S=_o(c),_=C5(t),T=N.useRef(!1),[M,k]=N.useState(0);return N.useEffect(()=>{const P=h.current;if(P)return P.addEventListener(uC,S),()=>P.removeEventListener(uC,S)},[S]),w.jsx(Kae,{scope:t,orientation:r,dir:p,loop:i,currentTabStopId:x,onItemFocus:N.useCallback(P=>v(P),[v]),onItemShiftTab:N.useCallback(()=>b(!0),[]),onFocusableItemAdd:N.useCallback(()=>k(P=>P+1),[]),onFocusableItemRemove:N.useCallback(()=>k(P=>P-1),[]),children:w.jsx(ls.div,{tabIndex:y||M===0?-1:0,"data-orientation":r,...d,ref:f,style:{outline:"none",...n.style},onMouseDown:Ft(n.onMouseDown,()=>{T.current=!0}),onFocus:Ft(n.onFocus,P=>{const z=!T.current;if(P.target===P.currentTarget&&z&&!y){const I=new CustomEvent(uC,Gae);if(P.currentTarget.dispatchEvent(I),!I.defaultPrevented){const L=_().filter(Y=>Y.focusable),W=L.find(Y=>Y.active),q=L.find(Y=>Y.id===x),ne=[W,q,...L].filter(Boolean).map(Y=>Y.ref.current);k5(ne,u)}}T.current=!1}),onBlur:Ft(n.onBlur,()=>b(!1))})})}),A5="RovingFocusGroupItem",N5=N.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,focusable:r=!0,active:i=!1,tabStopId:s,children:o,...a}=n,l=Ja(),c=s||l,u=Yae(A5,t),d=u.currentTabStopId===c,h=C5(t),{onFocusableItemAdd:f,onFocusableItemRemove:p,currentTabStopId:x}=u;return N.useEffect(()=>{if(r)return f(),()=>p()},[r,f,p]),w.jsx(KM.ItemSlot,{scope:t,id:c,focusable:r,active:i,children:w.jsx(ls.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...a,ref:e,onMouseDown:Ft(n.onMouseDown,v=>{r?u.onItemFocus(c):v.preventDefault()}),onFocus:Ft(n.onFocus,()=>u.onItemFocus(c)),onKeyDown:Ft(n.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const y=ele(v,u.orientation,u.dir);if(y!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let S=h().filter(_=>_.focusable).map(_=>_.ref.current);if(y==="last")S.reverse();else if(y==="prev"||y==="next"){y==="prev"&&S.reverse();const _=S.indexOf(v.currentTarget);S=u.loop?tle(S,_+1):S.slice(_+1)}setTimeout(()=>k5(S))}}),children:typeof o=="function"?o({isCurrentTabStop:d,hasTabStop:x!=null}):o})})});N5.displayName=A5;var Qae={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Jae(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function ele(n,e,t){const r=Jae(n.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Qae[r]}function k5(n,e=!1){const t=document.activeElement;for(const r of n)if(r===t||(r.focus({preventScroll:e}),document.activeElement!==t))return}function tle(n,e){return n.map((t,r)=>n[(e+r)%n.length])}var nle=M5,rle=N5;function ile(n,e){return N.useReducer((t,r)=>e[t][r]??t,n)}var I5=n=>{const{present:e,children:t}=n,r=sle(e),i=typeof t=="function"?t({present:r.isPresent}):N.Children.only(t),s=Gn(r.ref,ole(i));return typeof t=="function"||r.isPresent?N.cloneElement(i,{ref:s}):null};I5.displayName="Presence";function sle(n){const[e,t]=N.useState(),r=N.useRef(null),i=N.useRef(n),s=N.useRef("none"),o=n?"mounted":"unmounted",[a,l]=ile(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return N.useEffect(()=>{const c=$w(r.current);s.current=a==="mounted"?c:"none"},[a]),wi(()=>{const c=r.current,u=i.current;if(u!==n){const h=s.current,f=$w(c);n?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==f?"ANIMATION_OUT":"UNMOUNT"),i.current=n}},[n,l]),wi(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=f=>{const x=$w(r.current).includes(f.animationName);if(f.target===e&&x&&(l("ANIMATION_END"),!i.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},h=f=>{f.target===e&&(s.current=$w(r.current))};return e.addEventListener("animationstart",h),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",h),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:N.useCallback(c=>{r.current=c?getComputedStyle(c):null,t(c)},[])}}function $w(n){return(n==null?void 0:n.animationName)||"none"}function ole(n){var r,i;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(i=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var I_="Tabs",[ale,EBe]=Qo(I_,[T5]),R5=T5(),[lle,LI]=ale(I_),P5=N.forwardRef((n,e)=>{const{__scopeTabs:t,value:r,onValueChange:i,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:l="automatic",...c}=n,u=pg(a),[d,h]=DI({prop:r,onChange:i,defaultProp:s??"",caller:I_});return w.jsx(lle,{scope:t,baseId:Ja(),value:d,onValueChange:h,orientation:o,dir:u,activationMode:l,children:w.jsx(ls.div,{dir:u,"data-orientation":o,...c,ref:e})})});P5.displayName=I_;var D5="TabsList",L5=N.forwardRef((n,e)=>{const{__scopeTabs:t,loop:r=!0,...i}=n,s=LI(D5,t),o=R5(t);return w.jsx(nle,{asChild:!0,...o,orientation:s.orientation,dir:s.dir,loop:r,children:w.jsx(ls.div,{role:"tablist","aria-orientation":s.orientation,...i,ref:e})})});L5.displayName=D5;var O5="TabsTrigger",F5=N.forwardRef((n,e)=>{const{__scopeTabs:t,value:r,disabled:i=!1,...s}=n,o=LI(O5,t),a=R5(t),l=B5(o.baseId,r),c=$5(o.baseId,r),u=r===o.value;return w.jsx(rle,{asChild:!0,...a,focusable:!i,active:u,children:w.jsx(ls.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:l,...s,ref:e,onMouseDown:Ft(n.onMouseDown,d=>{!i&&d.button===0&&d.ctrlKey===!1?o.onValueChange(r):d.preventDefault()}),onKeyDown:Ft(n.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(r)}),onFocus:Ft(n.onFocus,()=>{const d=o.activationMode!=="manual";!u&&!i&&d&&o.onValueChange(r)})})})});F5.displayName=O5;var z5="TabsContent",U5=N.forwardRef((n,e)=>{const{__scopeTabs:t,value:r,forceMount:i,children:s,...o}=n,a=LI(z5,t),l=B5(a.baseId,r),c=$5(a.baseId,r),u=r===a.value,d=N.useRef(u);return N.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),w.jsx(I5,{present:i||u,children:({present:h})=>w.jsx(ls.div,{"data-state":u?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...o,ref:e,style:{...n.style,animationDuration:d.current?"0s":void 0},children:h&&s})})});U5.displayName=z5;function B5(n,e){return`${n}-trigger-${e}`}function $5(n,e){return`${n}-content-${e}`}var cle=P5,j5=L5,V5=F5,W5=U5;const ule=cle,H5=N.forwardRef(({className:n,...e},t)=>w.jsx(j5,{ref:t,className:wn("inline-flex h-9 items-center justify-center rounded-lg bg-zinc-100 p-1 text-zinc-500 dark:bg-zinc-800 dark:text-zinc-400",n),...e}));H5.displayName=j5.displayName;const lb=N.forwardRef(({className:n,...e},t)=>w.jsx(V5,{ref:t,className:wn("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-zinc-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-zinc-950 data-[state=active]:shadow dark:ring-offset-zinc-950 dark:focus-visible:ring-zinc-300 dark:data-[state=active]:bg-zinc-950 dark:data-[state=active]:text-zinc-50",n),...e}));lb.displayName=V5.displayName;const cb=N.forwardRef(({className:n,...e},t)=>w.jsx(W5,{ref:t,className:wn("mt-2 ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-zinc-950 focus-visible:ring-offset-2 dark:ring-offset-zinc-950 dark:focus-visible:ring-zinc-300",n),...e}));cb.displayName=W5.displayName;function vS(n,[e,t]){return Math.min(t,Math.max(e,n))}function G5(n){const e=N.useRef({value:n,previous:n});return N.useMemo(()=>(e.current.value!==n&&(e.current.previous=e.current.value,e.current.value=n),e.current.previous),[n])}var q5=["PageUp","PageDown"],X5=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],K5={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},bg="Slider",[YM,dle,hle]=E5(bg),[Y5,CBe]=Qo(bg,[hle]),[fle,R_]=Y5(bg),Z5=N.forwardRef((n,e)=>{const{name:t,min:r=0,max:i=100,step:s=1,orientation:o="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:f=!1,form:p,...x}=n,v=N.useRef(new Set),y=N.useRef(0),S=o==="horizontal"?ple:mle,[_=[],T]=DI({prop:u,defaultProp:c,onChange:L=>{var q;(q=[...v.current][y.current])==null||q.focus(),d(L)}}),M=N.useRef(_);function k(L){const W=wle(_,L);I(L,W)}function P(L){I(L,y.current)}function z(){const L=M.current[y.current];_[y.current]!==L&&h(_)}function I(L,W,{commit:q}={commit:!1}){const $=Ele(s),ne=Cle(Math.round((L-r)/s)*s+r,$),Y=vS(ne,[r,i]);T((we=[])=>{const H=vle(we,Y,W);if(_le(H,l*s)){y.current=H.indexOf(Y);const X=String(H)!==String(we);return X&&q&&h(H),X?H:we}else return we})}return w.jsx(fle,{scope:n.__scopeSlider,name:t,disabled:a,min:r,max:i,valueIndexToChangeRef:y,thumbs:v.current,values:_,orientation:o,form:p,children:w.jsx(YM.Provider,{scope:n.__scopeSlider,children:w.jsx(YM.Slot,{scope:n.__scopeSlider,children:w.jsx(S,{"aria-disabled":a,"data-disabled":a?"":void 0,...x,ref:e,onPointerDown:Ft(x.onPointerDown,()=>{a||(M.current=_)}),min:r,max:i,inverted:f,onSlideStart:a?void 0:k,onSlideMove:a?void 0:P,onSlideEnd:a?void 0:z,onHomeKeyDown:()=>!a&&I(r,0,{commit:!0}),onEndKeyDown:()=>!a&&I(i,_.length-1,{commit:!0}),onStepKeyDown:({event:L,direction:W})=>{if(!a){const ne=q5.includes(L.key)||L.shiftKey&&X5.includes(L.key)?10:1,Y=y.current,we=_[Y],H=s*ne*W;I(we+H,Y,{commit:!0})}}})})})})});Z5.displayName=bg;var[Q5,J5]=Y5(bg,{startEdge:"left",endEdge:"right",size:"width",direction:1}),ple=N.forwardRef((n,e)=>{const{min:t,max:r,dir:i,inverted:s,onSlideStart:o,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...u}=n,[d,h]=N.useState(null),f=Gn(e,S=>h(S)),p=N.useRef(void 0),x=pg(i),v=x==="ltr",y=v&&!s||!v&&s;function b(S){const _=p.current||d.getBoundingClientRect(),T=[0,_.width],k=OI(T,y?[t,r]:[r,t]);return p.current=_,k(S-_.left)}return w.jsx(Q5,{scope:n.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width",children:w.jsx(e6,{dir:x,"data-orientation":"horizontal",...u,ref:f,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:S=>{const _=b(S.clientX);o==null||o(_)},onSlideMove:S=>{const _=b(S.clientX);a==null||a(_)},onSlideEnd:()=>{p.current=void 0,l==null||l()},onStepKeyDown:S=>{const T=K5[y?"from-left":"from-right"].includes(S.key);c==null||c({event:S,direction:T?-1:1})}})})}),mle=N.forwardRef((n,e)=>{const{min:t,max:r,inverted:i,onSlideStart:s,onSlideMove:o,onSlideEnd:a,onStepKeyDown:l,...c}=n,u=N.useRef(null),d=Gn(e,u),h=N.useRef(void 0),f=!i;function p(x){const v=h.current||u.current.getBoundingClientRect(),y=[0,v.height],S=OI(y,f?[r,t]:[t,r]);return h.current=v,S(x-v.top)}return w.jsx(Q5,{scope:n.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:w.jsx(e6,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:x=>{const v=p(x.clientY);s==null||s(v)},onSlideMove:x=>{const v=p(x.clientY);o==null||o(v)},onSlideEnd:()=>{h.current=void 0,a==null||a()},onStepKeyDown:x=>{const y=K5[f?"from-bottom":"from-top"].includes(x.key);l==null||l({event:x,direction:y?-1:1})}})})}),e6=N.forwardRef((n,e)=>{const{__scopeSlider:t,onSlideStart:r,onSlideMove:i,onSlideEnd:s,onHomeKeyDown:o,onEndKeyDown:a,onStepKeyDown:l,...c}=n,u=R_(bg,t);return w.jsx(ls.span,{...c,ref:e,onKeyDown:Ft(n.onKeyDown,d=>{d.key==="Home"?(o(d),d.preventDefault()):d.key==="End"?(a(d),d.preventDefault()):q5.concat(X5).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:Ft(n.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():r(d)}),onPointerMove:Ft(n.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&i(d)}),onPointerUp:Ft(n.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),s(d))})})}),t6="SliderTrack",n6=N.forwardRef((n,e)=>{const{__scopeSlider:t,...r}=n,i=R_(t6,t);return w.jsx(ls.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...r,ref:e})});n6.displayName=t6;var ZM="SliderRange",r6=N.forwardRef((n,e)=>{const{__scopeSlider:t,...r}=n,i=R_(ZM,t),s=J5(ZM,t),o=N.useRef(null),a=Gn(e,o),l=i.values.length,c=i.values.map(h=>o6(h,i.min,i.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return w.jsx(ls.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...r,ref:a,style:{...n.style,[s.startEdge]:u+"%",[s.endEdge]:d+"%"}})});r6.displayName=ZM;var QM="SliderThumb",i6=N.forwardRef((n,e)=>{const t=dle(n.__scopeSlider),[r,i]=N.useState(null),s=Gn(e,a=>i(a)),o=N.useMemo(()=>r?t().findIndex(a=>a.ref.current===r):-1,[t,r]);return w.jsx(gle,{...n,ref:s,index:o})}),gle=N.forwardRef((n,e)=>{const{__scopeSlider:t,index:r,name:i,...s}=n,o=R_(QM,t),a=J5(QM,t),[l,c]=N.useState(null),u=Gn(e,b=>c(b)),d=l?o.form||!!l.closest("form"):!0,h=hj(l),f=o.values[r],p=f===void 0?0:o6(f,o.min,o.max),x=xle(r,o.values.length),v=h==null?void 0:h[a.size],y=v?ble(v,p,a.direction):0;return N.useEffect(()=>{if(l)return o.thumbs.add(l),()=>{o.thumbs.delete(l)}},[l,o.thumbs]),w.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${p}% + ${y}px)`},children:[w.jsx(YM.ItemSlot,{scope:n.__scopeSlider,children:w.jsx(ls.span,{role:"slider","aria-label":n["aria-label"]||x,"aria-valuemin":o.min,"aria-valuenow":f,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...s,ref:u,style:f===void 0?{display:"none"}:n.style,onFocus:Ft(n.onFocus,()=>{o.valueIndexToChangeRef.current=r})})}),d&&w.jsx(s6,{name:i??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:f},r)]})});i6.displayName=QM;var yle="RadioBubbleInput",s6=N.forwardRef(({__scopeSlider:n,value:e,...t},r)=>{const i=N.useRef(null),s=Gn(i,r),o=G5(e);return N.useEffect(()=>{const a=i.current;if(!a)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==e&&u){const d=new Event("input",{bubbles:!0});u.call(a,e),a.dispatchEvent(d)}},[o,e]),w.jsx(ls.input,{style:{display:"none"},...t,ref:s,defaultValue:e})});s6.displayName=yle;function vle(n=[],e,t){const r=[...n];return r[t]=e,r.sort((i,s)=>i-s)}function o6(n,e,t){const s=100/(t-e)*(n-e);return vS(s,[0,100])}function xle(n,e){return e>2?`Value ${n+1} of ${e}`:e===2?["Minimum","Maximum"][n]:void 0}function wle(n,e){if(n.length===1)return 0;const t=n.map(i=>Math.abs(i-e)),r=Math.min(...t);return t.indexOf(r)}function ble(n,e,t){const r=n/2,s=OI([0,50],[0,r]);return(r-s(e)*t)*t}function Sle(n){return n.slice(0,-1).map((e,t)=>n[t+1]-e)}function _le(n,e){if(e>0){const t=Sle(n);return Math.min(...t)>=e}return!0}function OI(n,e){return t=>{if(n[0]===n[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(n[1]-n[0]);return e[0]+r*(t-n[0])}}function Ele(n){return(String(n).split(".")[1]||"").length}function Cle(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}var a6=Z5,Tle=n6,Mle=r6,Ale=i6;const zp=N.forwardRef(({className:n,...e},t)=>w.jsxs(a6,{ref:t,className:wn("relative flex w-full touch-none select-none items-center",n),...e,children:[w.jsx(Tle,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-zinc-900/20 dark:bg-zinc-50/20",children:w.jsx(Mle,{className:"absolute h-full bg-zinc-900 dark:bg-zinc-50"})}),w.jsx(Ale,{className:"block h-4 w-4 rounded-full border border-zinc-200 border-zinc-900/50 bg-white shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-zinc-950 disabled:pointer-events-none disabled:opacity-50 dark:border-zinc-800 dark:border-zinc-50/50 dark:bg-zinc-950 dark:focus-visible:ring-zinc-300"})]}));zp.displayName=a6.displayName;/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Sg="161",uh={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},dh={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},l6=0,JM=1,c6=2,Nle=3,u6=0,P_=1,Sm=2,$a=3,Wc=0,Cs=1,Ka=2,zl=0,jh=1,eA=2,tA=3,nA=4,d6=5,Du=100,h6=101,f6=102,rA=103,iA=104,p6=200,m6=201,g6=202,y6=203,xS=204,wS=205,v6=206,x6=207,w6=208,b6=209,S6=210,_6=211,E6=212,C6=213,T6=214,M6=0,A6=1,N6=2,r0=3,k6=4,I6=5,R6=6,P6=7,ix=0,D6=1,L6=2,Ul=0,O6=1,F6=2,z6=3,FI=4,U6=5,B6=6,sA="attached",$6="detached",pd=300,ql=301,md=302,jm=303,i0=304,_g=306,Vm=1e3,Gr=1001,s0=1002,yi=1003,bS=1004,kle=1004,yh=1005,Ile=1005,Jn=1006,lv=1007,Rle=1007,Nl=1008,oA=1008,Wo=1009,zI=1010,UI=1011,D_=1012,L_=1013,kl=1014,fi=1015,Fi=1016,BI=1017,$I=1018,Ku=1020,j6=1021,Ii=1023,V6=1024,W6=1025,Yu=1026,cf=1027,jI=1028,VI=1029,H6=1030,WI=1031,HI=1033,ub=33776,db=33777,hb=33778,fb=33779,aA=35840,lA=35841,cA=35842,uA=35843,GI=36196,dA=37492,hA=37496,fA=37808,pA=37809,mA=37810,gA=37811,yA=37812,vA=37813,xA=37814,wA=37815,bA=37816,SA=37817,_A=37818,EA=37819,CA=37820,TA=37821,pb=36492,MA=36494,AA=36495,G6=36283,NA=36284,kA=36285,IA=36286,q6=2200,X6=2201,K6=2202,o0=2300,a0=2301,mb=2302,Ah=2400,Nh=2401,l0=2402,O_=2500,qI=2501,Ple=0,Dle=1,Lle=2,XI=3e3,Zu=3001,Y6=3200,Z6=3201,Md=0,Q6=1,zo="",Ai="srgb",Ko="srgb-linear",F_="display-p3",sx="display-p3-linear",c0="linear",Ir="srgb",u0="rec709",d0="p3",Ole=0,hh=7680,Fle=7681,zle=7682,Ule=7683,Ble=34055,$le=34056,jle=5386,Vle=512,Wle=513,Hle=514,Gle=515,qle=516,Xle=517,Kle=518,RA=519,J6=512,eW=513,tW=514,KI=515,nW=516,rW=517,iW=518,sW=519,h0=35044,Yle=35048,Zle=35040,Qle=35045,Jle=35049,ece=35041,tce=35046,nce=35050,rce=35042,ice="100",PA="300 es",SS=1035,Il=2e3,f0=2001;let Jl=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}};const gs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let iO=1234567;const Vh=Math.PI/180,Wm=180/Math.PI;function Ho(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(gs[n&255]+gs[n>>8&255]+gs[n>>16&255]+gs[n>>24&255]+"-"+gs[e&255]+gs[e>>8&255]+"-"+gs[e>>16&15|64]+gs[e>>24&255]+"-"+gs[t&63|128]+gs[t>>8&255]+"-"+gs[t>>16&255]+gs[t>>24&255]+gs[r&255]+gs[r>>8&255]+gs[r>>16&255]+gs[r>>24&255]).toLowerCase()}function di(n,e,t){return Math.max(e,Math.min(t,n))}function YI(n,e){return(n%e+e)%e}function sce(n,e,t,r,i){return r+(n-e)*(i-r)/(t-e)}function oce(n,e,t){return n!==e?(t-n)/(e-n):0}function cv(n,e,t){return(1-t)*n+t*e}function ace(n,e,t,r){return cv(n,e,1-Math.exp(-t*r))}function lce(n,e=1){return e-Math.abs(YI(n,e*2)-e)}function cce(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function uce(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function dce(n,e){return n+Math.floor(Math.random()*(e-n+1))}function hce(n,e){return n+Math.random()*(e-n)}function fce(n){return n*(.5-Math.random())}function pce(n){n!==void 0&&(iO=n);let e=iO+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function mce(n){return n*Vh}function gce(n){return n*Wm}function DA(n){return(n&n-1)===0&&n!==0}function yce(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function _S(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function vce(n,e,t,r,i){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+r)/2),u=o((e+r)/2),d=s((e-r)/2),h=o((e-r)/2),f=s((r-e)/2),p=o((r-e)/2);switch(i){case"XYX":n.set(a*u,l*d,l*h,a*c);break;case"YZY":n.set(l*h,a*u,l*d,a*c);break;case"ZXZ":n.set(l*d,l*h,a*u,a*c);break;case"XZX":n.set(a*u,l*p,l*f,a*c);break;case"YXY":n.set(l*f,a*u,l*p,a*c);break;case"ZYZ":n.set(l*p,l*f,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Ws(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Tn(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const oW={DEG2RAD:Vh,RAD2DEG:Wm,generateUUID:Ho,clamp:di,euclideanModulo:YI,mapLinear:sce,inverseLerp:oce,lerp:cv,damp:ace,pingpong:lce,smoothstep:cce,smootherstep:uce,randInt:dce,randFloat:hce,randFloatSpread:fce,seededRandom:pce,degToRad:mce,radToDeg:gce,isPowerOfTwo:DA,ceilPowerOfTwo:yce,floorPowerOfTwo:_S,setQuaternionFromProperEuler:vce,normalize:Tn,denormalize:Ws};let Ze=class aW{constructor(e=0,t=0){aW.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(di(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*r-o*i+e.x,this.y=s*i+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Vn=class lW{constructor(e,t,r,i,s,o,a,l,c){lW.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,o,a,l,c)}set(e,t,r,i,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=i,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=r,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[3],l=r[6],c=r[1],u=r[4],d=r[7],h=r[2],f=r[5],p=r[8],x=i[0],v=i[3],y=i[6],b=i[1],S=i[4],_=i[7],T=i[2],M=i[5],k=i[8];return s[0]=o*x+a*b+l*T,s[3]=o*v+a*S+l*M,s[6]=o*y+a*_+l*k,s[1]=c*x+u*b+d*T,s[4]=c*v+u*S+d*M,s[7]=c*y+u*_+d*k,s[2]=h*x+f*b+p*T,s[5]=h*v+f*S+p*M,s[8]=h*y+f*_+p*k,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-r*s*u+r*a*l+i*s*c-i*o*l}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,h=a*l-u*s,f=c*s-o*l,p=t*d+r*h+i*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/p;return e[0]=d*x,e[1]=(i*c-u*r)*x,e[2]=(a*r-i*o)*x,e[3]=h*x,e[4]=(u*t-i*l)*x,e[5]=(i*s-a*t)*x,e[6]=f*x,e[7]=(r*l-c*t)*x,e[8]=(o*t-r*s)*x,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(r*l,r*c,-r*(l*o+c*a)+o+e,-i*c,i*l,-i*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(dC.makeScale(e,t)),this}rotate(e){return this.premultiply(dC.makeRotation(-e)),this}translate(e,t){return this.premultiply(dC.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}};const dC=new Vn;function cW(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const xce={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function im(n,e){return new xce[n](e)}function p0(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function uW(){const n=p0("canvas");return n.style.display="block",n}const sO={};function Wh(n){n in sO||(sO[n]=!0,console.warn(n))}const oO=new Vn().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),aO=new Vn().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),jw={[Ko]:{transfer:c0,primaries:u0,toReference:n=>n,fromReference:n=>n},[Ai]:{transfer:Ir,primaries:u0,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[sx]:{transfer:c0,primaries:d0,toReference:n=>n.applyMatrix3(aO),fromReference:n=>n.applyMatrix3(oO)},[F_]:{transfer:Ir,primaries:d0,toReference:n=>n.convertSRGBToLinear().applyMatrix3(aO),fromReference:n=>n.applyMatrix3(oO).convertLinearToSRGB()}},wce=new Set([Ko,sx]),gr={enabled:!0,_workingColorSpace:Ko,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!wce.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const r=jw[e].toReference,i=jw[t].fromReference;return i(r(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return jw[n].primaries},getTransfer:function(n){return n===zo?c0:jw[n].transfer}};function _m(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function hC(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let up,ZI=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{up===void 0&&(up=p0("canvas")),up.width=e.width,up.height=e.height;const r=up.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=up}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=p0("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let o=0;o<s.length;o++)s[o]=_m(s[o]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(_m(t[r]/255)*255):t[r]=_m(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},bce=0,kh=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:bce++}),this.uuid=Ho(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?s.push(fC(i[o].image)):s.push(fC(i[o]))}else s=fC(i);r.url=s}return t||(e.images[this.uuid]=r),r}};function fC(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?ZI.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Sce=0,qr=class gb extends Jl{constructor(e=gb.DEFAULT_IMAGE,t=gb.DEFAULT_MAPPING,r=Gr,i=Gr,s=Jn,o=Nl,a=Ii,l=Wo,c=gb.DEFAULT_ANISOTROPY,u=zo){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Sce++}),this.uuid=Ho(),this.name="",this.source=new kh(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Ze(0,0),this.repeat=new Ze(1,1),this.center=new Ze(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Vn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof u=="string"?this.colorSpace=u:(Wh("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===Zu?Ai:zo),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==pd)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Vm:e.x=e.x-Math.floor(e.x);break;case Gr:e.x=e.x<0?0:1;break;case s0:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Vm:e.y=e.y-Math.floor(e.y);break;case Gr:e.y=e.y<0?0:1;break;case s0:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Wh("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Ai?Zu:XI}set encoding(e){Wh("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Zu?Ai:zo}};qr.DEFAULT_IMAGE=null;qr.DEFAULT_MAPPING=pd;qr.DEFAULT_ANISOTROPY=1;class vr{constructor(e=0,t=0,r=0,i=1){vr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*i+o[12]*s,this.y=o[1]*t+o[5]*r+o[9]*i+o[13]*s,this.z=o[2]*t+o[6]*r+o[10]*i+o[14]*s,this.w=o[3]*t+o[7]*r+o[11]*i+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],f=l[5],p=l[9],x=l[2],v=l[6],y=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-x)<.01&&Math.abs(p-v)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+x)<.1&&Math.abs(p+v)<.1&&Math.abs(c+f+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const S=(c+1)/2,_=(f+1)/2,T=(y+1)/2,M=(u+h)/4,k=(d+x)/4,P=(p+v)/4;return S>_&&S>T?S<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(S),i=M/r,s=k/r):_>T?_<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(_),r=M/i,s=P/i):T<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(T),r=k/s,i=P/s),this.set(r,i,s,t),this}let b=Math.sqrt((v-p)*(v-p)+(d-x)*(d-x)+(h-u)*(h-u));return Math.abs(b)<.001&&(b=1),this.x=(v-p)/b,this.y=(d-x)/b,this.z=(h-u)/b,this.w=Math.acos((c+f+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class dW extends Jl{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new vr(0,0,e,t),this.scissorTest=!1,this.viewport=new vr(0,0,e,t);const i={width:e,height:t,depth:1};r.encoding!==void 0&&(Wh("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===Zu?Ai:zo),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Jn,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},r),this.texture=new qr(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps,this.texture.internalFormat=r.internalFormat,this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new kh(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Eo extends dW{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class z_ extends qr{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=yi,this.minFilter=yi,this.wrapR=Gr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class _ce extends Eo{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new z_(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class QI extends qr{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=yi,this.minFilter=yi,this.wrapR=Gr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ece extends Eo{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new QI(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class Cce extends Eo{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<r;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,s=this.texture.length;i<s;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class Ts{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,o,a){let l=r[i+0],c=r[i+1],u=r[i+2],d=r[i+3];const h=s[o+0],f=s[o+1],p=s[o+2],x=s[o+3];if(a===0){e[t+0]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d;return}if(a===1){e[t+0]=h,e[t+1]=f,e[t+2]=p,e[t+3]=x;return}if(d!==x||l!==h||c!==f||u!==p){let v=1-a;const y=l*h+c*f+u*p+d*x,b=y>=0?1:-1,S=1-y*y;if(S>Number.EPSILON){const T=Math.sqrt(S),M=Math.atan2(T,y*b);v=Math.sin(v*M)/T,a=Math.sin(a*M)/T}const _=a*b;if(l=l*v+h*_,c=c*v+f*_,u=u*v+p*_,d=d*v+x*_,v===1-a){const T=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=T,c*=T,u*=T,d*=T}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,r,i,s,o){const a=r[i],l=r[i+1],c=r[i+2],u=r[i+3],d=s[o],h=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*d+l*f-c*h,e[t+1]=l*p+u*h+c*d-a*f,e[t+2]=c*p+u*f+a*h-l*d,e[t+3]=u*p-a*d-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,i=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(r/2),u=a(i/2),d=a(s/2),h=l(r/2),f=l(i/2),p=l(s/2);switch(o){case"XYZ":this._x=h*u*d+c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d-h*f*p;break;case"YXZ":this._x=h*u*d+c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d+h*f*p;break;case"ZXY":this._x=h*u*d-c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d-h*f*p;break;case"ZYX":this._x=h*u*d-c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d+h*f*p;break;case"YZX":this._x=h*u*d+c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d-h*f*p;break;case"XZY":this._x=h*u*d-c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d+h*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],d=t[10],h=r+a+d;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-i)*f}else if(r>a&&r>d){const f=2*Math.sqrt(1+r-a-d);this._w=(u-l)/f,this._x=.25*f,this._y=(i+o)/f,this._z=(s+c)/f}else if(a>d){const f=2*Math.sqrt(1+a-r-d);this._w=(s-c)/f,this._x=(i+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+d-r-a);this._w=(o-i)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(di(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=r*u+o*a+i*c-s*l,this._y=i*u+o*l+s*a-r*c,this._z=s*u+o*c+r*l-i*a,this._w=o*u-r*a-i*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,o=this._w;let a=o*e._w+r*e._x+i*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=i,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*r+t*this._x,this._y=f*i+t*this._y,this._z=f*s+t*this._z,this.normalize(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),d=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=o*d+this._w*h,this._x=r*d+this._x*h,this._y=i*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(s),r*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ie{constructor(e=0,t=0,r=0){ie.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(lO.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(lO.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,o=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*o,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*o,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*o,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*i-a*r),u=2*(a*t-s*i),d=2*(s*r-o*t);return this.x=t+l*c+o*d-a*u,this.y=r+l*u+a*c-s*d,this.z=i+l*d+s*u-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=i*l-s*a,this.y=s*o-r*l,this.z=r*a-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return pC.copy(this).projectOnVector(e),this.sub(pC)}reflect(e){return this.sub(pC.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(di(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const pC=new ie,lO=new Ts;class qs{constructor(e=new ie(1/0,1/0,1/0),t=new ie(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(La.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(La.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=La.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,La):La.fromBufferAttribute(s,o),La.applyMatrix4(e.matrixWorld),this.expandByPoint(La);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Vw.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),Vw.copy(r.boundingBox)),Vw.applyMatrix4(e.matrixWorld),this.union(Vw)}const i=e.children;for(let s=0,o=i.length;s<o;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,La),La.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(vy),Ww.subVectors(this.max,vy),dp.subVectors(e.a,vy),hp.subVectors(e.b,vy),fp.subVectors(e.c,vy),mu.subVectors(hp,dp),gu.subVectors(fp,hp),Zd.subVectors(dp,fp);let t=[0,-mu.z,mu.y,0,-gu.z,gu.y,0,-Zd.z,Zd.y,mu.z,0,-mu.x,gu.z,0,-gu.x,Zd.z,0,-Zd.x,-mu.y,mu.x,0,-gu.y,gu.x,0,-Zd.y,Zd.x,0];return!mC(t,dp,hp,fp,Ww)||(t=[1,0,0,0,1,0,0,0,1],!mC(t,dp,hp,fp,Ww))?!1:(Hw.crossVectors(mu,gu),t=[Hw.x,Hw.y,Hw.z],mC(t,dp,hp,fp,Ww))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,La).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(La).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(hc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),hc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),hc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),hc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),hc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),hc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),hc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),hc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(hc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const hc=[new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie],La=new ie,Vw=new qs,dp=new ie,hp=new ie,fp=new ie,mu=new ie,gu=new ie,Zd=new ie,vy=new ie,Ww=new ie,Hw=new ie,Qd=new ie;function mC(n,e,t,r,i){for(let s=0,o=n.length-3;s<=o;s+=3){Qd.fromArray(n,s);const a=i.x*Math.abs(Qd.x)+i.y*Math.abs(Qd.y)+i.z*Math.abs(Qd.z),l=e.dot(Qd),c=t.dot(Qd),u=r.dot(Qd);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const Tce=new qs,xy=new ie,gC=new ie;class Ms{constructor(e=new ie,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):Tce.setFromPoints(e).getCenter(r);let i=0;for(let s=0,o=e.length;s<o;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;xy.subVectors(e,this.center);const t=xy.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(xy,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(gC.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(xy.copy(e.center).add(gC)),this.expandByPoint(xy.copy(e.center).sub(gC))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const fc=new ie,yC=new ie,Gw=new ie,yu=new ie,vC=new ie,qw=new ie,xC=new ie;class Mf{constructor(e=new ie,t=new ie(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,fc)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=fc.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(fc.copy(this.origin).addScaledVector(this.direction,t),fc.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){yC.copy(e).add(t).multiplyScalar(.5),Gw.copy(t).sub(e).normalize(),yu.copy(this.origin).sub(yC);const s=e.distanceTo(t)*.5,o=-this.direction.dot(Gw),a=yu.dot(this.direction),l=-yu.dot(Gw),c=yu.lengthSq(),u=Math.abs(1-o*o);let d,h,f,p;if(u>0)if(d=o*l-a,h=o*a-l,p=s*u,d>=0)if(h>=-p)if(h<=p){const x=1/u;d*=x,h*=x,f=d*(d+o*h+2*a)+h*(o*d+h+2*l)+c}else h=s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h=-s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h<=-p?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c):h<=p?(d=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+c):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;return r&&r.copy(this.origin).addScaledVector(this.direction,d),i&&i.copy(yC).addScaledVector(Gw,h),f}intersectSphere(e,t){fc.subVectors(e.center,this.origin);const r=fc.dot(this.direction),i=fc.dot(fc)-r*r,s=e.radius*e.radius;if(i>s)return null;const o=Math.sqrt(s-i),a=r-o,l=r+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(r=(e.min.x-h.x)*c,i=(e.max.x-h.x)*c):(r=(e.max.x-h.x)*c,i=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),r>o||s>i||((s>r||isNaN(r))&&(r=s),(o<i||isNaN(i))&&(i=o),d>=0?(a=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),r>l||a>i)||((a>r||r!==r)&&(r=a),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,fc)!==null}intersectTriangle(e,t,r,i,s){vC.subVectors(t,e),qw.subVectors(r,e),xC.crossVectors(vC,qw);let o=this.direction.dot(xC),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;yu.subVectors(this.origin,e);const l=a*this.direction.dot(qw.crossVectors(yu,qw));if(l<0)return null;const c=a*this.direction.dot(vC.cross(yu));if(c<0||l+c>o)return null;const u=-a*yu.dot(xC);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class vn{constructor(e,t,r,i,s,o,a,l,c,u,d,h,f,p,x,v){vn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,o,a,l,c,u,d,h,f,p,x,v)}set(e,t,r,i,s,o,a,l,c,u,d,h,f,p,x,v){const y=this.elements;return y[0]=e,y[4]=t,y[8]=r,y[12]=i,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=c,y[6]=u,y[10]=d,y[14]=h,y[3]=f,y[7]=p,y[11]=x,y[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new vn().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/pp.setFromMatrixColumn(e,0).length(),s=1/pp.setFromMatrixColumn(e,1).length(),o=1/pp.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,o=Math.cos(r),a=Math.sin(r),l=Math.cos(i),c=Math.sin(i),u=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){const h=o*u,f=o*d,p=a*u,x=a*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=f+p*c,t[5]=h-x*c,t[9]=-a*l,t[2]=x-h*c,t[6]=p+f*c,t[10]=o*l}else if(e.order==="YXZ"){const h=l*u,f=l*d,p=c*u,x=c*d;t[0]=h+x*a,t[4]=p*a-f,t[8]=o*c,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=x+h*a,t[10]=o*l}else if(e.order==="ZXY"){const h=l*u,f=l*d,p=c*u,x=c*d;t[0]=h-x*a,t[4]=-o*d,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=x-h*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const h=o*u,f=o*d,p=a*u,x=a*d;t[0]=l*u,t[4]=p*c-f,t[8]=h*c+x,t[1]=l*d,t[5]=x*c+h,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const h=o*l,f=o*c,p=a*l,x=a*c;t[0]=l*u,t[4]=x-h*d,t[8]=p*d+f,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*d+p,t[10]=h-x*d}else if(e.order==="XZY"){const h=o*l,f=o*c,p=a*l,x=a*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=h*d+x,t[5]=o*u,t[9]=f*d-p,t[2]=p*d-f,t[6]=a*u,t[10]=x*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Mce,e,Ace)}lookAt(e,t,r){const i=this.elements;return Ro.subVectors(e,t),Ro.lengthSq()===0&&(Ro.z=1),Ro.normalize(),vu.crossVectors(r,Ro),vu.lengthSq()===0&&(Math.abs(r.z)===1?Ro.x+=1e-4:Ro.z+=1e-4,Ro.normalize(),vu.crossVectors(r,Ro)),vu.normalize(),Xw.crossVectors(Ro,vu),i[0]=vu.x,i[4]=Xw.x,i[8]=Ro.x,i[1]=vu.y,i[5]=Xw.y,i[9]=Ro.y,i[2]=vu.z,i[6]=Xw.z,i[10]=Ro.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[4],l=r[8],c=r[12],u=r[1],d=r[5],h=r[9],f=r[13],p=r[2],x=r[6],v=r[10],y=r[14],b=r[3],S=r[7],_=r[11],T=r[15],M=i[0],k=i[4],P=i[8],z=i[12],I=i[1],L=i[5],W=i[9],q=i[13],$=i[2],ne=i[6],Y=i[10],we=i[14],H=i[3],X=i[7],oe=i[11],ve=i[15];return s[0]=o*M+a*I+l*$+c*H,s[4]=o*k+a*L+l*ne+c*X,s[8]=o*P+a*W+l*Y+c*oe,s[12]=o*z+a*q+l*we+c*ve,s[1]=u*M+d*I+h*$+f*H,s[5]=u*k+d*L+h*ne+f*X,s[9]=u*P+d*W+h*Y+f*oe,s[13]=u*z+d*q+h*we+f*ve,s[2]=p*M+x*I+v*$+y*H,s[6]=p*k+x*L+v*ne+y*X,s[10]=p*P+x*W+v*Y+y*oe,s[14]=p*z+x*q+v*we+y*ve,s[3]=b*M+S*I+_*$+T*H,s[7]=b*k+S*L+_*ne+T*X,s[11]=b*P+S*W+_*Y+T*oe,s[15]=b*z+S*q+_*we+T*ve,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],f=e[14],p=e[3],x=e[7],v=e[11],y=e[15];return p*(+s*l*d-i*c*d-s*a*h+r*c*h+i*a*f-r*l*f)+x*(+t*l*f-t*c*h+s*o*h-i*o*f+i*c*u-s*l*u)+v*(+t*c*d-t*a*f-s*o*d+r*o*f+s*a*u-r*c*u)+y*(-i*a*u-t*l*d+t*a*h+i*o*d-r*o*h+r*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],x=e[13],v=e[14],y=e[15],b=d*v*c-x*h*c+x*l*f-a*v*f-d*l*y+a*h*y,S=p*h*c-u*v*c-p*l*f+o*v*f+u*l*y-o*h*y,_=u*x*c-p*d*c+p*a*f-o*x*f-u*a*y+o*d*y,T=p*d*l-u*x*l-p*a*h+o*x*h+u*a*v-o*d*v,M=t*b+r*S+i*_+s*T;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const k=1/M;return e[0]=b*k,e[1]=(x*h*s-d*v*s-x*i*f+r*v*f+d*i*y-r*h*y)*k,e[2]=(a*v*s-x*l*s+x*i*c-r*v*c-a*i*y+r*l*y)*k,e[3]=(d*l*s-a*h*s-d*i*c+r*h*c+a*i*f-r*l*f)*k,e[4]=S*k,e[5]=(u*v*s-p*h*s+p*i*f-t*v*f-u*i*y+t*h*y)*k,e[6]=(p*l*s-o*v*s-p*i*c+t*v*c+o*i*y-t*l*y)*k,e[7]=(o*h*s-u*l*s+u*i*c-t*h*c-o*i*f+t*l*f)*k,e[8]=_*k,e[9]=(p*d*s-u*x*s-p*r*f+t*x*f+u*r*y-t*d*y)*k,e[10]=(o*x*s-p*a*s+p*r*c-t*x*c-o*r*y+t*a*y)*k,e[11]=(u*a*s-o*d*s-u*r*c+t*d*c+o*r*f-t*a*f)*k,e[12]=T*k,e[13]=(u*x*i-p*d*i+p*r*h-t*x*h-u*r*v+t*d*v)*k,e[14]=(p*a*i-o*x*i-p*r*l+t*x*l+o*r*v-t*a*v)*k,e[15]=(o*d*i-u*a*i+u*r*l-t*d*l-o*r*h+t*a*h)*k,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+r,c*a-i*l,c*l+i*a,0,c*a+i*l,u*a+r,u*l-i*o,0,c*l-i*a,u*l+i*o,s*l*l+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,o){return this.set(1,r,s,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,d=a+a,h=s*c,f=s*u,p=s*d,x=o*u,v=o*d,y=a*d,b=l*c,S=l*u,_=l*d,T=r.x,M=r.y,k=r.z;return i[0]=(1-(x+y))*T,i[1]=(f+_)*T,i[2]=(p-S)*T,i[3]=0,i[4]=(f-_)*M,i[5]=(1-(h+y))*M,i[6]=(v+b)*M,i[7]=0,i[8]=(p+S)*k,i[9]=(v-b)*k,i[10]=(1-(h+x))*k,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=pp.set(i[0],i[1],i[2]).length();const o=pp.set(i[4],i[5],i[6]).length(),a=pp.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],Oa.copy(this);const c=1/s,u=1/o,d=1/a;return Oa.elements[0]*=c,Oa.elements[1]*=c,Oa.elements[2]*=c,Oa.elements[4]*=u,Oa.elements[5]*=u,Oa.elements[6]*=u,Oa.elements[8]*=d,Oa.elements[9]*=d,Oa.elements[10]*=d,t.setFromRotationMatrix(Oa),r.x=s,r.y=o,r.z=a,this}makePerspective(e,t,r,i,s,o,a=Il){const l=this.elements,c=2*s/(t-e),u=2*s/(r-i),d=(t+e)/(t-e),h=(r+i)/(r-i);let f,p;if(a===Il)f=-(o+s)/(o-s),p=-2*o*s/(o-s);else if(a===f0)f=-o/(o-s),p=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=u,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,r,i,s,o,a=Il){const l=this.elements,c=1/(t-e),u=1/(r-i),d=1/(o-s),h=(t+e)*c,f=(r+i)*u;let p,x;if(a===Il)p=(o+s)*d,x=-2*d;else if(a===f0)p=s*d,x=-1*d;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-h,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-f,l[2]=0,l[6]=0,l[10]=x,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const pp=new ie,Oa=new vn,Mce=new ie(0,0,0),Ace=new ie(1,1,1),vu=new ie,Xw=new ie,Ro=new ie,cO=new vn,uO=new Ts;class Eg{constructor(e=0,t=0,r=0,i=Eg.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],o=i[4],a=i[8],l=i[1],c=i[5],u=i[9],d=i[2],h=i[6],f=i[10];switch(t){case"XYZ":this._y=Math.asin(di(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(h,c),this._z=0);break;case"YXZ":this._x=Math.asin(-di(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(di(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-di(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(di(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-di(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return cO.makeRotationFromQuaternion(e),this.setFromRotationMatrix(cO,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return uO.setFromEuler(this),this.setFromQuaternion(uO,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Eg.DEFAULT_ORDER="XYZ";class Hh{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Nce=0;const dO=new ie,mp=new Ts,pc=new vn,Kw=new ie,wy=new ie,kce=new ie,Ice=new Ts,hO=new ie(1,0,0),fO=new ie(0,1,0),pO=new ie(0,0,1),Rce={type:"added"},Pce={type:"removed"};class cr extends Jl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Nce++}),this.uuid=Ho(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=cr.DEFAULT_UP.clone();const e=new ie,t=new Eg,r=new Ts,i=new ie(1,1,1);function s(){r.setFromEuler(t,!1)}function o(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new vn},normalMatrix:{value:new Vn}}),this.matrix=new vn,this.matrixWorld=new vn,this.matrixAutoUpdate=cr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=cr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Hh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return mp.setFromAxisAngle(e,t),this.quaternion.multiply(mp),this}rotateOnWorldAxis(e,t){return mp.setFromAxisAngle(e,t),this.quaternion.premultiply(mp),this}rotateX(e){return this.rotateOnAxis(hO,e)}rotateY(e){return this.rotateOnAxis(fO,e)}rotateZ(e){return this.rotateOnAxis(pO,e)}translateOnAxis(e,t){return dO.copy(e).applyQuaternion(this.quaternion),this.position.add(dO.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(hO,e)}translateY(e){return this.translateOnAxis(fO,e)}translateZ(e){return this.translateOnAxis(pO,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(pc.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?Kw.copy(e):Kw.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),wy.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?pc.lookAt(wy,Kw,this.up):pc.lookAt(Kw,wy,this.up),this.quaternion.setFromRotationMatrix(pc),i&&(pc.extractRotation(i.matrixWorld),mp.setFromRotationMatrix(pc),this.quaternion.premultiply(mp.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Rce)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Pce)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),pc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),pc.multiply(e.parent.matrixWorld)),e.applyMatrix4(pc),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const o=this.children[r].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(wy,e,kce),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(wy,Ice,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++){const s=t[r];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++){const a=i[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const d=l[c];s(e.shapes,d)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));i.material=a}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];i.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),d=o(e.shapes),h=o(e.skeletons),f=o(e.animations),p=o(e.nodes);a.length>0&&(r.geometries=a),l.length>0&&(r.materials=l),c.length>0&&(r.textures=c),u.length>0&&(r.images=u),d.length>0&&(r.shapes=d),h.length>0&&(r.skeletons=h),f.length>0&&(r.animations=f),p.length>0&&(r.nodes=p)}return r.object=i,r;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}cr.DEFAULT_UP=new ie(0,1,0);cr.DEFAULT_MATRIX_AUTO_UPDATE=!0;cr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Fa=new ie,mc=new ie,wC=new ie,gc=new ie,gp=new ie,yp=new ie,mO=new ie,bC=new ie,SC=new ie,_C=new ie;class Uo{constructor(e=new ie,t=new ie,r=new ie){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),Fa.subVectors(e,t),i.cross(Fa);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){Fa.subVectors(i,t),mc.subVectors(r,t),wC.subVectors(e,t);const o=Fa.dot(Fa),a=Fa.dot(mc),l=Fa.dot(wC),c=mc.dot(mc),u=mc.dot(wC),d=o*c-a*a;if(d===0)return s.set(0,0,0),null;const h=1/d,f=(c*l-a*u)*h,p=(o*u-a*l)*h;return s.set(1-f-p,p,f)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,gc)===null?!1:gc.x>=0&&gc.y>=0&&gc.x+gc.y<=1}static getInterpolation(e,t,r,i,s,o,a,l){return this.getBarycoord(e,t,r,i,gc)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,gc.x),l.addScaledVector(o,gc.y),l.addScaledVector(a,gc.z),l)}static isFrontFacing(e,t,r,i){return Fa.subVectors(r,t),mc.subVectors(e,t),Fa.cross(mc).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Fa.subVectors(this.c,this.b),mc.subVectors(this.a,this.b),Fa.cross(mc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Uo.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Uo.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,i,s){return Uo.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return Uo.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Uo.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let o,a;gp.subVectors(i,r),yp.subVectors(s,r),bC.subVectors(e,r);const l=gp.dot(bC),c=yp.dot(bC);if(l<=0&&c<=0)return t.copy(r);SC.subVectors(e,i);const u=gp.dot(SC),d=yp.dot(SC);if(u>=0&&d<=u)return t.copy(i);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(r).addScaledVector(gp,o);_C.subVectors(e,s);const f=gp.dot(_C),p=yp.dot(_C);if(p>=0&&f<=p)return t.copy(s);const x=f*c-l*p;if(x<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(r).addScaledVector(yp,a);const v=u*p-f*d;if(v<=0&&d-u>=0&&f-p>=0)return mO.subVectors(s,i),a=(d-u)/(d-u+(f-p)),t.copy(i).addScaledVector(mO,a);const y=1/(v+x+h);return o=x*y,a=h*y,t.copy(r).addScaledVector(gp,o).addScaledVector(yp,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const hW={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},xu={h:0,s:0,l:0},Yw={h:0,s:0,l:0};function EC(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class Ut{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ai){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,gr.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=gr.workingColorSpace){return this.r=e,this.g=t,this.b=r,gr.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=gr.workingColorSpace){if(e=YI(e,1),t=di(t,0,1),r=di(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,o=2*r-s;this.r=EC(o,s,e+1/3),this.g=EC(o,s,e),this.b=EC(o,s,e-1/3)}return gr.toWorkingColorSpace(this,i),this}setStyle(e,t=Ai){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ai){const r=hW[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=_m(e.r),this.g=_m(e.g),this.b=_m(e.b),this}copyLinearToSRGB(e){return this.r=hC(e.r),this.g=hC(e.g),this.b=hC(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ai){return gr.fromWorkingColorSpace(ys.copy(this),e),Math.round(di(ys.r*255,0,255))*65536+Math.round(di(ys.g*255,0,255))*256+Math.round(di(ys.b*255,0,255))}getHexString(e=Ai){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=gr.workingColorSpace){gr.fromWorkingColorSpace(ys.copy(this),t);const r=ys.r,i=ys.g,s=ys.b,o=Math.max(r,i,s),a=Math.min(r,i,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const d=o-a;switch(c=u<=.5?d/(o+a):d/(2-o-a),o){case r:l=(i-s)/d+(i<s?6:0);break;case i:l=(s-r)/d+2;break;case s:l=(r-i)/d+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=gr.workingColorSpace){return gr.fromWorkingColorSpace(ys.copy(this),t),e.r=ys.r,e.g=ys.g,e.b=ys.b,e}getStyle(e=Ai){gr.fromWorkingColorSpace(ys.copy(this),e);const t=ys.r,r=ys.g,i=ys.b;return e!==Ai?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,t,r){return this.getHSL(xu),this.setHSL(xu.h+e,xu.s+t,xu.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(xu),e.getHSL(Yw);const r=cv(xu.h,Yw.h,t),i=cv(xu.s,Yw.s,t),s=cv(xu.l,Yw.l,t);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*r+s[6]*i,this.g=s[1]*t+s[4]*r+s[7]*i,this.b=s[2]*t+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ys=new Ut;Ut.NAMES=hW;let Dce=0;class ks extends Jl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Dce++}),this.uuid=Ho(),this.name="",this.type="Material",this.blending=jh,this.side=Wc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=xS,this.blendDst=wS,this.blendEquation=Du,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ut(0,0,0),this.blendAlpha=0,this.depthFunc=r0,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=RA,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=hh,this.stencilZFail=hh,this.stencilZPass=hh,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==jh&&(r.blending=this.blending),this.side!==Wc&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==xS&&(r.blendSrc=this.blendSrc),this.blendDst!==wS&&(r.blendDst=this.blendDst),this.blendEquation!==Du&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==r0&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==RA&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==hh&&(r.stencilFail=this.stencilFail),this.stencilZFail!==hh&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==hh&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=i(e.textures),o=i(e.images);s.length>0&&(r.textures=s),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class ec extends ks{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ix,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ec=Lce();function Lce(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(r[l]=0,r[l|256]=32768,i[l]=24,i[l|256]=24):c<-14?(r[l]=1024>>-c-14,r[l|256]=1024>>-c-14|32768,i[l]=-c-1,i[l|256]=-c-1):c<=15?(r[l]=c+15<<10,r[l|256]=c+15<<10|32768,i[l]=13,i[l|256]=13):c<128?(r[l]=31744,r[l|256]=64512,i[l]=24,i[l|256]=24):(r[l]=31744,r[l|256]=64512,i[l]=13,i[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;!(c&8388608);)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:o,offsetTable:a}}function ho(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=di(n,-65504,65504),Ec.floatView[0]=n;const e=Ec.uint32View[0],t=e>>23&511;return Ec.baseTable[t]+((e&8388607)>>Ec.shiftTable[t])}function Hy(n){const e=n>>10;return Ec.uint32View[0]=Ec.mantissaTable[Ec.offsetTable[e]+(n&1023)]+Ec.exponentTable[e],Ec.floatView[0]}const Ih={toHalfFloat:ho,fromHalfFloat:Hy},Ti=new ie,Zw=new Ze;class pr{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=h0,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=fi,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return Wh("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)Zw.fromBufferAttribute(this,t),Zw.applyMatrix3(e),this.setXY(t,Zw.x,Zw.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Ti.fromBufferAttribute(this,t),Ti.applyMatrix3(e),this.setXYZ(t,Ti.x,Ti.y,Ti.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Ti.fromBufferAttribute(this,t),Ti.applyMatrix4(e),this.setXYZ(t,Ti.x,Ti.y,Ti.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Ti.fromBufferAttribute(this,t),Ti.applyNormalMatrix(e),this.setXYZ(t,Ti.x,Ti.y,Ti.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Ti.fromBufferAttribute(this,t),Ti.transformDirection(e),this.setXYZ(t,Ti.x,Ti.y,Ti.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=Ws(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Tn(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Ws(t,this.array)),t}setX(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Ws(t,this.array)),t}setY(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Ws(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Ws(t,this.array)),t}setW(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),r=Tn(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),r=Tn(r,this.array),i=Tn(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),r=Tn(r,this.array),i=Tn(i,this.array),s=Tn(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==h0&&(e.usage=this.usage),e}}class Oce extends pr{constructor(e,t,r){super(new Int8Array(e),t,r)}}class Fce extends pr{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class zce extends pr{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class Uce extends pr{constructor(e,t,r){super(new Int16Array(e),t,r)}}class JI extends pr{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class Bce extends pr{constructor(e,t,r){super(new Int32Array(e),t,r)}}class eR extends pr{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class $ce extends pr{constructor(e,t,r){super(new Uint16Array(e),t,r),this.isFloat16BufferAttribute=!0}getX(e){let t=Hy(this.array[e*this.itemSize]);return this.normalized&&(t=Ws(t,this.array)),t}setX(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize]=ho(t),this}getY(e){let t=Hy(this.array[e*this.itemSize+1]);return this.normalized&&(t=Ws(t,this.array)),t}setY(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+1]=ho(t),this}getZ(e){let t=Hy(this.array[e*this.itemSize+2]);return this.normalized&&(t=Ws(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+2]=ho(t),this}getW(e){let t=Hy(this.array[e*this.itemSize+3]);return this.normalized&&(t=Ws(t,this.array)),t}setW(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+3]=ho(t),this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),r=Tn(r,this.array)),this.array[e+0]=ho(t),this.array[e+1]=ho(r),this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),r=Tn(r,this.array),i=Tn(i,this.array)),this.array[e+0]=ho(t),this.array[e+1]=ho(r),this.array[e+2]=ho(i),this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),r=Tn(r,this.array),i=Tn(i,this.array),s=Tn(s,this.array)),this.array[e+0]=ho(t),this.array[e+1]=ho(r),this.array[e+2]=ho(i),this.array[e+3]=ho(s),this}}class Qt extends pr{constructor(e,t,r){super(new Float32Array(e),t,r)}}class jce extends pr{constructor(e,t,r){super(new Float64Array(e),t,r)}}let Vce=0;const ha=new vn,CC=new cr,vp=new ie,Po=new qs,by=new qs,qi=new ie;class Pn extends Jl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Vce++}),this.uuid=Ho(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(cW(e)?eR:JI)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new Vn().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ha.makeRotationFromQuaternion(e),this.applyMatrix4(ha),this}rotateX(e){return ha.makeRotationX(e),this.applyMatrix4(ha),this}rotateY(e){return ha.makeRotationY(e),this.applyMatrix4(ha),this}rotateZ(e){return ha.makeRotationZ(e),this.applyMatrix4(ha),this}translate(e,t,r){return ha.makeTranslation(e,t,r),this.applyMatrix4(ha),this}scale(e,t,r){return ha.makeScale(e,t,r),this.applyMatrix4(ha),this}lookAt(e){return CC.lookAt(e),CC.updateMatrix(),this.applyMatrix4(CC.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(vp).negate(),this.translate(vp.x,vp.y,vp.z),this}setFromPoints(e){const t=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Qt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new qs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new ie(-1/0,-1/0,-1/0),new ie(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];Po.setFromBufferAttribute(s),this.morphTargetsRelative?(qi.addVectors(this.boundingBox.min,Po.min),this.boundingBox.expandByPoint(qi),qi.addVectors(this.boundingBox.max,Po.max),this.boundingBox.expandByPoint(qi)):(this.boundingBox.expandByPoint(Po.min),this.boundingBox.expandByPoint(Po.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ms);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new ie,1/0);return}if(e){const r=this.boundingSphere.center;if(Po.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];by.setFromBufferAttribute(a),this.morphTargetsRelative?(qi.addVectors(Po.min,by.min),Po.expandByPoint(qi),qi.addVectors(Po.max,by.max),Po.expandByPoint(qi)):(Po.expandByPoint(by.min),Po.expandByPoint(by.max))}Po.getCenter(r);let i=0;for(let s=0,o=e.count;s<o;s++)qi.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(qi));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)qi.fromBufferAttribute(a,c),l&&(vp.fromBufferAttribute(e,c),qi.add(vp)),i=Math.max(i,r.distanceToSquared(qi))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,i=t.position.array,s=t.normal.array,o=t.uv.array,a=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new pr(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let I=0;I<a;I++)c[I]=new ie,u[I]=new ie;const d=new ie,h=new ie,f=new ie,p=new Ze,x=new Ze,v=new Ze,y=new ie,b=new ie;function S(I,L,W){d.fromArray(i,I*3),h.fromArray(i,L*3),f.fromArray(i,W*3),p.fromArray(o,I*2),x.fromArray(o,L*2),v.fromArray(o,W*2),h.sub(d),f.sub(d),x.sub(p),v.sub(p);const q=1/(x.x*v.y-v.x*x.y);isFinite(q)&&(y.copy(h).multiplyScalar(v.y).addScaledVector(f,-x.y).multiplyScalar(q),b.copy(f).multiplyScalar(x.x).addScaledVector(h,-v.x).multiplyScalar(q),c[I].add(y),c[L].add(y),c[W].add(y),u[I].add(b),u[L].add(b),u[W].add(b))}let _=this.groups;_.length===0&&(_=[{start:0,count:r.length}]);for(let I=0,L=_.length;I<L;++I){const W=_[I],q=W.start,$=W.count;for(let ne=q,Y=q+$;ne<Y;ne+=3)S(r[ne+0],r[ne+1],r[ne+2])}const T=new ie,M=new ie,k=new ie,P=new ie;function z(I){k.fromArray(s,I*3),P.copy(k);const L=c[I];T.copy(L),T.sub(k.multiplyScalar(k.dot(L))).normalize(),M.crossVectors(P,L);const q=M.dot(u[I])<0?-1:1;l[I*4]=T.x,l[I*4+1]=T.y,l[I*4+2]=T.z,l[I*4+3]=q}for(let I=0,L=_.length;I<L;++I){const W=_[I],q=W.start,$=W.count;for(let ne=q,Y=q+$;ne<Y;ne+=3)z(r[ne+0]),z(r[ne+1]),z(r[ne+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new pr(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let h=0,f=r.count;h<f;h++)r.setXYZ(h,0,0,0);const i=new ie,s=new ie,o=new ie,a=new ie,l=new ie,c=new ie,u=new ie,d=new ie;if(e)for(let h=0,f=e.count;h<f;h+=3){const p=e.getX(h+0),x=e.getX(h+1),v=e.getX(h+2);i.fromBufferAttribute(t,p),s.fromBufferAttribute(t,x),o.fromBufferAttribute(t,v),u.subVectors(o,s),d.subVectors(i,s),u.cross(d),a.fromBufferAttribute(r,p),l.fromBufferAttribute(r,x),c.fromBufferAttribute(r,v),a.add(u),l.add(u),c.add(u),r.setXYZ(p,a.x,a.y,a.z),r.setXYZ(x,l.x,l.y,l.z),r.setXYZ(v,c.x,c.y,c.z)}else for(let h=0,f=t.count;h<f;h+=3)i.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),u.subVectors(o,s),d.subVectors(i,s),u.cross(d),r.setXYZ(h+0,u.x,u.y,u.z),r.setXYZ(h+1,u.x,u.y,u.z),r.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)qi.fromBufferAttribute(e,t),qi.normalize(),e.setXYZ(t,qi.x,qi.y,qi.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,h=new c.constructor(l.length*u);let f=0,p=0;for(let x=0,v=l.length;x<v;x++){a.isInterleavedBufferAttribute?f=l[x]*a.data.stride+a.offset:f=l[x]*u;for(let y=0;y<u;y++)h[p++]=c[f++]}return new pr(h,u,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Pn,r=this.index.array,i=this.attributes;for(const a in i){const l=i[a],c=e(l,r);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){const h=c[u],f=e(h,r);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const l in r){const c=r[l];e.data.attributes[l]=c.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++){const f=c[d];u.push(f.toJSON(e.data))}u.length>0&&(i[l]=u,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const i=e.attributes;for(const c in i){const u=i[c];this.setAttribute(c,u.clone(t))}const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const gO=new vn,Jd=new Mf,Qw=new Ms,yO=new ie,xp=new ie,wp=new ie,bp=new ie,TC=new ie,Jw=new ie,e1=new Ze,t1=new Ze,n1=new Ze,vO=new ie,xO=new ie,wO=new ie,r1=new ie,i1=new ie;class ri extends cr{constructor(e=new Pn,t=new ec){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,o=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const a=this.morphTargetInfluences;if(s&&a){Jw.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l],d=s[l];u!==0&&(TC.fromBufferAttribute(d,e),o?Jw.addScaledVector(TC,u):Jw.addScaledVector(TC.sub(t),u))}t.add(Jw)}return t}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),Qw.copy(r.boundingSphere),Qw.applyMatrix4(s),Jd.copy(e.ray).recast(e.near),!(Qw.containsPoint(Jd.origin)===!1&&(Jd.intersectSphere(Qw,yO)===null||Jd.origin.distanceToSquared(yO)>(e.far-e.near)**2))&&(gO.copy(s).invert(),Jd.copy(e.ray).applyMatrix4(gO),!(r.boundingBox!==null&&Jd.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,Jd)))}_computeIntersections(e,t,r){let i;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,h=s.groups,f=s.drawRange;if(a!==null)if(Array.isArray(o))for(let p=0,x=h.length;p<x;p++){const v=h[p],y=o[v.materialIndex],b=Math.max(v.start,f.start),S=Math.min(a.count,Math.min(v.start+v.count,f.start+f.count));for(let _=b,T=S;_<T;_+=3){const M=a.getX(_),k=a.getX(_+1),P=a.getX(_+2);i=s1(this,y,e,r,c,u,d,M,k,P),i&&(i.faceIndex=Math.floor(_/3),i.face.materialIndex=v.materialIndex,t.push(i))}}else{const p=Math.max(0,f.start),x=Math.min(a.count,f.start+f.count);for(let v=p,y=x;v<y;v+=3){const b=a.getX(v),S=a.getX(v+1),_=a.getX(v+2);i=s1(this,o,e,r,c,u,d,b,S,_),i&&(i.faceIndex=Math.floor(v/3),t.push(i))}}else if(l!==void 0)if(Array.isArray(o))for(let p=0,x=h.length;p<x;p++){const v=h[p],y=o[v.materialIndex],b=Math.max(v.start,f.start),S=Math.min(l.count,Math.min(v.start+v.count,f.start+f.count));for(let _=b,T=S;_<T;_+=3){const M=_,k=_+1,P=_+2;i=s1(this,y,e,r,c,u,d,M,k,P),i&&(i.faceIndex=Math.floor(_/3),i.face.materialIndex=v.materialIndex,t.push(i))}}else{const p=Math.max(0,f.start),x=Math.min(l.count,f.start+f.count);for(let v=p,y=x;v<y;v+=3){const b=v,S=v+1,_=v+2;i=s1(this,o,e,r,c,u,d,b,S,_),i&&(i.faceIndex=Math.floor(v/3),t.push(i))}}}}function Wce(n,e,t,r,i,s,o,a){let l;if(e.side===Cs?l=r.intersectTriangle(o,s,i,!0,a):l=r.intersectTriangle(i,s,o,e.side===Wc,a),l===null)return null;i1.copy(a),i1.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(i1);return c<t.near||c>t.far?null:{distance:c,point:i1.clone(),object:n}}function s1(n,e,t,r,i,s,o,a,l,c){n.getVertexPosition(a,xp),n.getVertexPosition(l,wp),n.getVertexPosition(c,bp);const u=Wce(n,e,t,r,xp,wp,bp,r1);if(u){i&&(e1.fromBufferAttribute(i,a),t1.fromBufferAttribute(i,l),n1.fromBufferAttribute(i,c),u.uv=Uo.getInterpolation(r1,xp,wp,bp,e1,t1,n1,new Ze)),s&&(e1.fromBufferAttribute(s,a),t1.fromBufferAttribute(s,l),n1.fromBufferAttribute(s,c),u.uv1=Uo.getInterpolation(r1,xp,wp,bp,e1,t1,n1,new Ze),u.uv2=u.uv1),o&&(vO.fromBufferAttribute(o,a),xO.fromBufferAttribute(o,l),wO.fromBufferAttribute(o,c),u.normal=Uo.getInterpolation(r1,xp,wp,bp,vO,xO,wO,new ie),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const d={a,b:l,c,normal:new ie,materialIndex:0};Uo.getNormal(xp,wp,bp,d.normal),u.face=d}return u}class Af extends Pn{constructor(e=1,t=1,r=1,i=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:o};const a=this;i=Math.floor(i),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],d=[];let h=0,f=0;p("z","y","x",-1,-1,r,t,e,o,s,0),p("z","y","x",1,-1,r,t,-e,o,s,1),p("x","z","y",1,1,e,r,t,i,o,2),p("x","z","y",1,-1,e,r,-t,i,o,3),p("x","y","z",1,-1,e,t,r,i,s,4),p("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(l),this.setAttribute("position",new Qt(c,3)),this.setAttribute("normal",new Qt(u,3)),this.setAttribute("uv",new Qt(d,2));function p(x,v,y,b,S,_,T,M,k,P,z){const I=_/k,L=T/P,W=_/2,q=T/2,$=M/2,ne=k+1,Y=P+1;let we=0,H=0;const X=new ie;for(let oe=0;oe<Y;oe++){const ve=oe*L-q;for(let Te=0;Te<ne;Te++){const Xe=Te*I-W;X[x]=Xe*b,X[v]=ve*S,X[y]=$,c.push(X.x,X.y,X.z),X[x]=0,X[v]=0,X[y]=M>0?1:-1,u.push(X.x,X.y,X.z),d.push(Te/k),d.push(1-oe/P),we+=1}}for(let oe=0;oe<P;oe++)for(let ve=0;ve<k;ve++){const Te=h+ve+ne*oe,Xe=h+ve+ne*(oe+1),_e=h+(ve+1)+ne*(oe+1),Ue=h+(ve+1)+ne*oe;l.push(Te,Xe,Ue),l.push(Xe,_e,Ue),H+=6}a.addGroup(f,H,z),f+=H,h+=we}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Af(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Hm(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function Us(n){const e={};for(let t=0;t<n.length;t++){const r=Hm(n[t]);for(const i in r)e[i]=r[i]}return e}function Hce(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function fW(n){return n.getRenderTarget()===null?n.outputColorSpace:gr.workingColorSpace}const tR={clone:Hm,merge:Us};var Gce=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,qce=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ys extends ks{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Gce,this.fragmentShader=qce,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Hm(e.uniforms),this.uniformsGroups=Hce(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class ox extends cr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new vn,this.projectionMatrix=new vn,this.projectionMatrixInverse=new vn,this.coordinateSystem=Il}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const wu=new ie,bO=new Ze,SO=new Ze;let hi=class extends ox{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Wm*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Vh*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Wm*2*Math.atan(Math.tan(Vh*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){wu.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(wu.x,wu.y).multiplyScalar(-e/wu.z),wu.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(wu.x,wu.y).multiplyScalar(-e/wu.z)}getViewSize(e,t){return this.getViewBounds(e,bO,SO),t.subVectors(SO,bO)}setViewOffset(e,t,r,i,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Vh*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*i/l,t-=o.offsetY*r/c,i*=o.width/l,r*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const Sp=-90,_p=1;class pW extends cr{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new hi(Sp,_p,e,t);i.layers=this.layers,this.add(i);const s=new hi(Sp,_p,e,t);s.layers=this.layers,this.add(s);const o=new hi(Sp,_p,e,t);o.layers=this.layers,this.add(o);const a=new hi(Sp,_p,e,t);a.layers=this.layers,this.add(a);const l=new hi(Sp,_p,e,t);l.layers=this.layers,this.add(l);const c=new hi(Sp,_p,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,i,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===Il)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===f0)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,u]=this.children,d=e.getRenderTarget(),h=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const x=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,s),e.setRenderTarget(r,1,i),e.render(t,o),e.setRenderTarget(r,2,i),e.render(t,a),e.setRenderTarget(r,3,i),e.render(t,l),e.setRenderTarget(r,4,i),e.render(t,c),r.texture.generateMipmaps=x,e.setRenderTarget(r,5,i),e.render(t,u),e.setRenderTarget(d,h,f),e.xr.enabled=p,r.texture.needsPMREMUpdate=!0}}class ax extends qr{constructor(e,t,r,i,s,o,a,l,c,u){e=e!==void 0?e:[],t=t!==void 0?t:ql,super(e,t,r,i,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class nR extends Eo{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];t.encoding!==void 0&&(Wh("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Zu?Ai:zo),this.texture=new ax(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Jn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Af(5,5,5),s=new Ys({name:"CubemapFromEquirect",uniforms:Hm(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Cs,blending:zl});s.uniforms.tEquirect.value=t;const o=new ri(i,s),a=t.minFilter;return t.minFilter===Nl&&(t.minFilter=Jn),new pW(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,r,i){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,r,i);e.setRenderTarget(s)}}const MC=new ie,Xce=new ie,Kce=new Vn;class Wa{constructor(e=new ie(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=MC.subVectors(r,t).cross(Xce.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(MC),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||Kce.getNormalMatrix(e),i=this.coplanarPoint(MC).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const eh=new Ms,o1=new ie;class lx{constructor(e=new Wa,t=new Wa,r=new Wa,i=new Wa,s=new Wa,o=new Wa){this.planes=[e,t,r,i,s,o]}set(e,t,r,i,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(i),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=Il){const r=this.planes,i=e.elements,s=i[0],o=i[1],a=i[2],l=i[3],c=i[4],u=i[5],d=i[6],h=i[7],f=i[8],p=i[9],x=i[10],v=i[11],y=i[12],b=i[13],S=i[14],_=i[15];if(r[0].setComponents(l-s,h-c,v-f,_-y).normalize(),r[1].setComponents(l+s,h+c,v+f,_+y).normalize(),r[2].setComponents(l+o,h+u,v+p,_+b).normalize(),r[3].setComponents(l-o,h-u,v-p,_-b).normalize(),r[4].setComponents(l-a,h-d,v-x,_-S).normalize(),t===Il)r[5].setComponents(l+a,h+d,v+x,_+S).normalize();else if(t===f0)r[5].setComponents(a,d,x,S).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),eh.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),eh.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(eh)}intersectsSprite(e){return eh.center.set(0,0,0),eh.radius=.7071067811865476,eh.applyMatrix4(e.matrixWorld),this.intersectsSphere(eh)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(o1.x=i.normal.x>0?e.max.x:e.min.x,o1.y=i.normal.y>0?e.max.y:e.min.y,o1.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(o1)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function mW(){let n=null,e=!1,t=null,r=null;function i(s,o){t(s,o),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function Yce(n,e){const t=e.isWebGL2,r=new WeakMap;function i(c,u){const d=c.array,h=c.usage,f=d.byteLength,p=n.createBuffer();n.bindBuffer(u,p),n.bufferData(u,d,h),c.onUploadCallback();let x;if(d instanceof Float32Array)x=n.FLOAT;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(t)x=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else x=n.UNSIGNED_SHORT;else if(d instanceof Int16Array)x=n.SHORT;else if(d instanceof Uint32Array)x=n.UNSIGNED_INT;else if(d instanceof Int32Array)x=n.INT;else if(d instanceof Int8Array)x=n.BYTE;else if(d instanceof Uint8Array)x=n.UNSIGNED_BYTE;else if(d instanceof Uint8ClampedArray)x=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:p,type:x,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version,size:f}}function s(c,u,d){const h=u.array,f=u._updateRange,p=u.updateRanges;if(n.bindBuffer(d,c),f.count===-1&&p.length===0&&n.bufferSubData(d,0,h),p.length!==0){for(let x=0,v=p.length;x<v;x++){const y=p[x];t?n.bufferSubData(d,y.start*h.BYTES_PER_ELEMENT,h,y.start,y.count):n.bufferSubData(d,y.start*h.BYTES_PER_ELEMENT,h.subarray(y.start,y.start+y.count))}u.clearUpdateRanges()}f.count!==-1&&(t?n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),r.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=r.get(c);u&&(n.deleteBuffer(u.buffer),r.delete(c))}function l(c,u){if(c.isGLBufferAttribute){const h=r.get(c);(!h||h.version<c.version)&&r.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const d=r.get(c);if(d===void 0)r.set(c,i(c,u));else if(d.version<c.version){if(d.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(d.buffer,c,u),d.version=c.version}}return{get:o,remove:a,update:l}}class Ad extends Pn{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,o=t/2,a=Math.floor(r),l=Math.floor(i),c=a+1,u=l+1,d=e/a,h=t/l,f=[],p=[],x=[],v=[];for(let y=0;y<u;y++){const b=y*h-o;for(let S=0;S<c;S++){const _=S*d-s;p.push(_,-b,0),x.push(0,0,1),v.push(S/a),v.push(1-y/l)}}for(let y=0;y<l;y++)for(let b=0;b<a;b++){const S=b+c*y,_=b+c*(y+1),T=b+1+c*(y+1),M=b+1+c*y;f.push(S,_,M),f.push(_,T,M)}this.setIndex(f),this.setAttribute("position",new Qt(p,3)),this.setAttribute("normal",new Qt(x,3)),this.setAttribute("uv",new Qt(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ad(e.width,e.height,e.widthSegments,e.heightSegments)}}var Zce=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Qce=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Jce=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,eue=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,tue=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,nue=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,rue=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,iue=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,sue=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,oue=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,aue=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,lue=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,cue=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,uue=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,due=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,hue=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,fue=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,pue=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,mue=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,gue=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,yue=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,vue=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,xue=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,wue=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,bue=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Sue=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,_ue=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Eue=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Cue=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Tue=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Mue="gl_FragColor = linearToOutputTexel( gl_FragColor );",Aue=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,Nue=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,kue=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Iue=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Rue=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Pue=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Due=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Lue=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Oue=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Fue=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,zue=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Uue=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Bue=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,$ue=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,jue=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Vue=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Wue=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Hue=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Gue=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,que=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Xue=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Kue=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Yue=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Zue=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Que=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Jue=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,ede=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,tde=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,nde=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,rde=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,ide=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,sde=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,ode=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,ade=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,lde=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,cde=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,ude=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,dde=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,hde=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,fde=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,pde=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,mde=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,gde=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,yde=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,vde=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,xde=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,wde=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,bde=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Sde=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,_de=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Ede=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Cde=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Tde=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Mde=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Ade=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Nde=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,kde=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Ide=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Rde=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Pde=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Dde=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Lde=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Ode=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Fde=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,zde=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Ude=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Bde=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,$de=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,jde=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Vde=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Wde=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Hde=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Gde=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,qde=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Xde=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Kde=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Yde=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Zde=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Qde=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Jde=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,ehe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,the=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,nhe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,rhe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,ihe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,she=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,ohe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,ahe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,lhe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,che=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,uhe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,dhe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,hhe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fhe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,phe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,mhe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ghe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,yhe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vhe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,xhe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,whe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,bhe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,She=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,_he=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ehe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Che=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,The=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Mhe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Ahe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Nhe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,In={alphahash_fragment:Zce,alphahash_pars_fragment:Qce,alphamap_fragment:Jce,alphamap_pars_fragment:eue,alphatest_fragment:tue,alphatest_pars_fragment:nue,aomap_fragment:rue,aomap_pars_fragment:iue,batching_pars_vertex:sue,batching_vertex:oue,begin_vertex:aue,beginnormal_vertex:lue,bsdfs:cue,iridescence_fragment:uue,bumpmap_pars_fragment:due,clipping_planes_fragment:hue,clipping_planes_pars_fragment:fue,clipping_planes_pars_vertex:pue,clipping_planes_vertex:mue,color_fragment:gue,color_pars_fragment:yue,color_pars_vertex:vue,color_vertex:xue,common:wue,cube_uv_reflection_fragment:bue,defaultnormal_vertex:Sue,displacementmap_pars_vertex:_ue,displacementmap_vertex:Eue,emissivemap_fragment:Cue,emissivemap_pars_fragment:Tue,colorspace_fragment:Mue,colorspace_pars_fragment:Aue,envmap_fragment:Nue,envmap_common_pars_fragment:kue,envmap_pars_fragment:Iue,envmap_pars_vertex:Rue,envmap_physical_pars_fragment:Wue,envmap_vertex:Pue,fog_vertex:Due,fog_pars_vertex:Lue,fog_fragment:Oue,fog_pars_fragment:Fue,gradientmap_pars_fragment:zue,lightmap_fragment:Uue,lightmap_pars_fragment:Bue,lights_lambert_fragment:$ue,lights_lambert_pars_fragment:jue,lights_pars_begin:Vue,lights_toon_fragment:Hue,lights_toon_pars_fragment:Gue,lights_phong_fragment:que,lights_phong_pars_fragment:Xue,lights_physical_fragment:Kue,lights_physical_pars_fragment:Yue,lights_fragment_begin:Zue,lights_fragment_maps:Que,lights_fragment_end:Jue,logdepthbuf_fragment:ede,logdepthbuf_pars_fragment:tde,logdepthbuf_pars_vertex:nde,logdepthbuf_vertex:rde,map_fragment:ide,map_pars_fragment:sde,map_particle_fragment:ode,map_particle_pars_fragment:ade,metalnessmap_fragment:lde,metalnessmap_pars_fragment:cde,morphcolor_vertex:ude,morphnormal_vertex:dde,morphtarget_pars_vertex:hde,morphtarget_vertex:fde,normal_fragment_begin:pde,normal_fragment_maps:mde,normal_pars_fragment:gde,normal_pars_vertex:yde,normal_vertex:vde,normalmap_pars_fragment:xde,clearcoat_normal_fragment_begin:wde,clearcoat_normal_fragment_maps:bde,clearcoat_pars_fragment:Sde,iridescence_pars_fragment:_de,opaque_fragment:Ede,packing:Cde,premultiplied_alpha_fragment:Tde,project_vertex:Mde,dithering_fragment:Ade,dithering_pars_fragment:Nde,roughnessmap_fragment:kde,roughnessmap_pars_fragment:Ide,shadowmap_pars_fragment:Rde,shadowmap_pars_vertex:Pde,shadowmap_vertex:Dde,shadowmask_pars_fragment:Lde,skinbase_vertex:Ode,skinning_pars_vertex:Fde,skinning_vertex:zde,skinnormal_vertex:Ude,specularmap_fragment:Bde,specularmap_pars_fragment:$de,tonemapping_fragment:jde,tonemapping_pars_fragment:Vde,transmission_fragment:Wde,transmission_pars_fragment:Hde,uv_pars_fragment:Gde,uv_pars_vertex:qde,uv_vertex:Xde,worldpos_vertex:Kde,background_vert:Yde,background_frag:Zde,backgroundCube_vert:Qde,backgroundCube_frag:Jde,cube_vert:ehe,cube_frag:the,depth_vert:nhe,depth_frag:rhe,distanceRGBA_vert:ihe,distanceRGBA_frag:she,equirect_vert:ohe,equirect_frag:ahe,linedashed_vert:lhe,linedashed_frag:che,meshbasic_vert:uhe,meshbasic_frag:dhe,meshlambert_vert:hhe,meshlambert_frag:fhe,meshmatcap_vert:phe,meshmatcap_frag:mhe,meshnormal_vert:ghe,meshnormal_frag:yhe,meshphong_vert:vhe,meshphong_frag:xhe,meshphysical_vert:whe,meshphysical_frag:bhe,meshtoon_vert:She,meshtoon_frag:_he,points_vert:Ehe,points_frag:Che,shadow_vert:The,shadow_frag:Mhe,sprite_vert:Ahe,sprite_frag:Nhe},Ct={common:{diffuse:{value:new Ut(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Vn},alphaMap:{value:null},alphaMapTransform:{value:new Vn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Vn}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Vn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Vn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Vn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Vn},normalScale:{value:new Ze(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Vn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Vn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Vn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Vn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ut(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ut(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Vn},alphaTest:{value:0},uvTransform:{value:new Vn}},sprite:{diffuse:{value:new Ut(16777215)},opacity:{value:1},center:{value:new Ze(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Vn},alphaMap:{value:null},alphaMapTransform:{value:new Vn},alphaTest:{value:0}}},Ha={basic:{uniforms:Us([Ct.common,Ct.specularmap,Ct.envmap,Ct.aomap,Ct.lightmap,Ct.fog]),vertexShader:In.meshbasic_vert,fragmentShader:In.meshbasic_frag},lambert:{uniforms:Us([Ct.common,Ct.specularmap,Ct.envmap,Ct.aomap,Ct.lightmap,Ct.emissivemap,Ct.bumpmap,Ct.normalmap,Ct.displacementmap,Ct.fog,Ct.lights,{emissive:{value:new Ut(0)}}]),vertexShader:In.meshlambert_vert,fragmentShader:In.meshlambert_frag},phong:{uniforms:Us([Ct.common,Ct.specularmap,Ct.envmap,Ct.aomap,Ct.lightmap,Ct.emissivemap,Ct.bumpmap,Ct.normalmap,Ct.displacementmap,Ct.fog,Ct.lights,{emissive:{value:new Ut(0)},specular:{value:new Ut(1118481)},shininess:{value:30}}]),vertexShader:In.meshphong_vert,fragmentShader:In.meshphong_frag},standard:{uniforms:Us([Ct.common,Ct.envmap,Ct.aomap,Ct.lightmap,Ct.emissivemap,Ct.bumpmap,Ct.normalmap,Ct.displacementmap,Ct.roughnessmap,Ct.metalnessmap,Ct.fog,Ct.lights,{emissive:{value:new Ut(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:In.meshphysical_vert,fragmentShader:In.meshphysical_frag},toon:{uniforms:Us([Ct.common,Ct.aomap,Ct.lightmap,Ct.emissivemap,Ct.bumpmap,Ct.normalmap,Ct.displacementmap,Ct.gradientmap,Ct.fog,Ct.lights,{emissive:{value:new Ut(0)}}]),vertexShader:In.meshtoon_vert,fragmentShader:In.meshtoon_frag},matcap:{uniforms:Us([Ct.common,Ct.bumpmap,Ct.normalmap,Ct.displacementmap,Ct.fog,{matcap:{value:null}}]),vertexShader:In.meshmatcap_vert,fragmentShader:In.meshmatcap_frag},points:{uniforms:Us([Ct.points,Ct.fog]),vertexShader:In.points_vert,fragmentShader:In.points_frag},dashed:{uniforms:Us([Ct.common,Ct.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:In.linedashed_vert,fragmentShader:In.linedashed_frag},depth:{uniforms:Us([Ct.common,Ct.displacementmap]),vertexShader:In.depth_vert,fragmentShader:In.depth_frag},normal:{uniforms:Us([Ct.common,Ct.bumpmap,Ct.normalmap,Ct.displacementmap,{opacity:{value:1}}]),vertexShader:In.meshnormal_vert,fragmentShader:In.meshnormal_frag},sprite:{uniforms:Us([Ct.sprite,Ct.fog]),vertexShader:In.sprite_vert,fragmentShader:In.sprite_frag},background:{uniforms:{uvTransform:{value:new Vn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:In.background_vert,fragmentShader:In.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:In.backgroundCube_vert,fragmentShader:In.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:In.cube_vert,fragmentShader:In.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:In.equirect_vert,fragmentShader:In.equirect_frag},distanceRGBA:{uniforms:Us([Ct.common,Ct.displacementmap,{referencePosition:{value:new ie},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:In.distanceRGBA_vert,fragmentShader:In.distanceRGBA_frag},shadow:{uniforms:Us([Ct.lights,Ct.fog,{color:{value:new Ut(0)},opacity:{value:1}}]),vertexShader:In.shadow_vert,fragmentShader:In.shadow_frag}};Ha.physical={uniforms:Us([Ha.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Vn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Vn},clearcoatNormalScale:{value:new Ze(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Vn},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Vn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Vn},sheen:{value:0},sheenColor:{value:new Ut(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Vn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Vn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Vn},transmissionSamplerSize:{value:new Ze},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Vn},attenuationDistance:{value:0},attenuationColor:{value:new Ut(0)},specularColor:{value:new Ut(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Vn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Vn},anisotropyVector:{value:new Ze},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Vn}}]),vertexShader:In.meshphysical_vert,fragmentShader:In.meshphysical_frag};const a1={r:0,b:0,g:0};function khe(n,e,t,r,i,s,o){const a=new Ut(0);let l=s===!0?0:1,c,u,d=null,h=0,f=null;function p(v,y){let b=!1,S=y.isScene===!0?y.background:null;S&&S.isTexture&&(S=(y.backgroundBlurriness>0?t:e).get(S)),S===null?x(a,l):S&&S.isColor&&(x(S,1),b=!0);const _=n.xr.getEnvironmentBlendMode();_==="additive"?r.buffers.color.setClear(0,0,0,1,o):_==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,o),(n.autoClear||b)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),S&&(S.isCubeTexture||S.mapping===_g)?(u===void 0&&(u=new ri(new Af(1,1,1),new Ys({name:"BackgroundCubeMaterial",uniforms:Hm(Ha.backgroundCube.uniforms),vertexShader:Ha.backgroundCube.vertexShader,fragmentShader:Ha.backgroundCube.fragmentShader,side:Cs,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(T,M,k){this.matrixWorld.copyPosition(k.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),u.material.uniforms.envMap.value=S,u.material.uniforms.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,u.material.toneMapped=gr.getTransfer(S.colorSpace)!==Ir,(d!==S||h!==S.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,d=S,h=S.version,f=n.toneMapping),u.layers.enableAll(),v.unshift(u,u.geometry,u.material,0,0,null)):S&&S.isTexture&&(c===void 0&&(c=new ri(new Ad(2,2),new Ys({name:"BackgroundMaterial",uniforms:Hm(Ha.background.uniforms),vertexShader:Ha.background.vertexShader,fragmentShader:Ha.background.fragmentShader,side:Wc,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(c)),c.material.uniforms.t2D.value=S,c.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,c.material.toneMapped=gr.getTransfer(S.colorSpace)!==Ir,S.matrixAutoUpdate===!0&&S.updateMatrix(),c.material.uniforms.uvTransform.value.copy(S.matrix),(d!==S||h!==S.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,d=S,h=S.version,f=n.toneMapping),c.layers.enableAll(),v.unshift(c,c.geometry,c.material,0,0,null))}function x(v,y){v.getRGB(a1,fW(n)),r.buffers.color.setClear(a1.r,a1.g,a1.b,y,o)}return{getClearColor:function(){return a},setClearColor:function(v,y=1){a.set(v),l=y,x(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(v){l=v,x(a,l)},render:p}}function Ihe(n,e,t,r){const i=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||s!==null,a={},l=v(null);let c=l,u=!1;function d($,ne,Y,we,H){let X=!1;if(o){const oe=x(we,Y,ne);c!==oe&&(c=oe,f(c.object)),X=y($,we,Y,H),X&&b($,we,Y,H)}else{const oe=ne.wireframe===!0;(c.geometry!==we.id||c.program!==Y.id||c.wireframe!==oe)&&(c.geometry=we.id,c.program=Y.id,c.wireframe=oe,X=!0)}H!==null&&t.update(H,n.ELEMENT_ARRAY_BUFFER),(X||u)&&(u=!1,P($,ne,Y,we),H!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(H).buffer))}function h(){return r.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function f($){return r.isWebGL2?n.bindVertexArray($):s.bindVertexArrayOES($)}function p($){return r.isWebGL2?n.deleteVertexArray($):s.deleteVertexArrayOES($)}function x($,ne,Y){const we=Y.wireframe===!0;let H=a[$.id];H===void 0&&(H={},a[$.id]=H);let X=H[ne.id];X===void 0&&(X={},H[ne.id]=X);let oe=X[we];return oe===void 0&&(oe=v(h()),X[we]=oe),oe}function v($){const ne=[],Y=[],we=[];for(let H=0;H<i;H++)ne[H]=0,Y[H]=0,we[H]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ne,enabledAttributes:Y,attributeDivisors:we,object:$,attributes:{},index:null}}function y($,ne,Y,we){const H=c.attributes,X=ne.attributes;let oe=0;const ve=Y.getAttributes();for(const Te in ve)if(ve[Te].location>=0){const _e=H[Te];let Ue=X[Te];if(Ue===void 0&&(Te==="instanceMatrix"&&$.instanceMatrix&&(Ue=$.instanceMatrix),Te==="instanceColor"&&$.instanceColor&&(Ue=$.instanceColor)),_e===void 0||_e.attribute!==Ue||Ue&&_e.data!==Ue.data)return!0;oe++}return c.attributesNum!==oe||c.index!==we}function b($,ne,Y,we){const H={},X=ne.attributes;let oe=0;const ve=Y.getAttributes();for(const Te in ve)if(ve[Te].location>=0){let _e=X[Te];_e===void 0&&(Te==="instanceMatrix"&&$.instanceMatrix&&(_e=$.instanceMatrix),Te==="instanceColor"&&$.instanceColor&&(_e=$.instanceColor));const Ue={};Ue.attribute=_e,_e&&_e.data&&(Ue.data=_e.data),H[Te]=Ue,oe++}c.attributes=H,c.attributesNum=oe,c.index=we}function S(){const $=c.newAttributes;for(let ne=0,Y=$.length;ne<Y;ne++)$[ne]=0}function _($){T($,0)}function T($,ne){const Y=c.newAttributes,we=c.enabledAttributes,H=c.attributeDivisors;Y[$]=1,we[$]===0&&(n.enableVertexAttribArray($),we[$]=1),H[$]!==ne&&((r.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"]($,ne),H[$]=ne)}function M(){const $=c.newAttributes,ne=c.enabledAttributes;for(let Y=0,we=ne.length;Y<we;Y++)ne[Y]!==$[Y]&&(n.disableVertexAttribArray(Y),ne[Y]=0)}function k($,ne,Y,we,H,X,oe){oe===!0?n.vertexAttribIPointer($,ne,Y,H,X):n.vertexAttribPointer($,ne,Y,we,H,X)}function P($,ne,Y,we){if(r.isWebGL2===!1&&($.isInstancedMesh||we.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;S();const H=we.attributes,X=Y.getAttributes(),oe=ne.defaultAttributeValues;for(const ve in X){const Te=X[ve];if(Te.location>=0){let Xe=H[ve];if(Xe===void 0&&(ve==="instanceMatrix"&&$.instanceMatrix&&(Xe=$.instanceMatrix),ve==="instanceColor"&&$.instanceColor&&(Xe=$.instanceColor)),Xe!==void 0){const _e=Xe.normalized,Ue=Xe.itemSize,Fe=t.get(Xe);if(Fe===void 0)continue;const Oe=Fe.buffer,nt=Fe.type,rt=Fe.bytesPerElement,ut=r.isWebGL2===!0&&(nt===n.INT||nt===n.UNSIGNED_INT||Xe.gpuType===L_);if(Xe.isInterleavedBufferAttribute){const Qe=Xe.data,ae=Qe.stride,ze=Xe.offset;if(Qe.isInstancedInterleavedBuffer){for(let Re=0;Re<Te.locationSize;Re++)T(Te.location+Re,Qe.meshPerAttribute);$.isInstancedMesh!==!0&&we._maxInstanceCount===void 0&&(we._maxInstanceCount=Qe.meshPerAttribute*Qe.count)}else for(let Re=0;Re<Te.locationSize;Re++)_(Te.location+Re);n.bindBuffer(n.ARRAY_BUFFER,Oe);for(let Re=0;Re<Te.locationSize;Re++)k(Te.location+Re,Ue/Te.locationSize,nt,_e,ae*rt,(ze+Ue/Te.locationSize*Re)*rt,ut)}else{if(Xe.isInstancedBufferAttribute){for(let Qe=0;Qe<Te.locationSize;Qe++)T(Te.location+Qe,Xe.meshPerAttribute);$.isInstancedMesh!==!0&&we._maxInstanceCount===void 0&&(we._maxInstanceCount=Xe.meshPerAttribute*Xe.count)}else for(let Qe=0;Qe<Te.locationSize;Qe++)_(Te.location+Qe);n.bindBuffer(n.ARRAY_BUFFER,Oe);for(let Qe=0;Qe<Te.locationSize;Qe++)k(Te.location+Qe,Ue/Te.locationSize,nt,_e,Ue*rt,Ue/Te.locationSize*Qe*rt,ut)}}else if(oe!==void 0){const _e=oe[ve];if(_e!==void 0)switch(_e.length){case 2:n.vertexAttrib2fv(Te.location,_e);break;case 3:n.vertexAttrib3fv(Te.location,_e);break;case 4:n.vertexAttrib4fv(Te.location,_e);break;default:n.vertexAttrib1fv(Te.location,_e)}}}}M()}function z(){W();for(const $ in a){const ne=a[$];for(const Y in ne){const we=ne[Y];for(const H in we)p(we[H].object),delete we[H];delete ne[Y]}delete a[$]}}function I($){if(a[$.id]===void 0)return;const ne=a[$.id];for(const Y in ne){const we=ne[Y];for(const H in we)p(we[H].object),delete we[H];delete ne[Y]}delete a[$.id]}function L($){for(const ne in a){const Y=a[ne];if(Y[$.id]===void 0)continue;const we=Y[$.id];for(const H in we)p(we[H].object),delete we[H];delete Y[$.id]}}function W(){q(),u=!0,c!==l&&(c=l,f(c.object))}function q(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:d,reset:W,resetDefaultState:q,dispose:z,releaseStatesOfGeometry:I,releaseStatesOfProgram:L,initAttributes:S,enableAttribute:_,disableUnusedAttributes:M}}function Rhe(n,e,t,r){const i=r.isWebGL2;let s;function o(u){s=u}function a(u,d){n.drawArrays(s,u,d),t.update(d,s,1)}function l(u,d,h){if(h===0)return;let f,p;if(i)f=n,p="drawArraysInstanced";else if(f=e.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",f===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}f[p](s,u,d,h),t.update(d,s,h)}function c(u,d,h){if(h===0)return;const f=e.get("WEBGL_multi_draw");if(f===null)for(let p=0;p<h;p++)this.render(u[p],d[p]);else{f.multiDrawArraysWEBGL(s,u,0,d,0,h);let p=0;for(let x=0;x<h;x++)p+=d[x];t.update(p,s,1)}}this.setMode=o,this.render=a,this.renderInstances=l,this.renderMultiDraw=c}function Phe(n,e,t){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const k=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(k.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(k){if(k==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";k="mediump"}return k==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let a=t.precision!==void 0?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=t.logarithmicDepthBuffer===!0,d=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),h=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=n.getParameter(n.MAX_TEXTURE_SIZE),p=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),x=n.getParameter(n.MAX_VERTEX_ATTRIBS),v=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),y=n.getParameter(n.MAX_VARYING_VECTORS),b=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),S=h>0,_=o||e.has("OES_texture_float"),T=S&&_,M=o?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:i,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:p,maxAttributes:x,maxVertexUniforms:v,maxVaryings:y,maxFragmentUniforms:b,vertexTextures:S,floatFragmentTextures:_,floatVertexTextures:T,maxSamples:M}}function Dhe(n){const e=this;let t=null,r=0,i=!1,s=!1;const o=new Wa,a=new Vn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const f=d.length!==0||h||r!==0||i;return i=h,r=d.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){t=u(d,h,0)},this.setState=function(d,h,f){const p=d.clippingPlanes,x=d.clipIntersection,v=d.clipShadows,y=n.get(d);if(!i||p===null||p.length===0||s&&!v)s?u(null):c();else{const b=s?0:r,S=b*4;let _=y.clippingState||null;l.value=_,_=u(p,h,S,f);for(let T=0;T!==S;++T)_[T]=t[T];y.clippingState=_,this.numIntersection=x?this.numPlanes:0,this.numPlanes+=b}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(d,h,f,p){const x=d!==null?d.length:0;let v=null;if(x!==0){if(v=l.value,p!==!0||v===null){const y=f+x*4,b=h.matrixWorldInverse;a.getNormalMatrix(b),(v===null||v.length<y)&&(v=new Float32Array(y));for(let S=0,_=f;S!==x;++S,_+=4)o.copy(d[S]).applyMatrix4(b,a),o.normal.toArray(v,_),v[_+3]=o.constant}l.value=v,l.needsUpdate=!0}return e.numPlanes=x,e.numIntersection=0,v}}function Lhe(n){let e=new WeakMap;function t(o,a){return a===jm?o.mapping=ql:a===i0&&(o.mapping=md),o}function r(o){if(o&&o.isTexture){const a=o.mapping;if(a===jm||a===i0)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new nR(l.height);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",i),t(c.texture,o.mapping)}else return null}}return o}function i(o){const a=o.target;a.removeEventListener("dispose",i);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}class Ic extends ox{constructor(e=-1,t=1,r=1,i=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,o=r+e,a=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const sm=4,_O=[.125,.215,.35,.446,.526,.582],vh=20,AC=new Ic,EO=new Ut;let NC=null,kC=0,IC=0;const fh=(1+Math.sqrt(5))/2,Ep=1/fh,CO=[new ie(1,1,1),new ie(-1,1,1),new ie(1,1,-1),new ie(-1,1,-1),new ie(0,fh,Ep),new ie(0,fh,-Ep),new ie(Ep,0,fh),new ie(-Ep,0,fh),new ie(fh,Ep,0),new ie(-fh,Ep,0)];class LA{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){NC=this._renderer.getRenderTarget(),kC=this._renderer.getActiveCubeFace(),IC=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=AO(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=MO(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(NC,kC,IC),e.scissorTest=!1,l1(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ql||e.mapping===md?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),NC=this._renderer.getRenderTarget(),kC=this._renderer.getActiveCubeFace(),IC=this._renderer.getActiveMipmapLevel();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Jn,minFilter:Jn,generateMipmaps:!1,type:Fi,format:Ii,colorSpace:Ko,depthBuffer:!1},i=TO(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=TO(e,t,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Ohe(s)),this._blurMaterial=Fhe(s,e,t)}return i}_compileMaterial(e){const t=new ri(this._lodPlanes[0],e);this._renderer.compile(t,AC)}_sceneToCubeUV(e,t,r,i){const a=new hi(90,1,t,r),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(EO),u.toneMapping=Ul,u.autoClear=!1;const f=new ec({name:"PMREM.Background",side:Cs,depthWrite:!1,depthTest:!1}),p=new ri(new Af,f);let x=!1;const v=e.background;v?v.isColor&&(f.color.copy(v),e.background=null,x=!0):(f.color.copy(EO),x=!0);for(let y=0;y<6;y++){const b=y%3;b===0?(a.up.set(0,l[y],0),a.lookAt(c[y],0,0)):b===1?(a.up.set(0,0,l[y]),a.lookAt(0,c[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,c[y]));const S=this._cubeSize;l1(i,b*S,y>2?S:0,S,S),u.setRenderTarget(i),x&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=v}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===ql||e.mapping===md;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=AO()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=MO());const s=i?this._cubemapMaterial:this._equirectMaterial,o=new ri(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;l1(t,0,0,3*l,2*l),r.setRenderTarget(t),r.render(o,AC)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const s=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),o=CO[(i-1)%CO.length];this._blur(e,i-1,i,s,o)}t.autoClear=r}_blur(e,t,r,i,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,r,i,"latitudinal",s),this._halfBlur(o,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,d=new ri(this._lodPlanes[i],c),h=c.uniforms,f=this._sizeLods[r]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*vh-1),x=s/p,v=isFinite(s)?1+Math.floor(u*x):vh;v>vh&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${vh}`);const y=[];let b=0;for(let k=0;k<vh;++k){const P=k/x,z=Math.exp(-P*P/2);y.push(z),k===0?b+=z:k<v&&(b+=2*z)}for(let k=0;k<y.length;k++)y[k]=y[k]/b;h.envMap.value=e.texture,h.samples.value=v,h.weights.value=y,h.latitudinal.value=o==="latitudinal",a&&(h.poleAxis.value=a);const{_lodMax:S}=this;h.dTheta.value=p,h.mipInt.value=S-r;const _=this._sizeLods[i],T=3*_*(i>S-sm?i-S+sm:0),M=4*(this._cubeSize-_);l1(t,T,M,3*_,2*_),l.setRenderTarget(t),l.render(d,AC)}}function Ohe(n){const e=[],t=[],r=[];let i=n;const s=n-sm+1+_O.length;for(let o=0;o<s;o++){const a=Math.pow(2,i);t.push(a);let l=1/a;o>n-sm?l=_O[o-n+sm-1]:o===0&&(l=0),r.push(l);const c=1/(a-2),u=-c,d=1+c,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,p=6,x=3,v=2,y=1,b=new Float32Array(x*p*f),S=new Float32Array(v*p*f),_=new Float32Array(y*p*f);for(let M=0;M<f;M++){const k=M%3*2/3-1,P=M>2?0:-1,z=[k,P,0,k+2/3,P,0,k+2/3,P+1,0,k,P,0,k+2/3,P+1,0,k,P+1,0];b.set(z,x*p*M),S.set(h,v*p*M);const I=[M,M,M,M,M,M];_.set(I,y*p*M)}const T=new Pn;T.setAttribute("position",new pr(b,x)),T.setAttribute("uv",new pr(S,v)),T.setAttribute("faceIndex",new pr(_,y)),e.push(T),i>sm&&i--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function TO(n,e,t){const r=new Eo(n,e,t);return r.texture.mapping=_g,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function l1(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function Fhe(n,e,t){const r=new Float32Array(vh),i=new ie(0,1,0);return new Ys({name:"SphericalGaussianBlur",defines:{n:vh,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:rR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:zl,depthTest:!1,depthWrite:!1})}function MO(){return new Ys({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:rR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:zl,depthTest:!1,depthWrite:!1})}function AO(){return new Ys({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:rR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:zl,depthTest:!1,depthWrite:!1})}function rR(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function zhe(n){let e=new WeakMap,t=null;function r(a){if(a&&a.isTexture){const l=a.mapping,c=l===jm||l===i0,u=l===ql||l===md;if(c||u)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let d=e.get(a);return t===null&&(t=new LA(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}else{if(e.has(a))return e.get(a).texture;{const d=a.image;if(c&&d&&d.height>0||u&&d&&i(d)){t===null&&(t=new LA(n));const h=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}else return null}}}return a}function i(a){let l=0;const c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:o}}function Uhe(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(r)}return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const i=t(r);return i===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function Bhe(n,e,t,r){const i={},s=new WeakMap;function o(d){const h=d.target;h.index!==null&&e.remove(h.index);for(const p in h.attributes)e.remove(h.attributes[p]);for(const p in h.morphAttributes){const x=h.morphAttributes[p];for(let v=0,y=x.length;v<y;v++)e.remove(x[v])}h.removeEventListener("dispose",o),delete i[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),r.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,t.memory.geometries--}function a(d,h){return i[h.id]===!0||(h.addEventListener("dispose",o),i[h.id]=!0,t.memory.geometries++),h}function l(d){const h=d.attributes;for(const p in h)e.update(h[p],n.ARRAY_BUFFER);const f=d.morphAttributes;for(const p in f){const x=f[p];for(let v=0,y=x.length;v<y;v++)e.update(x[v],n.ARRAY_BUFFER)}}function c(d){const h=[],f=d.index,p=d.attributes.position;let x=0;if(f!==null){const b=f.array;x=f.version;for(let S=0,_=b.length;S<_;S+=3){const T=b[S+0],M=b[S+1],k=b[S+2];h.push(T,M,M,k,k,T)}}else if(p!==void 0){const b=p.array;x=p.version;for(let S=0,_=b.length/3-1;S<_;S+=3){const T=S+0,M=S+1,k=S+2;h.push(T,M,M,k,k,T)}}else return;const v=new(cW(h)?eR:JI)(h,1);v.version=x;const y=s.get(d);y&&e.remove(y),s.set(d,v)}function u(d){const h=s.get(d);if(h){const f=d.index;f!==null&&h.version<f.version&&c(d)}else c(d);return s.get(d)}return{get:a,update:l,getWireframeAttribute:u}}function $he(n,e,t,r){const i=r.isWebGL2;let s;function o(f){s=f}let a,l;function c(f){a=f.type,l=f.bytesPerElement}function u(f,p){n.drawElements(s,p,a,f*l),t.update(p,s,1)}function d(f,p,x){if(x===0)return;let v,y;if(i)v=n,y="drawElementsInstanced";else if(v=e.get("ANGLE_instanced_arrays"),y="drawElementsInstancedANGLE",v===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[y](s,p,a,f*l,x),t.update(p,s,x)}function h(f,p,x){if(x===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let y=0;y<x;y++)this.render(f[y]/l,p[y]);else{v.multiDrawElementsWEBGL(s,p,0,a,f,0,x);let y=0;for(let b=0;b<x;b++)y+=p[b];t.update(y,s,1)}}this.setMode=o,this.setIndex=c,this.render=u,this.renderInstances=d,this.renderMultiDraw=h}function jhe(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function Vhe(n,e){return n[0]-e[0]}function Whe(n,e){return Math.abs(e[1])-Math.abs(n[1])}function Hhe(n,e,t){const r={},i=new Float32Array(8),s=new WeakMap,o=new vr,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,u,d){const h=c.morphTargetInfluences;if(e.isWebGL2===!0){const p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,x=p!==void 0?p.length:0;let v=s.get(u);if(v===void 0||v.count!==x){let ne=function(){q.dispose(),s.delete(u),u.removeEventListener("dispose",ne)};var f=ne;v!==void 0&&v.texture.dispose();const S=u.morphAttributes.position!==void 0,_=u.morphAttributes.normal!==void 0,T=u.morphAttributes.color!==void 0,M=u.morphAttributes.position||[],k=u.morphAttributes.normal||[],P=u.morphAttributes.color||[];let z=0;S===!0&&(z=1),_===!0&&(z=2),T===!0&&(z=3);let I=u.attributes.position.count*z,L=1;I>e.maxTextureSize&&(L=Math.ceil(I/e.maxTextureSize),I=e.maxTextureSize);const W=new Float32Array(I*L*4*x),q=new z_(W,I,L,x);q.type=fi,q.needsUpdate=!0;const $=z*4;for(let Y=0;Y<x;Y++){const we=M[Y],H=k[Y],X=P[Y],oe=I*L*4*Y;for(let ve=0;ve<we.count;ve++){const Te=ve*$;S===!0&&(o.fromBufferAttribute(we,ve),W[oe+Te+0]=o.x,W[oe+Te+1]=o.y,W[oe+Te+2]=o.z,W[oe+Te+3]=0),_===!0&&(o.fromBufferAttribute(H,ve),W[oe+Te+4]=o.x,W[oe+Te+5]=o.y,W[oe+Te+6]=o.z,W[oe+Te+7]=0),T===!0&&(o.fromBufferAttribute(X,ve),W[oe+Te+8]=o.x,W[oe+Te+9]=o.y,W[oe+Te+10]=o.z,W[oe+Te+11]=X.itemSize===4?o.w:1)}}v={count:x,texture:q,size:new Ze(I,L)},s.set(u,v),u.addEventListener("dispose",ne)}let y=0;for(let S=0;S<h.length;S++)y+=h[S];const b=u.morphTargetsRelative?1:1-y;d.getUniforms().setValue(n,"morphTargetBaseInfluence",b),d.getUniforms().setValue(n,"morphTargetInfluences",h),d.getUniforms().setValue(n,"morphTargetsTexture",v.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",v.size)}else{const p=h===void 0?0:h.length;let x=r[u.id];if(x===void 0||x.length!==p){x=[];for(let _=0;_<p;_++)x[_]=[_,0];r[u.id]=x}for(let _=0;_<p;_++){const T=x[_];T[0]=_,T[1]=h[_]}x.sort(Whe);for(let _=0;_<8;_++)_<p&&x[_][1]?(a[_][0]=x[_][0],a[_][1]=x[_][1]):(a[_][0]=Number.MAX_SAFE_INTEGER,a[_][1]=0);a.sort(Vhe);const v=u.morphAttributes.position,y=u.morphAttributes.normal;let b=0;for(let _=0;_<8;_++){const T=a[_],M=T[0],k=T[1];M!==Number.MAX_SAFE_INTEGER&&k?(v&&u.getAttribute("morphTarget"+_)!==v[M]&&u.setAttribute("morphTarget"+_,v[M]),y&&u.getAttribute("morphNormal"+_)!==y[M]&&u.setAttribute("morphNormal"+_,y[M]),i[_]=k,b+=k):(v&&u.hasAttribute("morphTarget"+_)===!0&&u.deleteAttribute("morphTarget"+_),y&&u.hasAttribute("morphNormal"+_)===!0&&u.deleteAttribute("morphNormal"+_),i[_]=0)}const S=u.morphTargetsRelative?1:1-b;d.getUniforms().setValue(n,"morphTargetBaseInfluence",S),d.getUniforms().setValue(n,"morphTargetInfluences",i)}}return{update:l}}function Ghe(n,e,t,r){let i=new WeakMap;function s(l){const c=r.render.frame,u=l.geometry,d=e.get(l,u);if(i.get(d)!==c&&(e.update(d),i.set(d,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),i.set(l,c))),l.isSkinnedMesh){const h=l.skeleton;i.get(h)!==c&&(h.update(),i.set(h,c))}return d}function o(){i=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:o}}class U_ extends qr{constructor(e,t,r,i,s,o,a,l,c,u){if(u=u!==void 0?u:Yu,u!==Yu&&u!==cf)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&u===Yu&&(r=kl),r===void 0&&u===cf&&(r=Ku),super(null,i,s,o,a,l,u,r,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:yi,this.minFilter=l!==void 0?l:yi,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const gW=new qr,yW=new U_(1,1);yW.compareFunction=KI;const vW=new z_,xW=new QI,wW=new ax,NO=[],kO=[],IO=new Float32Array(16),RO=new Float32Array(9),PO=new Float32Array(4);function Cg(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=NO[i];if(s===void 0&&(s=new Float32Array(i),NO[i]=s),e!==0){r.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Bi(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function $i(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function B_(n,e){let t=kO[e];t===void 0&&(t=new Int32Array(e),kO[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function qhe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Xhe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Bi(t,e))return;n.uniform2fv(this.addr,e),$i(t,e)}}function Khe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Bi(t,e))return;n.uniform3fv(this.addr,e),$i(t,e)}}function Yhe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Bi(t,e))return;n.uniform4fv(this.addr,e),$i(t,e)}}function Zhe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Bi(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),$i(t,e)}else{if(Bi(t,r))return;PO.set(r),n.uniformMatrix2fv(this.addr,!1,PO),$i(t,r)}}function Qhe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Bi(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),$i(t,e)}else{if(Bi(t,r))return;RO.set(r),n.uniformMatrix3fv(this.addr,!1,RO),$i(t,r)}}function Jhe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Bi(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),$i(t,e)}else{if(Bi(t,r))return;IO.set(r),n.uniformMatrix4fv(this.addr,!1,IO),$i(t,r)}}function efe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function tfe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Bi(t,e))return;n.uniform2iv(this.addr,e),$i(t,e)}}function nfe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Bi(t,e))return;n.uniform3iv(this.addr,e),$i(t,e)}}function rfe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Bi(t,e))return;n.uniform4iv(this.addr,e),$i(t,e)}}function ife(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function sfe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Bi(t,e))return;n.uniform2uiv(this.addr,e),$i(t,e)}}function ofe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Bi(t,e))return;n.uniform3uiv(this.addr,e),$i(t,e)}}function afe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Bi(t,e))return;n.uniform4uiv(this.addr,e),$i(t,e)}}function lfe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i);const s=this.type===n.SAMPLER_2D_SHADOW?yW:gW;t.setTexture2D(e||s,i)}function cfe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||xW,i)}function ufe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||wW,i)}function dfe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||vW,i)}function hfe(n){switch(n){case 5126:return qhe;case 35664:return Xhe;case 35665:return Khe;case 35666:return Yhe;case 35674:return Zhe;case 35675:return Qhe;case 35676:return Jhe;case 5124:case 35670:return efe;case 35667:case 35671:return tfe;case 35668:case 35672:return nfe;case 35669:case 35673:return rfe;case 5125:return ife;case 36294:return sfe;case 36295:return ofe;case 36296:return afe;case 35678:case 36198:case 36298:case 36306:case 35682:return lfe;case 35679:case 36299:case 36307:return cfe;case 35680:case 36300:case 36308:case 36293:return ufe;case 36289:case 36303:case 36311:case 36292:return dfe}}function ffe(n,e){n.uniform1fv(this.addr,e)}function pfe(n,e){const t=Cg(e,this.size,2);n.uniform2fv(this.addr,t)}function mfe(n,e){const t=Cg(e,this.size,3);n.uniform3fv(this.addr,t)}function gfe(n,e){const t=Cg(e,this.size,4);n.uniform4fv(this.addr,t)}function yfe(n,e){const t=Cg(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function vfe(n,e){const t=Cg(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function xfe(n,e){const t=Cg(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function wfe(n,e){n.uniform1iv(this.addr,e)}function bfe(n,e){n.uniform2iv(this.addr,e)}function Sfe(n,e){n.uniform3iv(this.addr,e)}function _fe(n,e){n.uniform4iv(this.addr,e)}function Efe(n,e){n.uniform1uiv(this.addr,e)}function Cfe(n,e){n.uniform2uiv(this.addr,e)}function Tfe(n,e){n.uniform3uiv(this.addr,e)}function Mfe(n,e){n.uniform4uiv(this.addr,e)}function Afe(n,e,t){const r=this.cache,i=e.length,s=B_(t,i);Bi(r,s)||(n.uniform1iv(this.addr,s),$i(r,s));for(let o=0;o!==i;++o)t.setTexture2D(e[o]||gW,s[o])}function Nfe(n,e,t){const r=this.cache,i=e.length,s=B_(t,i);Bi(r,s)||(n.uniform1iv(this.addr,s),$i(r,s));for(let o=0;o!==i;++o)t.setTexture3D(e[o]||xW,s[o])}function kfe(n,e,t){const r=this.cache,i=e.length,s=B_(t,i);Bi(r,s)||(n.uniform1iv(this.addr,s),$i(r,s));for(let o=0;o!==i;++o)t.setTextureCube(e[o]||wW,s[o])}function Ife(n,e,t){const r=this.cache,i=e.length,s=B_(t,i);Bi(r,s)||(n.uniform1iv(this.addr,s),$i(r,s));for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||vW,s[o])}function Rfe(n){switch(n){case 5126:return ffe;case 35664:return pfe;case 35665:return mfe;case 35666:return gfe;case 35674:return yfe;case 35675:return vfe;case 35676:return xfe;case 5124:case 35670:return wfe;case 35667:case 35671:return bfe;case 35668:case 35672:return Sfe;case 35669:case 35673:return _fe;case 5125:return Efe;case 36294:return Cfe;case 36295:return Tfe;case 36296:return Mfe;case 35678:case 36198:case 36298:case 36306:case 35682:return Afe;case 35679:case 36299:case 36307:return Nfe;case 35680:case 36300:case 36308:case 36293:return kfe;case 36289:case 36303:case 36311:case 36292:return Ife}}class Pfe{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=hfe(t.type)}}class Dfe{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=Rfe(t.type)}}class Lfe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,o=i.length;s!==o;++s){const a=i[s];a.setValue(e,t[a.id],r)}}}const RC=/(\w+)(\])?(\[|\.)?/g;function DO(n,e){n.seq.push(e),n.map[e.id]=e}function Ofe(n,e,t){const r=n.name,i=r.length;for(RC.lastIndex=0;;){const s=RC.exec(r),o=RC.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===i){DO(t,c===void 0?new Pfe(a,n,e):new Dfe(a,n,e));break}else{let d=t.map[a];d===void 0&&(d=new Lfe(a),DO(t,d)),t=d}}}class yb{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const s=e.getActiveUniform(t,i),o=e.getUniformLocation(t,s.name);Ofe(s,o,this)}}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=r[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const o=e[i];o.id in t&&r.push(o)}return r}}function LO(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const Ffe=37297;let zfe=0;function Ufe(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=i;o<s;o++){const a=o+1;r.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return r.join(`
`)}function Bfe(n){const e=gr.getPrimaries(gr.workingColorSpace),t=gr.getPrimaries(n);let r;switch(e===t?r="":e===d0&&t===u0?r="LinearDisplayP3ToLinearSRGB":e===u0&&t===d0&&(r="LinearSRGBToLinearDisplayP3"),n){case Ko:case sx:return[r,"LinearTransferOETF"];case Ai:case F_:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[r,"LinearTransferOETF"]}}function OO(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),i=n.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+Ufe(n.getShaderSource(e),o)}else return i}function $fe(n,e){const t=Bfe(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function jfe(n,e){let t;switch(e){case O6:t="Linear";break;case F6:t="Reinhard";break;case z6:t="OptimizedCineon";break;case FI:t="ACESFilmic";break;case B6:t="AgX";break;case U6:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Vfe(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.alphaToCoverage||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(om).join(`
`)}function Wfe(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(om).join(`
`)}function Hfe(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function Gfe(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function om(n){return n!==""}function FO(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function zO(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const qfe=/^[ \t]*#include +<([\w\d./]+)>/gm;function OA(n){return n.replace(qfe,Kfe)}const Xfe=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Kfe(n,e){let t=In[e];if(t===void 0){const r=Xfe.get(e);if(r!==void 0)t=In[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return OA(t)}const Yfe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function UO(n){return n.replace(Yfe,Zfe)}function Zfe(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function BO(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	`;return n.isWebGL2&&(e+=`precision ${n.precision} sampler3D;
		precision ${n.precision} sampler2DArray;
		precision ${n.precision} sampler2DShadow;
		precision ${n.precision} samplerCubeShadow;
		precision ${n.precision} sampler2DArrayShadow;
		precision ${n.precision} isampler2D;
		precision ${n.precision} isampler3D;
		precision ${n.precision} isamplerCube;
		precision ${n.precision} isampler2DArray;
		precision ${n.precision} usampler2D;
		precision ${n.precision} usampler3D;
		precision ${n.precision} usamplerCube;
		precision ${n.precision} usampler2DArray;
		`),n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Qfe(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===P_?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===Sm?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===$a&&(e="SHADOWMAP_TYPE_VSM"),e}function Jfe(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case ql:case md:e="ENVMAP_TYPE_CUBE";break;case _g:e="ENVMAP_TYPE_CUBE_UV";break}return e}function epe(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case md:e="ENVMAP_MODE_REFRACTION";break}return e}function tpe(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case ix:e="ENVMAP_BLENDING_MULTIPLY";break;case D6:e="ENVMAP_BLENDING_MIX";break;case L6:e="ENVMAP_BLENDING_ADD";break}return e}function npe(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function rpe(n,e,t,r){const i=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=Qfe(t),c=Jfe(t),u=epe(t),d=tpe(t),h=npe(t),f=t.isWebGL2?"":Vfe(t),p=Wfe(t),x=Hfe(s),v=i.createProgram();let y,b,S=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(y=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x].filter(om).join(`
`),y.length>0&&(y+=`
`),b=[f,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x].filter(om).join(`
`),b.length>0&&(b+=`
`)):(y=[BO(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(om).join(`
`),b=[f,BO(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ul?"#define TONE_MAPPING":"",t.toneMapping!==Ul?In.tonemapping_pars_fragment:"",t.toneMapping!==Ul?jfe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",In.colorspace_pars_fragment,$fe("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(om).join(`
`)),o=OA(o),o=FO(o,t),o=zO(o,t),a=OA(a),a=FO(a,t),a=zO(a,t),o=UO(o),a=UO(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(S=`#version 300 es
`,y=[p,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,b=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===PA?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===PA?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+b);const _=S+y+o,T=S+b+a,M=LO(i,i.VERTEX_SHADER,_),k=LO(i,i.FRAGMENT_SHADER,T);i.attachShader(v,M),i.attachShader(v,k),t.index0AttributeName!==void 0?i.bindAttribLocation(v,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(v,0,"position"),i.linkProgram(v);function P(W){if(n.debug.checkShaderErrors){const q=i.getProgramInfoLog(v).trim(),$=i.getShaderInfoLog(M).trim(),ne=i.getShaderInfoLog(k).trim();let Y=!0,we=!0;if(i.getProgramParameter(v,i.LINK_STATUS)===!1)if(Y=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(i,v,M,k);else{const H=OO(i,M,"vertex"),X=OO(i,k,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(v,i.VALIDATE_STATUS)+`

Material Name: `+W.name+`
Material Type: `+W.type+`

Program Info Log: `+q+`
`+H+`
`+X)}else q!==""?console.warn("THREE.WebGLProgram: Program Info Log:",q):($===""||ne==="")&&(we=!1);we&&(W.diagnostics={runnable:Y,programLog:q,vertexShader:{log:$,prefix:y},fragmentShader:{log:ne,prefix:b}})}i.deleteShader(M),i.deleteShader(k),z=new yb(i,v),I=Gfe(i,v)}let z;this.getUniforms=function(){return z===void 0&&P(this),z};let I;this.getAttributes=function(){return I===void 0&&P(this),I};let L=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return L===!1&&(L=i.getProgramParameter(v,Ffe)),L},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(v),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=zfe++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=M,this.fragmentShader=k,this}let ipe=0;class spe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new ope(e),t.set(e,r)),r}}class ope{constructor(e){this.id=ipe++,this.code=e,this.usedTimes=0}}function ape(n,e,t,r,i,s,o){const a=new Hh,l=new spe,c=new Set,u=[],d=i.isWebGL2,h=i.logarithmicDepthBuffer,f=i.vertexTextures;let p=i.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(I){return c.add(I),I===0?"uv":`uv${I}`}function y(I,L,W,q,$){const ne=q.fog,Y=$.geometry,we=I.isMeshStandardMaterial?q.environment:null,H=(I.isMeshStandardMaterial?t:e).get(I.envMap||we),X=H&&H.mapping===_g?H.image.height:null,oe=x[I.type];I.precision!==null&&(p=i.getMaxPrecision(I.precision),p!==I.precision&&console.warn("THREE.WebGLProgram.getParameters:",I.precision,"not supported, using",p,"instead."));const ve=Y.morphAttributes.position||Y.morphAttributes.normal||Y.morphAttributes.color,Te=ve!==void 0?ve.length:0;let Xe=0;Y.morphAttributes.position!==void 0&&(Xe=1),Y.morphAttributes.normal!==void 0&&(Xe=2),Y.morphAttributes.color!==void 0&&(Xe=3);let _e,Ue,Fe,Oe;if(oe){const Dn=Ha[oe];_e=Dn.vertexShader,Ue=Dn.fragmentShader}else _e=I.vertexShader,Ue=I.fragmentShader,l.update(I),Fe=l.getVertexShaderID(I),Oe=l.getFragmentShaderID(I);const nt=n.getRenderTarget(),rt=$.isInstancedMesh===!0,ut=$.isBatchedMesh===!0,Qe=!!I.map,ae=!!I.matcap,ze=!!H,Re=!!I.aoMap,Je=!!I.lightMap,Ge=!!I.bumpMap,Et=!!I.normalMap,pt=!!I.displacementMap,Q=!!I.emissiveMap,G=!!I.metalnessMap,ke=!!I.roughnessMap,J=I.anisotropy>0,he=I.clearcoat>0,ee=I.iridescence>0,Ee=I.sheen>0,Me=I.transmission>0,Ae=J&&!!I.anisotropyMap,Be=he&&!!I.clearcoatMap,dt=he&&!!I.clearcoatNormalMap,We=he&&!!I.clearcoatRoughnessMap,Kt=ee&&!!I.iridescenceMap,cn=ee&&!!I.iridescenceThicknessMap,jt=Ee&&!!I.sheenColorMap,wt=Ee&&!!I.sheenRoughnessMap,Mt=!!I.specularMap,ye=!!I.specularColorMap,He=!!I.specularIntensityMap,st=Me&&!!I.transmissionMap,_t=Me&&!!I.thicknessMap,Ye=!!I.gradientMap,fe=!!I.alphaMap,ot=I.alphaTest>0,ht=!!I.alphaHash,Bt=!!I.extensions;let Pt=Ul;I.toneMapped&&(nt===null||nt.isXRRenderTarget===!0)&&(Pt=n.toneMapping);const xn={isWebGL2:d,shaderID:oe,shaderType:I.type,shaderName:I.name,vertexShader:_e,fragmentShader:Ue,defines:I.defines,customVertexShaderID:Fe,customFragmentShaderID:Oe,isRawShaderMaterial:I.isRawShaderMaterial===!0,glslVersion:I.glslVersion,precision:p,batching:ut,instancing:rt,instancingColor:rt&&$.instanceColor!==null,supportsVertexTextures:f,outputColorSpace:nt===null?n.outputColorSpace:nt.isXRRenderTarget===!0?nt.texture.colorSpace:Ko,alphaToCoverage:!!I.alphaToCoverage,map:Qe,matcap:ae,envMap:ze,envMapMode:ze&&H.mapping,envMapCubeUVHeight:X,aoMap:Re,lightMap:Je,bumpMap:Ge,normalMap:Et,displacementMap:f&&pt,emissiveMap:Q,normalMapObjectSpace:Et&&I.normalMapType===Q6,normalMapTangentSpace:Et&&I.normalMapType===Md,metalnessMap:G,roughnessMap:ke,anisotropy:J,anisotropyMap:Ae,clearcoat:he,clearcoatMap:Be,clearcoatNormalMap:dt,clearcoatRoughnessMap:We,iridescence:ee,iridescenceMap:Kt,iridescenceThicknessMap:cn,sheen:Ee,sheenColorMap:jt,sheenRoughnessMap:wt,specularMap:Mt,specularColorMap:ye,specularIntensityMap:He,transmission:Me,transmissionMap:st,thicknessMap:_t,gradientMap:Ye,opaque:I.transparent===!1&&I.blending===jh&&I.alphaToCoverage===!1,alphaMap:fe,alphaTest:ot,alphaHash:ht,combine:I.combine,mapUv:Qe&&v(I.map.channel),aoMapUv:Re&&v(I.aoMap.channel),lightMapUv:Je&&v(I.lightMap.channel),bumpMapUv:Ge&&v(I.bumpMap.channel),normalMapUv:Et&&v(I.normalMap.channel),displacementMapUv:pt&&v(I.displacementMap.channel),emissiveMapUv:Q&&v(I.emissiveMap.channel),metalnessMapUv:G&&v(I.metalnessMap.channel),roughnessMapUv:ke&&v(I.roughnessMap.channel),anisotropyMapUv:Ae&&v(I.anisotropyMap.channel),clearcoatMapUv:Be&&v(I.clearcoatMap.channel),clearcoatNormalMapUv:dt&&v(I.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:We&&v(I.clearcoatRoughnessMap.channel),iridescenceMapUv:Kt&&v(I.iridescenceMap.channel),iridescenceThicknessMapUv:cn&&v(I.iridescenceThicknessMap.channel),sheenColorMapUv:jt&&v(I.sheenColorMap.channel),sheenRoughnessMapUv:wt&&v(I.sheenRoughnessMap.channel),specularMapUv:Mt&&v(I.specularMap.channel),specularColorMapUv:ye&&v(I.specularColorMap.channel),specularIntensityMapUv:He&&v(I.specularIntensityMap.channel),transmissionMapUv:st&&v(I.transmissionMap.channel),thicknessMapUv:_t&&v(I.thicknessMap.channel),alphaMapUv:fe&&v(I.alphaMap.channel),vertexTangents:!!Y.attributes.tangent&&(Et||J),vertexColors:I.vertexColors,vertexAlphas:I.vertexColors===!0&&!!Y.attributes.color&&Y.attributes.color.itemSize===4,pointsUvs:$.isPoints===!0&&!!Y.attributes.uv&&(Qe||fe),fog:!!ne,useFog:I.fog===!0,fogExp2:!!ne&&ne.isFogExp2,flatShading:I.flatShading===!0,sizeAttenuation:I.sizeAttenuation===!0,logarithmicDepthBuffer:h,skinning:$.isSkinnedMesh===!0,morphTargets:Y.morphAttributes.position!==void 0,morphNormals:Y.morphAttributes.normal!==void 0,morphColors:Y.morphAttributes.color!==void 0,morphTargetsCount:Te,morphTextureStride:Xe,numDirLights:L.directional.length,numPointLights:L.point.length,numSpotLights:L.spot.length,numSpotLightMaps:L.spotLightMap.length,numRectAreaLights:L.rectArea.length,numHemiLights:L.hemi.length,numDirLightShadows:L.directionalShadowMap.length,numPointLightShadows:L.pointShadowMap.length,numSpotLightShadows:L.spotShadowMap.length,numSpotLightShadowsWithMaps:L.numSpotLightShadowsWithMaps,numLightProbes:L.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:I.dithering,shadowMapEnabled:n.shadowMap.enabled&&W.length>0,shadowMapType:n.shadowMap.type,toneMapping:Pt,useLegacyLights:n._useLegacyLights,decodeVideoTexture:Qe&&I.map.isVideoTexture===!0&&gr.getTransfer(I.map.colorSpace)===Ir,premultipliedAlpha:I.premultipliedAlpha,doubleSided:I.side===Ka,flipSided:I.side===Cs,useDepthPacking:I.depthPacking>=0,depthPacking:I.depthPacking||0,index0AttributeName:I.index0AttributeName,extensionDerivatives:Bt&&I.extensions.derivatives===!0,extensionFragDepth:Bt&&I.extensions.fragDepth===!0,extensionDrawBuffers:Bt&&I.extensions.drawBuffers===!0,extensionShaderTextureLOD:Bt&&I.extensions.shaderTextureLOD===!0,extensionClipCullDistance:Bt&&I.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Bt&&I.extensions.multiDraw===!0&&r.has("WEBGL_multi_draw"),rendererExtensionFragDepth:d||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||r.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:I.customProgramCacheKey()};return xn.vertexUv1s=c.has(1),xn.vertexUv2s=c.has(2),xn.vertexUv3s=c.has(3),c.clear(),xn}function b(I){const L=[];if(I.shaderID?L.push(I.shaderID):(L.push(I.customVertexShaderID),L.push(I.customFragmentShaderID)),I.defines!==void 0)for(const W in I.defines)L.push(W),L.push(I.defines[W]);return I.isRawShaderMaterial===!1&&(S(L,I),_(L,I),L.push(n.outputColorSpace)),L.push(I.customProgramCacheKey),L.join()}function S(I,L){I.push(L.precision),I.push(L.outputColorSpace),I.push(L.envMapMode),I.push(L.envMapCubeUVHeight),I.push(L.mapUv),I.push(L.alphaMapUv),I.push(L.lightMapUv),I.push(L.aoMapUv),I.push(L.bumpMapUv),I.push(L.normalMapUv),I.push(L.displacementMapUv),I.push(L.emissiveMapUv),I.push(L.metalnessMapUv),I.push(L.roughnessMapUv),I.push(L.anisotropyMapUv),I.push(L.clearcoatMapUv),I.push(L.clearcoatNormalMapUv),I.push(L.clearcoatRoughnessMapUv),I.push(L.iridescenceMapUv),I.push(L.iridescenceThicknessMapUv),I.push(L.sheenColorMapUv),I.push(L.sheenRoughnessMapUv),I.push(L.specularMapUv),I.push(L.specularColorMapUv),I.push(L.specularIntensityMapUv),I.push(L.transmissionMapUv),I.push(L.thicknessMapUv),I.push(L.combine),I.push(L.fogExp2),I.push(L.sizeAttenuation),I.push(L.morphTargetsCount),I.push(L.morphAttributeCount),I.push(L.numDirLights),I.push(L.numPointLights),I.push(L.numSpotLights),I.push(L.numSpotLightMaps),I.push(L.numHemiLights),I.push(L.numRectAreaLights),I.push(L.numDirLightShadows),I.push(L.numPointLightShadows),I.push(L.numSpotLightShadows),I.push(L.numSpotLightShadowsWithMaps),I.push(L.numLightProbes),I.push(L.shadowMapType),I.push(L.toneMapping),I.push(L.numClippingPlanes),I.push(L.numClipIntersection),I.push(L.depthPacking)}function _(I,L){a.disableAll(),L.isWebGL2&&a.enable(0),L.supportsVertexTextures&&a.enable(1),L.instancing&&a.enable(2),L.instancingColor&&a.enable(3),L.matcap&&a.enable(4),L.envMap&&a.enable(5),L.normalMapObjectSpace&&a.enable(6),L.normalMapTangentSpace&&a.enable(7),L.clearcoat&&a.enable(8),L.iridescence&&a.enable(9),L.alphaTest&&a.enable(10),L.vertexColors&&a.enable(11),L.vertexAlphas&&a.enable(12),L.vertexUv1s&&a.enable(13),L.vertexUv2s&&a.enable(14),L.vertexUv3s&&a.enable(15),L.vertexTangents&&a.enable(16),L.anisotropy&&a.enable(17),L.alphaHash&&a.enable(18),L.batching&&a.enable(19),I.push(a.mask),a.disableAll(),L.fog&&a.enable(0),L.useFog&&a.enable(1),L.flatShading&&a.enable(2),L.logarithmicDepthBuffer&&a.enable(3),L.skinning&&a.enable(4),L.morphTargets&&a.enable(5),L.morphNormals&&a.enable(6),L.morphColors&&a.enable(7),L.premultipliedAlpha&&a.enable(8),L.shadowMapEnabled&&a.enable(9),L.useLegacyLights&&a.enable(10),L.doubleSided&&a.enable(11),L.flipSided&&a.enable(12),L.useDepthPacking&&a.enable(13),L.dithering&&a.enable(14),L.transmission&&a.enable(15),L.sheen&&a.enable(16),L.opaque&&a.enable(17),L.pointsUvs&&a.enable(18),L.decodeVideoTexture&&a.enable(19),L.alphaToCoverage&&a.enable(20),I.push(a.mask)}function T(I){const L=x[I.type];let W;if(L){const q=Ha[L];W=tR.clone(q.uniforms)}else W=I.uniforms;return W}function M(I,L){let W;for(let q=0,$=u.length;q<$;q++){const ne=u[q];if(ne.cacheKey===L){W=ne,++W.usedTimes;break}}return W===void 0&&(W=new rpe(n,L,I,s),u.push(W)),W}function k(I){if(--I.usedTimes===0){const L=u.indexOf(I);u[L]=u[u.length-1],u.pop(),I.destroy()}}function P(I){l.remove(I)}function z(){l.dispose()}return{getParameters:y,getProgramCacheKey:b,getUniforms:T,acquireProgram:M,releaseProgram:k,releaseShaderCache:P,programs:u,dispose:z}}function lpe(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function r(s,o,a){n.get(s)[o]=a}function i(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:i}}function cpe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function $O(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function jO(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function o(d,h,f,p,x,v){let y=n[e];return y===void 0?(y={id:d.id,object:d,geometry:h,material:f,groupOrder:p,renderOrder:d.renderOrder,z:x,group:v},n[e]=y):(y.id=d.id,y.object=d,y.geometry=h,y.material=f,y.groupOrder=p,y.renderOrder=d.renderOrder,y.z=x,y.group=v),e++,y}function a(d,h,f,p,x,v){const y=o(d,h,f,p,x,v);f.transmission>0?r.push(y):f.transparent===!0?i.push(y):t.push(y)}function l(d,h,f,p,x,v){const y=o(d,h,f,p,x,v);f.transmission>0?r.unshift(y):f.transparent===!0?i.unshift(y):t.unshift(y)}function c(d,h){t.length>1&&t.sort(d||cpe),r.length>1&&r.sort(h||$O),i.length>1&&i.sort(h||$O)}function u(){for(let d=e,h=n.length;d<h;d++){const f=n[d];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:a,unshift:l,finish:u,sort:c}}function upe(){let n=new WeakMap;function e(r,i){const s=n.get(r);let o;return s===void 0?(o=new jO,n.set(r,[o])):i>=s.length?(o=new jO,s.push(o)):o=s[i],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function dpe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ie,color:new Ut};break;case"SpotLight":t={position:new ie,direction:new ie,color:new Ut,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ie,color:new Ut,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ie,skyColor:new Ut,groundColor:new Ut};break;case"RectAreaLight":t={color:new Ut,position:new ie,halfWidth:new ie,halfHeight:new ie};break}return n[e.id]=t,t}}}function hpe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ze};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ze};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ze,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let fpe=0;function ppe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function mpe(n,e){const t=new dpe,r=hpe(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)i.probe.push(new ie);const s=new ie,o=new vn,a=new vn;function l(u,d){let h=0,f=0,p=0;for(let W=0;W<9;W++)i.probe[W].set(0,0,0);let x=0,v=0,y=0,b=0,S=0,_=0,T=0,M=0,k=0,P=0,z=0;u.sort(ppe);const I=d===!0?Math.PI:1;for(let W=0,q=u.length;W<q;W++){const $=u[W],ne=$.color,Y=$.intensity,we=$.distance,H=$.shadow&&$.shadow.map?$.shadow.map.texture:null;if($.isAmbientLight)h+=ne.r*Y*I,f+=ne.g*Y*I,p+=ne.b*Y*I;else if($.isLightProbe){for(let X=0;X<9;X++)i.probe[X].addScaledVector($.sh.coefficients[X],Y);z++}else if($.isDirectionalLight){const X=t.get($);if(X.color.copy($.color).multiplyScalar($.intensity*I),$.castShadow){const oe=$.shadow,ve=r.get($);ve.shadowBias=oe.bias,ve.shadowNormalBias=oe.normalBias,ve.shadowRadius=oe.radius,ve.shadowMapSize=oe.mapSize,i.directionalShadow[x]=ve,i.directionalShadowMap[x]=H,i.directionalShadowMatrix[x]=$.shadow.matrix,_++}i.directional[x]=X,x++}else if($.isSpotLight){const X=t.get($);X.position.setFromMatrixPosition($.matrixWorld),X.color.copy(ne).multiplyScalar(Y*I),X.distance=we,X.coneCos=Math.cos($.angle),X.penumbraCos=Math.cos($.angle*(1-$.penumbra)),X.decay=$.decay,i.spot[y]=X;const oe=$.shadow;if($.map&&(i.spotLightMap[k]=$.map,k++,oe.updateMatrices($),$.castShadow&&P++),i.spotLightMatrix[y]=oe.matrix,$.castShadow){const ve=r.get($);ve.shadowBias=oe.bias,ve.shadowNormalBias=oe.normalBias,ve.shadowRadius=oe.radius,ve.shadowMapSize=oe.mapSize,i.spotShadow[y]=ve,i.spotShadowMap[y]=H,M++}y++}else if($.isRectAreaLight){const X=t.get($);X.color.copy(ne).multiplyScalar(Y),X.halfWidth.set($.width*.5,0,0),X.halfHeight.set(0,$.height*.5,0),i.rectArea[b]=X,b++}else if($.isPointLight){const X=t.get($);if(X.color.copy($.color).multiplyScalar($.intensity*I),X.distance=$.distance,X.decay=$.decay,$.castShadow){const oe=$.shadow,ve=r.get($);ve.shadowBias=oe.bias,ve.shadowNormalBias=oe.normalBias,ve.shadowRadius=oe.radius,ve.shadowMapSize=oe.mapSize,ve.shadowCameraNear=oe.camera.near,ve.shadowCameraFar=oe.camera.far,i.pointShadow[v]=ve,i.pointShadowMap[v]=H,i.pointShadowMatrix[v]=$.shadow.matrix,T++}i.point[v]=X,v++}else if($.isHemisphereLight){const X=t.get($);X.skyColor.copy($.color).multiplyScalar(Y*I),X.groundColor.copy($.groundColor).multiplyScalar(Y*I),i.hemi[S]=X,S++}}b>0&&(e.isWebGL2?n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Ct.LTC_FLOAT_1,i.rectAreaLTC2=Ct.LTC_FLOAT_2):(i.rectAreaLTC1=Ct.LTC_HALF_1,i.rectAreaLTC2=Ct.LTC_HALF_2):n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Ct.LTC_FLOAT_1,i.rectAreaLTC2=Ct.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=Ct.LTC_HALF_1,i.rectAreaLTC2=Ct.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=h,i.ambient[1]=f,i.ambient[2]=p;const L=i.hash;(L.directionalLength!==x||L.pointLength!==v||L.spotLength!==y||L.rectAreaLength!==b||L.hemiLength!==S||L.numDirectionalShadows!==_||L.numPointShadows!==T||L.numSpotShadows!==M||L.numSpotMaps!==k||L.numLightProbes!==z)&&(i.directional.length=x,i.spot.length=y,i.rectArea.length=b,i.point.length=v,i.hemi.length=S,i.directionalShadow.length=_,i.directionalShadowMap.length=_,i.pointShadow.length=T,i.pointShadowMap.length=T,i.spotShadow.length=M,i.spotShadowMap.length=M,i.directionalShadowMatrix.length=_,i.pointShadowMatrix.length=T,i.spotLightMatrix.length=M+k-P,i.spotLightMap.length=k,i.numSpotLightShadowsWithMaps=P,i.numLightProbes=z,L.directionalLength=x,L.pointLength=v,L.spotLength=y,L.rectAreaLength=b,L.hemiLength=S,L.numDirectionalShadows=_,L.numPointShadows=T,L.numSpotShadows=M,L.numSpotMaps=k,L.numLightProbes=z,i.version=fpe++)}function c(u,d){let h=0,f=0,p=0,x=0,v=0;const y=d.matrixWorldInverse;for(let b=0,S=u.length;b<S;b++){const _=u[b];if(_.isDirectionalLight){const T=i.directional[h];T.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),T.direction.sub(s),T.direction.transformDirection(y),h++}else if(_.isSpotLight){const T=i.spot[p];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(y),T.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),T.direction.sub(s),T.direction.transformDirection(y),p++}else if(_.isRectAreaLight){const T=i.rectArea[x];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(y),a.identity(),o.copy(_.matrixWorld),o.premultiply(y),a.extractRotation(o),T.halfWidth.set(_.width*.5,0,0),T.halfHeight.set(0,_.height*.5,0),T.halfWidth.applyMatrix4(a),T.halfHeight.applyMatrix4(a),x++}else if(_.isPointLight){const T=i.point[f];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(y),f++}else if(_.isHemisphereLight){const T=i.hemi[v];T.direction.setFromMatrixPosition(_.matrixWorld),T.direction.transformDirection(y),v++}}}return{setup:l,setupView:c,state:i}}function VO(n,e){const t=new mpe(n,e),r=[],i=[];function s(){r.length=0,i.length=0}function o(d){r.push(d)}function a(d){i.push(d)}function l(d){t.setup(r,d)}function c(d){t.setupView(r,d)}return{init:s,state:{lightsArray:r,shadowsArray:i,lights:t},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function gpe(n,e){let t=new WeakMap;function r(s,o=0){const a=t.get(s);let l;return a===void 0?(l=new VO(n,e),t.set(s,[l])):o>=a.length?(l=new VO(n,e),a.push(l)):l=a[o],l}function i(){t=new WeakMap}return{get:r,dispose:i}}class iR extends ks{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Y6,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class sR extends ks{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const ype=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,vpe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function xpe(n,e,t){let r=new lx;const i=new Ze,s=new Ze,o=new vr,a=new iR({depthPacking:Z6}),l=new sR,c={},u=t.maxTextureSize,d={[Wc]:Cs,[Cs]:Wc,[Ka]:Ka},h=new Ys({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ze},radius:{value:4}},vertexShader:ype,fragmentShader:vpe}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const p=new Pn;p.setAttribute("position",new pr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const x=new ri(p,h),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=P_;let y=this.type;this.render=function(M,k,P){if(v.enabled===!1||v.autoUpdate===!1&&v.needsUpdate===!1||M.length===0)return;const z=n.getRenderTarget(),I=n.getActiveCubeFace(),L=n.getActiveMipmapLevel(),W=n.state;W.setBlending(zl),W.buffers.color.setClear(1,1,1,1),W.buffers.depth.setTest(!0),W.setScissorTest(!1);const q=y!==$a&&this.type===$a,$=y===$a&&this.type!==$a;for(let ne=0,Y=M.length;ne<Y;ne++){const we=M[ne],H=we.shadow;if(H===void 0){console.warn("THREE.WebGLShadowMap:",we,"has no shadow.");continue}if(H.autoUpdate===!1&&H.needsUpdate===!1)continue;i.copy(H.mapSize);const X=H.getFrameExtents();if(i.multiply(X),s.copy(H.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/X.x),i.x=s.x*X.x,H.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/X.y),i.y=s.y*X.y,H.mapSize.y=s.y)),H.map===null||q===!0||$===!0){const ve=this.type!==$a?{minFilter:yi,magFilter:yi}:{};H.map!==null&&H.map.dispose(),H.map=new Eo(i.x,i.y,ve),H.map.texture.name=we.name+".shadowMap",H.camera.updateProjectionMatrix()}n.setRenderTarget(H.map),n.clear();const oe=H.getViewportCount();for(let ve=0;ve<oe;ve++){const Te=H.getViewport(ve);o.set(s.x*Te.x,s.y*Te.y,s.x*Te.z,s.y*Te.w),W.viewport(o),H.updateMatrices(we,ve),r=H.getFrustum(),_(k,P,H.camera,we,this.type)}H.isPointLightShadow!==!0&&this.type===$a&&b(H,P),H.needsUpdate=!1}y=this.type,v.needsUpdate=!1,n.setRenderTarget(z,I,L)};function b(M,k){const P=e.update(x);h.defines.VSM_SAMPLES!==M.blurSamples&&(h.defines.VSM_SAMPLES=M.blurSamples,f.defines.VSM_SAMPLES=M.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),M.mapPass===null&&(M.mapPass=new Eo(i.x,i.y)),h.uniforms.shadow_pass.value=M.map.texture,h.uniforms.resolution.value=M.mapSize,h.uniforms.radius.value=M.radius,n.setRenderTarget(M.mapPass),n.clear(),n.renderBufferDirect(k,null,P,h,x,null),f.uniforms.shadow_pass.value=M.mapPass.texture,f.uniforms.resolution.value=M.mapSize,f.uniforms.radius.value=M.radius,n.setRenderTarget(M.map),n.clear(),n.renderBufferDirect(k,null,P,f,x,null)}function S(M,k,P,z){let I=null;const L=P.isPointLight===!0?M.customDistanceMaterial:M.customDepthMaterial;if(L!==void 0)I=L;else if(I=P.isPointLight===!0?l:a,n.localClippingEnabled&&k.clipShadows===!0&&Array.isArray(k.clippingPlanes)&&k.clippingPlanes.length!==0||k.displacementMap&&k.displacementScale!==0||k.alphaMap&&k.alphaTest>0||k.map&&k.alphaTest>0){const W=I.uuid,q=k.uuid;let $=c[W];$===void 0&&($={},c[W]=$);let ne=$[q];ne===void 0&&(ne=I.clone(),$[q]=ne,k.addEventListener("dispose",T)),I=ne}if(I.visible=k.visible,I.wireframe=k.wireframe,z===$a?I.side=k.shadowSide!==null?k.shadowSide:k.side:I.side=k.shadowSide!==null?k.shadowSide:d[k.side],I.alphaMap=k.alphaMap,I.alphaTest=k.alphaTest,I.map=k.map,I.clipShadows=k.clipShadows,I.clippingPlanes=k.clippingPlanes,I.clipIntersection=k.clipIntersection,I.displacementMap=k.displacementMap,I.displacementScale=k.displacementScale,I.displacementBias=k.displacementBias,I.wireframeLinewidth=k.wireframeLinewidth,I.linewidth=k.linewidth,P.isPointLight===!0&&I.isMeshDistanceMaterial===!0){const W=n.properties.get(I);W.light=P}return I}function _(M,k,P,z,I){if(M.visible===!1)return;if(M.layers.test(k.layers)&&(M.isMesh||M.isLine||M.isPoints)&&(M.castShadow||M.receiveShadow&&I===$a)&&(!M.frustumCulled||r.intersectsObject(M))){M.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,M.matrixWorld);const q=e.update(M),$=M.material;if(Array.isArray($)){const ne=q.groups;for(let Y=0,we=ne.length;Y<we;Y++){const H=ne[Y],X=$[H.materialIndex];if(X&&X.visible){const oe=S(M,X,z,I);M.onBeforeShadow(n,M,k,P,q,oe,H),n.renderBufferDirect(P,null,q,oe,M,H),M.onAfterShadow(n,M,k,P,q,oe,H)}}}else if($.visible){const ne=S(M,$,z,I);M.onBeforeShadow(n,M,k,P,q,ne,null),n.renderBufferDirect(P,null,q,ne,M,null),M.onAfterShadow(n,M,k,P,q,ne,null)}}const W=M.children;for(let q=0,$=W.length;q<$;q++)_(W[q],k,P,z,I)}function T(M){M.target.removeEventListener("dispose",T);for(const P in c){const z=c[P],I=M.target.uuid;I in z&&(z[I].dispose(),delete z[I])}}}function wpe(n,e,t){const r=t.isWebGL2;function i(){let fe=!1;const ot=new vr;let ht=null;const Bt=new vr(0,0,0,0);return{setMask:function(Pt){ht!==Pt&&!fe&&(n.colorMask(Pt,Pt,Pt,Pt),ht=Pt)},setLocked:function(Pt){fe=Pt},setClear:function(Pt,xn,Dn,ir,wr){wr===!0&&(Pt*=ir,xn*=ir,Dn*=ir),ot.set(Pt,xn,Dn,ir),Bt.equals(ot)===!1&&(n.clearColor(Pt,xn,Dn,ir),Bt.copy(ot))},reset:function(){fe=!1,ht=null,Bt.set(-1,0,0,0)}}}function s(){let fe=!1,ot=null,ht=null,Bt=null;return{setTest:function(Pt){Pt?rt(n.DEPTH_TEST):ut(n.DEPTH_TEST)},setMask:function(Pt){ot!==Pt&&!fe&&(n.depthMask(Pt),ot=Pt)},setFunc:function(Pt){if(ht!==Pt){switch(Pt){case M6:n.depthFunc(n.NEVER);break;case A6:n.depthFunc(n.ALWAYS);break;case N6:n.depthFunc(n.LESS);break;case r0:n.depthFunc(n.LEQUAL);break;case k6:n.depthFunc(n.EQUAL);break;case I6:n.depthFunc(n.GEQUAL);break;case R6:n.depthFunc(n.GREATER);break;case P6:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}ht=Pt}},setLocked:function(Pt){fe=Pt},setClear:function(Pt){Bt!==Pt&&(n.clearDepth(Pt),Bt=Pt)},reset:function(){fe=!1,ot=null,ht=null,Bt=null}}}function o(){let fe=!1,ot=null,ht=null,Bt=null,Pt=null,xn=null,Dn=null,ir=null,wr=null;return{setTest:function(Wn){fe||(Wn?rt(n.STENCIL_TEST):ut(n.STENCIL_TEST))},setMask:function(Wn){ot!==Wn&&!fe&&(n.stencilMask(Wn),ot=Wn)},setFunc:function(Wn,kr,cs){(ht!==Wn||Bt!==kr||Pt!==cs)&&(n.stencilFunc(Wn,kr,cs),ht=Wn,Bt=kr,Pt=cs)},setOp:function(Wn,kr,cs){(xn!==Wn||Dn!==kr||ir!==cs)&&(n.stencilOp(Wn,kr,cs),xn=Wn,Dn=kr,ir=cs)},setLocked:function(Wn){fe=Wn},setClear:function(Wn){wr!==Wn&&(n.clearStencil(Wn),wr=Wn)},reset:function(){fe=!1,ot=null,ht=null,Bt=null,Pt=null,xn=null,Dn=null,ir=null,wr=null}}}const a=new i,l=new s,c=new o,u=new WeakMap,d=new WeakMap;let h={},f={},p=new WeakMap,x=[],v=null,y=!1,b=null,S=null,_=null,T=null,M=null,k=null,P=null,z=new Ut(0,0,0),I=0,L=!1,W=null,q=null,$=null,ne=null,Y=null;const we=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let H=!1,X=0;const oe=n.getParameter(n.VERSION);oe.indexOf("WebGL")!==-1?(X=parseFloat(/^WebGL (\d)/.exec(oe)[1]),H=X>=1):oe.indexOf("OpenGL ES")!==-1&&(X=parseFloat(/^OpenGL ES (\d)/.exec(oe)[1]),H=X>=2);let ve=null,Te={};const Xe=n.getParameter(n.SCISSOR_BOX),_e=n.getParameter(n.VIEWPORT),Ue=new vr().fromArray(Xe),Fe=new vr().fromArray(_e);function Oe(fe,ot,ht,Bt){const Pt=new Uint8Array(4),xn=n.createTexture();n.bindTexture(fe,xn),n.texParameteri(fe,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(fe,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Dn=0;Dn<ht;Dn++)r&&(fe===n.TEXTURE_3D||fe===n.TEXTURE_2D_ARRAY)?n.texImage3D(ot,0,n.RGBA,1,1,Bt,0,n.RGBA,n.UNSIGNED_BYTE,Pt):n.texImage2D(ot+Dn,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Pt);return xn}const nt={};nt[n.TEXTURE_2D]=Oe(n.TEXTURE_2D,n.TEXTURE_2D,1),nt[n.TEXTURE_CUBE_MAP]=Oe(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(nt[n.TEXTURE_2D_ARRAY]=Oe(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),nt[n.TEXTURE_3D]=Oe(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),rt(n.DEPTH_TEST),l.setFunc(r0),pt(!1),Q(JM),rt(n.CULL_FACE),Ge(zl);function rt(fe){h[fe]!==!0&&(n.enable(fe),h[fe]=!0)}function ut(fe){h[fe]!==!1&&(n.disable(fe),h[fe]=!1)}function Qe(fe,ot){return f[fe]!==ot?(n.bindFramebuffer(fe,ot),f[fe]=ot,r&&(fe===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=ot),fe===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=ot)),!0):!1}function ae(fe,ot){let ht=x,Bt=!1;if(fe)if(ht=p.get(ot),ht===void 0&&(ht=[],p.set(ot,ht)),fe.isWebGLMultipleRenderTargets){const Pt=fe.texture;if(ht.length!==Pt.length||ht[0]!==n.COLOR_ATTACHMENT0){for(let xn=0,Dn=Pt.length;xn<Dn;xn++)ht[xn]=n.COLOR_ATTACHMENT0+xn;ht.length=Pt.length,Bt=!0}}else ht[0]!==n.COLOR_ATTACHMENT0&&(ht[0]=n.COLOR_ATTACHMENT0,Bt=!0);else ht[0]!==n.BACK&&(ht[0]=n.BACK,Bt=!0);Bt&&(t.isWebGL2?n.drawBuffers(ht):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ht))}function ze(fe){return v!==fe?(n.useProgram(fe),v=fe,!0):!1}const Re={[Du]:n.FUNC_ADD,[h6]:n.FUNC_SUBTRACT,[f6]:n.FUNC_REVERSE_SUBTRACT};if(r)Re[rA]=n.MIN,Re[iA]=n.MAX;else{const fe=e.get("EXT_blend_minmax");fe!==null&&(Re[rA]=fe.MIN_EXT,Re[iA]=fe.MAX_EXT)}const Je={[p6]:n.ZERO,[m6]:n.ONE,[g6]:n.SRC_COLOR,[xS]:n.SRC_ALPHA,[S6]:n.SRC_ALPHA_SATURATE,[w6]:n.DST_COLOR,[v6]:n.DST_ALPHA,[y6]:n.ONE_MINUS_SRC_COLOR,[wS]:n.ONE_MINUS_SRC_ALPHA,[b6]:n.ONE_MINUS_DST_COLOR,[x6]:n.ONE_MINUS_DST_ALPHA,[_6]:n.CONSTANT_COLOR,[E6]:n.ONE_MINUS_CONSTANT_COLOR,[C6]:n.CONSTANT_ALPHA,[T6]:n.ONE_MINUS_CONSTANT_ALPHA};function Ge(fe,ot,ht,Bt,Pt,xn,Dn,ir,wr,Wn){if(fe===zl){y===!0&&(ut(n.BLEND),y=!1);return}if(y===!1&&(rt(n.BLEND),y=!0),fe!==d6){if(fe!==b||Wn!==L){if((S!==Du||M!==Du)&&(n.blendEquation(n.FUNC_ADD),S=Du,M=Du),Wn)switch(fe){case jh:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case eA:n.blendFunc(n.ONE,n.ONE);break;case tA:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case nA:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",fe);break}else switch(fe){case jh:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case eA:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case tA:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case nA:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",fe);break}_=null,T=null,k=null,P=null,z.set(0,0,0),I=0,b=fe,L=Wn}return}Pt=Pt||ot,xn=xn||ht,Dn=Dn||Bt,(ot!==S||Pt!==M)&&(n.blendEquationSeparate(Re[ot],Re[Pt]),S=ot,M=Pt),(ht!==_||Bt!==T||xn!==k||Dn!==P)&&(n.blendFuncSeparate(Je[ht],Je[Bt],Je[xn],Je[Dn]),_=ht,T=Bt,k=xn,P=Dn),(ir.equals(z)===!1||wr!==I)&&(n.blendColor(ir.r,ir.g,ir.b,wr),z.copy(ir),I=wr),b=fe,L=!1}function Et(fe,ot){fe.side===Ka?ut(n.CULL_FACE):rt(n.CULL_FACE);let ht=fe.side===Cs;ot&&(ht=!ht),pt(ht),fe.blending===jh&&fe.transparent===!1?Ge(zl):Ge(fe.blending,fe.blendEquation,fe.blendSrc,fe.blendDst,fe.blendEquationAlpha,fe.blendSrcAlpha,fe.blendDstAlpha,fe.blendColor,fe.blendAlpha,fe.premultipliedAlpha),l.setFunc(fe.depthFunc),l.setTest(fe.depthTest),l.setMask(fe.depthWrite),a.setMask(fe.colorWrite);const Bt=fe.stencilWrite;c.setTest(Bt),Bt&&(c.setMask(fe.stencilWriteMask),c.setFunc(fe.stencilFunc,fe.stencilRef,fe.stencilFuncMask),c.setOp(fe.stencilFail,fe.stencilZFail,fe.stencilZPass)),ke(fe.polygonOffset,fe.polygonOffsetFactor,fe.polygonOffsetUnits),fe.alphaToCoverage===!0?rt(n.SAMPLE_ALPHA_TO_COVERAGE):ut(n.SAMPLE_ALPHA_TO_COVERAGE)}function pt(fe){W!==fe&&(fe?n.frontFace(n.CW):n.frontFace(n.CCW),W=fe)}function Q(fe){fe!==l6?(rt(n.CULL_FACE),fe!==q&&(fe===JM?n.cullFace(n.BACK):fe===c6?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):ut(n.CULL_FACE),q=fe}function G(fe){fe!==$&&(H&&n.lineWidth(fe),$=fe)}function ke(fe,ot,ht){fe?(rt(n.POLYGON_OFFSET_FILL),(ne!==ot||Y!==ht)&&(n.polygonOffset(ot,ht),ne=ot,Y=ht)):ut(n.POLYGON_OFFSET_FILL)}function J(fe){fe?rt(n.SCISSOR_TEST):ut(n.SCISSOR_TEST)}function he(fe){fe===void 0&&(fe=n.TEXTURE0+we-1),ve!==fe&&(n.activeTexture(fe),ve=fe)}function ee(fe,ot,ht){ht===void 0&&(ve===null?ht=n.TEXTURE0+we-1:ht=ve);let Bt=Te[ht];Bt===void 0&&(Bt={type:void 0,texture:void 0},Te[ht]=Bt),(Bt.type!==fe||Bt.texture!==ot)&&(ve!==ht&&(n.activeTexture(ht),ve=ht),n.bindTexture(fe,ot||nt[fe]),Bt.type=fe,Bt.texture=ot)}function Ee(){const fe=Te[ve];fe!==void 0&&fe.type!==void 0&&(n.bindTexture(fe.type,null),fe.type=void 0,fe.texture=void 0)}function Me(){try{n.compressedTexImage2D.apply(n,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Ae(){try{n.compressedTexImage3D.apply(n,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Be(){try{n.texSubImage2D.apply(n,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function dt(){try{n.texSubImage3D.apply(n,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function We(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Kt(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function cn(){try{n.texStorage2D.apply(n,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function jt(){try{n.texStorage3D.apply(n,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function wt(){try{n.texImage2D.apply(n,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Mt(){try{n.texImage3D.apply(n,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function ye(fe){Ue.equals(fe)===!1&&(n.scissor(fe.x,fe.y,fe.z,fe.w),Ue.copy(fe))}function He(fe){Fe.equals(fe)===!1&&(n.viewport(fe.x,fe.y,fe.z,fe.w),Fe.copy(fe))}function st(fe,ot){let ht=d.get(ot);ht===void 0&&(ht=new WeakMap,d.set(ot,ht));let Bt=ht.get(fe);Bt===void 0&&(Bt=n.getUniformBlockIndex(ot,fe.name),ht.set(fe,Bt))}function _t(fe,ot){const Bt=d.get(ot).get(fe);u.get(ot)!==Bt&&(n.uniformBlockBinding(ot,Bt,fe.__bindingPointIndex),u.set(ot,Bt))}function Ye(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),r===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},ve=null,Te={},f={},p=new WeakMap,x=[],v=null,y=!1,b=null,S=null,_=null,T=null,M=null,k=null,P=null,z=new Ut(0,0,0),I=0,L=!1,W=null,q=null,$=null,ne=null,Y=null,Ue.set(0,0,n.canvas.width,n.canvas.height),Fe.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:rt,disable:ut,bindFramebuffer:Qe,drawBuffers:ae,useProgram:ze,setBlending:Ge,setMaterial:Et,setFlipSided:pt,setCullFace:Q,setLineWidth:G,setPolygonOffset:ke,setScissorTest:J,activeTexture:he,bindTexture:ee,unbindTexture:Ee,compressedTexImage2D:Me,compressedTexImage3D:Ae,texImage2D:wt,texImage3D:Mt,updateUBOMapping:st,uniformBlockBinding:_t,texStorage2D:cn,texStorage3D:jt,texSubImage2D:Be,texSubImage3D:dt,compressedTexSubImage2D:We,compressedTexSubImage3D:Kt,scissor:ye,viewport:He,reset:Ye}}function bpe(n,e,t,r,i,s,o){const a=i.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new WeakMap;let d;const h=new WeakMap;let f=!1;try{f=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(Q,G){return f?new OffscreenCanvas(Q,G):p0("canvas")}function x(Q,G,ke,J){let he=1;if((Q.width>J||Q.height>J)&&(he=J/Math.max(Q.width,Q.height)),he<1||G===!0)if(typeof HTMLImageElement<"u"&&Q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Q instanceof ImageBitmap){const ee=G?_S:Math.floor,Ee=ee(he*Q.width),Me=ee(he*Q.height);d===void 0&&(d=p(Ee,Me));const Ae=ke?p(Ee,Me):d;return Ae.width=Ee,Ae.height=Me,Ae.getContext("2d").drawImage(Q,0,0,Ee,Me),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Q.width+"x"+Q.height+") to ("+Ee+"x"+Me+")."),Ae}else return"data"in Q&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Q.width+"x"+Q.height+")."),Q;return Q}function v(Q){return DA(Q.width)&&DA(Q.height)}function y(Q){return a?!1:Q.wrapS!==Gr||Q.wrapT!==Gr||Q.minFilter!==yi&&Q.minFilter!==Jn}function b(Q,G){return Q.generateMipmaps&&G&&Q.minFilter!==yi&&Q.minFilter!==Jn}function S(Q){n.generateMipmap(Q)}function _(Q,G,ke,J,he=!1){if(a===!1)return G;if(Q!==null){if(n[Q]!==void 0)return n[Q];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Q+"'")}let ee=G;if(G===n.RED&&(ke===n.FLOAT&&(ee=n.R32F),ke===n.HALF_FLOAT&&(ee=n.R16F),ke===n.UNSIGNED_BYTE&&(ee=n.R8)),G===n.RED_INTEGER&&(ke===n.UNSIGNED_BYTE&&(ee=n.R8UI),ke===n.UNSIGNED_SHORT&&(ee=n.R16UI),ke===n.UNSIGNED_INT&&(ee=n.R32UI),ke===n.BYTE&&(ee=n.R8I),ke===n.SHORT&&(ee=n.R16I),ke===n.INT&&(ee=n.R32I)),G===n.RG&&(ke===n.FLOAT&&(ee=n.RG32F),ke===n.HALF_FLOAT&&(ee=n.RG16F),ke===n.UNSIGNED_BYTE&&(ee=n.RG8)),G===n.RGBA){const Ee=he?c0:gr.getTransfer(J);ke===n.FLOAT&&(ee=n.RGBA32F),ke===n.HALF_FLOAT&&(ee=n.RGBA16F),ke===n.UNSIGNED_BYTE&&(ee=Ee===Ir?n.SRGB8_ALPHA8:n.RGBA8),ke===n.UNSIGNED_SHORT_4_4_4_4&&(ee=n.RGBA4),ke===n.UNSIGNED_SHORT_5_5_5_1&&(ee=n.RGB5_A1)}return(ee===n.R16F||ee===n.R32F||ee===n.RG16F||ee===n.RG32F||ee===n.RGBA16F||ee===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ee}function T(Q,G,ke){return b(Q,ke)===!0||Q.isFramebufferTexture&&Q.minFilter!==yi&&Q.minFilter!==Jn?Math.log2(Math.max(G.width,G.height))+1:Q.mipmaps!==void 0&&Q.mipmaps.length>0?Q.mipmaps.length:Q.isCompressedTexture&&Array.isArray(Q.image)?G.mipmaps.length:1}function M(Q){return Q===yi||Q===bS||Q===yh?n.NEAREST:n.LINEAR}function k(Q){const G=Q.target;G.removeEventListener("dispose",k),z(G),G.isVideoTexture&&u.delete(G)}function P(Q){const G=Q.target;G.removeEventListener("dispose",P),L(G)}function z(Q){const G=r.get(Q);if(G.__webglInit===void 0)return;const ke=Q.source,J=h.get(ke);if(J){const he=J[G.__cacheKey];he.usedTimes--,he.usedTimes===0&&I(Q),Object.keys(J).length===0&&h.delete(ke)}r.remove(Q)}function I(Q){const G=r.get(Q);n.deleteTexture(G.__webglTexture);const ke=Q.source,J=h.get(ke);delete J[G.__cacheKey],o.memory.textures--}function L(Q){const G=Q.texture,ke=r.get(Q),J=r.get(G);if(J.__webglTexture!==void 0&&(n.deleteTexture(J.__webglTexture),o.memory.textures--),Q.depthTexture&&Q.depthTexture.dispose(),Q.isWebGLCubeRenderTarget)for(let he=0;he<6;he++){if(Array.isArray(ke.__webglFramebuffer[he]))for(let ee=0;ee<ke.__webglFramebuffer[he].length;ee++)n.deleteFramebuffer(ke.__webglFramebuffer[he][ee]);else n.deleteFramebuffer(ke.__webglFramebuffer[he]);ke.__webglDepthbuffer&&n.deleteRenderbuffer(ke.__webglDepthbuffer[he])}else{if(Array.isArray(ke.__webglFramebuffer))for(let he=0;he<ke.__webglFramebuffer.length;he++)n.deleteFramebuffer(ke.__webglFramebuffer[he]);else n.deleteFramebuffer(ke.__webglFramebuffer);if(ke.__webglDepthbuffer&&n.deleteRenderbuffer(ke.__webglDepthbuffer),ke.__webglMultisampledFramebuffer&&n.deleteFramebuffer(ke.__webglMultisampledFramebuffer),ke.__webglColorRenderbuffer)for(let he=0;he<ke.__webglColorRenderbuffer.length;he++)ke.__webglColorRenderbuffer[he]&&n.deleteRenderbuffer(ke.__webglColorRenderbuffer[he]);ke.__webglDepthRenderbuffer&&n.deleteRenderbuffer(ke.__webglDepthRenderbuffer)}if(Q.isWebGLMultipleRenderTargets)for(let he=0,ee=G.length;he<ee;he++){const Ee=r.get(G[he]);Ee.__webglTexture&&(n.deleteTexture(Ee.__webglTexture),o.memory.textures--),r.remove(G[he])}r.remove(G),r.remove(Q)}let W=0;function q(){W=0}function $(){const Q=W;return Q>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Q+" texture units while this GPU supports only "+i.maxTextures),W+=1,Q}function ne(Q){const G=[];return G.push(Q.wrapS),G.push(Q.wrapT),G.push(Q.wrapR||0),G.push(Q.magFilter),G.push(Q.minFilter),G.push(Q.anisotropy),G.push(Q.internalFormat),G.push(Q.format),G.push(Q.type),G.push(Q.generateMipmaps),G.push(Q.premultiplyAlpha),G.push(Q.flipY),G.push(Q.unpackAlignment),G.push(Q.colorSpace),G.join()}function Y(Q,G){const ke=r.get(Q);if(Q.isVideoTexture&&Et(Q),Q.isRenderTargetTexture===!1&&Q.version>0&&ke.__version!==Q.version){const J=Q.image;if(J===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(J.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ue(ke,Q,G);return}}t.bindTexture(n.TEXTURE_2D,ke.__webglTexture,n.TEXTURE0+G)}function we(Q,G){const ke=r.get(Q);if(Q.version>0&&ke.__version!==Q.version){Ue(ke,Q,G);return}t.bindTexture(n.TEXTURE_2D_ARRAY,ke.__webglTexture,n.TEXTURE0+G)}function H(Q,G){const ke=r.get(Q);if(Q.version>0&&ke.__version!==Q.version){Ue(ke,Q,G);return}t.bindTexture(n.TEXTURE_3D,ke.__webglTexture,n.TEXTURE0+G)}function X(Q,G){const ke=r.get(Q);if(Q.version>0&&ke.__version!==Q.version){Fe(ke,Q,G);return}t.bindTexture(n.TEXTURE_CUBE_MAP,ke.__webglTexture,n.TEXTURE0+G)}const oe={[Vm]:n.REPEAT,[Gr]:n.CLAMP_TO_EDGE,[s0]:n.MIRRORED_REPEAT},ve={[yi]:n.NEAREST,[bS]:n.NEAREST_MIPMAP_NEAREST,[yh]:n.NEAREST_MIPMAP_LINEAR,[Jn]:n.LINEAR,[lv]:n.LINEAR_MIPMAP_NEAREST,[Nl]:n.LINEAR_MIPMAP_LINEAR},Te={[J6]:n.NEVER,[sW]:n.ALWAYS,[eW]:n.LESS,[KI]:n.LEQUAL,[tW]:n.EQUAL,[iW]:n.GEQUAL,[nW]:n.GREATER,[rW]:n.NOTEQUAL};function Xe(Q,G,ke){if(G.type===fi&&e.has("OES_texture_float_linear")===!1&&(G.magFilter===Jn||G.magFilter===lv||G.magFilter===yh||G.magFilter===Nl||G.minFilter===Jn||G.minFilter===lv||G.minFilter===yh||G.minFilter===Nl)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),ke?(n.texParameteri(Q,n.TEXTURE_WRAP_S,oe[G.wrapS]),n.texParameteri(Q,n.TEXTURE_WRAP_T,oe[G.wrapT]),(Q===n.TEXTURE_3D||Q===n.TEXTURE_2D_ARRAY)&&n.texParameteri(Q,n.TEXTURE_WRAP_R,oe[G.wrapR]),n.texParameteri(Q,n.TEXTURE_MAG_FILTER,ve[G.magFilter]),n.texParameteri(Q,n.TEXTURE_MIN_FILTER,ve[G.minFilter])):(n.texParameteri(Q,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(Q,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(Q===n.TEXTURE_3D||Q===n.TEXTURE_2D_ARRAY)&&n.texParameteri(Q,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(G.wrapS!==Gr||G.wrapT!==Gr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(Q,n.TEXTURE_MAG_FILTER,M(G.magFilter)),n.texParameteri(Q,n.TEXTURE_MIN_FILTER,M(G.minFilter)),G.minFilter!==yi&&G.minFilter!==Jn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),G.compareFunction&&(n.texParameteri(Q,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(Q,n.TEXTURE_COMPARE_FUNC,Te[G.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const J=e.get("EXT_texture_filter_anisotropic");if(G.magFilter===yi||G.minFilter!==yh&&G.minFilter!==Nl||G.type===fi&&e.has("OES_texture_float_linear")===!1||a===!1&&G.type===Fi&&e.has("OES_texture_half_float_linear")===!1)return;(G.anisotropy>1||r.get(G).__currentAnisotropy)&&(n.texParameterf(Q,J.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(G.anisotropy,i.getMaxAnisotropy())),r.get(G).__currentAnisotropy=G.anisotropy)}}function _e(Q,G){let ke=!1;Q.__webglInit===void 0&&(Q.__webglInit=!0,G.addEventListener("dispose",k));const J=G.source;let he=h.get(J);he===void 0&&(he={},h.set(J,he));const ee=ne(G);if(ee!==Q.__cacheKey){he[ee]===void 0&&(he[ee]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,ke=!0),he[ee].usedTimes++;const Ee=he[Q.__cacheKey];Ee!==void 0&&(he[Q.__cacheKey].usedTimes--,Ee.usedTimes===0&&I(G)),Q.__cacheKey=ee,Q.__webglTexture=he[ee].texture}return ke}function Ue(Q,G,ke){let J=n.TEXTURE_2D;(G.isDataArrayTexture||G.isCompressedArrayTexture)&&(J=n.TEXTURE_2D_ARRAY),G.isData3DTexture&&(J=n.TEXTURE_3D);const he=_e(Q,G),ee=G.source;t.bindTexture(J,Q.__webglTexture,n.TEXTURE0+ke);const Ee=r.get(ee);if(ee.version!==Ee.__version||he===!0){t.activeTexture(n.TEXTURE0+ke);const Me=gr.getPrimaries(gr.workingColorSpace),Ae=G.colorSpace===zo?null:gr.getPrimaries(G.colorSpace),Be=G.colorSpace===zo||Me===Ae?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,G.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,G.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,G.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Be);const dt=y(G)&&v(G.image)===!1;let We=x(G.image,dt,!1,i.maxTextureSize);We=pt(G,We);const Kt=v(We)||a,cn=s.convert(G.format,G.colorSpace);let jt=s.convert(G.type),wt=_(G.internalFormat,cn,jt,G.colorSpace,G.isVideoTexture);Xe(J,G,Kt);let Mt;const ye=G.mipmaps,He=a&&G.isVideoTexture!==!0&&wt!==GI,st=Ee.__version===void 0||he===!0,_t=ee.dataReady,Ye=T(G,We,Kt);if(G.isDepthTexture)wt=n.DEPTH_COMPONENT,a?G.type===fi?wt=n.DEPTH_COMPONENT32F:G.type===kl?wt=n.DEPTH_COMPONENT24:G.type===Ku?wt=n.DEPTH24_STENCIL8:wt=n.DEPTH_COMPONENT16:G.type===fi&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),G.format===Yu&&wt===n.DEPTH_COMPONENT&&G.type!==D_&&G.type!==kl&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),G.type=kl,jt=s.convert(G.type)),G.format===cf&&wt===n.DEPTH_COMPONENT&&(wt=n.DEPTH_STENCIL,G.type!==Ku&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),G.type=Ku,jt=s.convert(G.type))),st&&(He?t.texStorage2D(n.TEXTURE_2D,1,wt,We.width,We.height):t.texImage2D(n.TEXTURE_2D,0,wt,We.width,We.height,0,cn,jt,null));else if(G.isDataTexture)if(ye.length>0&&Kt){He&&st&&t.texStorage2D(n.TEXTURE_2D,Ye,wt,ye[0].width,ye[0].height);for(let fe=0,ot=ye.length;fe<ot;fe++)Mt=ye[fe],He?_t&&t.texSubImage2D(n.TEXTURE_2D,fe,0,0,Mt.width,Mt.height,cn,jt,Mt.data):t.texImage2D(n.TEXTURE_2D,fe,wt,Mt.width,Mt.height,0,cn,jt,Mt.data);G.generateMipmaps=!1}else He?(st&&t.texStorage2D(n.TEXTURE_2D,Ye,wt,We.width,We.height),_t&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,We.width,We.height,cn,jt,We.data)):t.texImage2D(n.TEXTURE_2D,0,wt,We.width,We.height,0,cn,jt,We.data);else if(G.isCompressedTexture)if(G.isCompressedArrayTexture){He&&st&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Ye,wt,ye[0].width,ye[0].height,We.depth);for(let fe=0,ot=ye.length;fe<ot;fe++)Mt=ye[fe],G.format!==Ii?cn!==null?He?_t&&t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,fe,0,0,0,Mt.width,Mt.height,We.depth,cn,Mt.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,fe,wt,Mt.width,Mt.height,We.depth,0,Mt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):He?_t&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,fe,0,0,0,Mt.width,Mt.height,We.depth,cn,jt,Mt.data):t.texImage3D(n.TEXTURE_2D_ARRAY,fe,wt,Mt.width,Mt.height,We.depth,0,cn,jt,Mt.data)}else{He&&st&&t.texStorage2D(n.TEXTURE_2D,Ye,wt,ye[0].width,ye[0].height);for(let fe=0,ot=ye.length;fe<ot;fe++)Mt=ye[fe],G.format!==Ii?cn!==null?He?_t&&t.compressedTexSubImage2D(n.TEXTURE_2D,fe,0,0,Mt.width,Mt.height,cn,Mt.data):t.compressedTexImage2D(n.TEXTURE_2D,fe,wt,Mt.width,Mt.height,0,Mt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):He?_t&&t.texSubImage2D(n.TEXTURE_2D,fe,0,0,Mt.width,Mt.height,cn,jt,Mt.data):t.texImage2D(n.TEXTURE_2D,fe,wt,Mt.width,Mt.height,0,cn,jt,Mt.data)}else if(G.isDataArrayTexture)He?(st&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Ye,wt,We.width,We.height,We.depth),_t&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,We.width,We.height,We.depth,cn,jt,We.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,wt,We.width,We.height,We.depth,0,cn,jt,We.data);else if(G.isData3DTexture)He?(st&&t.texStorage3D(n.TEXTURE_3D,Ye,wt,We.width,We.height,We.depth),_t&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,We.width,We.height,We.depth,cn,jt,We.data)):t.texImage3D(n.TEXTURE_3D,0,wt,We.width,We.height,We.depth,0,cn,jt,We.data);else if(G.isFramebufferTexture){if(st)if(He)t.texStorage2D(n.TEXTURE_2D,Ye,wt,We.width,We.height);else{let fe=We.width,ot=We.height;for(let ht=0;ht<Ye;ht++)t.texImage2D(n.TEXTURE_2D,ht,wt,fe,ot,0,cn,jt,null),fe>>=1,ot>>=1}}else if(ye.length>0&&Kt){He&&st&&t.texStorage2D(n.TEXTURE_2D,Ye,wt,ye[0].width,ye[0].height);for(let fe=0,ot=ye.length;fe<ot;fe++)Mt=ye[fe],He?_t&&t.texSubImage2D(n.TEXTURE_2D,fe,0,0,cn,jt,Mt):t.texImage2D(n.TEXTURE_2D,fe,wt,cn,jt,Mt);G.generateMipmaps=!1}else He?(st&&t.texStorage2D(n.TEXTURE_2D,Ye,wt,We.width,We.height),_t&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,cn,jt,We)):t.texImage2D(n.TEXTURE_2D,0,wt,cn,jt,We);b(G,Kt)&&S(J),Ee.__version=ee.version,G.onUpdate&&G.onUpdate(G)}Q.__version=G.version}function Fe(Q,G,ke){if(G.image.length!==6)return;const J=_e(Q,G),he=G.source;t.bindTexture(n.TEXTURE_CUBE_MAP,Q.__webglTexture,n.TEXTURE0+ke);const ee=r.get(he);if(he.version!==ee.__version||J===!0){t.activeTexture(n.TEXTURE0+ke);const Ee=gr.getPrimaries(gr.workingColorSpace),Me=G.colorSpace===zo?null:gr.getPrimaries(G.colorSpace),Ae=G.colorSpace===zo||Ee===Me?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,G.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,G.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,G.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ae);const Be=G.isCompressedTexture||G.image[0].isCompressedTexture,dt=G.image[0]&&G.image[0].isDataTexture,We=[];for(let fe=0;fe<6;fe++)!Be&&!dt?We[fe]=x(G.image[fe],!1,!0,i.maxCubemapSize):We[fe]=dt?G.image[fe].image:G.image[fe],We[fe]=pt(G,We[fe]);const Kt=We[0],cn=v(Kt)||a,jt=s.convert(G.format,G.colorSpace),wt=s.convert(G.type),Mt=_(G.internalFormat,jt,wt,G.colorSpace),ye=a&&G.isVideoTexture!==!0,He=ee.__version===void 0||J===!0,st=he.dataReady;let _t=T(G,Kt,cn);Xe(n.TEXTURE_CUBE_MAP,G,cn);let Ye;if(Be){ye&&He&&t.texStorage2D(n.TEXTURE_CUBE_MAP,_t,Mt,Kt.width,Kt.height);for(let fe=0;fe<6;fe++){Ye=We[fe].mipmaps;for(let ot=0;ot<Ye.length;ot++){const ht=Ye[ot];G.format!==Ii?jt!==null?ye?st&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+fe,ot,0,0,ht.width,ht.height,jt,ht.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+fe,ot,Mt,ht.width,ht.height,0,ht.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ye?st&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+fe,ot,0,0,ht.width,ht.height,jt,wt,ht.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+fe,ot,Mt,ht.width,ht.height,0,jt,wt,ht.data)}}}else{Ye=G.mipmaps,ye&&He&&(Ye.length>0&&_t++,t.texStorage2D(n.TEXTURE_CUBE_MAP,_t,Mt,We[0].width,We[0].height));for(let fe=0;fe<6;fe++)if(dt){ye?st&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,0,0,We[fe].width,We[fe].height,jt,wt,We[fe].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,Mt,We[fe].width,We[fe].height,0,jt,wt,We[fe].data);for(let ot=0;ot<Ye.length;ot++){const Bt=Ye[ot].image[fe].image;ye?st&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+fe,ot+1,0,0,Bt.width,Bt.height,jt,wt,Bt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+fe,ot+1,Mt,Bt.width,Bt.height,0,jt,wt,Bt.data)}}else{ye?st&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,0,0,jt,wt,We[fe]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,Mt,jt,wt,We[fe]);for(let ot=0;ot<Ye.length;ot++){const ht=Ye[ot];ye?st&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+fe,ot+1,0,0,jt,wt,ht.image[fe]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+fe,ot+1,Mt,jt,wt,ht.image[fe])}}}b(G,cn)&&S(n.TEXTURE_CUBE_MAP),ee.__version=he.version,G.onUpdate&&G.onUpdate(G)}Q.__version=G.version}function Oe(Q,G,ke,J,he,ee){const Ee=s.convert(ke.format,ke.colorSpace),Me=s.convert(ke.type),Ae=_(ke.internalFormat,Ee,Me,ke.colorSpace);if(!r.get(G).__hasExternalTextures){const dt=Math.max(1,G.width>>ee),We=Math.max(1,G.height>>ee);he===n.TEXTURE_3D||he===n.TEXTURE_2D_ARRAY?t.texImage3D(he,ee,Ae,dt,We,G.depth,0,Ee,Me,null):t.texImage2D(he,ee,Ae,dt,We,0,Ee,Me,null)}t.bindFramebuffer(n.FRAMEBUFFER,Q),Ge(G)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,J,he,r.get(ke).__webglTexture,0,Je(G)):(he===n.TEXTURE_2D||he>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&he<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,J,he,r.get(ke).__webglTexture,ee),t.bindFramebuffer(n.FRAMEBUFFER,null)}function nt(Q,G,ke){if(n.bindRenderbuffer(n.RENDERBUFFER,Q),G.depthBuffer&&!G.stencilBuffer){let J=a===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(ke||Ge(G)){const he=G.depthTexture;he&&he.isDepthTexture&&(he.type===fi?J=n.DEPTH_COMPONENT32F:he.type===kl&&(J=n.DEPTH_COMPONENT24));const ee=Je(G);Ge(G)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ee,J,G.width,G.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,ee,J,G.width,G.height)}else n.renderbufferStorage(n.RENDERBUFFER,J,G.width,G.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,Q)}else if(G.depthBuffer&&G.stencilBuffer){const J=Je(G);ke&&Ge(G)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,J,n.DEPTH24_STENCIL8,G.width,G.height):Ge(G)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,J,n.DEPTH24_STENCIL8,G.width,G.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,G.width,G.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,Q)}else{const J=G.isWebGLMultipleRenderTargets===!0?G.texture:[G.texture];for(let he=0;he<J.length;he++){const ee=J[he],Ee=s.convert(ee.format,ee.colorSpace),Me=s.convert(ee.type),Ae=_(ee.internalFormat,Ee,Me,ee.colorSpace),Be=Je(G);ke&&Ge(G)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Be,Ae,G.width,G.height):Ge(G)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Be,Ae,G.width,G.height):n.renderbufferStorage(n.RENDERBUFFER,Ae,G.width,G.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function rt(Q,G){if(G&&G.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,Q),!(G.depthTexture&&G.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(G.depthTexture).__webglTexture||G.depthTexture.image.width!==G.width||G.depthTexture.image.height!==G.height)&&(G.depthTexture.image.width=G.width,G.depthTexture.image.height=G.height,G.depthTexture.needsUpdate=!0),Y(G.depthTexture,0);const J=r.get(G.depthTexture).__webglTexture,he=Je(G);if(G.depthTexture.format===Yu)Ge(G)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,J,0,he):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,J,0);else if(G.depthTexture.format===cf)Ge(G)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,J,0,he):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,J,0);else throw new Error("Unknown depthTexture format")}function ut(Q){const G=r.get(Q),ke=Q.isWebGLCubeRenderTarget===!0;if(Q.depthTexture&&!G.__autoAllocateDepthBuffer){if(ke)throw new Error("target.depthTexture not supported in Cube render targets");rt(G.__webglFramebuffer,Q)}else if(ke){G.__webglDepthbuffer=[];for(let J=0;J<6;J++)t.bindFramebuffer(n.FRAMEBUFFER,G.__webglFramebuffer[J]),G.__webglDepthbuffer[J]=n.createRenderbuffer(),nt(G.__webglDepthbuffer[J],Q,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,G.__webglFramebuffer),G.__webglDepthbuffer=n.createRenderbuffer(),nt(G.__webglDepthbuffer,Q,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Qe(Q,G,ke){const J=r.get(Q);G!==void 0&&Oe(J.__webglFramebuffer,Q,Q.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),ke!==void 0&&ut(Q)}function ae(Q){const G=Q.texture,ke=r.get(Q),J=r.get(G);Q.addEventListener("dispose",P),Q.isWebGLMultipleRenderTargets!==!0&&(J.__webglTexture===void 0&&(J.__webglTexture=n.createTexture()),J.__version=G.version,o.memory.textures++);const he=Q.isWebGLCubeRenderTarget===!0,ee=Q.isWebGLMultipleRenderTargets===!0,Ee=v(Q)||a;if(he){ke.__webglFramebuffer=[];for(let Me=0;Me<6;Me++)if(a&&G.mipmaps&&G.mipmaps.length>0){ke.__webglFramebuffer[Me]=[];for(let Ae=0;Ae<G.mipmaps.length;Ae++)ke.__webglFramebuffer[Me][Ae]=n.createFramebuffer()}else ke.__webglFramebuffer[Me]=n.createFramebuffer()}else{if(a&&G.mipmaps&&G.mipmaps.length>0){ke.__webglFramebuffer=[];for(let Me=0;Me<G.mipmaps.length;Me++)ke.__webglFramebuffer[Me]=n.createFramebuffer()}else ke.__webglFramebuffer=n.createFramebuffer();if(ee)if(i.drawBuffers){const Me=Q.texture;for(let Ae=0,Be=Me.length;Ae<Be;Ae++){const dt=r.get(Me[Ae]);dt.__webglTexture===void 0&&(dt.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&Q.samples>0&&Ge(Q)===!1){const Me=ee?G:[G];ke.__webglMultisampledFramebuffer=n.createFramebuffer(),ke.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,ke.__webglMultisampledFramebuffer);for(let Ae=0;Ae<Me.length;Ae++){const Be=Me[Ae];ke.__webglColorRenderbuffer[Ae]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ke.__webglColorRenderbuffer[Ae]);const dt=s.convert(Be.format,Be.colorSpace),We=s.convert(Be.type),Kt=_(Be.internalFormat,dt,We,Be.colorSpace,Q.isXRRenderTarget===!0),cn=Je(Q);n.renderbufferStorageMultisample(n.RENDERBUFFER,cn,Kt,Q.width,Q.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ae,n.RENDERBUFFER,ke.__webglColorRenderbuffer[Ae])}n.bindRenderbuffer(n.RENDERBUFFER,null),Q.depthBuffer&&(ke.__webglDepthRenderbuffer=n.createRenderbuffer(),nt(ke.__webglDepthRenderbuffer,Q,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(he){t.bindTexture(n.TEXTURE_CUBE_MAP,J.__webglTexture),Xe(n.TEXTURE_CUBE_MAP,G,Ee);for(let Me=0;Me<6;Me++)if(a&&G.mipmaps&&G.mipmaps.length>0)for(let Ae=0;Ae<G.mipmaps.length;Ae++)Oe(ke.__webglFramebuffer[Me][Ae],Q,G,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,Ae);else Oe(ke.__webglFramebuffer[Me],Q,G,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0);b(G,Ee)&&S(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ee){const Me=Q.texture;for(let Ae=0,Be=Me.length;Ae<Be;Ae++){const dt=Me[Ae],We=r.get(dt);t.bindTexture(n.TEXTURE_2D,We.__webglTexture),Xe(n.TEXTURE_2D,dt,Ee),Oe(ke.__webglFramebuffer,Q,dt,n.COLOR_ATTACHMENT0+Ae,n.TEXTURE_2D,0),b(dt,Ee)&&S(n.TEXTURE_2D)}t.unbindTexture()}else{let Me=n.TEXTURE_2D;if((Q.isWebGL3DRenderTarget||Q.isWebGLArrayRenderTarget)&&(a?Me=Q.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Me,J.__webglTexture),Xe(Me,G,Ee),a&&G.mipmaps&&G.mipmaps.length>0)for(let Ae=0;Ae<G.mipmaps.length;Ae++)Oe(ke.__webglFramebuffer[Ae],Q,G,n.COLOR_ATTACHMENT0,Me,Ae);else Oe(ke.__webglFramebuffer,Q,G,n.COLOR_ATTACHMENT0,Me,0);b(G,Ee)&&S(Me),t.unbindTexture()}Q.depthBuffer&&ut(Q)}function ze(Q){const G=v(Q)||a,ke=Q.isWebGLMultipleRenderTargets===!0?Q.texture:[Q.texture];for(let J=0,he=ke.length;J<he;J++){const ee=ke[J];if(b(ee,G)){const Ee=Q.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Me=r.get(ee).__webglTexture;t.bindTexture(Ee,Me),S(Ee),t.unbindTexture()}}}function Re(Q){if(a&&Q.samples>0&&Ge(Q)===!1){const G=Q.isWebGLMultipleRenderTargets?Q.texture:[Q.texture],ke=Q.width,J=Q.height;let he=n.COLOR_BUFFER_BIT;const ee=[],Ee=Q.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Me=r.get(Q),Ae=Q.isWebGLMultipleRenderTargets===!0;if(Ae)for(let Be=0;Be<G.length;Be++)t.bindFramebuffer(n.FRAMEBUFFER,Me.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Be,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Me.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Be,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Me.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Me.__webglFramebuffer);for(let Be=0;Be<G.length;Be++){ee.push(n.COLOR_ATTACHMENT0+Be),Q.depthBuffer&&ee.push(Ee);const dt=Me.__ignoreDepthValues!==void 0?Me.__ignoreDepthValues:!1;if(dt===!1&&(Q.depthBuffer&&(he|=n.DEPTH_BUFFER_BIT),Q.stencilBuffer&&(he|=n.STENCIL_BUFFER_BIT)),Ae&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Me.__webglColorRenderbuffer[Be]),dt===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Ee]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Ee])),Ae){const We=r.get(G[Be]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,We,0)}n.blitFramebuffer(0,0,ke,J,0,0,ke,J,he,n.NEAREST),c&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,ee)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Ae)for(let Be=0;Be<G.length;Be++){t.bindFramebuffer(n.FRAMEBUFFER,Me.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Be,n.RENDERBUFFER,Me.__webglColorRenderbuffer[Be]);const dt=r.get(G[Be]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Me.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Be,n.TEXTURE_2D,dt,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Me.__webglMultisampledFramebuffer)}}function Je(Q){return Math.min(i.maxSamples,Q.samples)}function Ge(Q){const G=r.get(Q);return a&&Q.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&G.__useRenderToTexture!==!1}function Et(Q){const G=o.render.frame;u.get(Q)!==G&&(u.set(Q,G),Q.update())}function pt(Q,G){const ke=Q.colorSpace,J=Q.format,he=Q.type;return Q.isCompressedTexture===!0||Q.isVideoTexture===!0||Q.format===SS||ke!==Ko&&ke!==zo&&(gr.getTransfer(ke)===Ir?a===!1?e.has("EXT_sRGB")===!0&&J===Ii?(Q.format=SS,Q.minFilter=Jn,Q.generateMipmaps=!1):G=ZI.sRGBToLinear(G):(J!==Ii||he!==Wo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ke)),G}this.allocateTextureUnit=$,this.resetTextureUnits=q,this.setTexture2D=Y,this.setTexture2DArray=we,this.setTexture3D=H,this.setTextureCube=X,this.rebindTextures=Qe,this.setupRenderTarget=ae,this.updateRenderTargetMipmap=ze,this.updateMultisampleRenderTarget=Re,this.setupDepthRenderbuffer=ut,this.setupFrameBufferTexture=Oe,this.useMultisampledRTT=Ge}function bW(n,e,t){const r=t.isWebGL2;function i(s,o=zo){let a;const l=gr.getTransfer(o);if(s===Wo)return n.UNSIGNED_BYTE;if(s===BI)return n.UNSIGNED_SHORT_4_4_4_4;if(s===$I)return n.UNSIGNED_SHORT_5_5_5_1;if(s===zI)return n.BYTE;if(s===UI)return n.SHORT;if(s===D_)return n.UNSIGNED_SHORT;if(s===L_)return n.INT;if(s===kl)return n.UNSIGNED_INT;if(s===fi)return n.FLOAT;if(s===Fi)return r?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===j6)return n.ALPHA;if(s===Ii)return n.RGBA;if(s===V6)return n.LUMINANCE;if(s===W6)return n.LUMINANCE_ALPHA;if(s===Yu)return n.DEPTH_COMPONENT;if(s===cf)return n.DEPTH_STENCIL;if(s===SS)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===jI)return n.RED;if(s===VI)return n.RED_INTEGER;if(s===H6)return n.RG;if(s===WI)return n.RG_INTEGER;if(s===HI)return n.RGBA_INTEGER;if(s===ub||s===db||s===hb||s===fb)if(l===Ir)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===ub)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===db)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===hb)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===fb)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===ub)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===db)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===hb)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===fb)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===aA||s===lA||s===cA||s===uA)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===aA)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===lA)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===cA)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===uA)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===GI)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===dA||s===hA)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===dA)return l===Ir?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===hA)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===fA||s===pA||s===mA||s===gA||s===yA||s===vA||s===xA||s===wA||s===bA||s===SA||s===_A||s===EA||s===CA||s===TA)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===fA)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===pA)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===mA)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===gA)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===yA)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===vA)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===xA)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===wA)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===bA)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===SA)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===_A)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===EA)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===CA)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===TA)return l===Ir?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===pb||s===MA||s===AA)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===pb)return l===Ir?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===MA)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===AA)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===G6||s===NA||s===kA||s===IA)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===pb)return a.COMPRESSED_RED_RGTC1_EXT;if(s===NA)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===kA)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===IA)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Ku?r?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:i}}class SW extends hi{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class am extends cr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Spe={type:"move"};class PC{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new am,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new am,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ie,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ie),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new am,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ie,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ie),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const x of e.hand.values()){const v=t.getJointPose(x,r),y=this._getHandJoint(c,x);v!==null&&(y.matrix.fromArray(v.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=v.radius),y.visible=v!==null}const u=c.joints["index-finger-tip"],d=c.joints["thumb-tip"],h=u.position.distanceTo(d.position),f=.02,p=.005;c.inputState.pinching&&h>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Spe)))}return a!==null&&(a.visible=i!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new am;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}const _pe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Epe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class Cpe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,r){if(this.texture===null){const i=new qr,s=e.properties.get(i);s.__webglTexture=t.texture,(t.depthNear!=r.depthNear||t.depthFar!=r.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}render(e,t){if(this.texture!==null){if(this.mesh===null){const r=t.cameras[0].viewport,i=new Ys({extensions:{fragDepth:!0},vertexShader:_pe,fragmentShader:Epe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:r.z},depthHeight:{value:r.w}}});this.mesh=new ri(new Ad(20,20),i)}e.render(this.mesh,t)}}reset(){this.texture=null,this.mesh=null}}class Tpe extends Jl{constructor(e,t){super();const r=this;let i=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,d=null,h=null,f=null,p=null;const x=new Cpe,v=t.getContextAttributes();let y=null,b=null;const S=[],_=[],T=new Ze;let M=null;const k=new hi;k.layers.enable(1),k.viewport=new vr;const P=new hi;P.layers.enable(2),P.viewport=new vr;const z=[k,P],I=new SW;I.layers.enable(1),I.layers.enable(2);let L=null,W=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(_e){let Ue=S[_e];return Ue===void 0&&(Ue=new PC,S[_e]=Ue),Ue.getTargetRaySpace()},this.getControllerGrip=function(_e){let Ue=S[_e];return Ue===void 0&&(Ue=new PC,S[_e]=Ue),Ue.getGripSpace()},this.getHand=function(_e){let Ue=S[_e];return Ue===void 0&&(Ue=new PC,S[_e]=Ue),Ue.getHandSpace()};function q(_e){const Ue=_.indexOf(_e.inputSource);if(Ue===-1)return;const Fe=S[Ue];Fe!==void 0&&(Fe.update(_e.inputSource,_e.frame,c||o),Fe.dispatchEvent({type:_e.type,data:_e.inputSource}))}function $(){i.removeEventListener("select",q),i.removeEventListener("selectstart",q),i.removeEventListener("selectend",q),i.removeEventListener("squeeze",q),i.removeEventListener("squeezestart",q),i.removeEventListener("squeezeend",q),i.removeEventListener("end",$),i.removeEventListener("inputsourceschange",ne);for(let _e=0;_e<S.length;_e++){const Ue=_[_e];Ue!==null&&(_[_e]=null,S[_e].disconnect(Ue))}L=null,W=null,x.reset(),e.setRenderTarget(y),f=null,h=null,d=null,i=null,b=null,Xe.stop(),r.isPresenting=!1,e.setPixelRatio(M),e.setSize(T.width,T.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(_e){s=_e,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(_e){a=_e,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(_e){c=_e},this.getBaseLayer=function(){return h!==null?h:f},this.getBinding=function(){return d},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(_e){if(i=_e,i!==null){if(y=e.getRenderTarget(),i.addEventListener("select",q),i.addEventListener("selectstart",q),i.addEventListener("selectend",q),i.addEventListener("squeeze",q),i.addEventListener("squeezestart",q),i.addEventListener("squeezeend",q),i.addEventListener("end",$),i.addEventListener("inputsourceschange",ne),v.xrCompatible!==!0&&await t.makeXRCompatible(),M=e.getPixelRatio(),e.getSize(T),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const Ue={antialias:i.renderState.layers===void 0?v.antialias:!0,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(i,t,Ue),i.updateRenderState({baseLayer:f}),e.setPixelRatio(1),e.setSize(f.framebufferWidth,f.framebufferHeight,!1),b=new Eo(f.framebufferWidth,f.framebufferHeight,{format:Ii,type:Wo,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil})}else{let Ue=null,Fe=null,Oe=null;v.depth&&(Oe=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ue=v.stencil?cf:Yu,Fe=v.stencil?Ku:kl);const nt={colorFormat:t.RGBA8,depthFormat:Oe,scaleFactor:s};d=new XRWebGLBinding(i,t),h=d.createProjectionLayer(nt),i.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),b=new Eo(h.textureWidth,h.textureHeight,{format:Ii,type:Wo,depthTexture:new U_(h.textureWidth,h.textureHeight,Fe,void 0,void 0,void 0,void 0,void 0,void 0,Ue),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0});const rt=e.properties.get(b);rt.__ignoreDepthValues=h.ignoreDepthValues}b.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await i.requestReferenceSpace(a),Xe.setContext(i),Xe.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode};function ne(_e){for(let Ue=0;Ue<_e.removed.length;Ue++){const Fe=_e.removed[Ue],Oe=_.indexOf(Fe);Oe>=0&&(_[Oe]=null,S[Oe].disconnect(Fe))}for(let Ue=0;Ue<_e.added.length;Ue++){const Fe=_e.added[Ue];let Oe=_.indexOf(Fe);if(Oe===-1){for(let rt=0;rt<S.length;rt++)if(rt>=_.length){_.push(Fe),Oe=rt;break}else if(_[rt]===null){_[rt]=Fe,Oe=rt;break}if(Oe===-1)break}const nt=S[Oe];nt&&nt.connect(Fe)}}const Y=new ie,we=new ie;function H(_e,Ue,Fe){Y.setFromMatrixPosition(Ue.matrixWorld),we.setFromMatrixPosition(Fe.matrixWorld);const Oe=Y.distanceTo(we),nt=Ue.projectionMatrix.elements,rt=Fe.projectionMatrix.elements,ut=nt[14]/(nt[10]-1),Qe=nt[14]/(nt[10]+1),ae=(nt[9]+1)/nt[5],ze=(nt[9]-1)/nt[5],Re=(nt[8]-1)/nt[0],Je=(rt[8]+1)/rt[0],Ge=ut*Re,Et=ut*Je,pt=Oe/(-Re+Je),Q=pt*-Re;Ue.matrixWorld.decompose(_e.position,_e.quaternion,_e.scale),_e.translateX(Q),_e.translateZ(pt),_e.matrixWorld.compose(_e.position,_e.quaternion,_e.scale),_e.matrixWorldInverse.copy(_e.matrixWorld).invert();const G=ut+pt,ke=Qe+pt,J=Ge-Q,he=Et+(Oe-Q),ee=ae*Qe/ke*G,Ee=ze*Qe/ke*G;_e.projectionMatrix.makePerspective(J,he,ee,Ee,G,ke),_e.projectionMatrixInverse.copy(_e.projectionMatrix).invert()}function X(_e,Ue){Ue===null?_e.matrixWorld.copy(_e.matrix):_e.matrixWorld.multiplyMatrices(Ue.matrixWorld,_e.matrix),_e.matrixWorldInverse.copy(_e.matrixWorld).invert()}this.updateCamera=function(_e){if(i===null)return;x.texture!==null&&(_e.near=x.depthNear,_e.far=x.depthFar),I.near=P.near=k.near=_e.near,I.far=P.far=k.far=_e.far,(L!==I.near||W!==I.far)&&(i.updateRenderState({depthNear:I.near,depthFar:I.far}),L=I.near,W=I.far,k.near=L,k.far=W,P.near=L,P.far=W,k.updateProjectionMatrix(),P.updateProjectionMatrix(),_e.updateProjectionMatrix());const Ue=_e.parent,Fe=I.cameras;X(I,Ue);for(let Oe=0;Oe<Fe.length;Oe++)X(Fe[Oe],Ue);Fe.length===2?H(I,k,P):I.projectionMatrix.copy(k.projectionMatrix),oe(_e,I,Ue)};function oe(_e,Ue,Fe){Fe===null?_e.matrix.copy(Ue.matrixWorld):(_e.matrix.copy(Fe.matrixWorld),_e.matrix.invert(),_e.matrix.multiply(Ue.matrixWorld)),_e.matrix.decompose(_e.position,_e.quaternion,_e.scale),_e.updateMatrixWorld(!0),_e.projectionMatrix.copy(Ue.projectionMatrix),_e.projectionMatrixInverse.copy(Ue.projectionMatrixInverse),_e.isPerspectiveCamera&&(_e.fov=Wm*2*Math.atan(1/_e.projectionMatrix.elements[5]),_e.zoom=1)}this.getCamera=function(){return I},this.getFoveation=function(){if(!(h===null&&f===null))return l},this.setFoveation=function(_e){l=_e,h!==null&&(h.fixedFoveation=_e),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=_e)},this.hasDepthSensing=function(){return x.texture!==null};let ve=null;function Te(_e,Ue){if(u=Ue.getViewerPose(c||o),p=Ue,u!==null){const Fe=u.views;f!==null&&(e.setRenderTargetFramebuffer(b,f.framebuffer),e.setRenderTarget(b));let Oe=!1;Fe.length!==I.cameras.length&&(I.cameras.length=0,Oe=!0);for(let rt=0;rt<Fe.length;rt++){const ut=Fe[rt];let Qe=null;if(f!==null)Qe=f.getViewport(ut);else{const ze=d.getViewSubImage(h,ut);Qe=ze.viewport,rt===0&&(e.setRenderTargetTextures(b,ze.colorTexture,h.ignoreDepthValues?void 0:ze.depthStencilTexture),e.setRenderTarget(b))}let ae=z[rt];ae===void 0&&(ae=new hi,ae.layers.enable(rt),ae.viewport=new vr,z[rt]=ae),ae.matrix.fromArray(ut.transform.matrix),ae.matrix.decompose(ae.position,ae.quaternion,ae.scale),ae.projectionMatrix.fromArray(ut.projectionMatrix),ae.projectionMatrixInverse.copy(ae.projectionMatrix).invert(),ae.viewport.set(Qe.x,Qe.y,Qe.width,Qe.height),rt===0&&(I.matrix.copy(ae.matrix),I.matrix.decompose(I.position,I.quaternion,I.scale)),Oe===!0&&I.cameras.push(ae)}const nt=i.enabledFeatures;if(nt&&nt.includes("depth-sensing")){const rt=d.getDepthInformation(Fe[0]);rt&&rt.isValid&&rt.texture&&x.init(e,rt,i.renderState)}}for(let Fe=0;Fe<S.length;Fe++){const Oe=_[Fe],nt=S[Fe];Oe!==null&&nt!==void 0&&nt.update(Oe,Ue,c||o)}x.render(e,I),ve&&ve(_e,Ue),Ue.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:Ue}),p=null}const Xe=new mW;Xe.setAnimationLoop(Te),this.setAnimationLoop=function(_e){ve=_e},this.dispose=function(){}}}function Mpe(n,e){function t(v,y){v.matrixAutoUpdate===!0&&v.updateMatrix(),y.value.copy(v.matrix)}function r(v,y){y.color.getRGB(v.fogColor.value,fW(n)),y.isFog?(v.fogNear.value=y.near,v.fogFar.value=y.far):y.isFogExp2&&(v.fogDensity.value=y.density)}function i(v,y,b,S,_){y.isMeshBasicMaterial||y.isMeshLambertMaterial?s(v,y):y.isMeshToonMaterial?(s(v,y),d(v,y)):y.isMeshPhongMaterial?(s(v,y),u(v,y)):y.isMeshStandardMaterial?(s(v,y),h(v,y),y.isMeshPhysicalMaterial&&f(v,y,_)):y.isMeshMatcapMaterial?(s(v,y),p(v,y)):y.isMeshDepthMaterial?s(v,y):y.isMeshDistanceMaterial?(s(v,y),x(v,y)):y.isMeshNormalMaterial?s(v,y):y.isLineBasicMaterial?(o(v,y),y.isLineDashedMaterial&&a(v,y)):y.isPointsMaterial?l(v,y,b,S):y.isSpriteMaterial?c(v,y):y.isShadowMaterial?(v.color.value.copy(y.color),v.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}function s(v,y){v.opacity.value=y.opacity,y.color&&v.diffuse.value.copy(y.color),y.emissive&&v.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(v.map.value=y.map,t(y.map,v.mapTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,t(y.alphaMap,v.alphaMapTransform)),y.bumpMap&&(v.bumpMap.value=y.bumpMap,t(y.bumpMap,v.bumpMapTransform),v.bumpScale.value=y.bumpScale,y.side===Cs&&(v.bumpScale.value*=-1)),y.normalMap&&(v.normalMap.value=y.normalMap,t(y.normalMap,v.normalMapTransform),v.normalScale.value.copy(y.normalScale),y.side===Cs&&v.normalScale.value.negate()),y.displacementMap&&(v.displacementMap.value=y.displacementMap,t(y.displacementMap,v.displacementMapTransform),v.displacementScale.value=y.displacementScale,v.displacementBias.value=y.displacementBias),y.emissiveMap&&(v.emissiveMap.value=y.emissiveMap,t(y.emissiveMap,v.emissiveMapTransform)),y.specularMap&&(v.specularMap.value=y.specularMap,t(y.specularMap,v.specularMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest);const b=e.get(y).envMap;if(b&&(v.envMap.value=b,v.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=y.reflectivity,v.ior.value=y.ior,v.refractionRatio.value=y.refractionRatio),y.lightMap){v.lightMap.value=y.lightMap;const S=n._useLegacyLights===!0?Math.PI:1;v.lightMapIntensity.value=y.lightMapIntensity*S,t(y.lightMap,v.lightMapTransform)}y.aoMap&&(v.aoMap.value=y.aoMap,v.aoMapIntensity.value=y.aoMapIntensity,t(y.aoMap,v.aoMapTransform))}function o(v,y){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,y.map&&(v.map.value=y.map,t(y.map,v.mapTransform))}function a(v,y){v.dashSize.value=y.dashSize,v.totalSize.value=y.dashSize+y.gapSize,v.scale.value=y.scale}function l(v,y,b,S){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,v.size.value=y.size*b,v.scale.value=S*.5,y.map&&(v.map.value=y.map,t(y.map,v.uvTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,t(y.alphaMap,v.alphaMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest)}function c(v,y){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,v.rotation.value=y.rotation,y.map&&(v.map.value=y.map,t(y.map,v.mapTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,t(y.alphaMap,v.alphaMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest)}function u(v,y){v.specular.value.copy(y.specular),v.shininess.value=Math.max(y.shininess,1e-4)}function d(v,y){y.gradientMap&&(v.gradientMap.value=y.gradientMap)}function h(v,y){v.metalness.value=y.metalness,y.metalnessMap&&(v.metalnessMap.value=y.metalnessMap,t(y.metalnessMap,v.metalnessMapTransform)),v.roughness.value=y.roughness,y.roughnessMap&&(v.roughnessMap.value=y.roughnessMap,t(y.roughnessMap,v.roughnessMapTransform)),e.get(y).envMap&&(v.envMapIntensity.value=y.envMapIntensity)}function f(v,y,b){v.ior.value=y.ior,y.sheen>0&&(v.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),v.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(v.sheenColorMap.value=y.sheenColorMap,t(y.sheenColorMap,v.sheenColorMapTransform)),y.sheenRoughnessMap&&(v.sheenRoughnessMap.value=y.sheenRoughnessMap,t(y.sheenRoughnessMap,v.sheenRoughnessMapTransform))),y.clearcoat>0&&(v.clearcoat.value=y.clearcoat,v.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(v.clearcoatMap.value=y.clearcoatMap,t(y.clearcoatMap,v.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,t(y.clearcoatRoughnessMap,v.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(v.clearcoatNormalMap.value=y.clearcoatNormalMap,t(y.clearcoatNormalMap,v.clearcoatNormalMapTransform),v.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),y.side===Cs&&v.clearcoatNormalScale.value.negate())),y.iridescence>0&&(v.iridescence.value=y.iridescence,v.iridescenceIOR.value=y.iridescenceIOR,v.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(v.iridescenceMap.value=y.iridescenceMap,t(y.iridescenceMap,v.iridescenceMapTransform)),y.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=y.iridescenceThicknessMap,t(y.iridescenceThicknessMap,v.iridescenceThicknessMapTransform))),y.transmission>0&&(v.transmission.value=y.transmission,v.transmissionSamplerMap.value=b.texture,v.transmissionSamplerSize.value.set(b.width,b.height),y.transmissionMap&&(v.transmissionMap.value=y.transmissionMap,t(y.transmissionMap,v.transmissionMapTransform)),v.thickness.value=y.thickness,y.thicknessMap&&(v.thicknessMap.value=y.thicknessMap,t(y.thicknessMap,v.thicknessMapTransform)),v.attenuationDistance.value=y.attenuationDistance,v.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(v.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(v.anisotropyMap.value=y.anisotropyMap,t(y.anisotropyMap,v.anisotropyMapTransform))),v.specularIntensity.value=y.specularIntensity,v.specularColor.value.copy(y.specularColor),y.specularColorMap&&(v.specularColorMap.value=y.specularColorMap,t(y.specularColorMap,v.specularColorMapTransform)),y.specularIntensityMap&&(v.specularIntensityMap.value=y.specularIntensityMap,t(y.specularIntensityMap,v.specularIntensityMapTransform))}function p(v,y){y.matcap&&(v.matcap.value=y.matcap)}function x(v,y){const b=e.get(y).light;v.referencePosition.value.setFromMatrixPosition(b.matrixWorld),v.nearDistance.value=b.shadow.camera.near,v.farDistance.value=b.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function Ape(n,e,t,r){let i={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(b,S){const _=S.program;r.uniformBlockBinding(b,_)}function c(b,S){let _=i[b.id];_===void 0&&(p(b),_=u(b),i[b.id]=_,b.addEventListener("dispose",v));const T=S.program;r.updateUBOMapping(b,T);const M=e.render.frame;s[b.id]!==M&&(h(b),s[b.id]=M)}function u(b){const S=d();b.__bindingPointIndex=S;const _=n.createBuffer(),T=b.__size,M=b.usage;return n.bindBuffer(n.UNIFORM_BUFFER,_),n.bufferData(n.UNIFORM_BUFFER,T,M),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,S,_),_}function d(){for(let b=0;b<a;b++)if(o.indexOf(b)===-1)return o.push(b),b;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(b){const S=i[b.id],_=b.uniforms,T=b.__cache;n.bindBuffer(n.UNIFORM_BUFFER,S);for(let M=0,k=_.length;M<k;M++){const P=Array.isArray(_[M])?_[M]:[_[M]];for(let z=0,I=P.length;z<I;z++){const L=P[z];if(f(L,M,z,T)===!0){const W=L.__offset,q=Array.isArray(L.value)?L.value:[L.value];let $=0;for(let ne=0;ne<q.length;ne++){const Y=q[ne],we=x(Y);typeof Y=="number"||typeof Y=="boolean"?(L.__data[0]=Y,n.bufferSubData(n.UNIFORM_BUFFER,W+$,L.__data)):Y.isMatrix3?(L.__data[0]=Y.elements[0],L.__data[1]=Y.elements[1],L.__data[2]=Y.elements[2],L.__data[3]=0,L.__data[4]=Y.elements[3],L.__data[5]=Y.elements[4],L.__data[6]=Y.elements[5],L.__data[7]=0,L.__data[8]=Y.elements[6],L.__data[9]=Y.elements[7],L.__data[10]=Y.elements[8],L.__data[11]=0):(Y.toArray(L.__data,$),$+=we.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,W,L.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function f(b,S,_,T){const M=b.value,k=S+"_"+_;if(T[k]===void 0)return typeof M=="number"||typeof M=="boolean"?T[k]=M:T[k]=M.clone(),!0;{const P=T[k];if(typeof M=="number"||typeof M=="boolean"){if(P!==M)return T[k]=M,!0}else if(P.equals(M)===!1)return P.copy(M),!0}return!1}function p(b){const S=b.uniforms;let _=0;const T=16;for(let k=0,P=S.length;k<P;k++){const z=Array.isArray(S[k])?S[k]:[S[k]];for(let I=0,L=z.length;I<L;I++){const W=z[I],q=Array.isArray(W.value)?W.value:[W.value];for(let $=0,ne=q.length;$<ne;$++){const Y=q[$],we=x(Y),H=_%T;H!==0&&T-H<we.boundary&&(_+=T-H),W.__data=new Float32Array(we.storage/Float32Array.BYTES_PER_ELEMENT),W.__offset=_,_+=we.storage}}}const M=_%T;return M>0&&(_+=T-M),b.__size=_,b.__cache={},this}function x(b){const S={boundary:0,storage:0};return typeof b=="number"||typeof b=="boolean"?(S.boundary=4,S.storage=4):b.isVector2?(S.boundary=8,S.storage=8):b.isVector3||b.isColor?(S.boundary=16,S.storage=12):b.isVector4?(S.boundary=16,S.storage=16):b.isMatrix3?(S.boundary=48,S.storage=48):b.isMatrix4?(S.boundary=64,S.storage=64):b.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",b),S}function v(b){const S=b.target;S.removeEventListener("dispose",v);const _=o.indexOf(S.__bindingPointIndex);o.splice(_,1),n.deleteBuffer(i[S.id]),delete i[S.id],delete s[S.id]}function y(){for(const b in i)n.deleteBuffer(i[b]);o=[],i={},s={}}return{bind:l,update:c,dispose:y}}class cx{constructor(e={}){const{canvas:t=uW(),context:r=null,depth:i=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1}=e;this.isWebGLRenderer=!0;let h;r!==null?h=r.getContextAttributes().alpha:h=o;const f=new Uint32Array(4),p=new Int32Array(4);let x=null,v=null;const y=[],b=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Ai,this._useLegacyLights=!1,this.toneMapping=Ul,this.toneMappingExposure=1;const S=this;let _=!1,T=0,M=0,k=null,P=-1,z=null;const I=new vr,L=new vr;let W=null;const q=new Ut(0);let $=0,ne=t.width,Y=t.height,we=1,H=null,X=null;const oe=new vr(0,0,ne,Y),ve=new vr(0,0,ne,Y);let Te=!1;const Xe=new lx;let _e=!1,Ue=!1,Fe=null;const Oe=new vn,nt=new Ze,rt=new ie,ut={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Qe(){return k===null?we:1}let ae=r;function ze(B,re){for(let le=0;le<B.length;le++){const me=B[le],pe=t.getContext(me,re);if(pe!==null)return pe}return null}try{const B={alpha:!0,depth:i,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Sg}`),t.addEventListener("webglcontextlost",Ye,!1),t.addEventListener("webglcontextrestored",fe,!1),t.addEventListener("webglcontextcreationerror",ot,!1),ae===null){const re=["webgl2","webgl","experimental-webgl"];if(S.isWebGL1Renderer===!0&&re.shift(),ae=ze(re,B),ae===null)throw ze(re)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&ae instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),ae.getShaderPrecisionFormat===void 0&&(ae.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(B){throw console.error("THREE.WebGLRenderer: "+B.message),B}let Re,Je,Ge,Et,pt,Q,G,ke,J,he,ee,Ee,Me,Ae,Be,dt,We,Kt,cn,jt,wt,Mt,ye,He;function st(){Re=new Uhe(ae),Je=new Phe(ae,Re,e),Re.init(Je),Mt=new bW(ae,Re,Je),Ge=new wpe(ae,Re,Je),Et=new jhe(ae),pt=new lpe,Q=new bpe(ae,Re,Ge,pt,Je,Mt,Et),G=new Lhe(S),ke=new zhe(S),J=new Yce(ae,Je),ye=new Ihe(ae,Re,J,Je),he=new Bhe(ae,J,Et,ye),ee=new Ghe(ae,he,J,Et),cn=new Hhe(ae,Je,Q),dt=new Dhe(pt),Ee=new ape(S,G,ke,Re,Je,ye,dt),Me=new Mpe(S,pt),Ae=new upe,Be=new gpe(Re,Je),Kt=new khe(S,G,ke,Ge,ee,h,l),We=new xpe(S,ee,Je),He=new Ape(ae,Et,Je,Ge),jt=new Rhe(ae,Re,Et,Je),wt=new $he(ae,Re,Et,Je),Et.programs=Ee.programs,S.capabilities=Je,S.extensions=Re,S.properties=pt,S.renderLists=Ae,S.shadowMap=We,S.state=Ge,S.info=Et}st();const _t=new Tpe(S,ae);this.xr=_t,this.getContext=function(){return ae},this.getContextAttributes=function(){return ae.getContextAttributes()},this.forceContextLoss=function(){const B=Re.get("WEBGL_lose_context");B&&B.loseContext()},this.forceContextRestore=function(){const B=Re.get("WEBGL_lose_context");B&&B.restoreContext()},this.getPixelRatio=function(){return we},this.setPixelRatio=function(B){B!==void 0&&(we=B,this.setSize(ne,Y,!1))},this.getSize=function(B){return B.set(ne,Y)},this.setSize=function(B,re,le=!0){if(_t.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ne=B,Y=re,t.width=Math.floor(B*we),t.height=Math.floor(re*we),le===!0&&(t.style.width=B+"px",t.style.height=re+"px"),this.setViewport(0,0,B,re)},this.getDrawingBufferSize=function(B){return B.set(ne*we,Y*we).floor()},this.setDrawingBufferSize=function(B,re,le){ne=B,Y=re,we=le,t.width=Math.floor(B*le),t.height=Math.floor(re*le),this.setViewport(0,0,B,re)},this.getCurrentViewport=function(B){return B.copy(I)},this.getViewport=function(B){return B.copy(oe)},this.setViewport=function(B,re,le,me){B.isVector4?oe.set(B.x,B.y,B.z,B.w):oe.set(B,re,le,me),Ge.viewport(I.copy(oe).multiplyScalar(we).floor())},this.getScissor=function(B){return B.copy(ve)},this.setScissor=function(B,re,le,me){B.isVector4?ve.set(B.x,B.y,B.z,B.w):ve.set(B,re,le,me),Ge.scissor(L.copy(ve).multiplyScalar(we).floor())},this.getScissorTest=function(){return Te},this.setScissorTest=function(B){Ge.setScissorTest(Te=B)},this.setOpaqueSort=function(B){H=B},this.setTransparentSort=function(B){X=B},this.getClearColor=function(B){return B.copy(Kt.getClearColor())},this.setClearColor=function(){Kt.setClearColor.apply(Kt,arguments)},this.getClearAlpha=function(){return Kt.getClearAlpha()},this.setClearAlpha=function(){Kt.setClearAlpha.apply(Kt,arguments)},this.clear=function(B=!0,re=!0,le=!0){let me=0;if(B){let pe=!1;if(k!==null){const Ie=k.texture.format;pe=Ie===HI||Ie===WI||Ie===VI}if(pe){const Ie=k.texture.type,Le=Ie===Wo||Ie===kl||Ie===D_||Ie===Ku||Ie===BI||Ie===$I,$e=Kt.getClearColor(),je=Kt.getClearAlpha(),Dt=$e.r,et=$e.g,it=$e.b;Le?(f[0]=Dt,f[1]=et,f[2]=it,f[3]=je,ae.clearBufferuiv(ae.COLOR,0,f)):(p[0]=Dt,p[1]=et,p[2]=it,p[3]=je,ae.clearBufferiv(ae.COLOR,0,p))}else me|=ae.COLOR_BUFFER_BIT}re&&(me|=ae.DEPTH_BUFFER_BIT),le&&(me|=ae.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ae.clear(me)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ye,!1),t.removeEventListener("webglcontextrestored",fe,!1),t.removeEventListener("webglcontextcreationerror",ot,!1),Ae.dispose(),Be.dispose(),pt.dispose(),G.dispose(),ke.dispose(),ee.dispose(),ye.dispose(),He.dispose(),Ee.dispose(),_t.dispose(),_t.removeEventListener("sessionstart",wr),_t.removeEventListener("sessionend",Wn),Fe&&(Fe.dispose(),Fe=null),kr.stop()};function Ye(B){B.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_=!0}function fe(){console.log("THREE.WebGLRenderer: Context Restored."),_=!1;const B=Et.autoReset,re=We.enabled,le=We.autoUpdate,me=We.needsUpdate,pe=We.type;st(),Et.autoReset=B,We.enabled=re,We.autoUpdate=le,We.needsUpdate=me,We.type=pe}function ot(B){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",B.statusMessage)}function ht(B){const re=B.target;re.removeEventListener("dispose",ht),Bt(re)}function Bt(B){Pt(B),pt.remove(B)}function Pt(B){const re=pt.get(B).programs;re!==void 0&&(re.forEach(function(le){Ee.releaseProgram(le)}),B.isShaderMaterial&&Ee.releaseShaderCache(B))}this.renderBufferDirect=function(B,re,le,me,pe,Ie){re===null&&(re=ut);const Le=pe.isMesh&&pe.matrixWorld.determinant()<0,$e=j(B,re,le,me,pe);Ge.setMaterial(me,Le);let je=le.index,Dt=1;if(me.wireframe===!0){if(je=he.getWireframeAttribute(le),je===void 0)return;Dt=2}const et=le.drawRange,it=le.attributes.position;let At=et.start*Dt,en=(et.start+et.count)*Dt;Ie!==null&&(At=Math.max(At,Ie.start*Dt),en=Math.min(en,(Ie.start+Ie.count)*Dt)),je!==null?(At=Math.max(At,0),en=Math.min(en,je.count)):it!=null&&(At=Math.max(At,0),en=Math.min(en,it.count));const tn=en-At;if(tn<0||tn===1/0)return;ye.setup(pe,me,$e,le,je);let on,It=jt;if(je!==null&&(on=J.get(je),It=wt,It.setIndex(on)),pe.isMesh)me.wireframe===!0?(Ge.setLineWidth(me.wireframeLinewidth*Qe()),It.setMode(ae.LINES)):It.setMode(ae.TRIANGLES);else if(pe.isLine){let bt=me.linewidth;bt===void 0&&(bt=1),Ge.setLineWidth(bt*Qe()),pe.isLineSegments?It.setMode(ae.LINES):pe.isLineLoop?It.setMode(ae.LINE_LOOP):It.setMode(ae.LINE_STRIP)}else pe.isPoints?It.setMode(ae.POINTS):pe.isSprite&&It.setMode(ae.TRIANGLES);if(pe.isBatchedMesh)It.renderMultiDraw(pe._multiDrawStarts,pe._multiDrawCounts,pe._multiDrawCount);else if(pe.isInstancedMesh)It.renderInstances(At,tn,pe.count);else if(le.isInstancedBufferGeometry){const bt=le._maxInstanceCount!==void 0?le._maxInstanceCount:1/0,Cn=Math.min(le.instanceCount,bt);It.renderInstances(At,tn,Cn)}else It.render(At,tn)};function xn(B,re,le){B.transparent===!0&&B.side===Ka&&B.forceSinglePass===!1?(B.side=Cs,B.needsUpdate=!0,ln(B,re,le),B.side=Wc,B.needsUpdate=!0,ln(B,re,le),B.side=Ka):ln(B,re,le)}this.compile=function(B,re,le=null){le===null&&(le=B),v=Be.get(le),v.init(),b.push(v),le.traverseVisible(function(pe){pe.isLight&&pe.layers.test(re.layers)&&(v.pushLight(pe),pe.castShadow&&v.pushShadow(pe))}),B!==le&&B.traverseVisible(function(pe){pe.isLight&&pe.layers.test(re.layers)&&(v.pushLight(pe),pe.castShadow&&v.pushShadow(pe))}),v.setupLights(S._useLegacyLights);const me=new Set;return B.traverse(function(pe){const Ie=pe.material;if(Ie)if(Array.isArray(Ie))for(let Le=0;Le<Ie.length;Le++){const $e=Ie[Le];xn($e,le,pe),me.add($e)}else xn(Ie,le,pe),me.add(Ie)}),b.pop(),v=null,me},this.compileAsync=function(B,re,le=null){const me=this.compile(B,re,le);return new Promise(pe=>{function Ie(){if(me.forEach(function(Le){pt.get(Le).currentProgram.isReady()&&me.delete(Le)}),me.size===0){pe(B);return}setTimeout(Ie,10)}Re.get("KHR_parallel_shader_compile")!==null?Ie():setTimeout(Ie,10)})};let Dn=null;function ir(B){Dn&&Dn(B)}function wr(){kr.stop()}function Wn(){kr.start()}const kr=new mW;kr.setAnimationLoop(ir),typeof self<"u"&&kr.setContext(self),this.setAnimationLoop=function(B){Dn=B,_t.setAnimationLoop(B),B===null?kr.stop():kr.start()},_t.addEventListener("sessionstart",wr),_t.addEventListener("sessionend",Wn),this.render=function(B,re){if(re!==void 0&&re.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(_===!0)return;B.matrixWorldAutoUpdate===!0&&B.updateMatrixWorld(),re.parent===null&&re.matrixWorldAutoUpdate===!0&&re.updateMatrixWorld(),_t.enabled===!0&&_t.isPresenting===!0&&(_t.cameraAutoUpdate===!0&&_t.updateCamera(re),re=_t.getCamera()),B.isScene===!0&&B.onBeforeRender(S,B,re,k),v=Be.get(B,b.length),v.init(),b.push(v),Oe.multiplyMatrices(re.projectionMatrix,re.matrixWorldInverse),Xe.setFromProjectionMatrix(Oe),Ue=this.localClippingEnabled,_e=dt.init(this.clippingPlanes,Ue),x=Ae.get(B,y.length),x.init(),y.push(x),cs(B,re,0,S.sortObjects),x.finish(),S.sortObjects===!0&&x.sort(H,X),this.info.render.frame++,_e===!0&&dt.beginShadows();const le=v.state.shadowsArray;if(We.render(le,B,re),_e===!0&&dt.endShadows(),this.info.autoReset===!0&&this.info.reset(),(_t.enabled===!1||_t.isPresenting===!1||_t.hasDepthSensing()===!1)&&Kt.render(x,B),v.setupLights(S._useLegacyLights),re.isArrayCamera){const me=re.cameras;for(let pe=0,Ie=me.length;pe<Ie;pe++){const Le=me[pe];bi(x,B,Le,Le.viewport)}}else bi(x,B,re);k!==null&&(Q.updateMultisampleRenderTarget(k),Q.updateRenderTargetMipmap(k)),B.isScene===!0&&B.onAfterRender(S,B,re),ye.resetDefaultState(),P=-1,z=null,b.pop(),b.length>0?v=b[b.length-1]:v=null,y.pop(),y.length>0?x=y[y.length-1]:x=null};function cs(B,re,le,me){if(B.visible===!1)return;if(B.layers.test(re.layers)){if(B.isGroup)le=B.renderOrder;else if(B.isLOD)B.autoUpdate===!0&&B.update(re);else if(B.isLight)v.pushLight(B),B.castShadow&&v.pushShadow(B);else if(B.isSprite){if(!B.frustumCulled||Xe.intersectsSprite(B)){me&&rt.setFromMatrixPosition(B.matrixWorld).applyMatrix4(Oe);const Le=ee.update(B),$e=B.material;$e.visible&&x.push(B,Le,$e,le,rt.z,null)}}else if((B.isMesh||B.isLine||B.isPoints)&&(!B.frustumCulled||Xe.intersectsObject(B))){const Le=ee.update(B),$e=B.material;if(me&&(B.boundingSphere!==void 0?(B.boundingSphere===null&&B.computeBoundingSphere(),rt.copy(B.boundingSphere.center)):(Le.boundingSphere===null&&Le.computeBoundingSphere(),rt.copy(Le.boundingSphere.center)),rt.applyMatrix4(B.matrixWorld).applyMatrix4(Oe)),Array.isArray($e)){const je=Le.groups;for(let Dt=0,et=je.length;Dt<et;Dt++){const it=je[Dt],At=$e[it.materialIndex];At&&At.visible&&x.push(B,Le,At,le,rt.z,it)}}else $e.visible&&x.push(B,Le,$e,le,rt.z,null)}}const Ie=B.children;for(let Le=0,$e=Ie.length;Le<$e;Le++)cs(Ie[Le],re,le,me)}function bi(B,re,le,me){const pe=B.opaque,Ie=B.transmissive,Le=B.transparent;v.setupLightsView(le),_e===!0&&dt.setGlobalState(S.clippingPlanes,le),Ie.length>0&&Is(pe,Ie,re,le),me&&Ge.viewport(I.copy(me)),pe.length>0&&Rs(pe,re,le),Ie.length>0&&Rs(Ie,re,le),Le.length>0&&Rs(Le,re,le),Ge.buffers.depth.setTest(!0),Ge.buffers.depth.setMask(!0),Ge.buffers.color.setMask(!0),Ge.setPolygonOffset(!1)}function Is(B,re,le,me){if((le.isScene===!0?le.overrideMaterial:null)!==null)return;const Ie=Je.isWebGL2;Fe===null&&(Fe=new Eo(1,1,{generateMipmaps:!0,type:Re.has("EXT_color_buffer_half_float")?Fi:Wo,minFilter:Nl,samples:Ie?4:0})),S.getDrawingBufferSize(nt),Ie?Fe.setSize(nt.x,nt.y):Fe.setSize(_S(nt.x),_S(nt.y));const Le=S.getRenderTarget();S.setRenderTarget(Fe),S.getClearColor(q),$=S.getClearAlpha(),$<1&&S.setClearColor(16777215,.5),S.clear();const $e=S.toneMapping;S.toneMapping=Ul,Rs(B,le,me),Q.updateMultisampleRenderTarget(Fe),Q.updateRenderTargetMipmap(Fe);let je=!1;for(let Dt=0,et=re.length;Dt<et;Dt++){const it=re[Dt],At=it.object,en=it.geometry,tn=it.material,on=it.group;if(tn.side===Ka&&At.layers.test(me.layers)){const It=tn.side;tn.side=Cs,tn.needsUpdate=!0,Xn(At,le,me,en,tn,on),tn.side=It,tn.needsUpdate=!0,je=!0}}je===!0&&(Q.updateMultisampleRenderTarget(Fe),Q.updateRenderTargetMipmap(Fe)),S.setRenderTarget(Le),S.setClearColor(q,$),S.toneMapping=$e}function Rs(B,re,le){const me=re.isScene===!0?re.overrideMaterial:null;for(let pe=0,Ie=B.length;pe<Ie;pe++){const Le=B[pe],$e=Le.object,je=Le.geometry,Dt=me===null?Le.material:me,et=Le.group;$e.layers.test(le.layers)&&Xn($e,re,le,je,Dt,et)}}function Xn(B,re,le,me,pe,Ie){B.onBeforeRender(S,re,le,me,pe,Ie),B.modelViewMatrix.multiplyMatrices(le.matrixWorldInverse,B.matrixWorld),B.normalMatrix.getNormalMatrix(B.modelViewMatrix),pe.onBeforeRender(S,re,le,me,B,Ie),pe.transparent===!0&&pe.side===Ka&&pe.forceSinglePass===!1?(pe.side=Cs,pe.needsUpdate=!0,S.renderBufferDirect(le,re,me,pe,B,Ie),pe.side=Wc,pe.needsUpdate=!0,S.renderBufferDirect(le,re,me,pe,B,Ie),pe.side=Ka):S.renderBufferDirect(le,re,me,pe,B,Ie),B.onAfterRender(S,re,le,me,pe,Ie)}function ln(B,re,le){re.isScene!==!0&&(re=ut);const me=pt.get(B),pe=v.state.lights,Ie=v.state.shadowsArray,Le=pe.state.version,$e=Ee.getParameters(B,pe.state,Ie,re,le),je=Ee.getProgramCacheKey($e);let Dt=me.programs;me.environment=B.isMeshStandardMaterial?re.environment:null,me.fog=re.fog,me.envMap=(B.isMeshStandardMaterial?ke:G).get(B.envMap||me.environment),Dt===void 0&&(B.addEventListener("dispose",ht),Dt=new Map,me.programs=Dt);let et=Dt.get(je);if(et!==void 0){if(me.currentProgram===et&&me.lightsStateVersion===Le)return tu(B,$e),et}else $e.uniforms=Ee.getUniforms(B),B.onBuild(le,$e,S),B.onBeforeCompile($e,S),et=Ee.acquireProgram($e,je),Dt.set(je,et),me.uniforms=$e.uniforms;const it=me.uniforms;return(!B.isShaderMaterial&&!B.isRawShaderMaterial||B.clipping===!0)&&(it.clippingPlanes=dt.uniform),tu(B,$e),me.needsLights=xe(B),me.lightsStateVersion=Le,me.needsLights&&(it.ambientLightColor.value=pe.state.ambient,it.lightProbe.value=pe.state.probe,it.directionalLights.value=pe.state.directional,it.directionalLightShadows.value=pe.state.directionalShadow,it.spotLights.value=pe.state.spot,it.spotLightShadows.value=pe.state.spotShadow,it.rectAreaLights.value=pe.state.rectArea,it.ltc_1.value=pe.state.rectAreaLTC1,it.ltc_2.value=pe.state.rectAreaLTC2,it.pointLights.value=pe.state.point,it.pointLightShadows.value=pe.state.pointShadow,it.hemisphereLights.value=pe.state.hemi,it.directionalShadowMap.value=pe.state.directionalShadowMap,it.directionalShadowMatrix.value=pe.state.directionalShadowMatrix,it.spotShadowMap.value=pe.state.spotShadowMap,it.spotLightMatrix.value=pe.state.spotLightMatrix,it.spotLightMap.value=pe.state.spotLightMap,it.pointShadowMap.value=pe.state.pointShadowMap,it.pointShadowMatrix.value=pe.state.pointShadowMatrix),me.currentProgram=et,me.uniformsList=null,et}function Ra(B){if(B.uniformsList===null){const re=B.currentProgram.getUniforms();B.uniformsList=yb.seqWithValue(re.seq,B.uniforms)}return B.uniformsList}function tu(B,re){const le=pt.get(B);le.outputColorSpace=re.outputColorSpace,le.batching=re.batching,le.instancing=re.instancing,le.instancingColor=re.instancingColor,le.skinning=re.skinning,le.morphTargets=re.morphTargets,le.morphNormals=re.morphNormals,le.morphColors=re.morphColors,le.morphTargetsCount=re.morphTargetsCount,le.numClippingPlanes=re.numClippingPlanes,le.numIntersection=re.numClipIntersection,le.vertexAlphas=re.vertexAlphas,le.vertexTangents=re.vertexTangents,le.toneMapping=re.toneMapping}function j(B,re,le,me,pe){re.isScene!==!0&&(re=ut),Q.resetTextureUnits();const Ie=re.fog,Le=me.isMeshStandardMaterial?re.environment:null,$e=k===null?S.outputColorSpace:k.isXRRenderTarget===!0?k.texture.colorSpace:Ko,je=(me.isMeshStandardMaterial?ke:G).get(me.envMap||Le),Dt=me.vertexColors===!0&&!!le.attributes.color&&le.attributes.color.itemSize===4,et=!!le.attributes.tangent&&(!!me.normalMap||me.anisotropy>0),it=!!le.morphAttributes.position,At=!!le.morphAttributes.normal,en=!!le.morphAttributes.color;let tn=Ul;me.toneMapped&&(k===null||k.isXRRenderTarget===!0)&&(tn=S.toneMapping);const on=le.morphAttributes.position||le.morphAttributes.normal||le.morphAttributes.color,It=on!==void 0?on.length:0,bt=pt.get(me),Cn=v.state.lights;if(_e===!0&&(Ue===!0||B!==z)){const bn=B===z&&me.id===P;dt.setState(me,B,bn)}let an=!1;me.version===bt.__version?(bt.needsLights&&bt.lightsStateVersion!==Cn.state.version||bt.outputColorSpace!==$e||pe.isBatchedMesh&&bt.batching===!1||!pe.isBatchedMesh&&bt.batching===!0||pe.isInstancedMesh&&bt.instancing===!1||!pe.isInstancedMesh&&bt.instancing===!0||pe.isSkinnedMesh&&bt.skinning===!1||!pe.isSkinnedMesh&&bt.skinning===!0||pe.isInstancedMesh&&bt.instancingColor===!0&&pe.instanceColor===null||pe.isInstancedMesh&&bt.instancingColor===!1&&pe.instanceColor!==null||bt.envMap!==je||me.fog===!0&&bt.fog!==Ie||bt.numClippingPlanes!==void 0&&(bt.numClippingPlanes!==dt.numPlanes||bt.numIntersection!==dt.numIntersection)||bt.vertexAlphas!==Dt||bt.vertexTangents!==et||bt.morphTargets!==it||bt.morphNormals!==At||bt.morphColors!==en||bt.toneMapping!==tn||Je.isWebGL2===!0&&bt.morphTargetsCount!==It)&&(an=!0):(an=!0,bt.__version=me.version);let fn=bt.currentProgram;an===!0&&(fn=ln(me,re,pe));let ur=!1,zr=!1,Tr=!1;const Hn=fn.getUniforms(),Nn=bt.uniforms;if(Ge.useProgram(fn.program)&&(ur=!0,zr=!0,Tr=!0),me.id!==P&&(P=me.id,zr=!0),ur||z!==B){Hn.setValue(ae,"projectionMatrix",B.projectionMatrix),Hn.setValue(ae,"viewMatrix",B.matrixWorldInverse);const bn=Hn.map.cameraPosition;bn!==void 0&&bn.setValue(ae,rt.setFromMatrixPosition(B.matrixWorld)),Je.logarithmicDepthBuffer&&Hn.setValue(ae,"logDepthBufFC",2/(Math.log(B.far+1)/Math.LN2)),(me.isMeshPhongMaterial||me.isMeshToonMaterial||me.isMeshLambertMaterial||me.isMeshBasicMaterial||me.isMeshStandardMaterial||me.isShaderMaterial)&&Hn.setValue(ae,"isOrthographic",B.isOrthographicCamera===!0),z!==B&&(z=B,zr=!0,Tr=!0)}if(pe.isSkinnedMesh){Hn.setOptional(ae,pe,"bindMatrix"),Hn.setOptional(ae,pe,"bindMatrixInverse");const bn=pe.skeleton;bn&&(Je.floatVertexTextures?(bn.boneTexture===null&&bn.computeBoneTexture(),Hn.setValue(ae,"boneTexture",bn.boneTexture,Q)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}pe.isBatchedMesh&&(Hn.setOptional(ae,pe,"batchingTexture"),Hn.setValue(ae,"batchingTexture",pe._matricesTexture,Q));const $n=le.morphAttributes;if(($n.position!==void 0||$n.normal!==void 0||$n.color!==void 0&&Je.isWebGL2===!0)&&cn.update(pe,le,fn),(zr||bt.receiveShadow!==pe.receiveShadow)&&(bt.receiveShadow=pe.receiveShadow,Hn.setValue(ae,"receiveShadow",pe.receiveShadow)),me.isMeshGouraudMaterial&&me.envMap!==null&&(Nn.envMap.value=je,Nn.flipEnvMap.value=je.isCubeTexture&&je.isRenderTargetTexture===!1?-1:1),zr&&(Hn.setValue(ae,"toneMappingExposure",S.toneMappingExposure),bt.needsLights&&Z(Nn,Tr),Ie&&me.fog===!0&&Me.refreshFogUniforms(Nn,Ie),Me.refreshMaterialUniforms(Nn,me,we,Y,Fe),yb.upload(ae,Ra(bt),Nn,Q)),me.isShaderMaterial&&me.uniformsNeedUpdate===!0&&(yb.upload(ae,Ra(bt),Nn,Q),me.uniformsNeedUpdate=!1),me.isSpriteMaterial&&Hn.setValue(ae,"center",pe.center),Hn.setValue(ae,"modelViewMatrix",pe.modelViewMatrix),Hn.setValue(ae,"normalMatrix",pe.normalMatrix),Hn.setValue(ae,"modelMatrix",pe.matrixWorld),me.isShaderMaterial||me.isRawShaderMaterial){const bn=me.uniformsGroups;for(let Un=0,dr=bn.length;Un<dr;Un++)if(Je.isWebGL2){const Ps=bn[Un];He.update(Ps,fn),He.bind(Ps,fn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return fn}function Z(B,re){B.ambientLightColor.needsUpdate=re,B.lightProbe.needsUpdate=re,B.directionalLights.needsUpdate=re,B.directionalLightShadows.needsUpdate=re,B.pointLights.needsUpdate=re,B.pointLightShadows.needsUpdate=re,B.spotLights.needsUpdate=re,B.spotLightShadows.needsUpdate=re,B.rectAreaLights.needsUpdate=re,B.hemisphereLights.needsUpdate=re}function xe(B){return B.isMeshLambertMaterial||B.isMeshToonMaterial||B.isMeshPhongMaterial||B.isMeshStandardMaterial||B.isShadowMaterial||B.isShaderMaterial&&B.lights===!0}this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return M},this.getRenderTarget=function(){return k},this.setRenderTargetTextures=function(B,re,le){pt.get(B.texture).__webglTexture=re,pt.get(B.depthTexture).__webglTexture=le;const me=pt.get(B);me.__hasExternalTextures=!0,me.__hasExternalTextures&&(me.__autoAllocateDepthBuffer=le===void 0,me.__autoAllocateDepthBuffer||Re.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),me.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(B,re){const le=pt.get(B);le.__webglFramebuffer=re,le.__useDefaultFramebuffer=re===void 0},this.setRenderTarget=function(B,re=0,le=0){k=B,T=re,M=le;let me=!0,pe=null,Ie=!1,Le=!1;if(B){const je=pt.get(B);je.__useDefaultFramebuffer!==void 0?(Ge.bindFramebuffer(ae.FRAMEBUFFER,null),me=!1):je.__webglFramebuffer===void 0?Q.setupRenderTarget(B):je.__hasExternalTextures&&Q.rebindTextures(B,pt.get(B.texture).__webglTexture,pt.get(B.depthTexture).__webglTexture);const Dt=B.texture;(Dt.isData3DTexture||Dt.isDataArrayTexture||Dt.isCompressedArrayTexture)&&(Le=!0);const et=pt.get(B).__webglFramebuffer;B.isWebGLCubeRenderTarget?(Array.isArray(et[re])?pe=et[re][le]:pe=et[re],Ie=!0):Je.isWebGL2&&B.samples>0&&Q.useMultisampledRTT(B)===!1?pe=pt.get(B).__webglMultisampledFramebuffer:Array.isArray(et)?pe=et[le]:pe=et,I.copy(B.viewport),L.copy(B.scissor),W=B.scissorTest}else I.copy(oe).multiplyScalar(we).floor(),L.copy(ve).multiplyScalar(we).floor(),W=Te;if(Ge.bindFramebuffer(ae.FRAMEBUFFER,pe)&&Je.drawBuffers&&me&&Ge.drawBuffers(B,pe),Ge.viewport(I),Ge.scissor(L),Ge.setScissorTest(W),Ie){const je=pt.get(B.texture);ae.framebufferTexture2D(ae.FRAMEBUFFER,ae.COLOR_ATTACHMENT0,ae.TEXTURE_CUBE_MAP_POSITIVE_X+re,je.__webglTexture,le)}else if(Le){const je=pt.get(B.texture),Dt=re||0;ae.framebufferTextureLayer(ae.FRAMEBUFFER,ae.COLOR_ATTACHMENT0,je.__webglTexture,le||0,Dt)}P=-1},this.readRenderTargetPixels=function(B,re,le,me,pe,Ie,Le){if(!(B&&B.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let $e=pt.get(B).__webglFramebuffer;if(B.isWebGLCubeRenderTarget&&Le!==void 0&&($e=$e[Le]),$e){Ge.bindFramebuffer(ae.FRAMEBUFFER,$e);try{const je=B.texture,Dt=je.format,et=je.type;if(Dt!==Ii&&Mt.convert(Dt)!==ae.getParameter(ae.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const it=et===Fi&&(Re.has("EXT_color_buffer_half_float")||Je.isWebGL2&&Re.has("EXT_color_buffer_float"));if(et!==Wo&&Mt.convert(et)!==ae.getParameter(ae.IMPLEMENTATION_COLOR_READ_TYPE)&&!(et===fi&&(Je.isWebGL2||Re.has("OES_texture_float")||Re.has("WEBGL_color_buffer_float")))&&!it){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}re>=0&&re<=B.width-me&&le>=0&&le<=B.height-pe&&ae.readPixels(re,le,me,pe,Mt.convert(Dt),Mt.convert(et),Ie)}finally{const je=k!==null?pt.get(k).__webglFramebuffer:null;Ge.bindFramebuffer(ae.FRAMEBUFFER,je)}}},this.copyFramebufferToTexture=function(B,re,le=0){const me=Math.pow(2,-le),pe=Math.floor(re.image.width*me),Ie=Math.floor(re.image.height*me);Q.setTexture2D(re,0),ae.copyTexSubImage2D(ae.TEXTURE_2D,le,0,0,B.x,B.y,pe,Ie),Ge.unbindTexture()},this.copyTextureToTexture=function(B,re,le,me=0){const pe=re.image.width,Ie=re.image.height,Le=Mt.convert(le.format),$e=Mt.convert(le.type);Q.setTexture2D(le,0),ae.pixelStorei(ae.UNPACK_FLIP_Y_WEBGL,le.flipY),ae.pixelStorei(ae.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),ae.pixelStorei(ae.UNPACK_ALIGNMENT,le.unpackAlignment),re.isDataTexture?ae.texSubImage2D(ae.TEXTURE_2D,me,B.x,B.y,pe,Ie,Le,$e,re.image.data):re.isCompressedTexture?ae.compressedTexSubImage2D(ae.TEXTURE_2D,me,B.x,B.y,re.mipmaps[0].width,re.mipmaps[0].height,Le,re.mipmaps[0].data):ae.texSubImage2D(ae.TEXTURE_2D,me,B.x,B.y,Le,$e,re.image),me===0&&le.generateMipmaps&&ae.generateMipmap(ae.TEXTURE_2D),Ge.unbindTexture()},this.copyTextureToTexture3D=function(B,re,le,me,pe=0){if(S.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ie=B.max.x-B.min.x+1,Le=B.max.y-B.min.y+1,$e=B.max.z-B.min.z+1,je=Mt.convert(me.format),Dt=Mt.convert(me.type);let et;if(me.isData3DTexture)Q.setTexture3D(me,0),et=ae.TEXTURE_3D;else if(me.isDataArrayTexture||me.isCompressedArrayTexture)Q.setTexture2DArray(me,0),et=ae.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ae.pixelStorei(ae.UNPACK_FLIP_Y_WEBGL,me.flipY),ae.pixelStorei(ae.UNPACK_PREMULTIPLY_ALPHA_WEBGL,me.premultiplyAlpha),ae.pixelStorei(ae.UNPACK_ALIGNMENT,me.unpackAlignment);const it=ae.getParameter(ae.UNPACK_ROW_LENGTH),At=ae.getParameter(ae.UNPACK_IMAGE_HEIGHT),en=ae.getParameter(ae.UNPACK_SKIP_PIXELS),tn=ae.getParameter(ae.UNPACK_SKIP_ROWS),on=ae.getParameter(ae.UNPACK_SKIP_IMAGES),It=le.isCompressedTexture?le.mipmaps[pe]:le.image;ae.pixelStorei(ae.UNPACK_ROW_LENGTH,It.width),ae.pixelStorei(ae.UNPACK_IMAGE_HEIGHT,It.height),ae.pixelStorei(ae.UNPACK_SKIP_PIXELS,B.min.x),ae.pixelStorei(ae.UNPACK_SKIP_ROWS,B.min.y),ae.pixelStorei(ae.UNPACK_SKIP_IMAGES,B.min.z),le.isDataTexture||le.isData3DTexture?ae.texSubImage3D(et,pe,re.x,re.y,re.z,Ie,Le,$e,je,Dt,It.data):le.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ae.compressedTexSubImage3D(et,pe,re.x,re.y,re.z,Ie,Le,$e,je,It.data)):ae.texSubImage3D(et,pe,re.x,re.y,re.z,Ie,Le,$e,je,Dt,It),ae.pixelStorei(ae.UNPACK_ROW_LENGTH,it),ae.pixelStorei(ae.UNPACK_IMAGE_HEIGHT,At),ae.pixelStorei(ae.UNPACK_SKIP_PIXELS,en),ae.pixelStorei(ae.UNPACK_SKIP_ROWS,tn),ae.pixelStorei(ae.UNPACK_SKIP_IMAGES,on),pe===0&&me.generateMipmaps&&ae.generateMipmap(et),Ge.unbindTexture()},this.initTexture=function(B){B.isCubeTexture?Q.setTextureCube(B,0):B.isData3DTexture?Q.setTexture3D(B,0):B.isDataArrayTexture||B.isCompressedArrayTexture?Q.setTexture2DArray(B,0):Q.setTexture2D(B,0),Ge.unbindTexture()},this.resetState=function(){T=0,M=0,k=null,Ge.reset(),ye.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Il}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===F_?"display-p3":"srgb",t.unpackColorSpace=gr.workingColorSpace===sx?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Ai?Zu:XI}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Zu?Ai:Ko}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class _W extends cx{}_W.prototype.isWebGL1Renderer=!0;class $_{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ut(e),this.density=t}clone(){return new $_(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class j_{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new Ut(e),this.near=t,this.far=r}clone(){return new j_(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Tg extends cr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class V_{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=h0,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Ho()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return Wh("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ho()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ho()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const zs=new ie;class uf{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)zs.fromBufferAttribute(this,t),zs.applyMatrix4(e),this.setXYZ(t,zs.x,zs.y,zs.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)zs.fromBufferAttribute(this,t),zs.applyNormalMatrix(e),this.setXYZ(t,zs.x,zs.y,zs.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)zs.fromBufferAttribute(this,t),zs.transformDirection(e),this.setXYZ(t,zs.x,zs.y,zs.z);return this}getComponent(e,t){let r=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(r=Ws(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Tn(r,this.array)),this.data.array[e*this.data.stride+this.offset+t]=r,this}setX(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Ws(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Ws(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Ws(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Ws(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Tn(t,this.array),r=Tn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Tn(t,this.array),r=Tn(r,this.array),i=Tn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Tn(t,this.array),r=Tn(r,this.array),i=Tn(i,this.array),s=Tn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new pr(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new uf(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class oR extends ks{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ut(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Cp;const Sy=new ie,Tp=new ie,Mp=new ie,Ap=new Ze,_y=new Ze,EW=new vn,c1=new ie,Ey=new ie,u1=new ie,WO=new Ze,DC=new Ze,HO=new Ze;class CW extends cr{constructor(e=new oR){if(super(),this.isSprite=!0,this.type="Sprite",Cp===void 0){Cp=new Pn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new V_(t,5);Cp.setIndex([0,1,2,0,2,3]),Cp.setAttribute("position",new uf(r,3,0,!1)),Cp.setAttribute("uv",new uf(r,2,3,!1))}this.geometry=Cp,this.material=e,this.center=new Ze(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Tp.setFromMatrixScale(this.matrixWorld),EW.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Mp.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Tp.multiplyScalar(-Mp.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const o=this.center;d1(c1.set(-.5,-.5,0),Mp,o,Tp,i,s),d1(Ey.set(.5,-.5,0),Mp,o,Tp,i,s),d1(u1.set(.5,.5,0),Mp,o,Tp,i,s),WO.set(0,0),DC.set(1,0),HO.set(1,1);let a=e.ray.intersectTriangle(c1,Ey,u1,!1,Sy);if(a===null&&(d1(Ey.set(-.5,.5,0),Mp,o,Tp,i,s),DC.set(0,1),a=e.ray.intersectTriangle(c1,u1,Ey,!1,Sy),a===null))return;const l=e.ray.origin.distanceTo(Sy);l<e.near||l>e.far||t.push({distance:l,point:Sy.clone(),uv:Uo.getInterpolation(Sy,c1,Ey,u1,WO,DC,HO,new Ze),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function d1(n,e,t,r,i,s){Ap.subVectors(n,t).addScalar(.5).multiply(r),i!==void 0?(_y.x=s*Ap.x-i*Ap.y,_y.y=i*Ap.x+s*Ap.y):_y.copy(Ap),n.copy(e),n.x+=_y.x,n.y+=_y.y,n.applyMatrix4(EW)}const h1=new ie,GO=new ie;class TW extends cr{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let r=0,i=t.length;r<i;r++){const s=t[r];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,r=0){t=Math.abs(t);const i=this.levels;let s;for(s=0;s<i.length&&!(t<i[s].distance);s++);return i.splice(s,0,{distance:t,hysteresis:r,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let r,i;for(r=1,i=t.length;r<i;r++){let s=t[r].distance;if(t[r].object.visible&&(s-=s*t[r].hysteresis),e<s)break}return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){h1.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(h1);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){h1.setFromMatrixPosition(e.matrixWorld),GO.setFromMatrixPosition(this.matrixWorld);const r=h1.distanceTo(GO)/e.zoom;t[0].object.visible=!0;let i,s;for(i=1,s=t.length;i<s;i++){let o=t[i].distance;if(t[i].object.visible&&(o-=o*t[i].hysteresis),r>=o)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let i=0,s=r.length;i<s;i++){const o=r[i];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const qO=new ie,XO=new vr,KO=new vr,Npe=new ie,YO=new vn,f1=new ie,LC=new Ms,ZO=new vn,OC=new Mf;class MW extends ri{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=sA,this.bindMatrix=new vn,this.bindMatrixInverse=new vn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new qs),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,f1),this.boundingBox.expandByPoint(f1)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Ms),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,f1),this.boundingSphere.expandByPoint(f1)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.material,i=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),LC.copy(this.boundingSphere),LC.applyMatrix4(i),e.ray.intersectsSphere(LC)!==!1&&(ZO.copy(i).invert(),OC.copy(e.ray).applyMatrix4(ZO),!(this.boundingBox!==null&&OC.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,OC)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new vr,t=this.geometry.attributes.skinWeight;for(let r=0,i=t.count;r<i;r++){e.fromBufferAttribute(t,r);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===sA?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===$6?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const r=this.skeleton,i=this.geometry;XO.fromBufferAttribute(i.attributes.skinIndex,e),KO.fromBufferAttribute(i.attributes.skinWeight,e),qO.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=KO.getComponent(s);if(o!==0){const a=XO.getComponent(s);YO.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),t.addScaledVector(Npe.copy(qO).applyMatrix4(YO),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class aR extends cr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Qu extends qr{constructor(e=null,t=1,r=1,i,s,o,a,l,c=yi,u=yi,d,h){super(null,o,a,l,c,u,i,s,d,h),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const QO=new vn,kpe=new vn;class W_{constructor(e=[],t=[]){this.uuid=Ho(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new vn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new vn;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:kpe;QO.multiplyMatrices(a,t[s]),QO.toArray(r,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new W_(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new Qu(t,e,e,Ii,fi);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const s=e.bones[r];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new aR),this.bones.push(o),this.boneInverses.push(new vn().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const o=t[i];e.bones.push(o.uuid);const a=r[i];e.boneInverses.push(a.toArray())}return e}}class Gm extends pr{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Np=new vn,JO=new vn,p1=[],eF=new qs,Ipe=new vn,Cy=new ri,Ty=new Ms;class AW extends ri{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Gm(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<r;i++)this.setMatrixAt(i,Ipe)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new qs),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,Np),eF.copy(e.boundingBox).applyMatrix4(Np),this.boundingBox.union(eF)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Ms),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,Np),Ty.copy(e.boundingSphere).applyMatrix4(Np),this.boundingSphere.union(Ty)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const r=this.matrixWorld,i=this.count;if(Cy.geometry=this.geometry,Cy.material=this.material,Cy.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Ty.copy(this.boundingSphere),Ty.applyMatrix4(r),e.ray.intersectsSphere(Ty)!==!1))for(let s=0;s<i;s++){this.getMatrixAt(s,Np),JO.multiplyMatrices(r,Np),Cy.matrixWorld=JO,Cy.raycast(e,p1);for(let o=0,a=p1.length;o<a;o++){const l=p1[o];l.instanceId=s,l.object=this,t.push(l)}p1.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Gm(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}function Rpe(n,e){return n.z-e.z}function Ppe(n,e){return e.z-n.z}class Dpe{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){const r=this.pool,i=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1});const s=r[this.index];i.push(s),this.index++,s.start=e.start,s.count=e.count,s.z=t}reset(){this.list.length=0,this.index=0}}const kp="batchId",bu=new vn,tF=new vn,Lpe=new vn,nF=new vn,FC=new lx,m1=new qs,th=new Ms,My=new ie,zC=new Dpe,vs=new ri,g1=[];function Ope(n,e,t=0){const r=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const i=n.count;for(let s=0;s<i;s++)for(let o=0;o<r;o++)e.setComponent(s+t,o,n.getComponent(s,o))}else e.array.set(n.array,t*r);e.needsUpdate=!0}class NW extends ri{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t,r=t*2,i){super(new Pn,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),r=new Qu(t,e,e,Ii,fi);this._matricesTexture=r}_initializeGeometry(e){const t=this.geometry,r=this._maxVertexCount,i=this._maxGeometryCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const a in e.attributes){const l=e.getAttribute(a),{array:c,itemSize:u,normalized:d}=l,h=new c.constructor(r*u),f=new l.constructor(h,u,d);f.setUsage(l.usage),t.setAttribute(a,f)}if(e.getIndex()!==null){const a=r>65536?new Uint32Array(s):new Uint16Array(s);t.setIndex(new pr(a,1))}const o=i>65536?new Uint32Array(r):new Uint16Array(r);t.setAttribute(kp,new pr(o,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(kp))throw new Error(`BatchedMesh: Geometry cannot use attribute "${kp}"`);const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const r in t.attributes){if(r===kp)continue;if(!e.hasAttribute(r))throw new Error(`BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const i=e.getAttribute(r),s=t.getAttribute(r);if(i.itemSize!==s.itemSize||i.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new qs);const e=this._geometryCount,t=this.boundingBox,r=this._active;t.makeEmpty();for(let i=0;i<e;i++)r[i]!==!1&&(this.getMatrixAt(i,bu),this.getBoundingBoxAt(i,m1).applyMatrix4(bu),t.union(m1))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ms);const e=this._geometryCount,t=this.boundingSphere,r=this._active;t.makeEmpty();for(let i=0;i<e;i++)r[i]!==!1&&(this.getMatrixAt(i,bu),this.getBoundingSphereAt(i,th).applyMatrix4(bu),t.union(th))}addGeometry(e,t=-1,r=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const i={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this._reservedRanges,a=this._drawRanges,l=this._bounds;this._geometryCount!==0&&(s=o[o.length-1]),t===-1?i.vertexCount=e.getAttribute("position").count:i.vertexCount=t,s===null?i.vertexStart=0:i.vertexStart=s.vertexStart+s.vertexCount;const c=e.getIndex(),u=c!==null;if(u&&(r===-1?i.indexCount=c.count:i.indexCount=r,s===null?i.indexStart=0:i.indexStart=s.indexStart+s.indexCount),i.indexStart!==-1&&i.indexStart+i.indexCount>this._maxIndexCount||i.vertexStart+i.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const d=this._visibility,h=this._active,f=this._matricesTexture,p=this._matricesTexture.image.data;d.push(!0),h.push(!0);const x=this._geometryCount;this._geometryCount++,Lpe.toArray(p,x*16),f.needsUpdate=!0,o.push(i),a.push({start:u?i.indexStart:i.vertexStart,count:-1}),l.push({boxInitialized:!1,box:new qs,sphereInitialized:!1,sphere:new Ms});const v=this.geometry.getAttribute(kp);for(let y=0;y<i.vertexCount;y++)v.setX(i.vertexStart+y,x);return v.needsUpdate=!0,this.setGeometryAt(x,e),x}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const r=this.geometry,i=r.getIndex()!==null,s=r.getIndex(),o=t.getIndex(),a=this._reservedRanges[e];if(i&&o.count>a.indexCount||t.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const l=a.vertexStart,c=a.vertexCount;for(const f in r.attributes){if(f===kp)continue;const p=t.getAttribute(f),x=r.getAttribute(f);Ope(p,x,l);const v=p.itemSize;for(let y=p.count,b=c;y<b;y++){const S=l+y;for(let _=0;_<v;_++)x.setComponent(S,_,0)}x.needsUpdate=!0}if(i){const f=a.indexStart;for(let p=0;p<o.count;p++)s.setX(f+p,l+o.getX(p));for(let p=o.count,x=a.indexCount;p<x;p++)s.setX(f+p,l);s.needsUpdate=!0}const u=this._bounds[e];t.boundingBox!==null?(u.box.copy(t.boundingBox),u.boxInitialized=!0):u.boxInitialized=!1,t.boundingSphere!==null?(u.sphere.copy(t.boundingSphere),u.sphereInitialized=!0):u.sphereInitialized=!1;const d=this._drawRanges[e],h=t.getAttribute("position");return d.count=i?o.count:h.count,this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._active;return e>=t.length||t[e]===!1?this:(t[e]=!1,this._visibilityChanged=!0,this)}getBoundingBoxAt(e,t){if(this._active[e]===!1)return null;const i=this._bounds[e],s=i.box,o=this.geometry;if(i.boxInitialized===!1){s.makeEmpty();const a=o.index,l=o.attributes.position,c=this._drawRanges[e];for(let u=c.start,d=c.start+c.count;u<d;u++){let h=u;a&&(h=a.getX(h)),s.expandByPoint(My.fromBufferAttribute(l,h))}i.boxInitialized=!0}return t.copy(s),t}getBoundingSphereAt(e,t){if(this._active[e]===!1)return null;const i=this._bounds[e],s=i.sphere,o=this.geometry;if(i.sphereInitialized===!1){s.makeEmpty(),this.getBoundingBoxAt(e,m1),m1.getCenter(s.center);const a=o.index,l=o.attributes.position,c=this._drawRanges[e];let u=0;for(let d=c.start,h=c.start+c.count;d<h;d++){let f=d;a&&(f=a.getX(f)),My.fromBufferAttribute(l,f),u=Math.max(u,s.center.distanceToSquared(My))}s.radius=Math.sqrt(u),i.sphereInitialized=!0}return t.copy(s),t}setMatrixAt(e,t){const r=this._active,i=this._matricesTexture,s=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||r[e]===!1?this:(t.toArray(s,e*16),i.needsUpdate=!0,this)}getMatrixAt(e,t){const r=this._active,i=this._matricesTexture.image.data,s=this._geometryCount;return e>=s||r[e]===!1?null:t.fromArray(i,e*16)}setVisibleAt(e,t){const r=this._visibility,i=this._active,s=this._geometryCount;return e>=s||i[e]===!1||r[e]===t?this:(r[e]=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._visibility,r=this._active,i=this._geometryCount;return e>=i||r[e]===!1?!1:t[e]}raycast(e,t){const r=this._visibility,i=this._active,s=this._drawRanges,o=this._geometryCount,a=this.matrixWorld,l=this.geometry;vs.material=this.material,vs.geometry.index=l.index,vs.geometry.attributes=l.attributes,vs.geometry.boundingBox===null&&(vs.geometry.boundingBox=new qs),vs.geometry.boundingSphere===null&&(vs.geometry.boundingSphere=new Ms);for(let c=0;c<o;c++){if(!r[c]||!i[c])continue;const u=s[c];vs.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(c,vs.matrixWorld).premultiply(a),this.getBoundingBoxAt(c,vs.geometry.boundingBox),this.getBoundingSphereAt(c,vs.geometry.boundingSphere),vs.raycast(e,g1);for(let d=0,h=g1.length;d<h;d++){const f=g1[d];f.object=this,f.batchId=c,t.push(f)}g1.length=0}vs.material=null,vs.geometry.index=null,vs.geometry.attributes={},vs.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,r,i,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=i.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._active,c=this._visibility,u=this._multiDrawStarts,d=this._multiDrawCounts,h=this._drawRanges,f=this.perObjectFrustumCulled;f&&(nF.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),FC.setFromProjectionMatrix(nF,e.coordinateSystem));let p=0;if(this.sortObjects){tF.copy(this.matrixWorld).invert(),My.setFromMatrixPosition(r.matrixWorld).applyMatrix4(tF);for(let y=0,b=c.length;y<b;y++)if(c[y]&&l[y]){this.getMatrixAt(y,bu),this.getBoundingSphereAt(y,th).applyMatrix4(bu);let S=!1;if(f&&(S=!FC.intersectsSphere(th)),!S){const _=My.distanceTo(th.center);zC.push(h[y],_)}}const x=zC.list,v=this.customSort;v===null?x.sort(s.transparent?Ppe:Rpe):v.call(this,x,r);for(let y=0,b=x.length;y<b;y++){const S=x[y];u[p]=S.start*a,d[p]=S.count,p++}zC.reset()}else for(let x=0,v=c.length;x<v;x++)if(c[x]&&l[x]){let y=!1;if(f&&(this.getMatrixAt(x,bu),this.getBoundingSphereAt(x,th).applyMatrix4(bu),y=!FC.intersectsSphere(th)),!y){const b=h[x];u[p]=b.start*a,d[p]=b.count,p++}}this._multiDrawCount=p,this._visibilityChanged=!1}onBeforeShadow(e,t,r,i,s,o){this.onBeforeRender(e,null,i,s,o)}}class no extends ks{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ut(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const rF=new ie,iF=new ie,sF=new vn,UC=new Mf,y1=new Ms;class gd extends cr{constructor(e=new Pn,t=new no){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,s=t.count;i<s;i++)rF.fromBufferAttribute(t,i-1),iF.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=rF.distanceTo(iF);e.setAttribute("lineDistance",new Qt(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),y1.copy(r.boundingSphere),y1.applyMatrix4(i),y1.radius+=s,e.ray.intersectsSphere(y1)===!1)return;sF.copy(i).invert(),UC.copy(e.ray).applyMatrix4(sF);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new ie,u=new ie,d=new ie,h=new ie,f=this.isLineSegments?2:1,p=r.index,v=r.attributes.position;if(p!==null){const y=Math.max(0,o.start),b=Math.min(p.count,o.start+o.count);for(let S=y,_=b-1;S<_;S+=f){const T=p.getX(S),M=p.getX(S+1);if(c.fromBufferAttribute(v,T),u.fromBufferAttribute(v,M),UC.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const P=e.ray.origin.distanceTo(h);P<e.near||P>e.far||t.push({distance:P,point:d.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}else{const y=Math.max(0,o.start),b=Math.min(v.count,o.start+o.count);for(let S=y,_=b-1;S<_;S+=f){if(c.fromBufferAttribute(v,S),u.fromBufferAttribute(v,S+1),UC.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(h);M<e.near||M>e.far||t.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const oF=new ie,aF=new ie;class tc extends gd{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let i=0,s=t.count;i<s;i+=2)oF.fromBufferAttribute(t,i),aF.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+oF.distanceTo(aF);e.setAttribute("lineDistance",new Qt(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class kW extends gd{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class H_ extends ks{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ut(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const lF=new vn,FA=new Mf,v1=new Ms,x1=new ie;class lR extends cr{constructor(e=new Pn,t=new H_){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),v1.copy(r.boundingSphere),v1.applyMatrix4(i),v1.radius+=s,e.ray.intersectsSphere(v1)===!1)return;lF.copy(i).invert(),FA.copy(e.ray).applyMatrix4(lF);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=r.index,d=r.attributes.position;if(c!==null){const h=Math.max(0,o.start),f=Math.min(c.count,o.start+o.count);for(let p=h,x=f;p<x;p++){const v=c.getX(p);x1.fromBufferAttribute(d,v),cF(x1,v,l,i,e,t,this)}}else{const h=Math.max(0,o.start),f=Math.min(d.count,o.start+o.count);for(let p=h,x=f;p<x;p++)x1.fromBufferAttribute(d,p),cF(x1,p,l,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function cF(n,e,t,r,i,s,o){const a=FA.distanceSqToPoint(n);if(a<t){const l=new ie;FA.closestPointToPoint(n,l),l.applyMatrix4(r);const c=i.ray.origin.distanceTo(l);if(c<i.near||c>i.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class Fpe extends qr{constructor(e,t,r,i,s,o,a,l,c){super(e,t,r,i,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:Jn,this.magFilter=s!==void 0?s:Jn,this.generateMipmaps=!1;const u=this;function d(){u.needsUpdate=!0,e.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(d)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class zpe extends qr{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=yi,this.minFilter=yi,this.generateMipmaps=!1,this.needsUpdate=!0}}class G_ extends qr{constructor(e,t,r,i,s,o,a,l,c,u,d,h){super(null,o,a,l,c,u,i,s,d,h),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Upe extends G_{constructor(e,t,r,i,s,o){super(e,t,r,s,o),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=Gr}}class Bpe extends G_{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,ql),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class $pe extends qr{constructor(e,t,r,i,s,o,a,l,c){super(e,t,r,i,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class ll{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,i=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)r=this.getPoint(o/e),s+=r.distanceTo(i),t.push(s),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let i=0;const s=r.length;let o;t?o=t:o=e*r[s-1];let a=0,l=s-1,c;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),c=r[i]-o,c<0)a=i+1;else if(c>0)l=i-1;else{l=i;break}if(i=l,r[i]===o)return i/(s-1);const u=r[i],h=r[i+1]-u,f=(o-u)/h;return(i+f)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const o=this.getPoint(i),a=this.getPoint(s),l=t||(o.isVector2?new Ze:new ie);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new ie,i=[],s=[],o=[],a=new ie,l=new vn;for(let f=0;f<=e;f++){const p=f/e;i[f]=this.getTangentAt(p,new ie)}s[0]=new ie,o[0]=new ie;let c=Number.MAX_VALUE;const u=Math.abs(i[0].x),d=Math.abs(i[0].y),h=Math.abs(i[0].z);u<=c&&(c=u,r.set(1,0,0)),d<=c&&(c=d,r.set(0,1,0)),h<=c&&r.set(0,0,1),a.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],a),o[0].crossVectors(i[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(i[f-1],i[f]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(di(i[f-1].dot(i[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,p))}o[f].crossVectors(i[f],s[f])}if(t===!0){let f=Math.acos(di(s[0].dot(s[e]),-1,1));f/=e,i[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(i[p],f*p)),o[p].crossVectors(i[p],s[p])}return{tangents:i,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class q_ extends ll{constructor(e=0,t=0,r=1,i=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const r=t||new Ze,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(o?s=0:s=i),this.aClockwise===!0&&!o&&(s===i?s=-i:s=s-i);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const u=Math.cos(this.aRotation),d=Math.sin(this.aRotation),h=l-this.aX,f=c-this.aY;l=h*u-f*d+this.aX,c=h*d+f*u+this.aY}return r.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class IW extends q_{constructor(e,t,r,i,s,o){super(e,t,r,r,i,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function cR(){let n=0,e=0,t=0,r=0;function i(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,r=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){i(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,d){let h=(o-s)/c-(a-s)/(c+u)+(a-o)/u,f=(a-o)/u-(l-o)/(u+d)+(l-a)/d;h*=u,f*=u,i(o,a,h,f)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+r*a}}}const w1=new ie,BC=new cR,$C=new cR,jC=new cR;class RW extends ll{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new ie){const r=t,i=this.points,s=i.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,u;this.closed||a>0?c=i[(a-1)%s]:(w1.subVectors(i[0],i[1]).add(i[0]),c=w1);const d=i[a%s],h=i[(a+1)%s];if(this.closed||a+2<s?u=i[(a+2)%s]:(w1.subVectors(i[s-1],i[s-2]).add(i[s-1]),u=w1),this.curveType==="centripetal"||this.curveType==="chordal"){const f=this.curveType==="chordal"?.5:.25;let p=Math.pow(c.distanceToSquared(d),f),x=Math.pow(d.distanceToSquared(h),f),v=Math.pow(h.distanceToSquared(u),f);x<1e-4&&(x=1),p<1e-4&&(p=x),v<1e-4&&(v=x),BC.initNonuniformCatmullRom(c.x,d.x,h.x,u.x,p,x,v),$C.initNonuniformCatmullRom(c.y,d.y,h.y,u.y,p,x,v),jC.initNonuniformCatmullRom(c.z,d.z,h.z,u.z,p,x,v)}else this.curveType==="catmullrom"&&(BC.initCatmullRom(c.x,d.x,h.x,u.x,this.tension),$C.initCatmullRom(c.y,d.y,h.y,u.y,this.tension),jC.initCatmullRom(c.z,d.z,h.z,u.z,this.tension));return r.set(BC.calc(l),$C.calc(l),jC.calc(l)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new ie().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function uF(n,e,t,r,i){const s=(r-e)*.5,o=(i-t)*.5,a=n*n,l=n*a;return(2*t-2*r+s+o)*l+(-3*t+3*r-2*s-o)*a+s*n+t}function jpe(n,e){const t=1-n;return t*t*e}function Vpe(n,e){return 2*(1-n)*n*e}function Wpe(n,e){return n*n*e}function uv(n,e,t,r){return jpe(n,e)+Vpe(n,t)+Wpe(n,r)}function Hpe(n,e){const t=1-n;return t*t*t*e}function Gpe(n,e){const t=1-n;return 3*t*t*n*e}function qpe(n,e){return 3*(1-n)*n*n*e}function Xpe(n,e){return n*n*n*e}function dv(n,e,t,r,i){return Hpe(n,e)+Gpe(n,t)+qpe(n,r)+Xpe(n,i)}class uR extends ll{constructor(e=new Ze,t=new Ze,r=new Ze,i=new Ze){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new Ze){const r=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(dv(e,i.x,s.x,o.x,a.x),dv(e,i.y,s.y,o.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class PW extends ll{constructor(e=new ie,t=new ie,r=new ie,i=new ie){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new ie){const r=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(dv(e,i.x,s.x,o.x,a.x),dv(e,i.y,s.y,o.y,a.y),dv(e,i.z,s.z,o.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class dR extends ll{constructor(e=new Ze,t=new Ze){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Ze){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ze){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class DW extends ll{constructor(e=new ie,t=new ie){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ie){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ie){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class hR extends ll{constructor(e=new Ze,t=new Ze,r=new Ze){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Ze){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(uv(e,i.x,s.x,o.x),uv(e,i.y,s.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class fR extends ll{constructor(e=new ie,t=new ie,r=new ie){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new ie){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(uv(e,i.x,s.x,o.x),uv(e,i.y,s.y,o.y),uv(e,i.z,s.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class pR extends ll{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Ze){const r=t,i=this.points,s=(i.length-1)*e,o=Math.floor(s),a=s-o,l=i[o===0?o:o-1],c=i[o],u=i[o>i.length-2?i.length-1:o+1],d=i[o>i.length-3?i.length-1:o+2];return r.set(uF(a,l.x,c.x,u.x,d.x),uF(a,l.y,c.y,u.y,d.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new Ze().fromArray(i))}return this}}var ES=Object.freeze({__proto__:null,ArcCurve:IW,CatmullRomCurve3:RW,CubicBezierCurve:uR,CubicBezierCurve3:PW,EllipseCurve:q_,LineCurve:dR,LineCurve3:DW,QuadraticBezierCurve:hR,QuadraticBezierCurve3:fR,SplineCurve:pR});class LW extends ll{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new ES[r](t,e))}return this}getPoint(e,t){const r=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const o=i[s]-r,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const o=s[i],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){const u=l[c];r&&r.equals(u)||(t.push(u),r=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(new ES[i.type]().fromJSON(i))}return this}}class m0 extends LW{constructor(e){super(),this.type="Path",this.currentPoint=new Ze,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new dR(this.currentPoint.clone(),new Ze(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){const s=new hR(this.currentPoint.clone(),new Ze(e,t),new Ze(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,s,o){const a=new uR(this.currentPoint.clone(),new Ze(e,t),new Ze(r,i),new Ze(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new pR(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,r,i,s,o),this}absarc(e,t,r,i,s,o){return this.absellipse(e,t,r,r,i,s,o),this}ellipse(e,t,r,i,s,o,a,l){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,t+u,r,i,s,o,a,l),this}absellipse(e,t,r,i,s,o,a,l){const c=new q_(e,t,r,i,s,o,a,l);if(this.curves.length>0){const d=c.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class ux extends Pn{constructor(e=[new Ze(0,-.5),new Ze(.5,0),new Ze(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=di(i,0,Math.PI*2);const s=[],o=[],a=[],l=[],c=[],u=1/t,d=new ie,h=new Ze,f=new ie,p=new ie,x=new ie;let v=0,y=0;for(let b=0;b<=e.length-1;b++)switch(b){case 0:v=e[b+1].x-e[b].x,y=e[b+1].y-e[b].y,f.x=y*1,f.y=-v,f.z=y*0,x.copy(f),f.normalize(),l.push(f.x,f.y,f.z);break;case e.length-1:l.push(x.x,x.y,x.z);break;default:v=e[b+1].x-e[b].x,y=e[b+1].y-e[b].y,f.x=y*1,f.y=-v,f.z=y*0,p.copy(f),f.x+=x.x,f.y+=x.y,f.z+=x.z,f.normalize(),l.push(f.x,f.y,f.z),x.copy(p)}for(let b=0;b<=t;b++){const S=r+b*u*i,_=Math.sin(S),T=Math.cos(S);for(let M=0;M<=e.length-1;M++){d.x=e[M].x*_,d.y=e[M].y,d.z=e[M].x*T,o.push(d.x,d.y,d.z),h.x=b/t,h.y=M/(e.length-1),a.push(h.x,h.y);const k=l[3*M+0]*_,P=l[3*M+1],z=l[3*M+0]*T;c.push(k,P,z)}}for(let b=0;b<t;b++)for(let S=0;S<e.length-1;S++){const _=S+b*e.length,T=_,M=_+e.length,k=_+e.length+1,P=_+1;s.push(T,M,P),s.push(k,P,M)}this.setIndex(s),this.setAttribute("position",new Qt(o,3)),this.setAttribute("uv",new Qt(a,2)),this.setAttribute("normal",new Qt(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ux(e.points,e.segments,e.phiStart,e.phiLength)}}class X_ extends ux{constructor(e=1,t=1,r=4,i=8){const s=new m0;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(r),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:r,radialSegments:i}}static fromJSON(e){return new X_(e.radius,e.length,e.capSegments,e.radialSegments)}}class K_ extends Pn{constructor(e=1,t=32,r=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i},t=Math.max(3,t);const s=[],o=[],a=[],l=[],c=new ie,u=new Ze;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let d=0,h=3;d<=t;d++,h+=3){const f=r+d/t*i;c.x=e*Math.cos(f),c.y=e*Math.sin(f),o.push(c.x,c.y,c.z),a.push(0,0,1),u.x=(o[h]/e+1)/2,u.y=(o[h+1]/e+1)/2,l.push(u.x,u.y)}for(let d=1;d<=t;d++)s.push(d,d+1,0);this.setIndex(s),this.setAttribute("position",new Qt(o,3)),this.setAttribute("normal",new Qt(a,3)),this.setAttribute("uv",new Qt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new K_(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Mg extends Pn{constructor(e=1,t=1,r=1,i=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;i=Math.floor(i),s=Math.floor(s);const u=[],d=[],h=[],f=[];let p=0;const x=[],v=r/2;let y=0;b(),o===!1&&(e>0&&S(!0),t>0&&S(!1)),this.setIndex(u),this.setAttribute("position",new Qt(d,3)),this.setAttribute("normal",new Qt(h,3)),this.setAttribute("uv",new Qt(f,2));function b(){const _=new ie,T=new ie;let M=0;const k=(t-e)/r;for(let P=0;P<=s;P++){const z=[],I=P/s,L=I*(t-e)+e;for(let W=0;W<=i;W++){const q=W/i,$=q*l+a,ne=Math.sin($),Y=Math.cos($);T.x=L*ne,T.y=-I*r+v,T.z=L*Y,d.push(T.x,T.y,T.z),_.set(ne,k,Y).normalize(),h.push(_.x,_.y,_.z),f.push(q,1-I),z.push(p++)}x.push(z)}for(let P=0;P<i;P++)for(let z=0;z<s;z++){const I=x[z][P],L=x[z+1][P],W=x[z+1][P+1],q=x[z][P+1];u.push(I,L,q),u.push(L,W,q),M+=6}c.addGroup(y,M,0),y+=M}function S(_){const T=p,M=new Ze,k=new ie;let P=0;const z=_===!0?e:t,I=_===!0?1:-1;for(let W=1;W<=i;W++)d.push(0,v*I,0),h.push(0,I,0),f.push(.5,.5),p++;const L=p;for(let W=0;W<=i;W++){const $=W/i*l+a,ne=Math.cos($),Y=Math.sin($);k.x=z*Y,k.y=v*I,k.z=z*ne,d.push(k.x,k.y,k.z),h.push(0,I,0),M.x=ne*.5+.5,M.y=Y*.5*I+.5,f.push(M.x,M.y),p++}for(let W=0;W<i;W++){const q=T+W,$=L+W;_===!0?u.push($,$+1,q):u.push($+1,$,q),P+=3}c.addGroup(y,P,_===!0?1:2),y+=P}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mg(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Y_ extends Mg{constructor(e=1,t=1,r=32,i=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,r,i,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new Y_(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Nd extends Pn{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const s=[],o=[];a(i),c(r),u(),this.setAttribute("position",new Qt(s,3)),this.setAttribute("normal",new Qt(s.slice(),3)),this.setAttribute("uv",new Qt(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(b){const S=new ie,_=new ie,T=new ie;for(let M=0;M<t.length;M+=3)f(t[M+0],S),f(t[M+1],_),f(t[M+2],T),l(S,_,T,b)}function l(b,S,_,T){const M=T+1,k=[];for(let P=0;P<=M;P++){k[P]=[];const z=b.clone().lerp(_,P/M),I=S.clone().lerp(_,P/M),L=M-P;for(let W=0;W<=L;W++)W===0&&P===M?k[P][W]=z:k[P][W]=z.clone().lerp(I,W/L)}for(let P=0;P<M;P++)for(let z=0;z<2*(M-P)-1;z++){const I=Math.floor(z/2);z%2===0?(h(k[P][I+1]),h(k[P+1][I]),h(k[P][I])):(h(k[P][I+1]),h(k[P+1][I+1]),h(k[P+1][I]))}}function c(b){const S=new ie;for(let _=0;_<s.length;_+=3)S.x=s[_+0],S.y=s[_+1],S.z=s[_+2],S.normalize().multiplyScalar(b),s[_+0]=S.x,s[_+1]=S.y,s[_+2]=S.z}function u(){const b=new ie;for(let S=0;S<s.length;S+=3){b.x=s[S+0],b.y=s[S+1],b.z=s[S+2];const _=v(b)/2/Math.PI+.5,T=y(b)/Math.PI+.5;o.push(_,1-T)}p(),d()}function d(){for(let b=0;b<o.length;b+=6){const S=o[b+0],_=o[b+2],T=o[b+4],M=Math.max(S,_,T),k=Math.min(S,_,T);M>.9&&k<.1&&(S<.2&&(o[b+0]+=1),_<.2&&(o[b+2]+=1),T<.2&&(o[b+4]+=1))}}function h(b){s.push(b.x,b.y,b.z)}function f(b,S){const _=b*3;S.x=e[_+0],S.y=e[_+1],S.z=e[_+2]}function p(){const b=new ie,S=new ie,_=new ie,T=new ie,M=new Ze,k=new Ze,P=new Ze;for(let z=0,I=0;z<s.length;z+=9,I+=6){b.set(s[z+0],s[z+1],s[z+2]),S.set(s[z+3],s[z+4],s[z+5]),_.set(s[z+6],s[z+7],s[z+8]),M.set(o[I+0],o[I+1]),k.set(o[I+2],o[I+3]),P.set(o[I+4],o[I+5]),T.copy(b).add(S).add(_).divideScalar(3);const L=v(T);x(M,I+0,b,L),x(k,I+2,S,L),x(P,I+4,_,L)}}function x(b,S,_,T){T<0&&b.x===1&&(o[S]=b.x-1),_.x===0&&_.z===0&&(o[S]=T/2/Math.PI+.5)}function v(b){return Math.atan2(b.z,-b.x)}function y(b){return Math.atan2(-b.y,Math.sqrt(b.x*b.x+b.z*b.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Nd(e.vertices,e.indices,e.radius,e.details)}}class Z_ extends Nd{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Z_(e.radius,e.detail)}}const b1=new ie,S1=new ie,VC=new ie,_1=new Uo;class OW extends Pn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(Vh*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],u=["a","b","c"],d=new Array(3),h={},f=[];for(let p=0;p<l;p+=3){o?(c[0]=o.getX(p),c[1]=o.getX(p+1),c[2]=o.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:x,b:v,c:y}=_1;if(x.fromBufferAttribute(a,c[0]),v.fromBufferAttribute(a,c[1]),y.fromBufferAttribute(a,c[2]),_1.getNormal(VC),d[0]=`${Math.round(x.x*i)},${Math.round(x.y*i)},${Math.round(x.z*i)}`,d[1]=`${Math.round(v.x*i)},${Math.round(v.y*i)},${Math.round(v.z*i)}`,d[2]=`${Math.round(y.x*i)},${Math.round(y.y*i)},${Math.round(y.z*i)}`,!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(let b=0;b<3;b++){const S=(b+1)%3,_=d[b],T=d[S],M=_1[u[b]],k=_1[u[S]],P=`${_}_${T}`,z=`${T}_${_}`;z in h&&h[z]?(VC.dot(h[z].normal)<=s&&(f.push(M.x,M.y,M.z),f.push(k.x,k.y,k.z)),h[z]=null):P in h||(h[P]={index0:c[b],index1:c[S],normal:VC.clone()})}}for(const p in h)if(h[p]){const{index0:x,index1:v}=h[p];b1.fromBufferAttribute(a,x),S1.fromBufferAttribute(a,v),f.push(b1.x,b1.y,b1.z),f.push(S1.x,S1.y,S1.z)}this.setAttribute("position",new Qt(f,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Gh extends m0{constructor(e){super(e),this.uuid=Ho(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(new m0().fromJSON(i))}return this}}const Kpe={triangulate:function(n,e,t=2){const r=e&&e.length,i=r?e[0]*t:n.length;let s=FW(n,0,i,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,d,h,f;if(r&&(s=eme(n,e,s,t)),n.length>80*t){a=c=n[0],l=u=n[1];for(let p=t;p<i;p+=t)d=n[p],h=n[p+1],d<a&&(a=d),h<l&&(l=h),d>c&&(c=d),h>u&&(u=h);f=Math.max(c-a,u-l),f=f!==0?32767/f:0}return g0(s,o,t,a,l,f,0),o}};function FW(n,e,t,r,i){let s,o;if(i===dme(n,e,t,r)>0)for(s=e;s<t;s+=r)o=dF(s,n[s],n[s+1],o);else for(s=t-r;s>=e;s-=r)o=dF(s,n[s],n[s+1],o);return o&&Q_(o,o.next)&&(v0(o),o=o.next),o}function df(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(Q_(t,t.next)||ni(t.prev,t,t.next)===0)){if(v0(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function g0(n,e,t,r,i,s,o){if(!n)return;!o&&s&&sme(n,r,i,s);let a=n,l,c;for(;n.prev!==n.next;){if(l=n.prev,c=n.next,s?Zpe(n,r,i,s):Ype(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(c.i/t|0),v0(n),n=c.next,a=c.next;continue}if(n=c,n===a){o?o===1?(n=Qpe(df(n),e,t),g0(n,e,t,r,i,s,2)):o===2&&Jpe(n,e,t,r,i,s):g0(df(n),e,t,r,i,s,1);break}}}function Ype(n){const e=n.prev,t=n,r=n.next;if(ni(e,t,r)>=0)return!1;const i=e.x,s=t.x,o=r.x,a=e.y,l=t.y,c=r.y,u=i<s?i<o?i:o:s<o?s:o,d=a<l?a<c?a:c:l<c?l:c,h=i>s?i>o?i:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c;let p=r.next;for(;p!==e;){if(p.x>=u&&p.x<=h&&p.y>=d&&p.y<=f&&lm(i,a,s,l,o,c,p.x,p.y)&&ni(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Zpe(n,e,t,r){const i=n.prev,s=n,o=n.next;if(ni(i,s,o)>=0)return!1;const a=i.x,l=s.x,c=o.x,u=i.y,d=s.y,h=o.y,f=a<l?a<c?a:c:l<c?l:c,p=u<d?u<h?u:h:d<h?d:h,x=a>l?a>c?a:c:l>c?l:c,v=u>d?u>h?u:h:d>h?d:h,y=zA(f,p,e,t,r),b=zA(x,v,e,t,r);let S=n.prevZ,_=n.nextZ;for(;S&&S.z>=y&&_&&_.z<=b;){if(S.x>=f&&S.x<=x&&S.y>=p&&S.y<=v&&S!==i&&S!==o&&lm(a,u,l,d,c,h,S.x,S.y)&&ni(S.prev,S,S.next)>=0||(S=S.prevZ,_.x>=f&&_.x<=x&&_.y>=p&&_.y<=v&&_!==i&&_!==o&&lm(a,u,l,d,c,h,_.x,_.y)&&ni(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;S&&S.z>=y;){if(S.x>=f&&S.x<=x&&S.y>=p&&S.y<=v&&S!==i&&S!==o&&lm(a,u,l,d,c,h,S.x,S.y)&&ni(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;_&&_.z<=b;){if(_.x>=f&&_.x<=x&&_.y>=p&&_.y<=v&&_!==i&&_!==o&&lm(a,u,l,d,c,h,_.x,_.y)&&ni(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function Qpe(n,e,t){let r=n;do{const i=r.prev,s=r.next.next;!Q_(i,s)&&zW(i,r,r.next,s)&&y0(i,s)&&y0(s,i)&&(e.push(i.i/t|0),e.push(r.i/t|0),e.push(s.i/t|0),v0(r),v0(r.next),r=n=s),r=r.next}while(r!==n);return df(r)}function Jpe(n,e,t,r,i,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&lme(o,a)){let l=UW(o,a);o=df(o,o.next),l=df(l,l.next),g0(o,e,t,r,i,s,0),g0(l,e,t,r,i,s,0);return}a=a.next}o=o.next}while(o!==n)}function eme(n,e,t,r){const i=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:n.length,c=FW(n,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(ame(c));for(i.sort(tme),s=0;s<i.length;s++)t=nme(i[s],t);return t}function tme(n,e){return n.x-e.x}function nme(n,e){const t=rme(n,e);if(!t)return e;const r=UW(t,n);return df(r,r.next),df(t,t.next)}function rme(n,e){let t=e,r=-1/0,i;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const h=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(h<=s&&h>r&&(r=h,i=t.x<t.next.x?t:t.next,h===s))return i}t=t.next}while(t!==e);if(!i)return null;const a=i,l=i.x,c=i.y;let u=1/0,d;t=i;do s>=t.x&&t.x>=l&&s!==t.x&&lm(o<c?s:r,o,l,c,o<c?r:s,o,t.x,t.y)&&(d=Math.abs(o-t.y)/(s-t.x),y0(t,n)&&(d<u||d===u&&(t.x>i.x||t.x===i.x&&ime(i,t)))&&(i=t,u=d)),t=t.next;while(t!==a);return i}function ime(n,e){return ni(n.prev,n,e.prev)<0&&ni(e.next,n,n.next)<0}function sme(n,e,t,r){let i=n;do i.z===0&&(i.z=zA(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,ome(i)}function ome(n){let e,t,r,i,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,r=t,a=0,e=0;e<c&&(a++,r=r.nextZ,!!r);e++);for(l=c;a>0||l>0&&r;)a!==0&&(l===0||!r||t.z<=r.z)?(i=t,t=t.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;t=r}s.nextZ=null,c*=2}while(o>1);return n}function zA(n,e,t,r,i){return n=(n-t)*i|0,e=(e-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function ame(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function lm(n,e,t,r,i,s,o,a){return(i-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(r-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(i-o)*(r-a)}function lme(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!cme(n,e)&&(y0(n,e)&&y0(e,n)&&ume(n,e)&&(ni(n.prev,n,e.prev)||ni(n,e.prev,e))||Q_(n,e)&&ni(n.prev,n,n.next)>0&&ni(e.prev,e,e.next)>0)}function ni(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Q_(n,e){return n.x===e.x&&n.y===e.y}function zW(n,e,t,r){const i=C1(ni(n,e,t)),s=C1(ni(n,e,r)),o=C1(ni(t,r,n)),a=C1(ni(t,r,e));return!!(i!==s&&o!==a||i===0&&E1(n,t,e)||s===0&&E1(n,r,e)||o===0&&E1(t,n,r)||a===0&&E1(t,e,r))}function E1(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function C1(n){return n>0?1:n<0?-1:0}function cme(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&zW(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function y0(n,e){return ni(n.prev,n,n.next)<0?ni(n,e,n.next)>=0&&ni(n,n.prev,e)>=0:ni(n,e,n.prev)<0||ni(n,n.next,e)<0}function ume(n,e){let t=n,r=!1;const i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function UW(n,e){const t=new UA(n.i,n.x,n.y),r=new UA(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function dF(n,e,t,r){const i=new UA(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function v0(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function UA(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function dme(n,e,t,r){let i=0;for(let s=e,o=t-r;s<t;s+=r)i+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return i}class Bl{static area(e){const t=e.length;let r=0;for(let i=t-1,s=0;s<t;i=s++)r+=e[i].x*e[s].y-e[s].x*e[i].y;return r*.5}static isClockWise(e){return Bl.area(e)<0}static triangulateShape(e,t){const r=[],i=[],s=[];hF(e),fF(r,e);let o=e.length;t.forEach(hF);for(let l=0;l<t.length;l++)i.push(o),o+=t[l].length,fF(r,t[l]);const a=Kpe.triangulate(r,i);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function hF(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function fF(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class J_ extends Pn{constructor(e=new Gh([new Ze(.5,.5),new Ze(-.5,.5),new Ze(-.5,-.5),new Ze(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,i=[],s=[];for(let a=0,l=e.length;a<l;a++){const c=e[a];o(c)}this.setAttribute("position",new Qt(i,3)),this.setAttribute("uv",new Qt(s,2)),this.computeVertexNormals();function o(a){const l=[],c=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,d=t.depth!==void 0?t.depth:1;let h=t.bevelEnabled!==void 0?t.bevelEnabled:!0,f=t.bevelThickness!==void 0?t.bevelThickness:.2,p=t.bevelSize!==void 0?t.bevelSize:f-.1,x=t.bevelOffset!==void 0?t.bevelOffset:0,v=t.bevelSegments!==void 0?t.bevelSegments:3;const y=t.extrudePath,b=t.UVGenerator!==void 0?t.UVGenerator:hme;let S,_=!1,T,M,k,P;y&&(S=y.getSpacedPoints(u),_=!0,h=!1,T=y.computeFrenetFrames(u,!1),M=new ie,k=new ie,P=new ie),h||(v=0,f=0,p=0,x=0);const z=a.extractPoints(c);let I=z.shape;const L=z.holes;if(!Bl.isClockWise(I)){I=I.reverse();for(let ae=0,ze=L.length;ae<ze;ae++){const Re=L[ae];Bl.isClockWise(Re)&&(L[ae]=Re.reverse())}}const q=Bl.triangulateShape(I,L),$=I;for(let ae=0,ze=L.length;ae<ze;ae++){const Re=L[ae];I=I.concat(Re)}function ne(ae,ze,Re){return ze||console.error("THREE.ExtrudeGeometry: vec does not exist"),ae.clone().addScaledVector(ze,Re)}const Y=I.length,we=q.length;function H(ae,ze,Re){let Je,Ge,Et;const pt=ae.x-ze.x,Q=ae.y-ze.y,G=Re.x-ae.x,ke=Re.y-ae.y,J=pt*pt+Q*Q,he=pt*ke-Q*G;if(Math.abs(he)>Number.EPSILON){const ee=Math.sqrt(J),Ee=Math.sqrt(G*G+ke*ke),Me=ze.x-Q/ee,Ae=ze.y+pt/ee,Be=Re.x-ke/Ee,dt=Re.y+G/Ee,We=((Be-Me)*ke-(dt-Ae)*G)/(pt*ke-Q*G);Je=Me+pt*We-ae.x,Ge=Ae+Q*We-ae.y;const Kt=Je*Je+Ge*Ge;if(Kt<=2)return new Ze(Je,Ge);Et=Math.sqrt(Kt/2)}else{let ee=!1;pt>Number.EPSILON?G>Number.EPSILON&&(ee=!0):pt<-Number.EPSILON?G<-Number.EPSILON&&(ee=!0):Math.sign(Q)===Math.sign(ke)&&(ee=!0),ee?(Je=-Q,Ge=pt,Et=Math.sqrt(J)):(Je=pt,Ge=Q,Et=Math.sqrt(J/2))}return new Ze(Je/Et,Ge/Et)}const X=[];for(let ae=0,ze=$.length,Re=ze-1,Je=ae+1;ae<ze;ae++,Re++,Je++)Re===ze&&(Re=0),Je===ze&&(Je=0),X[ae]=H($[ae],$[Re],$[Je]);const oe=[];let ve,Te=X.concat();for(let ae=0,ze=L.length;ae<ze;ae++){const Re=L[ae];ve=[];for(let Je=0,Ge=Re.length,Et=Ge-1,pt=Je+1;Je<Ge;Je++,Et++,pt++)Et===Ge&&(Et=0),pt===Ge&&(pt=0),ve[Je]=H(Re[Je],Re[Et],Re[pt]);oe.push(ve),Te=Te.concat(ve)}for(let ae=0;ae<v;ae++){const ze=ae/v,Re=f*Math.cos(ze*Math.PI/2),Je=p*Math.sin(ze*Math.PI/2)+x;for(let Ge=0,Et=$.length;Ge<Et;Ge++){const pt=ne($[Ge],X[Ge],Je);Oe(pt.x,pt.y,-Re)}for(let Ge=0,Et=L.length;Ge<Et;Ge++){const pt=L[Ge];ve=oe[Ge];for(let Q=0,G=pt.length;Q<G;Q++){const ke=ne(pt[Q],ve[Q],Je);Oe(ke.x,ke.y,-Re)}}}const Xe=p+x;for(let ae=0;ae<Y;ae++){const ze=h?ne(I[ae],Te[ae],Xe):I[ae];_?(k.copy(T.normals[0]).multiplyScalar(ze.x),M.copy(T.binormals[0]).multiplyScalar(ze.y),P.copy(S[0]).add(k).add(M),Oe(P.x,P.y,P.z)):Oe(ze.x,ze.y,0)}for(let ae=1;ae<=u;ae++)for(let ze=0;ze<Y;ze++){const Re=h?ne(I[ze],Te[ze],Xe):I[ze];_?(k.copy(T.normals[ae]).multiplyScalar(Re.x),M.copy(T.binormals[ae]).multiplyScalar(Re.y),P.copy(S[ae]).add(k).add(M),Oe(P.x,P.y,P.z)):Oe(Re.x,Re.y,d/u*ae)}for(let ae=v-1;ae>=0;ae--){const ze=ae/v,Re=f*Math.cos(ze*Math.PI/2),Je=p*Math.sin(ze*Math.PI/2)+x;for(let Ge=0,Et=$.length;Ge<Et;Ge++){const pt=ne($[Ge],X[Ge],Je);Oe(pt.x,pt.y,d+Re)}for(let Ge=0,Et=L.length;Ge<Et;Ge++){const pt=L[Ge];ve=oe[Ge];for(let Q=0,G=pt.length;Q<G;Q++){const ke=ne(pt[Q],ve[Q],Je);_?Oe(ke.x,ke.y+S[u-1].y,S[u-1].x+Re):Oe(ke.x,ke.y,d+Re)}}}_e(),Ue();function _e(){const ae=i.length/3;if(h){let ze=0,Re=Y*ze;for(let Je=0;Je<we;Je++){const Ge=q[Je];nt(Ge[2]+Re,Ge[1]+Re,Ge[0]+Re)}ze=u+v*2,Re=Y*ze;for(let Je=0;Je<we;Je++){const Ge=q[Je];nt(Ge[0]+Re,Ge[1]+Re,Ge[2]+Re)}}else{for(let ze=0;ze<we;ze++){const Re=q[ze];nt(Re[2],Re[1],Re[0])}for(let ze=0;ze<we;ze++){const Re=q[ze];nt(Re[0]+Y*u,Re[1]+Y*u,Re[2]+Y*u)}}r.addGroup(ae,i.length/3-ae,0)}function Ue(){const ae=i.length/3;let ze=0;Fe($,ze),ze+=$.length;for(let Re=0,Je=L.length;Re<Je;Re++){const Ge=L[Re];Fe(Ge,ze),ze+=Ge.length}r.addGroup(ae,i.length/3-ae,1)}function Fe(ae,ze){let Re=ae.length;for(;--Re>=0;){const Je=Re;let Ge=Re-1;Ge<0&&(Ge=ae.length-1);for(let Et=0,pt=u+v*2;Et<pt;Et++){const Q=Y*Et,G=Y*(Et+1),ke=ze+Je+Q,J=ze+Ge+Q,he=ze+Ge+G,ee=ze+Je+G;rt(ke,J,he,ee)}}}function Oe(ae,ze,Re){l.push(ae),l.push(ze),l.push(Re)}function nt(ae,ze,Re){ut(ae),ut(ze),ut(Re);const Je=i.length/3,Ge=b.generateTopUV(r,i,Je-3,Je-2,Je-1);Qe(Ge[0]),Qe(Ge[1]),Qe(Ge[2])}function rt(ae,ze,Re,Je){ut(ae),ut(ze),ut(Je),ut(ze),ut(Re),ut(Je);const Ge=i.length/3,Et=b.generateSideWallUV(r,i,Ge-6,Ge-3,Ge-2,Ge-1);Qe(Et[0]),Qe(Et[1]),Qe(Et[3]),Qe(Et[1]),Qe(Et[2]),Qe(Et[3])}function ut(ae){i.push(l[ae*3+0]),i.push(l[ae*3+1]),i.push(l[ae*3+2])}function Qe(ae){s.push(ae.x),s.push(ae.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return fme(t,r,e)}static fromJSON(e,t){const r=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];r.push(a)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new ES[i.type]().fromJSON(i)),new J_(r,e.options)}}const hme={generateTopUV:function(n,e,t,r,i){const s=e[t*3],o=e[t*3+1],a=e[r*3],l=e[r*3+1],c=e[i*3],u=e[i*3+1];return[new Ze(s,o),new Ze(a,l),new Ze(c,u)]},generateSideWallUV:function(n,e,t,r,i,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],c=e[r*3],u=e[r*3+1],d=e[r*3+2],h=e[i*3],f=e[i*3+1],p=e[i*3+2],x=e[s*3],v=e[s*3+1],y=e[s*3+2];return Math.abs(a-u)<Math.abs(o-c)?[new Ze(o,1-l),new Ze(c,1-d),new Ze(h,1-p),new Ze(x,1-y)]:[new Ze(a,1-l),new Ze(u,1-d),new Ze(f,1-p),new Ze(v,1-y)]}};function fme(n,e,t){if(t.shapes=[],Array.isArray(n))for(let r=0,i=n.length;r<i;r++){const s=n[r];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class dx extends Nd{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new dx(e.radius,e.detail)}}class hx extends Nd{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new hx(e.radius,e.detail)}}class e2 extends Pn{constructor(e=.5,t=1,r=32,i=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:i,thetaStart:s,thetaLength:o},r=Math.max(3,r),i=Math.max(1,i);const a=[],l=[],c=[],u=[];let d=e;const h=(t-e)/i,f=new ie,p=new Ze;for(let x=0;x<=i;x++){for(let v=0;v<=r;v++){const y=s+v/r*o;f.x=d*Math.cos(y),f.y=d*Math.sin(y),l.push(f.x,f.y,f.z),c.push(0,0,1),p.x=(f.x/t+1)/2,p.y=(f.y/t+1)/2,u.push(p.x,p.y)}d+=h}for(let x=0;x<i;x++){const v=x*(r+1);for(let y=0;y<r;y++){const b=y+v,S=b,_=b+r+1,T=b+r+2,M=b+1;a.push(S,_,M),a.push(_,T,M)}}this.setIndex(a),this.setAttribute("position",new Qt(l,3)),this.setAttribute("normal",new Qt(c,3)),this.setAttribute("uv",new Qt(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new e2(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class t2 extends Pn{constructor(e=new Gh([new Ze(0,.5),new Ze(-.5,-.5),new Ze(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],i=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;this.setIndex(r),this.setAttribute("position",new Qt(i,3)),this.setAttribute("normal",new Qt(s,3)),this.setAttribute("uv",new Qt(o,2));function c(u){const d=i.length/3,h=u.extractPoints(t);let f=h.shape;const p=h.holes;Bl.isClockWise(f)===!1&&(f=f.reverse());for(let v=0,y=p.length;v<y;v++){const b=p[v];Bl.isClockWise(b)===!0&&(p[v]=b.reverse())}const x=Bl.triangulateShape(f,p);for(let v=0,y=p.length;v<y;v++){const b=p[v];f=f.concat(b)}for(let v=0,y=f.length;v<y;v++){const b=f[v];i.push(b.x,b.y,0),s.push(0,0,1),o.push(b.x,b.y)}for(let v=0,y=x.length;v<y;v++){const b=x[v],S=b[0]+d,_=b[1]+d,T=b[2]+d;r.push(S,_,T),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return pme(t,e)}static fromJSON(e,t){const r=[];for(let i=0,s=e.shapes.length;i<s;i++){const o=t[e.shapes[i]];r.push(o)}return new t2(r,e.curveSegments)}}function pme(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const i=n[t];e.shapes.push(i.uuid)}else e.shapes.push(n.uuid);return e}class fx extends Pn{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const l=Math.min(o+a,Math.PI);let c=0;const u=[],d=new ie,h=new ie,f=[],p=[],x=[],v=[];for(let y=0;y<=r;y++){const b=[],S=y/r;let _=0;y===0&&o===0?_=.5/t:y===r&&l===Math.PI&&(_=-.5/t);for(let T=0;T<=t;T++){const M=T/t;d.x=-e*Math.cos(i+M*s)*Math.sin(o+S*a),d.y=e*Math.cos(o+S*a),d.z=e*Math.sin(i+M*s)*Math.sin(o+S*a),p.push(d.x,d.y,d.z),h.copy(d).normalize(),x.push(h.x,h.y,h.z),v.push(M+_,1-S),b.push(c++)}u.push(b)}for(let y=0;y<r;y++)for(let b=0;b<t;b++){const S=u[y][b+1],_=u[y][b],T=u[y+1][b],M=u[y+1][b+1];(y!==0||o>0)&&f.push(S,_,M),(y!==r-1||l<Math.PI)&&f.push(_,T,M)}this.setIndex(f),this.setAttribute("position",new Qt(p,3)),this.setAttribute("normal",new Qt(x,3)),this.setAttribute("uv",new Qt(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fx(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class n2 extends Nd{constructor(e=1,t=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new n2(e.radius,e.detail)}}class r2 extends Pn{constructor(e=1,t=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const o=[],a=[],l=[],c=[],u=new ie,d=new ie,h=new ie;for(let f=0;f<=r;f++)for(let p=0;p<=i;p++){const x=p/i*s,v=f/r*Math.PI*2;d.x=(e+t*Math.cos(v))*Math.cos(x),d.y=(e+t*Math.cos(v))*Math.sin(x),d.z=t*Math.sin(v),a.push(d.x,d.y,d.z),u.x=e*Math.cos(x),u.y=e*Math.sin(x),h.subVectors(d,u).normalize(),l.push(h.x,h.y,h.z),c.push(p/i),c.push(f/r)}for(let f=1;f<=r;f++)for(let p=1;p<=i;p++){const x=(i+1)*f+p-1,v=(i+1)*(f-1)+p-1,y=(i+1)*(f-1)+p,b=(i+1)*f+p;o.push(x,v,b),o.push(v,y,b)}this.setIndex(o),this.setAttribute("position",new Qt(a,3)),this.setAttribute("normal",new Qt(l,3)),this.setAttribute("uv",new Qt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new r2(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class i2 extends Pn{constructor(e=1,t=.4,r=64,i=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:s,q:o},r=Math.floor(r),i=Math.floor(i);const a=[],l=[],c=[],u=[],d=new ie,h=new ie,f=new ie,p=new ie,x=new ie,v=new ie,y=new ie;for(let S=0;S<=r;++S){const _=S/r*s*Math.PI*2;b(_,s,o,e,f),b(_+.01,s,o,e,p),v.subVectors(p,f),y.addVectors(p,f),x.crossVectors(v,y),y.crossVectors(x,v),x.normalize(),y.normalize();for(let T=0;T<=i;++T){const M=T/i*Math.PI*2,k=-t*Math.cos(M),P=t*Math.sin(M);d.x=f.x+(k*y.x+P*x.x),d.y=f.y+(k*y.y+P*x.y),d.z=f.z+(k*y.z+P*x.z),l.push(d.x,d.y,d.z),h.subVectors(d,f).normalize(),c.push(h.x,h.y,h.z),u.push(S/r),u.push(T/i)}}for(let S=1;S<=r;S++)for(let _=1;_<=i;_++){const T=(i+1)*(S-1)+(_-1),M=(i+1)*S+(_-1),k=(i+1)*S+_,P=(i+1)*(S-1)+_;a.push(T,M,P),a.push(M,k,P)}this.setIndex(a),this.setAttribute("position",new Qt(l,3)),this.setAttribute("normal",new Qt(c,3)),this.setAttribute("uv",new Qt(u,2));function b(S,_,T,M,k){const P=Math.cos(S),z=Math.sin(S),I=T/_*S,L=Math.cos(I);k.x=M*(2+L)*.5*P,k.y=M*(2+L)*z*.5,k.z=M*Math.sin(I)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i2(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class s2 extends Pn{constructor(e=new fR(new ie(-1,-1,0),new ie(-1,1,0),new ie(1,1,0)),t=64,r=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:i,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new ie,l=new ie,c=new Ze;let u=new ie;const d=[],h=[],f=[],p=[];x(),this.setIndex(p),this.setAttribute("position",new Qt(d,3)),this.setAttribute("normal",new Qt(h,3)),this.setAttribute("uv",new Qt(f,2));function x(){for(let S=0;S<t;S++)v(S);v(s===!1?t:0),b(),y()}function v(S){u=e.getPointAt(S/t,u);const _=o.normals[S],T=o.binormals[S];for(let M=0;M<=i;M++){const k=M/i*Math.PI*2,P=Math.sin(k),z=-Math.cos(k);l.x=z*_.x+P*T.x,l.y=z*_.y+P*T.y,l.z=z*_.z+P*T.z,l.normalize(),h.push(l.x,l.y,l.z),a.x=u.x+r*l.x,a.y=u.y+r*l.y,a.z=u.z+r*l.z,d.push(a.x,a.y,a.z)}}function y(){for(let S=1;S<=t;S++)for(let _=1;_<=i;_++){const T=(i+1)*(S-1)+(_-1),M=(i+1)*S+(_-1),k=(i+1)*S+_,P=(i+1)*(S-1)+_;p.push(T,M,P),p.push(M,k,P)}}function b(){for(let S=0;S<=t;S++)for(let _=0;_<=i;_++)c.x=S/t,c.y=_/i,f.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new s2(new ES[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class BW extends Pn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],r=new Set,i=new ie,s=new ie;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const d=l[c],h=d.start,f=d.count;for(let p=h,x=h+f;p<x;p+=3)for(let v=0;v<3;v++){const y=a.getX(p+v),b=a.getX(p+(v+1)%3);i.fromBufferAttribute(o,y),s.fromBufferAttribute(o,b),pF(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const u=3*a+c,d=3*a+(c+1)%3;i.fromBufferAttribute(o,u),s.fromBufferAttribute(o,d),pF(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Qt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function pF(n,e,t){const r=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(r)===!0||t.has(i)===!0?!1:(t.add(r),t.add(i),!0)}var mF=Object.freeze({__proto__:null,BoxGeometry:Af,CapsuleGeometry:X_,CircleGeometry:K_,ConeGeometry:Y_,CylinderGeometry:Mg,DodecahedronGeometry:Z_,EdgesGeometry:OW,ExtrudeGeometry:J_,IcosahedronGeometry:dx,LatheGeometry:ux,OctahedronGeometry:hx,PlaneGeometry:Ad,PolyhedronGeometry:Nd,RingGeometry:e2,ShapeGeometry:t2,SphereGeometry:fx,TetrahedronGeometry:n2,TorusGeometry:r2,TorusKnotGeometry:i2,TubeGeometry:s2,WireframeGeometry:BW});class $W extends ks{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ut(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class jW extends Ys{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class o2 extends ks{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ut(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Md,this.normalScale=new Ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class VW extends o2{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ze(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return di(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ut(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ut(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ut(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class WW extends ks{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ut(16777215),this.specular=new Ut(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Md,this.normalScale=new Ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ix,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class HW extends ks{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ut(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Md,this.normalScale=new Ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class GW extends ks{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Md,this.normalScale=new Ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class qW extends ks{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Md,this.normalScale=new Ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ix,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class XW extends ks{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ut(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Md,this.normalScale=new Ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class KW extends no{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Rh(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function YW(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function ZW(n){function e(i,s){return n[i]-n[s]}const t=n.length,r=new Array(t);for(let i=0;i!==t;++i)r[i]=i;return r.sort(e),r}function BA(n,e,t){const r=n.length,i=new n.constructor(r);for(let s=0,o=0;o!==r;++s){const a=t[s]*e;for(let l=0;l!==e;++l)i[o++]=n[a+l]}return i}function mR(n,e,t,r){let i=1,s=n[0];for(;s!==void 0&&s[r]===void 0;)s=n[i++];if(s===void 0)return;let o=s[r];if(o!==void 0)if(Array.isArray(o))do o=s[r],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[i++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[r],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[i++];while(s!==void 0);else do o=s[r],o!==void 0&&(e.push(s.time),t.push(o)),s=n[i++];while(s!==void 0)}function mme(n,e,t,r,i=30){const s=n.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),d=[],h=[];for(let f=0;f<c.times.length;++f){const p=c.times[f]*i;if(!(p<t||p>=r)){d.push(c.times[f]);for(let x=0;x<u;++x)h.push(c.values[f*u+x])}}d.length!==0&&(c.times=Rh(d,c.times.constructor),c.values=Rh(h,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function gme(n,e=0,t=n,r=30){r<=0&&(r=30);const i=t.tracks.length,s=e/r;for(let o=0;o<i;++o){const a=t.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=n.tracks.find(function(y){return y.name===a.name&&y.ValueTypeName===l});if(c===void 0)continue;let u=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let h=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=f/3);const p=a.times.length-1;let x;if(s<=a.times[0]){const y=u,b=d-u;x=a.values.slice(y,b)}else if(s>=a.times[p]){const y=p*d+u,b=y+d-u;x=a.values.slice(y,b)}else{const y=a.createInterpolant(),b=u,S=d-u;y.evaluate(s),x=y.resultBuffer.slice(b,S)}l==="quaternion"&&new Ts().fromArray(x).normalize().conjugate().toArray(x);const v=c.times.length;for(let y=0;y<v;++y){const b=y*f+h;if(l==="quaternion")Ts.multiplyQuaternionsFlat(c.values,b,x,0,c.values,b);else{const S=f-h*2;for(let _=0;_<S;++_)c.values[b+_]-=x[_]}}}return n.blendMode=qI,n}const yme={convertArray:Rh,isTypedArray:YW,getKeyframeOrder:ZW,sortedArray:BA,flattenJSON:mR,subclip:mme,makeClipAdditive:gme};class px{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,i=t[r],s=t[r-1];e:{t:{let o;n:{r:if(!(e<i)){for(let a=r+2;;){if(i===void 0){if(e<s)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(s=i,i=t[++r],e<i)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(r=2,s=a);for(let l=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===l)break;if(i=s,s=t[--r-1],e>=s)break t}o=r,r=0;break n}break e}for(;r<o;){const a=r+o>>>1;e<t[a]?o=a:r=a+1}if(i=t[r],s=t[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,i)}return this.interpolate_(r,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i;for(let o=0;o!==i;++o)t[o]=r[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class QW extends px{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Ah,endingEnd:Ah}}intervalChanged_(e,t,r){const i=this.parameterPositions;let s=e-2,o=e+1,a=i[s],l=i[o];if(a===void 0)switch(this.getSettings_().endingStart){case Nh:s=e,a=2*t-r;break;case l0:s=i.length-2,a=t+i[s]-i[s+1];break;default:s=e,a=r}if(l===void 0)switch(this.getSettings_().endingEnd){case Nh:o=e,l=2*r-t;break;case l0:o=1,l=r+i[1]-i[0];break;default:o=e-1,l=t}const c=(r-t)*.5,u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-r),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(r-t)/(i-t),x=p*p,v=x*p,y=-h*v+2*h*x-h*p,b=(1+h)*v+(-1.5-2*h)*x+(-.5+h)*p+1,S=(-1-f)*v+(1.5+f)*x+.5*p,_=f*v-f*x;for(let T=0;T!==a;++T)s[T]=y*o[u+T]+b*o[c+T]+S*o[l+T]+_*o[d+T];return s}}class gR extends px{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(r-t)/(i-t),d=1-u;for(let h=0;h!==a;++h)s[h]=o[c+h]*d+o[l+h]*u;return s}}class JW extends px{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class cl{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Rh(t,this.TimeBufferType),this.values=Rh(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Rh(e.times,Array),values:Rh(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new JW(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new gR(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new QW(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case o0:t=this.InterpolantFactoryMethodDiscrete;break;case a0:t=this.InterpolantFactoryMethodLinear;break;case mb:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return o0;case this.InterpolantFactoryMethodLinear:return a0;case this.InterpolantFactoryMethodSmooth:return mb}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){const r=this.times,i=r.length;let s=0,o=i-1;for(;s!==i&&r[s]<e;)++s;for(;o!==-1&&r[o]>t;)--o;if(++o,s!==0||o!==i){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=r.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,s=r.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=r[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(i!==void 0&&YW(i))for(let a=0,l=i.length;a!==l;++a){const c=i[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),i=this.getInterpolation()===mb,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a],u=e[a+1];if(c!==u&&(a!==1||c!==e[0]))if(i)l=!0;else{const d=a*r,h=d-r,f=d+r;for(let p=0;p!==r;++p){const x=t[d+p];if(x!==t[h+p]||x!==t[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*r,h=o*r;for(let f=0;f!==r;++f)t[h+f]=t[d+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*r,l=o*r,c=0;c!==r;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*r)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}cl.prototype.TimeBufferType=Float32Array;cl.prototype.ValueBufferType=Float32Array;cl.prototype.DefaultInterpolation=a0;class Nf extends cl{}Nf.prototype.ValueTypeName="bool";Nf.prototype.ValueBufferType=Array;Nf.prototype.DefaultInterpolation=o0;Nf.prototype.InterpolantFactoryMethodLinear=void 0;Nf.prototype.InterpolantFactoryMethodSmooth=void 0;class yR extends cl{}yR.prototype.ValueTypeName="color";class x0 extends cl{}x0.prototype.ValueTypeName="number";class eH extends px{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(r-t)/(i-t);let c=e*a;for(let u=c+a;c!==u;c+=4)Ts.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Ag extends cl{InterpolantFactoryMethodLinear(e){return new eH(this.times,this.values,this.getValueSize(),e)}}Ag.prototype.ValueTypeName="quaternion";Ag.prototype.DefaultInterpolation=a0;Ag.prototype.InterpolantFactoryMethodSmooth=void 0;class kf extends cl{}kf.prototype.ValueTypeName="string";kf.prototype.ValueBufferType=Array;kf.prototype.DefaultInterpolation=o0;kf.prototype.InterpolantFactoryMethodLinear=void 0;kf.prototype.InterpolantFactoryMethodSmooth=void 0;class w0 extends cl{}w0.prototype.ValueTypeName="vector";class b0{constructor(e,t=-1,r,i=O_){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Ho(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,i=1/(e.fps||1);for(let o=0,a=r.length;o!==a;++o)t.push(xme(r[o]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=r.length;s!==o;++s)t.push(cl.toJSON(r[s]));return i}static CreateFromMorphTargetSequence(e,t,r,i){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=ZW(l);l=BA(l,1,u),c=BA(c,1,u),!i&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new x0(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/r))}return new this(e,-1,o)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const i={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const d=u[1];let h=i[d];h||(i[d]=h=[]),h.push(c)}}const o=[];for(const a in i)o.push(this.CreateFromMorphTargetSequence(a,i[a],t,r));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(d,h,f,p,x){if(f.length!==0){const v=[],y=[];mR(f,v,y,p),v.length!==0&&x.push(new d(h,v,y))}},i=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const h=c[d].keys;if(!(!h||h.length===0))if(h[0].morphTargets){const f={};let p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let x=0;x<h[p].morphTargets.length;x++)f[h[p].morphTargets[x]]=-1;for(const x in f){const v=[],y=[];for(let b=0;b!==h[p].morphTargets.length;++b){const S=h[p];v.push(S.time),y.push(S.morphTarget===x?1:0)}i.push(new x0(".morphTargetInfluence["+x+"]",v,y))}l=f.length*o}else{const f=".bones["+t[d].name+"]";r(w0,f+".position",h,"pos",i),r(Ag,f+".quaternion",h,"rot",i),r(w0,f+".scale",h,"scl",i)}}return i.length===0?null:new this(s,l,i,a)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,i=e.length;r!==i;++r){const s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function vme(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return x0;case"vector":case"vector2":case"vector3":case"vector4":return w0;case"color":return yR;case"quaternion":return Ag;case"bool":case"boolean":return Nf;case"string":return kf}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function xme(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=vme(n.type);if(n.times===void 0){const t=[],r=[];mR(n.keys,t,r,"value"),n.times=t,n.values=r}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Ac={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};let a2=class{constructor(e,t,r){const i=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(u){a++,s===!1&&i.onStart!==void 0&&i.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,i.onProgress!==void 0&&i.onProgress(u,o,a),o===a&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(u){i.onError!==void 0&&i.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return d!==-1&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=c.length;d<h;d+=2){const f=c[d],p=c[d+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}};const tH=new a2;let ro=class{constructor(e){this.manager=e!==void 0?e:tH,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(i,s){r.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};ro.DEFAULT_MATERIAL_NAME="__DEFAULT";const yc={};class wme extends Error{constructor(e,t){super(e),this.response=t}}class Go extends ro{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Ac.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(yc[e]!==void 0){yc[e].push({onLoad:t,onProgress:r,onError:i});return}yc[e]=[],yc[e].push({onLoad:t,onProgress:r,onError:i});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const u=yc[e],d=c.body.getReader(),h=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),f=h?parseInt(h):0,p=f!==0;let x=0;const v=new ReadableStream({start(y){b();function b(){d.read().then(({done:S,value:_})=>{if(S)y.close();else{x+=_.byteLength;const T=new ProgressEvent("progress",{lengthComputable:p,loaded:x,total:f});for(let M=0,k=u.length;M<k;M++){const P=u[M];P.onProgress&&P.onProgress(T)}y.enqueue(_),b()}})}}});return new Response(v)}else throw new wme(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return c.json();default:if(a===void 0)return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),h=d&&d[1]?d[1].toLowerCase():void 0,f=new TextDecoder(h);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{Ac.add(e,c);const u=yc[e];delete yc[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onLoad&&f.onLoad(c)}}).catch(c=>{const u=yc[e];if(u===void 0)throw this.manager.itemError(e),c;delete yc[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class bme extends ro{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Go(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t=[];for(let r=0;r<e.length;r++){const i=b0.parse(e[r]);t.push(i)}return t}}class Sme extends ro{constructor(e){super(e)}load(e,t,r,i){const s=this,o=[],a=new G_,l=new Go(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(d){l.load(e[d],function(h){const f=s.parse(h,!0);o[d]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},c+=1,c===6&&(f.mipmapCount===1&&(a.minFilter=Jn),a.image=o,a.format=f.format,a.needsUpdate=!0,t&&t(a))},r,i)}if(Array.isArray(e))for(let d=0,h=e.length;d<h;++d)u(d);else l.load(e,function(d){const h=s.parse(d,!0);if(h.isCubemap){const f=h.mipmaps.length/h.mipmapCount;for(let p=0;p<f;p++){o[p]={mipmaps:[]};for(let x=0;x<h.mipmapCount;x++)o[p].mipmaps.push(h.mipmaps[p*h.mipmapCount+x]),o[p].format=h.format,o[p].width=h.width,o[p].height=h.height}a.image=o}else a.image.width=h.width,a.image.height=h.height,a.mipmaps=h.mipmaps;h.mipmapCount===1&&(a.minFilter=Jn),a.format=h.format,a.needsUpdate=!0,t&&t(a)},r,i);return a}}let S0=class extends ro{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Ac.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=p0("img");function l(){u(),Ac.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(d){u(),i&&i(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}};class nH extends ro{constructor(e){super(e)}load(e,t,r,i){const s=new ax;s.colorSpace=Ai;const o=new S0(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let c=0;c<e.length;++c)l(c);return s}}class vR extends ro{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Qu,a=new Go(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let c;try{c=s.parse(l)}catch(u){if(i!==void 0)i(u);else{console.error(u);return}}c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:Gr,o.wrapT=c.wrapT!==void 0?c.wrapT:Gr,o.magFilter=c.magFilter!==void 0?c.magFilter:Jn,o.minFilter=c.minFilter!==void 0?c.minFilter:Jn,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0?o.colorSpace=c.colorSpace:c.encoding!==void 0&&(o.encoding=c.encoding),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=Nl),c.mipmapCount===1&&(o.minFilter=Jn),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c)},r,i),o}}let _me=class extends ro{constructor(e){super(e)}load(e,t,r,i){const s=new qr,o=new S0(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},r,i),s}};class kd extends cr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ut(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class rH extends kd{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(cr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ut(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const WC=new vn,gF=new ie,yF=new ie;class xR{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ze(512,512),this.map=null,this.mapPass=null,this.matrix=new vn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new lx,this._frameExtents=new Ze(1,1),this._viewportCount=1,this._viewports=[new vr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;gF.setFromMatrixPosition(e.matrixWorld),t.position.copy(gF),yF.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(yF),t.updateMatrixWorld(),WC.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(WC),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(WC)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Eme extends xR{constructor(){super(new hi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=Wm*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(r!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=r,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class iH extends kd{constructor(e,t,r=0,i=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(cr.DEFAULT_UP),this.updateMatrix(),this.target=new cr,this.distance=r,this.angle=i,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new Eme}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const vF=new vn,Ay=new ie,HC=new ie;class Cme extends xR{constructor(){super(new hi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ze(4,2),this._viewportCount=6,this._viewports=[new vr(2,1,1,1),new vr(0,1,1,1),new vr(3,1,1,1),new vr(1,1,1,1),new vr(3,0,1,1),new vr(1,0,1,1)],this._cubeDirections=[new ie(1,0,0),new ie(-1,0,0),new ie(0,0,1),new ie(0,0,-1),new ie(0,1,0),new ie(0,-1,0)],this._cubeUps=[new ie(0,1,0),new ie(0,1,0),new ie(0,1,0),new ie(0,1,0),new ie(0,0,1),new ie(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,i=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),Ay.setFromMatrixPosition(e.matrixWorld),r.position.copy(Ay),HC.copy(r.position),HC.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(HC),r.updateMatrixWorld(),i.makeTranslation(-Ay.x,-Ay.y,-Ay.z),vF.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(vF)}}class sH extends kd{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new Cme}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Tme extends xR{constructor(){super(new Ic(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class wR extends kd{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(cr.DEFAULT_UP),this.updateMatrix(),this.target=new cr,this.shadow=new Tme}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class bR extends kd{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class oH extends kd{constructor(e,t,r=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class aH{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ie)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*i),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*r),t.addScaledVector(o[4],1.092548*(r*i)),t.addScaledVector(o[5],1.092548*(i*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(r*s)),t.addScaledVector(o[8],.546274*(r*r-i*i)),t}getIrradianceAt(e,t){const r=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*i),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*r),t.addScaledVector(o[4],2*.429043*r*i),t.addScaledVector(o[5],2*.429043*i*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*r*s),t.addScaledVector(o[8],.429043*(r*r-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const r=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*r,t[4]=1.092548*r*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*r*s,t[8]=.546274*(r*r-i*i)}}class lH extends kd{constructor(e=new aH,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class l2 extends ro{constructor(e){super(e),this.textures={}}load(e,t,r,i){const s=this,o=new Go(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t=this.textures;function r(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const i=l2.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new Ut().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(i.uniforms[s]={},o.type){case"t":i.uniforms[s].value=r(o.value);break;case"c":i.uniforms[s].value=new Ut().setHex(o.value);break;case"v2":i.uniforms[s].value=new Ze().fromArray(o.value);break;case"v3":i.uniforms[s].value=new ie().fromArray(o.value);break;case"v4":i.uniforms[s].value=new vr().fromArray(o.value);break;case"m3":i.uniforms[s].value=new Vn().fromArray(o.value);break;case"m4":i.uniforms[s].value=new vn().fromArray(o.value);break;default:i.uniforms[s].value=o.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=r(e.map)),e.matcap!==void 0&&(i.matcap=r(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new Ze().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=r(e.envMap)),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new Ze().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:$W,SpriteMaterial:oR,RawShaderMaterial:jW,ShaderMaterial:Ys,PointsMaterial:H_,MeshPhysicalMaterial:VW,MeshStandardMaterial:o2,MeshPhongMaterial:WW,MeshToonMaterial:HW,MeshNormalMaterial:GW,MeshLambertMaterial:qW,MeshDepthMaterial:iR,MeshDistanceMaterial:sR,MeshBasicMaterial:ec,MeshMatcapMaterial:XW,LineDashedMaterial:KW,LineBasicMaterial:no,Material:ks};return new t[e]}}class $A{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,i=e.length;r<i;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class cH extends Pn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class uH extends ro{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Go(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t={},r={};function i(f,p){if(t[p]!==void 0)return t[p];const v=f.interleavedBuffers[p],y=s(f,v.buffer),b=im(v.type,y),S=new V_(b,v.stride);return S.uuid=v.uuid,t[p]=S,S}function s(f,p){if(r[p]!==void 0)return r[p];const v=f.arrayBuffers[p],y=new Uint32Array(v).buffer;return r[p]=y,y}const o=e.isInstancedBufferGeometry?new cH:new Pn,a=e.data.index;if(a!==void 0){const f=im(a.type,a.array);o.setIndex(new pr(f,1))}const l=e.data.attributes;for(const f in l){const p=l[f];let x;if(p.isInterleavedBufferAttribute){const v=i(e.data,p.data);x=new uf(v,p.itemSize,p.offset,p.normalized)}else{const v=im(p.type,p.array),y=p.isInstancedBufferAttribute?Gm:pr;x=new y(v,p.itemSize,p.normalized)}p.name!==void 0&&(x.name=p.name),p.usage!==void 0&&x.setUsage(p.usage),o.setAttribute(f,x)}const c=e.data.morphAttributes;if(c)for(const f in c){const p=c[f],x=[];for(let v=0,y=p.length;v<y;v++){const b=p[v];let S;if(b.isInterleavedBufferAttribute){const _=i(e.data,b.data);S=new uf(_,b.itemSize,b.offset,b.normalized)}else{const _=im(b.type,b.array);S=new pr(_,b.itemSize,b.normalized)}b.name!==void 0&&(S.name=b.name),x.push(S)}o.morphAttributes[f]=x}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const d=e.data.groups||e.data.drawcalls||e.data.offsets;if(d!==void 0)for(let f=0,p=d.length;f!==p;++f){const x=d[f];o.addGroup(x.start,x.count,x.materialIndex)}const h=e.data.boundingSphere;if(h!==void 0){const f=new ie;h.center!==void 0&&f.fromArray(h.center),o.boundingSphere=new Ms(f,h.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Mme extends ro{constructor(e){super(e)}load(e,t,r,i){const s=this,o=this.path===""?$A.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Go(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(d){i!==void 0&&i(d),console.error("THREE:ObjectLoader: Can't parse "+e+".",d.message);return}const u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,t)},r,i)}async loadAsync(e,t){const r=this,i=this.path===""?$A.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new Go(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(a)}parse(e,t){const r=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),o=this.parseImages(e.images,function(){t!==void 0&&t(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,r),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),t!==void 0){let d=!1;for(const h in o)if(o[h].data instanceof HTMLImageElement){d=!0;break}d===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,a,o,t),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),l}parseShapes(e){const t={};if(e!==void 0)for(let r=0,i=e.length;r<i;r++){const s=new Gh().fromJSON(e[r]);t[s.uuid]=s}return t}parseSkeletons(e,t){const r={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new W_().fromJSON(e[s],i);r[a.uuid]=a}return r}parseGeometries(e,t){const r={};if(e!==void 0){const i=new uH;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=i.parse(l);break;default:l.type in mF?a=mF[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),r[l.uuid]=a}}return r}parseMaterials(e,t){const r={},i={};if(e!==void 0){const s=new l2;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];r[l.uuid]===void 0&&(r[l.uuid]=s.parse(l)),i[l.uuid]=r[l.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let r=0;r<e.length;r++){const i=e[r],s=b0.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const r=this,i={};let s;function o(l){return r.manager.itemStart(l),s.load(l,function(){r.manager.itemEnd(l)},void 0,function(){r.manager.itemError(l),r.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:r.resourcePath+c;return o(u)}else return l.data?{data:im(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new a2(t);s=new S0(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const d=e[c],h=d.url;if(Array.isArray(h)){const f=[];for(let p=0,x=h.length;p<x;p++){const v=h[p],y=a(v);y!==null&&(y instanceof HTMLImageElement?f.push(y):f.push(new Qu(y.data,y.width,y.height)))}i[d.uuid]=new kh(f)}else{const f=a(d.url);i[d.uuid]=new kh(f)}}}return i}async parseImagesAsync(e){const t=this,r={};let i;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await i.loadAsync(l)}else return o.data?{data:im(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){i=new S0(this.manager),i.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.url;if(Array.isArray(c)){const u=[];for(let d=0,h=c.length;d<h;d++){const f=c[d],p=await s(f);p!==null&&(p instanceof HTMLImageElement?u.push(p):u.push(new Qu(p.data,p.width,p.height)))}r[l.uuid]=new kh(u)}else{const u=await s(l.url);r[l.uuid]=new kh(u)}}}return r}parseTextures(e,t){function r(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const i={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],c=l.data;let u;Array.isArray(c)?(u=new ax,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new Qu:u=new qr,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=a.uuid,a.name!==void 0&&(u.name=a.name),a.mapping!==void 0&&(u.mapping=r(a.mapping,Ame)),a.channel!==void 0&&(u.channel=a.channel),a.offset!==void 0&&u.offset.fromArray(a.offset),a.repeat!==void 0&&u.repeat.fromArray(a.repeat),a.center!==void 0&&u.center.fromArray(a.center),a.rotation!==void 0&&(u.rotation=a.rotation),a.wrap!==void 0&&(u.wrapS=r(a.wrap[0],xF),u.wrapT=r(a.wrap[1],xF)),a.format!==void 0&&(u.format=a.format),a.internalFormat!==void 0&&(u.internalFormat=a.internalFormat),a.type!==void 0&&(u.type=a.type),a.colorSpace!==void 0&&(u.colorSpace=a.colorSpace),a.encoding!==void 0&&(u.encoding=a.encoding),a.minFilter!==void 0&&(u.minFilter=r(a.minFilter,wF)),a.magFilter!==void 0&&(u.magFilter=r(a.magFilter,wF)),a.anisotropy!==void 0&&(u.anisotropy=a.anisotropy),a.flipY!==void 0&&(u.flipY=a.flipY),a.generateMipmaps!==void 0&&(u.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(u.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(u.compareFunction=a.compareFunction),a.userData!==void 0&&(u.userData=a.userData),i[a.uuid]=u}return i}parseObject(e,t,r,i,s){let o;function a(h){return t[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",h),t[h]}function l(h){if(h!==void 0){if(Array.isArray(h)){const f=[];for(let p=0,x=h.length;p<x;p++){const v=h[p];r[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",v),f.push(r[v])}return f}return r[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",h),r[h]}}function c(h){return i[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",h),i[h]}let u,d;switch(e.type){case"Scene":o=new Tg,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new Ut(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new j_(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new $_(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new hi(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Ic(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new bR(e.color,e.intensity);break;case"DirectionalLight":o=new wR(e.color,e.intensity);break;case"PointLight":o=new sH(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new oH(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new iH(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new rH(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new lH().fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),d=l(e.material),o=new MW(u,d),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),d=l(e.material),o=new ri(u,d);break;case"InstancedMesh":u=a(e.geometry),d=l(e.material);const h=e.count,f=e.instanceMatrix,p=e.instanceColor;o=new AW(u,d,h),o.instanceMatrix=new Gm(new Float32Array(f.array),16),p!==void 0&&(o.instanceColor=new Gm(new Float32Array(p.array),p.itemSize));break;case"BatchedMesh":u=a(e.geometry),d=l(e.material),o=new NW(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,d),o.geometry=u,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(x=>{const v=new qs;v.min.fromArray(x.boxMin),v.max.fromArray(x.boxMax);const y=new Ms;return y.radius=x.sphereRadius,y.center.fromArray(x.sphereCenter),{boxInitialized:x.boxInitialized,box:v,sphereInitialized:x.sphereInitialized,sphere:y}}),o._maxGeometryCount=e.maxGeometryCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=c(e.matricesTexture.uuid);break;case"LOD":o=new TW;break;case"Line":o=new gd(a(e.geometry),l(e.material));break;case"LineLoop":o=new kW(a(e.geometry),l(e.material));break;case"LineSegments":o=new tc(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new lR(a(e.geometry),l(e.material));break;case"Sprite":o=new CW(l(e.material));break;case"Group":o=new am;break;case"Bone":o=new aR;break;default:o=new cr}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const h=e.children;for(let f=0;f<h.length;f++)o.add(this.parseObject(h[f],t,r,i,s))}if(e.animations!==void 0){const h=e.animations;for(let f=0;f<h.length;f++){const p=h[f];o.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const h=e.levels;for(let f=0;f<h.length;f++){const p=h[f],x=o.getObjectByProperty("uuid",p.object);x!==void 0&&o.addLevel(x,p.distance,p.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const i=t[r.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(i,r.bindMatrix)}})}}const Ame={UVMapping:pd,CubeReflectionMapping:ql,CubeRefractionMapping:md,EquirectangularReflectionMapping:jm,EquirectangularRefractionMapping:i0,CubeUVReflectionMapping:_g},xF={RepeatWrapping:Vm,ClampToEdgeWrapping:Gr,MirroredRepeatWrapping:s0},wF={NearestFilter:yi,NearestMipmapNearestFilter:bS,NearestMipmapLinearFilter:yh,LinearFilter:Jn,LinearMipmapNearestFilter:lv,LinearMipmapLinearFilter:Nl};class Nme extends ro{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Ac.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(c=>{t&&t(c),s.manager.itemEnd(e)}).catch(c=>{i&&i(c)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const l=fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return Ac.add(e,c),t&&t(c),s.manager.itemEnd(e),c}).catch(function(c){i&&i(c),Ac.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Ac.add(e,l),s.manager.itemStart(e)}}let T1;class SR{static getContext(){return T1===void 0&&(T1=new(window.AudioContext||window.webkitAudioContext)),T1}static setContext(e){T1=e}}class kme extends ro{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Go(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const c=l.slice(0);SR.getContext().decodeAudioData(c,function(d){t(d)}).catch(a)}catch(c){a(c)}},r,i);function a(l){i?i(l):console.error(l),s.manager.itemError(e)}}}const bF=new vn,SF=new vn,nh=new vn;class Ime{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new hi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new hi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,nh.copy(e.projectionMatrix);const i=t.eyeSep/2,s=i*t.near/t.focus,o=t.near*Math.tan(Vh*t.fov*.5)/t.zoom;let a,l;SF.elements[12]=-i,bF.elements[12]=i,a=-o*t.aspect+s,l=o*t.aspect+s,nh.elements[0]=2*t.near/(l-a),nh.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(nh),a=-o*t.aspect-s,l=o*t.aspect-s,nh.elements[0]=2*t.near/(l-a),nh.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(nh)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(SF),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(bF)}}class _R{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=_F(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=_F();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function _F(){return(typeof performance>"u"?Date:performance).now()}const rh=new ie,EF=new Ts,Rme=new ie,ih=new ie;class Pme extends cr{constructor(){super(),this.type="AudioListener",this.context=SR.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new _R}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(rh,EF,Rme),ih.set(0,0,-1).applyQuaternion(EF),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(rh.x,i),t.positionY.linearRampToValueAtTime(rh.y,i),t.positionZ.linearRampToValueAtTime(rh.z,i),t.forwardX.linearRampToValueAtTime(ih.x,i),t.forwardY.linearRampToValueAtTime(ih.y,i),t.forwardZ.linearRampToValueAtTime(ih.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(rh.x,rh.y,rh.z),t.setOrientation(ih.x,ih.y,ih.z,r.x,r.y,r.z)}}class dH extends cr{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const sh=new ie,CF=new Ts,Dme=new ie,oh=new ie;class Lme extends dH{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(sh,CF,Dme),oh.set(0,0,1).applyQuaternion(CF);const t=this.panner;if(t.positionX){const r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(sh.x,r),t.positionY.linearRampToValueAtTime(sh.y,r),t.positionZ.linearRampToValueAtTime(sh.z,r),t.orientationX.linearRampToValueAtTime(oh.x,r),t.orientationY.linearRampToValueAtTime(oh.y,r),t.orientationZ.linearRampToValueAtTime(oh.z,r)}else t.setPosition(sh.x,sh.y,sh.z),t.setOrientation(oh.x,oh.y,oh.z)}}class Ome{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}class hH{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,s,o;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,i=this.valueSize,s=e*i+i;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==i;++a)r[s+a]=r[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(r,s,0,a,i)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,i=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(r,i,l,1-s,t)}o>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(r[l]!==r[l+t]){a.setValue(r,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let s=r,o=i;s!==o;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,s){if(i>=.5)for(let o=0;o!==s;++o)e[t+o]=e[r+o]}_slerp(e,t,r,i){Ts.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,s){const o=this._workIndex*s;Ts.multiplyQuaternionsFlat(e,o,e,t,e,r),Ts.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,r,i,s){const o=1-i;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[r+a]*i}}_lerpAdditive(e,t,r,i,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[r+o]*i}}}const ER="\\[\\]\\.:\\/",Fme=new RegExp("["+ER+"]","g"),CR="[^"+ER+"]",zme="[^"+ER.replace("\\.","")+"]",Ume=/((?:WC+[\/:])*)/.source.replace("WC",CR),Bme=/(WCOD+)?/.source.replace("WCOD",zme),$me=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",CR),jme=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",CR),Vme=new RegExp("^"+Ume+Bme+$me+jme+"$"),Wme=["material","materials","bones","map"];class Hme{constructor(e,t,r){const i=r||sr.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class sr{constructor(e,t,r){this.path=t,this.parsedPath=r||sr.parseTrackName(t),this.node=sr.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new sr.Composite(e,t,r):new sr(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Fme,"")}static parseTrackName(e){const t=Vme.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);Wme.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=r(a.children);if(l)return l}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=sr.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let c=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[i];if(o===void 0){const c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}sr.Composite=Hme;sr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};sr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};sr.prototype.GetterByBindingType=[sr.prototype._getValue_direct,sr.prototype._getValue_array,sr.prototype._getValue_arrayElement,sr.prototype._getValue_toArray];sr.prototype.SetterByBindingTypeAndVersioning=[[sr.prototype._setValue_direct,sr.prototype._setValue_direct_setNeedsUpdate,sr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[sr.prototype._setValue_array,sr.prototype._setValue_array_setNeedsUpdate,sr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[sr.prototype._setValue_arrayElement,sr.prototype._setValue_arrayElement_setNeedsUpdate,sr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[sr.prototype._setValue_fromArray,sr.prototype._setValue_fromArray_setNeedsUpdate,sr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Gme{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Ho(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,i=arguments.length;r!==i;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,r=this._paths,i=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let u=0,d=arguments.length;u!==d;++u){const h=arguments[u],f=h.uuid;let p=t[f];if(p===void 0){p=l++,t[f]=p,e.push(h);for(let x=0,v=o;x!==v;++x)s[x].push(new sr(h,r[x],i[x]))}else if(p<c){a=e[p];const x=--c,v=e[x];t[v.uuid]=p,e[p]=v,t[f]=x,e[x]=h;for(let y=0,b=o;y!==b;++y){const S=s[y],_=S[x];let T=S[p];S[p]=_,T===void 0&&(T=new sr(h,r[y],i[y])),S[x]=T}}else e[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,u=t[c];if(u!==void 0&&u>=s){const d=s++,h=e[d];t[h.uuid]=u,e[u]=h,t[c]=d,e[d]=l;for(let f=0,p=i;f!==p;++f){const x=r[f],v=x[d],y=x[u];x[u]=v,x[d]=y}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],u=c.uuid,d=t[u];if(d!==void 0)if(delete t[u],d<s){const h=--s,f=e[h],p=--o,x=e[p];t[f.uuid]=d,e[d]=f,t[x.uuid]=h,e[h]=x,e.pop();for(let v=0,y=i;v!==y;++v){const b=r[v],S=b[h],_=b[p];b[d]=S,b[h]=_,b.pop()}}else{const h=--o,f=e[h];h>0&&(t[f.uuid]=d),e[d]=f,e.pop();for(let p=0,x=i;p!==x;++p){const v=r[p];v[d]=v[h],v.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const r=this._bindingsIndicesByPath;let i=r[e];const s=this._bindings;if(i!==void 0)return s[i];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,d=new Array(c);i=s.length,r[e]=i,o.push(e),a.push(t),s.push(d);for(let h=u,f=l.length;h!==f;++h){const p=l[h];d[h]=new sr(p,e,t)}return d}unsubscribe_(e){const t=this._bindingsIndicesByPath,r=t[e];if(r!==void 0){const i=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=e[a];t[c]=r,o[r]=l,o.pop(),s[r]=s[a],s.pop(),i[r]=i[a],i.pop()}}}class fH{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:Ah,endingEnd:Ah};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=X6,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const i=this._clip.duration,s=e._clip.duration,o=s/i,a=i/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const i=this._mixer,s=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+r,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*r;l<0||r===0?t=0:(this._startTime=null,t=r*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case qI:for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);break;case O_:default:for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let i=this.time+e,s=this._loopCount;const o=r===K6;if(e===0)return s===-1?i:o&&(s&1)===1?t-i:i;if(r===q6){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=t||i<0){const a=Math.floor(i/t);i-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(o&&(s&1)===1)return t-i}return i}_setEndings(e,t,r){const i=this._interpolantSettings;r?(i.endingStart=Nh,i.endingEnd=Nh):(e?i.endingStart=this.zeroSlopeAtStart?Nh:Ah:i.endingStart=l0,t?i.endingEnd=this.zeroSlopeAtEnd?Nh:Ah:i.endingEnd=l0)}_scheduleFading(e,t,r){const i=this._mixer,s=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=r,this}}const qme=new Float32Array(1);class Xme extends Jl{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,i=e._clip.tracks,s=i.length,o=e._propertyBindings,a=e._interpolants,l=r.uuid,c=this._bindingsByRootAndName;let u=c[l];u===void 0&&(u={},c[l]=u);for(let d=0;d!==s;++d){const h=i[d],f=h.name;let p=u[f];if(p!==void 0)++p.referenceCount,o[d]=p;else{if(p=o[d],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,f));continue}const x=t&&t._propertyBindings[d].binding.parsedPath;p=new hH(sr.create(r,f,x),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,f),o[d]=p}a[d].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,r)}const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){const i=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null;const d=a.actionByRoot,h=(e._localRoot||this._root).uuid;delete d[h],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_addInactiveBinding(e,t,r){const i=this._bindingsByRootAndName,s=this._bindings;let o=i[t];o===void 0&&(o={},i[t]=o),o[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,i=r.rootNode.uuid,s=r.path,o=this._bindingsByRootAndName,a=o[i],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[i]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return r===void 0&&(r=new gR(new Float32Array(2),new Float32Array(2),1,qme),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=r,t[r]=s}clipAction(e,t,r){const i=t||this._root,s=i.uuid;let o=typeof e=="string"?b0.findByName(i,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let c=null;if(r===void 0&&(o!==null?r=o.blendMode:r=O_),l!==void 0){const d=l.actionByRoot[s];if(d!==void 0&&d.blendMode===r)return d;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const u=new fH(this,o,t,r);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,t){const r=t||this._root,i=r.uuid,s=typeof e=="string"?b0.findByName(r,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,i=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==r;++c)t[c]._update(i,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,i=this._actionsByClip,s=i[r];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,d=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,d._cacheIndex=u,t[u]=d,t.pop(),this._removeInactiveBindingsForAction(c)}delete i[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const o in r){const a=r[o].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class TR{constructor(e){this.value=e}clone(){return new TR(this.value.clone===void 0?this.value:this.value.clone())}}let Kme=0;class Yme extends Jl{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Kme++}),this.name="",this.usage=h0,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let r=0,i=t.length;r<i;r++){const s=Array.isArray(t[r])?t[r]:[t[r]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class Zme extends V_{constructor(e,t,r=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class Qme{constructor(e,t,r,i,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class c2{constructor(e,t,r=0,i=1/0){this.ray=new Mf(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new Hh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return jA(e,this,r,t),r.sort(TF),r}intersectObjects(e,t=!0,r=[]){for(let i=0,s=e.length;i<s;i++)jA(e[i],this,r,t);return r.sort(TF),r}}function TF(n,e){return n.distance-e.distance}function jA(n,e,t,r){if(n.layers.test(e.layers)&&n.raycast(e,t),r===!0){const i=n.children;for(let s=0,o=i.length;s<o;s++)jA(i[s],e,t,!0)}}class VA{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(di(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Jme{constructor(e=1,t=0,r=0){return this.radius=e,this.theta=t,this.y=r,this}set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return new this.constructor().copy(this)}}const MF=new Ze;class ege{constructor(e=new Ze(1/0,1/0),t=new Ze(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=MF.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,MF).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const AF=new ie,M1=new ie;class tge{constructor(e=new ie,t=new ie){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){AF.subVectors(e,this.start),M1.subVectors(this.end,this.start);const r=M1.dot(M1);let s=M1.dot(AF)/r;return t&&(s=di(s,0,1)),s}closestPointToPoint(e,t,r){const i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const NF=new ie;class nge extends cr{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const r=new Pn,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,u=a/l*Math.PI*2;i.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}r.setAttribute("position",new Qt(i,3));const s=new no({fog:!1,toneMapped:!1});this.cone=new tc(r,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),NF.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(NF),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Su=new ie,A1=new vn,GC=new vn;class rge extends tc{constructor(e){const t=pH(e),r=new Pn,i=[],s=[],o=new Ut(0,0,1),a=new Ut(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}r.setAttribute("position",new Qt(i,3)),r.setAttribute("color",new Qt(s,3));const l=new no({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,i=r.getAttribute("position");GC.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(A1.multiplyMatrices(GC,a.matrixWorld),Su.setFromMatrixPosition(A1),i.setXYZ(o,Su.x,Su.y,Su.z),A1.multiplyMatrices(GC,a.parent.matrixWorld),Su.setFromMatrixPosition(A1),i.setXYZ(o+1,Su.x,Su.y,Su.z),o+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function pH(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,pH(n.children[t]));return e}class ige extends ri{constructor(e,t,r){const i=new fx(t,4,2),s=new ec({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const sge=new ie,kF=new Ut,IF=new Ut;class oge extends cr{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const i=new hx(t);i.rotateY(Math.PI*.5),this.material=new ec({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),o=new Float32Array(s.count*3);i.setAttribute("color",new pr(o,3)),this.add(new ri(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");kF.copy(this.light.color),IF.copy(this.light.groundColor);for(let r=0,i=t.count;r<i;r++){const s=r<i/2?kF:IF;t.setXYZ(r,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(sge.setFromMatrixPosition(this.light.matrixWorld).negate())}}class mH extends tc{constructor(e=10,t=10,r=4473924,i=8947848){r=new Ut(r),i=new Ut(i);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let h=0,f=0,p=-a;h<=t;h++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const x=h===s?r:i;x.toArray(c,f),f+=3,x.toArray(c,f),f+=3,x.toArray(c,f),f+=3,x.toArray(c,f),f+=3}const u=new Pn;u.setAttribute("position",new Qt(l,3)),u.setAttribute("color",new Qt(c,3));const d=new no({vertexColors:!0,toneMapped:!1});super(u,d),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class age extends tc{constructor(e=10,t=16,r=8,i=64,s=4473924,o=8947848){s=new Ut(s),o=new Ut(o);const a=[],l=[];if(t>1)for(let d=0;d<t;d++){const h=d/t*(Math.PI*2),f=Math.sin(h)*e,p=Math.cos(h)*e;a.push(0,0,0),a.push(f,0,p);const x=d&1?s:o;l.push(x.r,x.g,x.b),l.push(x.r,x.g,x.b)}for(let d=0;d<r;d++){const h=d&1?s:o,f=e-e/r*d;for(let p=0;p<i;p++){let x=p/i*(Math.PI*2),v=Math.sin(x)*f,y=Math.cos(x)*f;a.push(v,0,y),l.push(h.r,h.g,h.b),x=(p+1)/i*(Math.PI*2),v=Math.sin(x)*f,y=Math.cos(x)*f,a.push(v,0,y),l.push(h.r,h.g,h.b)}}const c=new Pn;c.setAttribute("position",new Qt(a,3)),c.setAttribute("color",new Qt(l,3));const u=new no({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const RF=new ie,N1=new ie,PF=new ie;class lge extends cr{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new Pn;i.setAttribute("position",new Qt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new no({fog:!1,toneMapped:!1});this.lightPlane=new gd(i,s),this.add(this.lightPlane),i=new Pn,i.setAttribute("position",new Qt([0,0,0,0,0,1],3)),this.targetLine=new gd(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),RF.setFromMatrixPosition(this.light.matrixWorld),N1.setFromMatrixPosition(this.light.target.matrixWorld),PF.subVectors(N1,RF),this.lightPlane.lookAt(N1),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(N1),this.targetLine.scale.z=PF.length()}}const k1=new ie,ci=new ox;class cge extends tc{constructor(e){const t=new Pn,r=new no({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,x){l(p),l(x)}function l(p){i.push(0,0,0),s.push(0,0,0),o[p]===void 0&&(o[p]=[]),o[p].push(i.length/3-1)}t.setAttribute("position",new Qt(i,3)),t.setAttribute("color",new Qt(s,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new Ut(16755200),u=new Ut(16711680),d=new Ut(43775),h=new Ut(16777215),f=new Ut(3355443);this.setColors(c,u,d,h,f)}setColors(e,t,r,i,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,r.r,r.g,r.b),a.setXYZ(33,r.r,r.g,r.b),a.setXYZ(34,r.r,r.g,r.b),a.setXYZ(35,r.r,r.g,r.b),a.setXYZ(36,r.r,r.g,r.b),a.setXYZ(37,r.r,r.g,r.b),a.setXYZ(38,i.r,i.g,i.b),a.setXYZ(39,i.r,i.g,i.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,r=1,i=1;ci.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),gi("c",t,e,ci,0,0,-1),gi("t",t,e,ci,0,0,1),gi("n1",t,e,ci,-1,-1,-1),gi("n2",t,e,ci,r,-1,-1),gi("n3",t,e,ci,-1,i,-1),gi("n4",t,e,ci,r,i,-1),gi("f1",t,e,ci,-1,-1,1),gi("f2",t,e,ci,r,-1,1),gi("f3",t,e,ci,-1,i,1),gi("f4",t,e,ci,r,i,1),gi("u1",t,e,ci,r*.7,i*1.1,-1),gi("u2",t,e,ci,-1*.7,i*1.1,-1),gi("u3",t,e,ci,0,i*2,-1),gi("cf1",t,e,ci,-1,0,1),gi("cf2",t,e,ci,r,0,1),gi("cf3",t,e,ci,0,-1,1),gi("cf4",t,e,ci,0,i,1),gi("cn1",t,e,ci,-1,0,-1),gi("cn2",t,e,ci,r,0,-1),gi("cn3",t,e,ci,0,-1,-1),gi("cn4",t,e,ci,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function gi(n,e,t,r,i,s,o){k1.set(i,s,o).unproject(r);const a=e[n];if(a!==void 0){const l=t.getAttribute("position");for(let c=0,u=a.length;c<u;c++)l.setXYZ(a[c],k1.x,k1.y,k1.z)}}const I1=new qs;class uge extends tc{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new Pn;s.setIndex(new pr(r,1)),s.setAttribute("position",new pr(i,3)),super(s,new no({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&I1.setFromObject(this.object),I1.isEmpty())return;const t=I1.min,r=I1.max,i=this.geometry.attributes.position,s=i.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=t.x,s[4]=r.y,s[5]=r.z,s[6]=t.x,s[7]=t.y,s[8]=r.z,s[9]=r.x,s[10]=t.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=t.z,s[15]=t.x,s[16]=r.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=r.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class dge extends tc{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Pn;s.setIndex(new pr(r,1)),s.setAttribute("position",new Qt(i,3)),super(s,new no({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class hge extends gd{constructor(e,t=1,r=16776960){const i=r,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new Pn;o.setAttribute("position",new Qt(s,3)),o.computeBoundingSphere(),super(o,new no({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Pn;l.setAttribute("position",new Qt(a,3)),l.computeBoundingSphere(),this.add(new ri(l,new ec({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const DF=new ie;let R1,qC;class fge extends cr{constructor(e=new ie(0,0,1),t=new ie(0,0,0),r=1,i=16776960,s=r*.2,o=s*.2){super(),this.type="ArrowHelper",R1===void 0&&(R1=new Pn,R1.setAttribute("position",new Qt([0,0,0,0,1,0],3)),qC=new Mg(0,.5,1,5,1),qC.translate(0,-.5,0)),this.position.copy(t),this.line=new gd(R1,new no({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ri(qC,new ec({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{DF.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(DF,t)}}setLength(e,t=e*.2,r=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class pge extends tc{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Pn;i.setAttribute("position",new Qt(t,3)),i.setAttribute("color",new Qt(r,3));const s=new no({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,t,r){const i=new Ut,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(r),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class mge{constructor(){this.type="ShapePath",this.color=new Ut,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new m0,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,s,o){return this.currentPath.bezierCurveTo(e,t,r,i,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(y){const b=[];for(let S=0,_=y.length;S<_;S++){const T=y[S],M=new Gh;M.curves=T.curves,b.push(M)}return b}function r(y,b){const S=b.length;let _=!1;for(let T=S-1,M=0;M<S;T=M++){let k=b[T],P=b[M],z=P.x-k.x,I=P.y-k.y;if(Math.abs(I)>Number.EPSILON){if(I<0&&(k=b[M],z=-z,P=b[T],I=-I),y.y<k.y||y.y>P.y)continue;if(y.y===k.y){if(y.x===k.x)return!0}else{const L=I*(y.x-k.x)-z*(y.y-k.y);if(L===0)return!0;if(L<0)continue;_=!_}}else{if(y.y!==k.y)continue;if(P.x<=y.x&&y.x<=k.x||k.x<=y.x&&y.x<=P.x)return!0}}return _}const i=Bl.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const c=[];if(s.length===1)return a=s[0],l=new Gh,l.curves=a.curves,c.push(l),c;let u=!i(s[0].getPoints());u=e?!u:u;const d=[],h=[];let f=[],p=0,x;h[p]=void 0,f[p]=[];for(let y=0,b=s.length;y<b;y++)a=s[y],x=a.getPoints(),o=i(x),o=e?!o:o,o?(!u&&h[p]&&p++,h[p]={s:new Gh,p:x},h[p].s.curves=a.curves,u&&p++,f[p]=[]):f[p].push({h:a,p:x[0]});if(!h[0])return t(s);if(h.length>1){let y=!1,b=0;for(let S=0,_=h.length;S<_;S++)d[S]=[];for(let S=0,_=h.length;S<_;S++){const T=f[S];for(let M=0;M<T.length;M++){const k=T[M];let P=!0;for(let z=0;z<h.length;z++)r(k.p,h[z].p)&&(S!==z&&b++,P?(P=!1,d[z].push(k)):y=!0);P&&d[S].push(k)}}b>0&&y===!1&&(f=d)}let v;for(let y=0,b=h.length;y<b;y++){l=h[y].s,c.push(l),v=f[y];for(let S=0,_=v.length;S<_;S++)l.holes.push(v[S].h)}return c}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Sg}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Sg);const gge=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:FI,AddEquation:Du,AddOperation:L6,AdditiveAnimationBlendMode:qI,AdditiveBlending:eA,AgXToneMapping:B6,AlphaFormat:j6,AlwaysCompare:sW,AlwaysDepth:A6,AlwaysStencilFunc:RA,AmbientLight:bR,AnimationAction:fH,AnimationClip:b0,AnimationLoader:bme,AnimationMixer:Xme,AnimationObjectGroup:Gme,AnimationUtils:yme,ArcCurve:IW,ArrayCamera:SW,ArrowHelper:fge,AttachedBindMode:sA,Audio:dH,AudioAnalyser:Ome,AudioContext:SR,AudioListener:Pme,AudioLoader:kme,AxesHelper:pge,BackSide:Cs,BasicDepthPacking:Y6,BasicShadowMap:u6,BatchedMesh:NW,Bone:aR,BooleanKeyframeTrack:Nf,Box2:ege,Box3:qs,Box3Helper:dge,BoxGeometry:Af,BoxHelper:uge,BufferAttribute:pr,BufferGeometry:Pn,BufferGeometryLoader:uH,ByteType:zI,Cache:Ac,Camera:ox,CameraHelper:cge,CanvasTexture:$pe,CapsuleGeometry:X_,CatmullRomCurve3:RW,CineonToneMapping:z6,CircleGeometry:K_,ClampToEdgeWrapping:Gr,Clock:_R,Color:Ut,ColorKeyframeTrack:yR,ColorManagement:gr,CompressedArrayTexture:Upe,CompressedCubeTexture:Bpe,CompressedTexture:G_,CompressedTextureLoader:Sme,ConeGeometry:Y_,ConstantAlphaFactor:C6,ConstantColorFactor:_6,CubeCamera:pW,CubeReflectionMapping:ql,CubeRefractionMapping:md,CubeTexture:ax,CubeTextureLoader:nH,CubeUVReflectionMapping:_g,CubicBezierCurve:uR,CubicBezierCurve3:PW,CubicInterpolant:QW,CullFaceBack:JM,CullFaceFront:c6,CullFaceFrontBack:Nle,CullFaceNone:l6,Curve:ll,CurvePath:LW,CustomBlending:d6,CustomToneMapping:U6,CylinderGeometry:Mg,Cylindrical:Jme,Data3DTexture:QI,DataArrayTexture:z_,DataTexture:Qu,DataTextureLoader:vR,DataUtils:Ih,DecrementStencilOp:Ule,DecrementWrapStencilOp:$le,DefaultLoadingManager:tH,DepthFormat:Yu,DepthStencilFormat:cf,DepthTexture:U_,DetachedBindMode:$6,DirectionalLight:wR,DirectionalLightHelper:lge,DiscreteInterpolant:JW,DisplayP3ColorSpace:F_,DodecahedronGeometry:Z_,DoubleSide:Ka,DstAlphaFactor:v6,DstColorFactor:w6,DynamicCopyUsage:nce,DynamicDrawUsage:Yle,DynamicReadUsage:Jle,EdgesGeometry:OW,EllipseCurve:q_,EqualCompare:tW,EqualDepth:k6,EqualStencilFunc:Hle,EquirectangularReflectionMapping:jm,EquirectangularRefractionMapping:i0,Euler:Eg,EventDispatcher:Jl,ExtrudeGeometry:J_,FileLoader:Go,Float16BufferAttribute:$ce,Float32BufferAttribute:Qt,Float64BufferAttribute:jce,FloatType:fi,Fog:j_,FogExp2:$_,FramebufferTexture:zpe,FrontSide:Wc,Frustum:lx,GLBufferAttribute:Qme,GLSL1:ice,GLSL3:PA,GreaterCompare:nW,GreaterDepth:R6,GreaterEqualCompare:iW,GreaterEqualDepth:I6,GreaterEqualStencilFunc:Kle,GreaterStencilFunc:qle,GridHelper:mH,Group:am,HalfFloatType:Fi,HemisphereLight:rH,HemisphereLightHelper:oge,IcosahedronGeometry:dx,ImageBitmapLoader:Nme,ImageLoader:S0,ImageUtils:ZI,IncrementStencilOp:zle,IncrementWrapStencilOp:Ble,InstancedBufferAttribute:Gm,InstancedBufferGeometry:cH,InstancedInterleavedBuffer:Zme,InstancedMesh:AW,Int16BufferAttribute:Uce,Int32BufferAttribute:Bce,Int8BufferAttribute:Oce,IntType:L_,InterleavedBuffer:V_,InterleavedBufferAttribute:uf,Interpolant:px,InterpolateDiscrete:o0,InterpolateLinear:a0,InterpolateSmooth:mb,InvertStencilOp:jle,KeepStencilOp:hh,KeyframeTrack:cl,LOD:TW,LatheGeometry:ux,Layers:Hh,LessCompare:eW,LessDepth:N6,LessEqualCompare:KI,LessEqualDepth:r0,LessEqualStencilFunc:Gle,LessStencilFunc:Wle,Light:kd,LightProbe:lH,Line:gd,Line3:tge,LineBasicMaterial:no,LineCurve:dR,LineCurve3:DW,LineDashedMaterial:KW,LineLoop:kW,LineSegments:tc,LinearDisplayP3ColorSpace:sx,LinearEncoding:XI,LinearFilter:Jn,LinearInterpolant:gR,LinearMipMapLinearFilter:oA,LinearMipMapNearestFilter:Rle,LinearMipmapLinearFilter:Nl,LinearMipmapNearestFilter:lv,LinearSRGBColorSpace:Ko,LinearToneMapping:O6,LinearTransfer:c0,Loader:ro,LoaderUtils:$A,LoadingManager:a2,LoopOnce:q6,LoopPingPong:K6,LoopRepeat:X6,LuminanceAlphaFormat:W6,LuminanceFormat:V6,MOUSE:uh,Material:ks,MaterialLoader:l2,MathUtils:oW,Matrix3:Vn,Matrix4:vn,MaxEquation:iA,Mesh:ri,MeshBasicMaterial:ec,MeshDepthMaterial:iR,MeshDistanceMaterial:sR,MeshLambertMaterial:qW,MeshMatcapMaterial:XW,MeshNormalMaterial:GW,MeshPhongMaterial:WW,MeshPhysicalMaterial:VW,MeshStandardMaterial:o2,MeshToonMaterial:HW,MinEquation:rA,MirroredRepeatWrapping:s0,MixOperation:D6,MultiplyBlending:nA,MultiplyOperation:ix,NearestFilter:yi,NearestMipMapLinearFilter:Ile,NearestMipMapNearestFilter:kle,NearestMipmapLinearFilter:yh,NearestMipmapNearestFilter:bS,NeverCompare:J6,NeverDepth:M6,NeverStencilFunc:Vle,NoBlending:zl,NoColorSpace:zo,NoToneMapping:Ul,NormalAnimationBlendMode:O_,NormalBlending:jh,NotEqualCompare:rW,NotEqualDepth:P6,NotEqualStencilFunc:Xle,NumberKeyframeTrack:x0,Object3D:cr,ObjectLoader:Mme,ObjectSpaceNormalMap:Q6,OctahedronGeometry:hx,OneFactor:m6,OneMinusConstantAlphaFactor:T6,OneMinusConstantColorFactor:E6,OneMinusDstAlphaFactor:x6,OneMinusDstColorFactor:b6,OneMinusSrcAlphaFactor:wS,OneMinusSrcColorFactor:y6,OrthographicCamera:Ic,P3Primaries:d0,PCFShadowMap:P_,PCFSoftShadowMap:Sm,PMREMGenerator:LA,Path:m0,PerspectiveCamera:hi,Plane:Wa,PlaneGeometry:Ad,PlaneHelper:hge,PointLight:sH,PointLightHelper:ige,Points:lR,PointsMaterial:H_,PolarGridHelper:age,PolyhedronGeometry:Nd,PositionalAudio:Lme,PropertyBinding:sr,PropertyMixer:hH,QuadraticBezierCurve:hR,QuadraticBezierCurve3:fR,Quaternion:Ts,QuaternionKeyframeTrack:Ag,QuaternionLinearInterpolant:eH,RED_GREEN_RGTC2_Format:kA,RED_RGTC1_Format:G6,REVISION:Sg,RGBADepthPacking:Z6,RGBAFormat:Ii,RGBAIntegerFormat:HI,RGBA_ASTC_10x10_Format:EA,RGBA_ASTC_10x5_Format:bA,RGBA_ASTC_10x6_Format:SA,RGBA_ASTC_10x8_Format:_A,RGBA_ASTC_12x10_Format:CA,RGBA_ASTC_12x12_Format:TA,RGBA_ASTC_4x4_Format:fA,RGBA_ASTC_5x4_Format:pA,RGBA_ASTC_5x5_Format:mA,RGBA_ASTC_6x5_Format:gA,RGBA_ASTC_6x6_Format:yA,RGBA_ASTC_8x5_Format:vA,RGBA_ASTC_8x6_Format:xA,RGBA_ASTC_8x8_Format:wA,RGBA_BPTC_Format:pb,RGBA_ETC2_EAC_Format:hA,RGBA_PVRTC_2BPPV1_Format:uA,RGBA_PVRTC_4BPPV1_Format:cA,RGBA_S3TC_DXT1_Format:db,RGBA_S3TC_DXT3_Format:hb,RGBA_S3TC_DXT5_Format:fb,RGB_BPTC_SIGNED_Format:MA,RGB_BPTC_UNSIGNED_Format:AA,RGB_ETC1_Format:GI,RGB_ETC2_Format:dA,RGB_PVRTC_2BPPV1_Format:lA,RGB_PVRTC_4BPPV1_Format:aA,RGB_S3TC_DXT1_Format:ub,RGFormat:H6,RGIntegerFormat:WI,RawShaderMaterial:jW,Ray:Mf,Raycaster:c2,Rec709Primaries:u0,RectAreaLight:oH,RedFormat:jI,RedIntegerFormat:VI,ReinhardToneMapping:F6,RenderTarget:dW,RepeatWrapping:Vm,ReplaceStencilOp:Fle,ReverseSubtractEquation:f6,RingGeometry:e2,SIGNED_RED_GREEN_RGTC2_Format:IA,SIGNED_RED_RGTC1_Format:NA,SRGBColorSpace:Ai,SRGBTransfer:Ir,Scene:Tg,ShaderChunk:In,ShaderLib:Ha,ShaderMaterial:Ys,ShadowMaterial:$W,Shape:Gh,ShapeGeometry:t2,ShapePath:mge,ShapeUtils:Bl,ShortType:UI,Skeleton:W_,SkeletonHelper:rge,SkinnedMesh:MW,Source:kh,Sphere:Ms,SphereGeometry:fx,Spherical:VA,SphericalHarmonics3:aH,SplineCurve:pR,SpotLight:iH,SpotLightHelper:nge,Sprite:CW,SpriteMaterial:oR,SrcAlphaFactor:xS,SrcAlphaSaturateFactor:S6,SrcColorFactor:g6,StaticCopyUsage:tce,StaticDrawUsage:h0,StaticReadUsage:Qle,StereoCamera:Ime,StreamCopyUsage:rce,StreamDrawUsage:Zle,StreamReadUsage:ece,StringKeyframeTrack:kf,SubtractEquation:h6,SubtractiveBlending:tA,TOUCH:dh,TangentSpaceNormalMap:Md,TetrahedronGeometry:n2,Texture:qr,TextureLoader:_me,TorusGeometry:r2,TorusKnotGeometry:i2,Triangle:Uo,TriangleFanDrawMode:Lle,TriangleStripDrawMode:Dle,TrianglesDrawMode:Ple,TubeGeometry:s2,UVMapping:pd,Uint16BufferAttribute:JI,Uint32BufferAttribute:eR,Uint8BufferAttribute:Fce,Uint8ClampedBufferAttribute:zce,Uniform:TR,UniformsGroup:Yme,UniformsLib:Ct,UniformsUtils:tR,UnsignedByteType:Wo,UnsignedInt248Type:Ku,UnsignedIntType:kl,UnsignedShort4444Type:BI,UnsignedShort5551Type:$I,UnsignedShortType:D_,VSMShadowMap:$a,Vector2:Ze,Vector3:ie,Vector4:vr,VectorKeyframeTrack:w0,VideoTexture:Fpe,WebGL1Renderer:_W,WebGL3DRenderTarget:Ece,WebGLArrayRenderTarget:_ce,WebGLCoordinateSystem:Il,WebGLCubeRenderTarget:nR,WebGLMultipleRenderTargets:Cce,WebGLRenderTarget:Eo,WebGLRenderer:cx,WebGLUtils:bW,WebGPUCoordinateSystem:f0,WireframeGeometry:BW,WrapAroundEnding:l0,ZeroCurvatureEnding:Ah,ZeroFactor:p6,ZeroSlopeEnding:Nh,ZeroStencilOp:Ole,_SRGBAFormat:SS,createCanvasElement:uW,sRGBEncoding:Zu},Symbol.toStringTag,{value:"Module"}));var gH={exports:{}},If={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */If.ConcurrentRoot=1;If.ContinuousEventPriority=4;If.DefaultEventPriority=16;If.DiscreteEventPriority=1;If.IdleEventPriority=536870912;If.LegacyRoot=0;gH.exports=If;var cm=gH.exports;function yge(n){let e;const t=new Set,r=(c,u)=>{const d=typeof c=="function"?c(e):c;if(d!==e){const h=e;e=u?d:Object.assign({},e,d),t.forEach(f=>f(e,h))}},i=()=>e,s=(c,u=i,d=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let h=u(e);function f(){const p=u(e);if(!d(h,p)){const x=h;c(h=p,x)}}return t.add(f),()=>t.delete(f)},l={setState:r,getState:i,subscribe:(c,u,d)=>u||d?s(c,u,d):(t.add(c),()=>t.delete(c)),destroy:()=>t.clear()};return e=n(r,i,l),l}const vge=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),LF=vge?N.useEffect:N.useLayoutEffect;function yH(n){const e=typeof n=="function"?yge(n):n,t=(r=e.getState,i=Object.is)=>{const[,s]=N.useReducer(v=>v+1,0),o=e.getState(),a=N.useRef(o),l=N.useRef(r),c=N.useRef(i),u=N.useRef(!1),d=N.useRef();d.current===void 0&&(d.current=r(o));let h,f=!1;(a.current!==o||l.current!==r||c.current!==i||u.current)&&(h=r(o),f=!i(d.current,h)),LF(()=>{f&&(d.current=h),a.current=o,l.current=r,c.current=i,u.current=!1});const p=N.useRef(o);LF(()=>{const v=()=>{try{const b=e.getState(),S=l.current(b);c.current(d.current,S)||(a.current=b,d.current=S,s())}catch{u.current=!0,s()}},y=e.subscribe(v);return e.getState()!==p.current&&v(),y},[]);const x=f?h:d.current;return N.useDebugValue(x),x};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[t,e];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},t}const xge=n=>typeof n=="object"&&typeof n.then=="function",Ph=[];function vH(n,e,t=(r,i)=>r===i){if(n===e)return!0;if(!n||!e)return!1;const r=n.length;if(e.length!==r)return!1;for(let i=0;i<r;i++)if(!t(n[i],e[i]))return!1;return!0}function xH(n,e=null,t=!1,r={}){e===null&&(e=[n]);for(const s of Ph)if(vH(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!t)throw s.promise}const i={keys:e,equal:r.equal,remove:()=>{const s=Ph.indexOf(i);s!==-1&&Ph.splice(s,1)},promise:(xge(n)?n:n(...e)).then(s=>{i.response=s,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(s=>i.error=s)};if(Ph.push(i),!t)throw i.promise}const wge=(n,e,t)=>xH(n,e,!1,t),bge=(n,e,t)=>void xH(n,e,!0,t),Sge=n=>{if(n===void 0||n.length===0)Ph.splice(0,Ph.length);else{const e=Ph.find(t=>vH(n,t.keys,t.equal));e&&e.remove()}};var wH={exports:{}},bH={exports:{}},SH={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(H,X){var oe=H.length;H.push(X);e:for(;0<oe;){var ve=oe-1>>>1,Te=H[ve];if(0<i(Te,X))H[ve]=X,H[oe]=Te,oe=ve;else break e}}function t(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var X=H[0],oe=H.pop();if(oe!==X){H[0]=oe;e:for(var ve=0,Te=H.length,Xe=Te>>>1;ve<Xe;){var _e=2*(ve+1)-1,Ue=H[_e],Fe=_e+1,Oe=H[Fe];if(0>i(Ue,oe))Fe<Te&&0>i(Oe,Ue)?(H[ve]=Oe,H[Fe]=oe,ve=Fe):(H[ve]=Ue,H[_e]=oe,ve=_e);else if(Fe<Te&&0>i(Oe,oe))H[ve]=Oe,H[Fe]=oe,ve=Fe;else break e}}return X}function i(H,X){var oe=H.sortIndex-X.sortIndex;return oe!==0?oe:H.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,x=!1,v=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(H){for(var X=t(c);X!==null;){if(X.callback===null)r(c);else if(X.startTime<=H)r(c),X.sortIndex=X.expirationTime,e(l,X);else break;X=t(c)}}function _(H){if(x=!1,S(H),!p)if(t(l)!==null)p=!0,Y(T);else{var X=t(c);X!==null&&we(_,X.startTime-H)}}function T(H,X){p=!1,x&&(x=!1,y(P),P=-1),f=!0;var oe=h;try{for(S(X),d=t(l);d!==null&&(!(d.expirationTime>X)||H&&!L());){var ve=d.callback;if(typeof ve=="function"){d.callback=null,h=d.priorityLevel;var Te=ve(d.expirationTime<=X);X=n.unstable_now(),typeof Te=="function"?d.callback=Te:d===t(l)&&r(l),S(X)}else r(l);d=t(l)}if(d!==null)var Xe=!0;else{var _e=t(c);_e!==null&&we(_,_e.startTime-X),Xe=!1}return Xe}finally{d=null,h=oe,f=!1}}var M=!1,k=null,P=-1,z=5,I=-1;function L(){return!(n.unstable_now()-I<z)}function W(){if(k!==null){var H=n.unstable_now();I=H;var X=!0;try{X=k(!0,H)}finally{X?q():(M=!1,k=null)}}else M=!1}var q;if(typeof b=="function")q=function(){b(W)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,ne=$.port2;$.port1.onmessage=W,q=function(){ne.postMessage(null)}}else q=function(){v(W,0)};function Y(H){k=H,M||(M=!0,q())}function we(H,X){P=v(function(){H(n.unstable_now())},X)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_continueExecution=function(){p||f||(p=!0,Y(T))},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(H){switch(h){case 1:case 2:case 3:var X=3;break;default:X=h}var oe=h;h=X;try{return H()}finally{h=oe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(H,X){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var oe=h;h=H;try{return X()}finally{h=oe}},n.unstable_scheduleCallback=function(H,X,oe){var ve=n.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?ve+oe:ve):oe=ve,H){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=oe+Te,H={id:u++,callback:X,priorityLevel:H,startTime:oe,expirationTime:Te,sortIndex:-1},oe>ve?(H.sortIndex=oe,e(c,H),t(l)===null&&H===t(c)&&(x?(y(P),P=-1):x=!0,we(_,oe-ve))):(H.sortIndex=Te,e(l,H),p||f||(p=!0,Y(T))),H},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(H){var X=h;return function(){var oe=h;h=X;try{return H.apply(this,arguments)}finally{h=oe}}}})(SH);bH.exports=SH;var WA=bH.exports;/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _ge=function(e){var t={},r=N,i=WA,s=Object.assign;function o(m){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+m,E=1;E<arguments.length;E++)g+="&args[]="+encodeURIComponent(arguments[E]);return"Minified React error #"+m+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),p=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),_=Symbol.for("react.offscreen"),T=Symbol.iterator;function M(m){return m===null||typeof m!="object"?null:(m=T&&m[T]||m["@@iterator"],typeof m=="function"?m:null)}function k(m){if(m==null)return null;if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case u:return"Fragment";case c:return"Portal";case h:return"Profiler";case d:return"StrictMode";case v:return"Suspense";case y:return"SuspenseList"}if(typeof m=="object")switch(m.$$typeof){case p:return(m.displayName||"Context")+".Consumer";case f:return(m._context.displayName||"Context")+".Provider";case x:var g=m.render;return m=m.displayName,m||(m=g.displayName||g.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case b:return g=m.displayName||null,g!==null?g:k(m.type)||"Memo";case S:g=m._payload,m=m._init;try{return k(m(g))}catch{}}return null}function P(m){var g=m.type;switch(m.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return m=g.render,m=m.displayName||m.name||"",g.displayName||(m!==""?"ForwardRef("+m+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return k(g);case 8:return g===d?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function z(m){var g=m,E=m;if(m.alternate)for(;g.return;)g=g.return;else{m=g;do g=m,g.flags&4098&&(E=g.return),m=g.return;while(m)}return g.tag===3?E:null}function I(m){if(z(m)!==m)throw Error(o(188))}function L(m){var g=m.alternate;if(!g){if(g=z(m),g===null)throw Error(o(188));return g!==m?null:m}for(var E=m,A=g;;){var D=E.return;if(D===null)break;var U=D.alternate;if(U===null){if(A=D.return,A!==null){E=A;continue}break}if(D.child===U.child){for(U=D.child;U;){if(U===E)return I(D),m;if(U===A)return I(D),g;U=U.sibling}throw Error(o(188))}if(E.return!==A.return)E=D,A=U;else{for(var de=!1,Ce=D.child;Ce;){if(Ce===E){de=!0,E=D,A=U;break}if(Ce===A){de=!0,A=D,E=U;break}Ce=Ce.sibling}if(!de){for(Ce=U.child;Ce;){if(Ce===E){de=!0,E=U,A=D;break}if(Ce===A){de=!0,A=U,E=D;break}Ce=Ce.sibling}if(!de)throw Error(o(189))}}if(E.alternate!==A)throw Error(o(190))}if(E.tag!==3)throw Error(o(188));return E.stateNode.current===E?m:g}function W(m){return m=L(m),m!==null?q(m):null}function q(m){if(m.tag===5||m.tag===6)return m;for(m=m.child;m!==null;){var g=q(m);if(g!==null)return g;m=m.sibling}return null}function $(m){if(m.tag===5||m.tag===6)return m;for(m=m.child;m!==null;){if(m.tag!==4){var g=$(m);if(g!==null)return g}m=m.sibling}return null}var ne=Array.isArray,Y=e.getPublicInstance,we=e.getRootHostContext,H=e.getChildHostContext,X=e.prepareForCommit,oe=e.resetAfterCommit,ve=e.createInstance,Te=e.appendInitialChild,Xe=e.finalizeInitialChildren,_e=e.prepareUpdate,Ue=e.shouldSetTextContent,Fe=e.createTextInstance,Oe=e.scheduleTimeout,nt=e.cancelTimeout,rt=e.noTimeout,ut=e.isPrimaryRenderer,Qe=e.supportsMutation,ae=e.supportsPersistence,ze=e.supportsHydration,Re=e.getInstanceFromNode,Je=e.preparePortalMount,Ge=e.getCurrentEventPriority,Et=e.detachDeletedInstance,pt=e.supportsMicrotasks,Q=e.scheduleMicrotask,G=e.supportsTestSelectors,ke=e.findFiberRoot,J=e.getBoundingRect,he=e.getTextContent,ee=e.isHiddenSubtree,Ee=e.matchAccessibilityRole,Me=e.setFocusIfFocusable,Ae=e.setupIntersectionObserver,Be=e.appendChild,dt=e.appendChildToContainer,We=e.commitTextUpdate,Kt=e.commitMount,cn=e.commitUpdate,jt=e.insertBefore,wt=e.insertInContainerBefore,Mt=e.removeChild,ye=e.removeChildFromContainer,He=e.resetTextContent,st=e.hideInstance,_t=e.hideTextInstance,Ye=e.unhideInstance,fe=e.unhideTextInstance,ot=e.clearContainer,ht=e.cloneInstance,Bt=e.createContainerChildSet,Pt=e.appendChildToContainerChildSet,xn=e.finalizeContainerChildren,Dn=e.replaceContainerChildren,ir=e.cloneHiddenInstance,wr=e.cloneHiddenTextInstance,Wn=e.canHydrateInstance,kr=e.canHydrateTextInstance,cs=e.canHydrateSuspenseInstance,bi=e.isSuspenseInstancePending,Is=e.isSuspenseInstanceFallback,Rs=e.registerSuspenseInstanceRetry,Xn=e.getNextHydratableSibling,ln=e.getFirstHydratableChild,Ra=e.getFirstHydratableChildWithinContainer,tu=e.getFirstHydratableChildWithinSuspenseInstance,j=e.hydrateInstance,Z=e.hydrateTextInstance,xe=e.hydrateSuspenseInstance,B=e.getNextHydratableInstanceAfterSuspenseInstance,re=e.commitHydratedContainer,le=e.commitHydratedSuspenseInstance,me=e.clearSuspenseBoundary,pe=e.clearSuspenseBoundaryFromContainer,Ie=e.shouldDeleteUnhydratedTailInstances,Le=e.didNotMatchHydratedContainerTextInstance,$e=e.didNotMatchHydratedTextInstance,je;function Dt(m){if(je===void 0)try{throw Error()}catch(E){var g=E.stack.trim().match(/\n( *(at )?)/);je=g&&g[1]||""}return`
`+je+m}var et=!1;function it(m,g){if(!m||et)return"";et=!0;var E=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(mt){var A=mt}Reflect.construct(m,[],g)}else{try{g.call()}catch(mt){A=mt}m.call(g.prototype)}else{try{throw Error()}catch(mt){A=mt}m()}}catch(mt){if(mt&&A&&typeof mt.stack=="string"){for(var D=mt.stack.split(`
`),U=A.stack.split(`
`),de=D.length-1,Ce=U.length-1;1<=de&&0<=Ce&&D[de]!==U[Ce];)Ce--;for(;1<=de&&0<=Ce;de--,Ce--)if(D[de]!==U[Ce]){if(de!==1||Ce!==1)do if(de--,Ce--,0>Ce||D[de]!==U[Ce]){var qe=`
`+D[de].replace(" at new "," at ");return m.displayName&&qe.includes("<anonymous>")&&(qe=qe.replace("<anonymous>",m.displayName)),qe}while(1<=de&&0<=Ce);break}}}finally{et=!1,Error.prepareStackTrace=E}return(m=m?m.displayName||m.name:"")?Dt(m):""}var At=Object.prototype.hasOwnProperty,en=[],tn=-1;function on(m){return{current:m}}function It(m){0>tn||(m.current=en[tn],en[tn]=null,tn--)}function bt(m,g){tn++,en[tn]=m.current,m.current=g}var Cn={},an=on(Cn),fn=on(!1),ur=Cn;function zr(m,g){var E=m.type.contextTypes;if(!E)return Cn;var A=m.stateNode;if(A&&A.__reactInternalMemoizedUnmaskedChildContext===g)return A.__reactInternalMemoizedMaskedChildContext;var D={},U;for(U in E)D[U]=g[U];return A&&(m=m.stateNode,m.__reactInternalMemoizedUnmaskedChildContext=g,m.__reactInternalMemoizedMaskedChildContext=D),D}function Tr(m){return m=m.childContextTypes,m!=null}function Hn(){It(fn),It(an)}function Nn(m,g,E){if(an.current!==Cn)throw Error(o(168));bt(an,g),bt(fn,E)}function $n(m,g,E){var A=m.stateNode;if(g=g.childContextTypes,typeof A.getChildContext!="function")return E;A=A.getChildContext();for(var D in A)if(!(D in g))throw Error(o(108,P(m)||"Unknown",D));return s({},E,A)}function bn(m){return m=(m=m.stateNode)&&m.__reactInternalMemoizedMergedChildContext||Cn,ur=an.current,bt(an,m),bt(fn,fn.current),!0}function Un(m,g,E){var A=m.stateNode;if(!A)throw Error(o(169));E?(m=$n(m,g,ur),A.__reactInternalMemoizedMergedChildContext=m,It(fn),It(an),bt(an,m)):It(fn),bt(fn,E)}var dr=Math.clz32?Math.clz32:na,Ps=Math.log,Vi=Math.LN2;function na(m){return m>>>=0,m===0?32:31-(Ps(m)/Vi|0)|0}var Uf=64,Od=4194304;function nu(m){switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return m&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return m}}function rc(m,g){var E=m.pendingLanes;if(E===0)return 0;var A=0,D=m.suspendedLanes,U=m.pingedLanes,de=E&268435455;if(de!==0){var Ce=de&~D;Ce!==0?A=nu(Ce):(U&=de,U!==0&&(A=nu(U)))}else de=E&~D,de!==0?A=nu(de):U!==0&&(A=nu(U));if(A===0)return 0;if(g!==0&&g!==A&&!(g&D)&&(D=A&-A,U=g&-g,D>=U||D===16&&(U&4194240)!==0))return g;if(A&4&&(A|=E&16),g=m.entangledLanes,g!==0)for(m=m.entanglements,g&=A;0<g;)E=31-dr(g),D=1<<E,A|=m[E],g&=~D;return A}function Cx(m,g){switch(m){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tx(m,g){for(var E=m.suspendedLanes,A=m.pingedLanes,D=m.expirationTimes,U=m.pendingLanes;0<U;){var de=31-dr(U),Ce=1<<de,qe=D[de];qe===-1?(!(Ce&E)||Ce&A)&&(D[de]=Cx(Ce,g)):qe<=g&&(m.expiredLanes|=Ce),U&=~Ce}}function ic(m){return m=m.pendingLanes&-1073741825,m!==0?m:m&1073741824?1073741824:0}function Fg(m){for(var g=[],E=0;31>E;E++)g.push(m);return g}function Fd(m,g,E){m.pendingLanes|=g,g!==536870912&&(m.suspendedLanes=0,m.pingedLanes=0),m=m.eventTimes,g=31-dr(g),m[g]=E}function R2(m,g){var E=m.pendingLanes&~g;m.pendingLanes=g,m.suspendedLanes=0,m.pingedLanes=0,m.expiredLanes&=g,m.mutableReadLanes&=g,m.entangledLanes&=g,g=m.entanglements;var A=m.eventTimes;for(m=m.expirationTimes;0<E;){var D=31-dr(E),U=1<<D;g[D]=0,A[D]=-1,m[D]=-1,E&=~U}}function zg(m,g){var E=m.entangledLanes|=g;for(m=m.entanglements;E;){var A=31-dr(E),D=1<<A;D&g|m[A]&g&&(m[A]|=g),E&=~D}}var Kn=0;function ru(m){return m&=-m,1<m?4<m?m&268435455?16:536870912:4:1}var Ug=i.unstable_scheduleCallback,Mx=i.unstable_cancelCallback,P2=i.unstable_shouldYield,D2=i.unstable_requestPaint,ai=i.unstable_now,Bf=i.unstable_ImmediatePriority,Ax=i.unstable_UserBlockingPriority,sc=i.unstable_NormalPriority,Mo=i.unstable_IdlePriority,$f=null,ra=null;function Nx(m){if(ra&&typeof ra.onCommitFiberRoot=="function")try{ra.onCommitFiberRoot($f,m,void 0,(m.current.flags&128)===128)}catch{}}function kx(m,g){return m===g&&(m!==0||1/m===1/g)||m!==m&&g!==g}var so=typeof Object.is=="function"?Object.is:kx,Ao=null,Pa=!1,jf=!1;function Vf(m){Ao===null?Ao=[m]:Ao.push(m)}function L2(m){Pa=!0,Vf(m)}function ia(){if(!jf&&Ao!==null){jf=!0;var m=0,g=Kn;try{var E=Ao;for(Kn=1;m<E.length;m++){var A=E[m];do A=A(!0);while(A!==null)}Ao=null,Pa=!1}catch(D){throw Ao!==null&&(Ao=Ao.slice(m+1)),Ug(Bf,ia),D}finally{Kn=g,jf=!1}}return null}var zd=a.ReactCurrentBatchConfig;function Ud(m,g){if(so(m,g))return!0;if(typeof m!="object"||m===null||typeof g!="object"||g===null)return!1;var E=Object.keys(m),A=Object.keys(g);if(E.length!==A.length)return!1;for(A=0;A<E.length;A++){var D=E[A];if(!At.call(g,D)||!so(m[D],g[D]))return!1}return!0}function Ix(m){switch(m.tag){case 5:return Dt(m.type);case 16:return Dt("Lazy");case 13:return Dt("Suspense");case 19:return Dt("SuspenseList");case 0:case 2:case 15:return m=it(m.type,!1),m;case 11:return m=it(m.type.render,!1),m;case 1:return m=it(m.type,!0),m;default:return""}}function No(m,g){if(m&&m.defaultProps){g=s({},g),m=m.defaultProps;for(var E in m)g[E]===void 0&&(g[E]=m[E]);return g}return g}var Wf=on(null),oc=null,ac=null,Bg=null;function Hf(){Bg=ac=oc=null}function Rx(m,g,E){ut?(bt(Wf,g._currentValue),g._currentValue=E):(bt(Wf,g._currentValue2),g._currentValue2=E)}function $g(m){var g=Wf.current;It(Wf),ut?m._currentValue=g:m._currentValue2=g}function Bd(m,g,E){for(;m!==null;){var A=m.alternate;if((m.childLanes&g)!==g?(m.childLanes|=g,A!==null&&(A.childLanes|=g)):A!==null&&(A.childLanes&g)!==g&&(A.childLanes|=g),m===E)break;m=m.return}}function fl(m,g){oc=m,Bg=ac=null,m=m.dependencies,m!==null&&m.firstContext!==null&&(m.lanes&g&&(ko=!0),m.firstContext=null)}function Ds(m){var g=ut?m._currentValue:m._currentValue2;if(Bg!==m)if(m={context:m,memoizedValue:g,next:null},ac===null){if(oc===null)throw Error(o(308));ac=m,oc.dependencies={lanes:0,firstContext:m}}else ac=ac.next=m;return g}var sa=null,pl=!1;function jg(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Px(m,g){m=m.updateQueue,g.updateQueue===m&&(g.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,effects:m.effects})}function oa(m,g){return{eventTime:m,lane:g,tag:0,payload:null,callback:null,next:null}}function ml(m,g){var E=m.updateQueue;E!==null&&(E=E.shared,Ei!==null&&m.mode&1&&!(Bn&2)?(m=E.interleaved,m===null?(g.next=g,sa===null?sa=[E]:sa.push(E)):(g.next=m.next,m.next=g),E.interleaved=g):(m=E.pending,m===null?g.next=g:(g.next=m.next,m.next=g),E.pending=g))}function Gf(m,g,E){if(g=g.updateQueue,g!==null&&(g=g.shared,(E&4194240)!==0)){var A=g.lanes;A&=m.pendingLanes,E|=A,g.lanes=E,zg(m,E)}}function qf(m,g){var E=m.updateQueue,A=m.alternate;if(A!==null&&(A=A.updateQueue,E===A)){var D=null,U=null;if(E=E.firstBaseUpdate,E!==null){do{var de={eventTime:E.eventTime,lane:E.lane,tag:E.tag,payload:E.payload,callback:E.callback,next:null};U===null?D=U=de:U=U.next=de,E=E.next}while(E!==null);U===null?D=U=g:U=U.next=g}else D=U=g;E={baseState:A.baseState,firstBaseUpdate:D,lastBaseUpdate:U,shared:A.shared,effects:A.effects},m.updateQueue=E;return}m=E.lastBaseUpdate,m===null?E.firstBaseUpdate=g:m.next=g,E.lastBaseUpdate=g}function Xf(m,g,E,A){var D=m.updateQueue;pl=!1;var U=D.firstBaseUpdate,de=D.lastBaseUpdate,Ce=D.shared.pending;if(Ce!==null){D.shared.pending=null;var qe=Ce,mt=qe.next;qe.next=null,de===null?U=mt:de.next=mt,de=qe;var Wt=m.alternate;Wt!==null&&(Wt=Wt.updateQueue,Ce=Wt.lastBaseUpdate,Ce!==de&&(Ce===null?Wt.firstBaseUpdate=mt:Ce.next=mt,Wt.lastBaseUpdate=qe))}if(U!==null){var _n=D.baseState;de=0,Wt=mt=qe=null,Ce=U;do{var dn=Ce.lane,Mr=Ce.eventTime;if((A&dn)===dn){Wt!==null&&(Wt=Wt.next={eventTime:Mr,lane:0,tag:Ce.tag,payload:Ce.payload,callback:Ce.callback,next:null});e:{var sn=m,fs=Ce;switch(dn=g,Mr=E,fs.tag){case 1:if(sn=fs.payload,typeof sn=="function"){_n=sn.call(Mr,_n,dn);break e}_n=sn;break e;case 3:sn.flags=sn.flags&-65537|128;case 0:if(sn=fs.payload,dn=typeof sn=="function"?sn.call(Mr,_n,dn):sn,dn==null)break e;_n=s({},_n,dn);break e;case 2:pl=!0}}Ce.callback!==null&&Ce.lane!==0&&(m.flags|=64,dn=D.effects,dn===null?D.effects=[Ce]:dn.push(Ce))}else Mr={eventTime:Mr,lane:dn,tag:Ce.tag,payload:Ce.payload,callback:Ce.callback,next:null},Wt===null?(mt=Wt=Mr,qe=_n):Wt=Wt.next=Mr,de|=dn;if(Ce=Ce.next,Ce===null){if(Ce=D.shared.pending,Ce===null)break;dn=Ce,Ce=dn.next,dn.next=null,D.lastBaseUpdate=dn,D.shared.pending=null}}while(!0);if(Wt===null&&(qe=_n),D.baseState=qe,D.firstBaseUpdate=mt,D.lastBaseUpdate=Wt,g=D.shared.interleaved,g!==null){D=g;do de|=D.lane,D=D.next;while(D!==g)}else U===null&&(D.shared.lanes=0);rp|=de,m.lanes=de,m.memoizedState=_n}}function Dx(m,g,E){if(m=g.effects,g.effects=null,m!==null)for(g=0;g<m.length;g++){var A=m[g],D=A.callback;if(D!==null){if(A.callback=null,A=E,typeof D!="function")throw Error(o(191,D));D.call(A)}}}var Lx=new r.Component().refs;function iu(m,g,E,A){g=m.memoizedState,E=E(A,g),E=E==null?g:s({},g,E),m.memoizedState=E,m.lanes===0&&(m.updateQueue.baseState=E)}var Kf={isMounted:function(m){return(m=m._reactInternals)?z(m)===m:!1},enqueueSetState:function(m,g,E){m=m._reactInternals;var A=Fs(),D=lu(m),U=oa(A,D);U.payload=g,E!=null&&(U.callback=E),ml(m,U),g=ca(m,D,A),g!==null&&Gf(g,m,D)},enqueueReplaceState:function(m,g,E){m=m._reactInternals;var A=Fs(),D=lu(m),U=oa(A,D);U.tag=1,U.payload=g,E!=null&&(U.callback=E),ml(m,U),g=ca(m,D,A),g!==null&&Gf(g,m,D)},enqueueForceUpdate:function(m,g){m=m._reactInternals;var E=Fs(),A=lu(m),D=oa(E,A);D.tag=2,g!=null&&(D.callback=g),ml(m,D),g=ca(m,A,E),g!==null&&Gf(g,m,A)}};function Ox(m,g,E,A,D,U,de){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(A,U,de):g.prototype&&g.prototype.isPureReactComponent?!Ud(E,A)||!Ud(D,U):!0}function Fx(m,g,E){var A=!1,D=Cn,U=g.contextType;return typeof U=="object"&&U!==null?U=Ds(U):(D=Tr(g)?ur:an.current,A=g.contextTypes,U=(A=A!=null)?zr(m,D):Cn),g=new g(E,U),m.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Kf,m.stateNode=g,g._reactInternals=m,A&&(m=m.stateNode,m.__reactInternalMemoizedUnmaskedChildContext=D,m.__reactInternalMemoizedMaskedChildContext=U),g}function Vg(m,g,E,A){m=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(E,A),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(E,A),g.state!==m&&Kf.enqueueReplaceState(g,g.state,null)}function Yf(m,g,E,A){var D=m.stateNode;D.props=E,D.state=m.memoizedState,D.refs=Lx,jg(m);var U=g.contextType;typeof U=="object"&&U!==null?D.context=Ds(U):(U=Tr(g)?ur:an.current,D.context=zr(m,U)),D.state=m.memoizedState,U=g.getDerivedStateFromProps,typeof U=="function"&&(iu(m,g,U,E),D.state=m.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(g=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),g!==D.state&&Kf.enqueueReplaceState(D,D.state,null),Xf(m,E,D,A),D.state=m.memoizedState),typeof D.componentDidMount=="function"&&(m.flags|=4194308)}var C=[],R=0,F=null,V=0,se=[],ue=0,ce=null,Se=1,Pe="";function tt(m,g){C[R++]=V,C[R++]=F,F=m,V=g}function St(m,g,E){se[ue++]=Se,se[ue++]=Pe,se[ue++]=ce,ce=m;var A=Se;m=Pe;var D=32-dr(A)-1;A&=~(1<<D),E+=1;var U=32-dr(g)+D;if(30<U){var de=D-D%5;U=(A&(1<<de)-1).toString(32),A>>=de,D-=de,Se=1<<32-dr(g)+D|E<<D|A,Pe=U+m}else Se=1<<U|E<<D|A,Pe=m}function un(m){m.return!==null&&(tt(m,1),St(m,1,0))}function Zt(m){for(;m===F;)F=C[--R],C[R]=null,V=C[--R],C[R]=null;for(;m===ce;)ce=se[--ue],se[ue]=null,Pe=se[--ue],se[ue]=null,Se=se[--ue],se[ue]=null}var yt=null,Yt=null,Gt=!1,hr=!1,jn=null;function Si(m,g){var E=ua(5,null,null,0);E.elementType="DELETED",E.stateNode=g,E.return=m,g=m.deletions,g===null?(m.deletions=[E],m.flags|=16):g.push(E)}function Ls(m,g){switch(m.tag){case 5:return g=Wn(g,m.type,m.pendingProps),g!==null?(m.stateNode=g,yt=m,Yt=ln(g),!0):!1;case 6:return g=kr(g,m.pendingProps),g!==null?(m.stateNode=g,yt=m,Yt=null,!0):!1;case 13:if(g=cs(g),g!==null){var E=ce!==null?{id:Se,overflow:Pe}:null;return m.memoizedState={dehydrated:g,treeContext:E,retryLane:1073741824},E=ua(18,null,null,0),E.stateNode=g,E.return=m,m.child=E,yt=m,Yt=null,!0}return!1;default:return!1}}function Wi(m){return(m.mode&1)!==0&&(m.flags&128)===0}function Yn(m){if(Gt){var g=Yt;if(g){var E=g;if(!Ls(m,g)){if(Wi(m))throw Error(o(418));g=Xn(E);var A=yt;g&&Ls(m,g)?Si(A,E):(m.flags=m.flags&-4097|2,Gt=!1,yt=m)}}else{if(Wi(m))throw Error(o(418));m.flags=m.flags&-4097|2,Gt=!1,yt=m}}}function _i(m){for(m=m.return;m!==null&&m.tag!==5&&m.tag!==3&&m.tag!==13;)m=m.return;yt=m}function oo(m){if(!ze||m!==yt)return!1;if(!Gt)return _i(m),Gt=!0,!1;if(m.tag!==3&&(m.tag!==5||Ie(m.type)&&!Ue(m.type,m.memoizedProps))){var g=Yt;if(g){if(Wi(m)){for(m=Yt;m;)m=Xn(m);throw Error(o(418))}for(;g;)Si(m,g),g=Xn(g)}}if(_i(m),m.tag===13){if(!ze)throw Error(o(316));if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(o(317));Yt=B(m)}else Yt=yt?Xn(m.stateNode):null;return!0}function su(){ze&&(Yt=yt=null,hr=Gt=!1)}function Wg(m){jn===null?jn=[m]:jn.push(m)}function $d(m,g,E){if(m=E.ref,m!==null&&typeof m!="function"&&typeof m!="object"){if(E._owner){if(E=E._owner,E){if(E.tag!==1)throw Error(o(309));var A=E.stateNode}if(!A)throw Error(o(147,m));var D=A,U=""+m;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===U?g.ref:(g=function(de){var Ce=D.refs;Ce===Lx&&(Ce=D.refs={}),de===null?delete Ce[U]:Ce[U]=de},g._stringRef=U,g)}if(typeof m!="string")throw Error(o(284));if(!E._owner)throw Error(o(290,m))}return m}function Zf(m,g){throw m=Object.prototype.toString.call(g),Error(o(31,m==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":m))}function zx(m){var g=m._init;return g(m._payload)}function jd(m){function g(De,Ne){if(m){var Ve=De.deletions;Ve===null?(De.deletions=[Ne],De.flags|=16):Ve.push(Ne)}}function E(De,Ne){if(!m)return null;for(;Ne!==null;)g(De,Ne),Ne=Ne.sibling;return null}function A(De,Ne){for(De=new Map;Ne!==null;)Ne.key!==null?De.set(Ne.key,Ne):De.set(Ne.index,Ne),Ne=Ne.sibling;return De}function D(De,Ne){return De=uu(De,Ne),De.index=0,De.sibling=null,De}function U(De,Ne,Ve){return De.index=Ve,m?(Ve=De.alternate,Ve!==null?(Ve=Ve.index,Ve<Ne?(De.flags|=2,Ne):Ve):(De.flags|=2,Ne)):(De.flags|=1048576,Ne)}function de(De){return m&&De.alternate===null&&(De.flags|=2),De}function Ce(De,Ne,Ve,Lt){return Ne===null||Ne.tag!==6?(Ne=vE(Ve,De.mode,Lt),Ne.return=De,Ne):(Ne=D(Ne,Ve),Ne.return=De,Ne)}function qe(De,Ne,Ve,Lt){var nn=Ve.type;return nn===u?Wt(De,Ne,Ve.props.children,Lt,Ve.key):Ne!==null&&(Ne.elementType===nn||typeof nn=="object"&&nn!==null&&nn.$$typeof===S&&zx(nn)===Ne.type)?(Lt=D(Ne,Ve.props),Lt.ref=$d(De,Ne,Ve),Lt.return=De,Lt):(Lt=mw(Ve.type,Ve.key,Ve.props,null,De.mode,Lt),Lt.ref=$d(De,Ne,Ve),Lt.return=De,Lt)}function mt(De,Ne,Ve,Lt){return Ne===null||Ne.tag!==4||Ne.stateNode.containerInfo!==Ve.containerInfo||Ne.stateNode.implementation!==Ve.implementation?(Ne=xE(Ve,De.mode,Lt),Ne.return=De,Ne):(Ne=D(Ne,Ve.children||[]),Ne.return=De,Ne)}function Wt(De,Ne,Ve,Lt,nn){return Ne===null||Ne.tag!==7?(Ne=Kd(Ve,De.mode,Lt,nn),Ne.return=De,Ne):(Ne=D(Ne,Ve),Ne.return=De,Ne)}function _n(De,Ne,Ve){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number")return Ne=vE(""+Ne,De.mode,Ve),Ne.return=De,Ne;if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case l:return Ve=mw(Ne.type,Ne.key,Ne.props,null,De.mode,Ve),Ve.ref=$d(De,null,Ne),Ve.return=De,Ve;case c:return Ne=xE(Ne,De.mode,Ve),Ne.return=De,Ne;case S:var Lt=Ne._init;return _n(De,Lt(Ne._payload),Ve)}if(ne(Ne)||M(Ne))return Ne=Kd(Ne,De.mode,Ve,null),Ne.return=De,Ne;Zf(De,Ne)}return null}function dn(De,Ne,Ve,Lt){var nn=Ne!==null?Ne.key:null;if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number")return nn!==null?null:Ce(De,Ne,""+Ve,Lt);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case l:return Ve.key===nn?qe(De,Ne,Ve,Lt):null;case c:return Ve.key===nn?mt(De,Ne,Ve,Lt):null;case S:return nn=Ve._init,dn(De,Ne,nn(Ve._payload),Lt)}if(ne(Ve)||M(Ve))return nn!==null?null:Wt(De,Ne,Ve,Lt,null);Zf(De,Ve)}return null}function Mr(De,Ne,Ve,Lt,nn){if(typeof Lt=="string"&&Lt!==""||typeof Lt=="number")return De=De.get(Ve)||null,Ce(Ne,De,""+Lt,nn);if(typeof Lt=="object"&&Lt!==null){switch(Lt.$$typeof){case l:return De=De.get(Lt.key===null?Ve:Lt.key)||null,qe(Ne,De,Lt,nn);case c:return De=De.get(Lt.key===null?Ve:Lt.key)||null,mt(Ne,De,Lt,nn);case S:var Ln=Lt._init;return Mr(De,Ne,Ve,Ln(Lt._payload),nn)}if(ne(Lt)||M(Lt))return De=De.get(Ve)||null,Wt(Ne,De,Lt,nn,null);Zf(Ne,Lt)}return null}function sn(De,Ne,Ve,Lt){for(var nn=null,Ln=null,En=Ne,ar=Ne=0,Gi=null;En!==null&&ar<Ve.length;ar++){En.index>ar?(Gi=En,En=null):Gi=En.sibling;var lr=dn(De,En,Ve[ar],Lt);if(lr===null){En===null&&(En=Gi);break}m&&En&&lr.alternate===null&&g(De,En),Ne=U(lr,Ne,ar),Ln===null?nn=lr:Ln.sibling=lr,Ln=lr,En=Gi}if(ar===Ve.length)return E(De,En),Gt&&tt(De,ar),nn;if(En===null){for(;ar<Ve.length;ar++)En=_n(De,Ve[ar],Lt),En!==null&&(Ne=U(En,Ne,ar),Ln===null?nn=En:Ln.sibling=En,Ln=En);return Gt&&tt(De,ar),nn}for(En=A(De,En);ar<Ve.length;ar++)Gi=Mr(En,De,ar,Ve[ar],Lt),Gi!==null&&(m&&Gi.alternate!==null&&En.delete(Gi.key===null?ar:Gi.key),Ne=U(Gi,Ne,ar),Ln===null?nn=Gi:Ln.sibling=Gi,Ln=Gi);return m&&En.forEach(function(du){return g(De,du)}),Gt&&tt(De,ar),nn}function fs(De,Ne,Ve,Lt){var nn=M(Ve);if(typeof nn!="function")throw Error(o(150));if(Ve=nn.call(Ve),Ve==null)throw Error(o(151));for(var Ln=nn=null,En=Ne,ar=Ne=0,Gi=null,lr=Ve.next();En!==null&&!lr.done;ar++,lr=Ve.next()){En.index>ar?(Gi=En,En=null):Gi=En.sibling;var du=dn(De,En,lr.value,Lt);if(du===null){En===null&&(En=Gi);break}m&&En&&du.alternate===null&&g(De,En),Ne=U(du,Ne,ar),Ln===null?nn=du:Ln.sibling=du,Ln=du,En=Gi}if(lr.done)return E(De,En),Gt&&tt(De,ar),nn;if(En===null){for(;!lr.done;ar++,lr=Ve.next())lr=_n(De,lr.value,Lt),lr!==null&&(Ne=U(lr,Ne,ar),Ln===null?nn=lr:Ln.sibling=lr,Ln=lr);return Gt&&tt(De,ar),nn}for(En=A(De,En);!lr.done;ar++,lr=Ve.next())lr=Mr(En,De,ar,lr.value,Lt),lr!==null&&(m&&lr.alternate!==null&&En.delete(lr.key===null?ar:lr.key),Ne=U(lr,Ne,ar),Ln===null?nn=lr:Ln.sibling=lr,Ln=lr);return m&&En.forEach(function(sY){return g(De,sY)}),Gt&&tt(De,ar),nn}function da(De,Ne,Ve,Lt){if(typeof Ve=="object"&&Ve!==null&&Ve.type===u&&Ve.key===null&&(Ve=Ve.props.children),typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case l:e:{for(var nn=Ve.key,Ln=Ne;Ln!==null;){if(Ln.key===nn){if(nn=Ve.type,nn===u){if(Ln.tag===7){E(De,Ln.sibling),Ne=D(Ln,Ve.props.children),Ne.return=De,De=Ne;break e}}else if(Ln.elementType===nn||typeof nn=="object"&&nn!==null&&nn.$$typeof===S&&zx(nn)===Ln.type){E(De,Ln.sibling),Ne=D(Ln,Ve.props),Ne.ref=$d(De,Ln,Ve),Ne.return=De,De=Ne;break e}E(De,Ln);break}else g(De,Ln);Ln=Ln.sibling}Ve.type===u?(Ne=Kd(Ve.props.children,De.mode,Lt,Ve.key),Ne.return=De,De=Ne):(Lt=mw(Ve.type,Ve.key,Ve.props,null,De.mode,Lt),Lt.ref=$d(De,Ne,Ve),Lt.return=De,De=Lt)}return de(De);case c:e:{for(Ln=Ve.key;Ne!==null;){if(Ne.key===Ln)if(Ne.tag===4&&Ne.stateNode.containerInfo===Ve.containerInfo&&Ne.stateNode.implementation===Ve.implementation){E(De,Ne.sibling),Ne=D(Ne,Ve.children||[]),Ne.return=De,De=Ne;break e}else{E(De,Ne);break}else g(De,Ne);Ne=Ne.sibling}Ne=xE(Ve,De.mode,Lt),Ne.return=De,De=Ne}return de(De);case S:return Ln=Ve._init,da(De,Ne,Ln(Ve._payload),Lt)}if(ne(Ve))return sn(De,Ne,Ve,Lt);if(M(Ve))return fs(De,Ne,Ve,Lt);Zf(De,Ve)}return typeof Ve=="string"&&Ve!==""||typeof Ve=="number"?(Ve=""+Ve,Ne!==null&&Ne.tag===6?(E(De,Ne.sibling),Ne=D(Ne,Ve),Ne.return=De,De=Ne):(E(De,Ne),Ne=vE(Ve,De.mode,Lt),Ne.return=De,De=Ne),de(De)):E(De,Ne)}return da}var Qf=jd(!0),R3=jd(!1),Hg={},aa=on(Hg),Gg=on(Hg),Jf=on(Hg);function gl(m){if(m===Hg)throw Error(o(174));return m}function O2(m,g){bt(Jf,g),bt(Gg,m),bt(aa,Hg),m=we(g),It(aa),bt(aa,m)}function ep(){It(aa),It(Gg),It(Jf)}function P3(m){var g=gl(Jf.current),E=gl(aa.current);g=H(E,m.type,g),E!==g&&(bt(Gg,m),bt(aa,g))}function F2(m){Gg.current===m&&(It(aa),It(Gg))}var Kr=on(0);function Ux(m){for(var g=m;g!==null;){if(g.tag===13){var E=g.memoizedState;if(E!==null&&(E=E.dehydrated,E===null||bi(E)||Is(E)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if(g.flags&128)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===m)break;for(;g.sibling===null;){if(g.return===null||g.return===m)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var z2=[];function U2(){for(var m=0;m<z2.length;m++){var g=z2[m];ut?g._workInProgressVersionPrimary=null:g._workInProgressVersionSecondary=null}z2.length=0}var Bx=a.ReactCurrentDispatcher,la=a.ReactCurrentBatchConfig,tp=0,li=null,us=null,Hi=null,$x=!1,qg=!1,Xg=0,kK=0;function ds(){throw Error(o(321))}function B2(m,g){if(g===null)return!1;for(var E=0;E<g.length&&E<m.length;E++)if(!so(m[E],g[E]))return!1;return!0}function $2(m,g,E,A,D,U){if(tp=U,li=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Bx.current=m===null||m.memoizedState===null?DK:LK,m=E(A,D),qg){U=0;do{if(qg=!1,Xg=0,25<=U)throw Error(o(301));U+=1,Hi=us=null,g.updateQueue=null,Bx.current=OK,m=E(A,D)}while(qg)}if(Bx.current=Gx,g=us!==null&&us.next!==null,tp=0,Hi=us=li=null,$x=!1,g)throw Error(o(300));return m}function j2(){var m=Xg!==0;return Xg=0,m}function lc(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hi===null?li.memoizedState=Hi=m:Hi=Hi.next=m,Hi}function yl(){if(us===null){var m=li.alternate;m=m!==null?m.memoizedState:null}else m=us.next;var g=Hi===null?li.memoizedState:Hi.next;if(g!==null)Hi=g,us=m;else{if(m===null)throw Error(o(310));us=m,m={memoizedState:us.memoizedState,baseState:us.baseState,baseQueue:us.baseQueue,queue:us.queue,next:null},Hi===null?li.memoizedState=Hi=m:Hi=Hi.next=m}return Hi}function Vd(m,g){return typeof g=="function"?g(m):g}function jx(m){var g=yl(),E=g.queue;if(E===null)throw Error(o(311));E.lastRenderedReducer=m;var A=us,D=A.baseQueue,U=E.pending;if(U!==null){if(D!==null){var de=D.next;D.next=U.next,U.next=de}A.baseQueue=D=U,E.pending=null}if(D!==null){U=D.next,A=A.baseState;var Ce=de=null,qe=null,mt=U;do{var Wt=mt.lane;if((tp&Wt)===Wt)qe!==null&&(qe=qe.next={lane:0,action:mt.action,hasEagerState:mt.hasEagerState,eagerState:mt.eagerState,next:null}),A=mt.hasEagerState?mt.eagerState:m(A,mt.action);else{var _n={lane:Wt,action:mt.action,hasEagerState:mt.hasEagerState,eagerState:mt.eagerState,next:null};qe===null?(Ce=qe=_n,de=A):qe=qe.next=_n,li.lanes|=Wt,rp|=Wt}mt=mt.next}while(mt!==null&&mt!==U);qe===null?de=A:qe.next=Ce,so(A,g.memoizedState)||(ko=!0),g.memoizedState=A,g.baseState=de,g.baseQueue=qe,E.lastRenderedState=A}if(m=E.interleaved,m!==null){D=m;do U=D.lane,li.lanes|=U,rp|=U,D=D.next;while(D!==m)}else D===null&&(E.lanes=0);return[g.memoizedState,E.dispatch]}function Vx(m){var g=yl(),E=g.queue;if(E===null)throw Error(o(311));E.lastRenderedReducer=m;var A=E.dispatch,D=E.pending,U=g.memoizedState;if(D!==null){E.pending=null;var de=D=D.next;do U=m(U,de.action),de=de.next;while(de!==D);so(U,g.memoizedState)||(ko=!0),g.memoizedState=U,g.baseQueue===null&&(g.baseState=U),E.lastRenderedState=U}return[U,A]}function D3(){}function L3(m,g){var E=li,A=yl(),D=g(),U=!so(A.memoizedState,D);if(U&&(A.memoizedState=D,ko=!0),A=A.queue,Yg(z3.bind(null,E,A,m),[m]),A.getSnapshot!==g||U||Hi!==null&&Hi.memoizedState.tag&1){if(E.flags|=2048,Kg(9,F3.bind(null,E,A,D,g),void 0,null),Ei===null)throw Error(o(349));tp&30||O3(E,g,D)}return D}function O3(m,g,E){m.flags|=16384,m={getSnapshot:g,value:E},g=li.updateQueue,g===null?(g={lastEffect:null,stores:null},li.updateQueue=g,g.stores=[m]):(E=g.stores,E===null?g.stores=[m]:E.push(m))}function F3(m,g,E,A){g.value=E,g.getSnapshot=A,U3(g)&&ca(m,1,-1)}function z3(m,g,E){return E(function(){U3(g)&&ca(m,1,-1)})}function U3(m){var g=m.getSnapshot;m=m.value;try{var E=g();return!so(m,E)}catch{return!0}}function V2(m){var g=lc();return typeof m=="function"&&(m=m()),g.memoizedState=g.baseState=m,m={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vd,lastRenderedState:m},g.queue=m,m=m.dispatch=PK.bind(null,li,m),[g.memoizedState,m]}function Kg(m,g,E,A){return m={tag:m,create:g,destroy:E,deps:A,next:null},g=li.updateQueue,g===null?(g={lastEffect:null,stores:null},li.updateQueue=g,g.lastEffect=m.next=m):(E=g.lastEffect,E===null?g.lastEffect=m.next=m:(A=E.next,E.next=m,m.next=A,g.lastEffect=m)),m}function B3(){return yl().memoizedState}function Wx(m,g,E,A){var D=lc();li.flags|=m,D.memoizedState=Kg(1|g,E,void 0,A===void 0?null:A)}function Hx(m,g,E,A){var D=yl();A=A===void 0?null:A;var U=void 0;if(us!==null){var de=us.memoizedState;if(U=de.destroy,A!==null&&B2(A,de.deps)){D.memoizedState=Kg(g,E,U,A);return}}li.flags|=m,D.memoizedState=Kg(1|g,E,U,A)}function W2(m,g){return Wx(8390656,8,m,g)}function Yg(m,g){return Hx(2048,8,m,g)}function $3(m,g){return Hx(4,2,m,g)}function j3(m,g){return Hx(4,4,m,g)}function V3(m,g){if(typeof g=="function")return m=m(),g(m),function(){g(null)};if(g!=null)return m=m(),g.current=m,function(){g.current=null}}function W3(m,g,E){return E=E!=null?E.concat([m]):null,Hx(4,4,V3.bind(null,g,m),E)}function H2(){}function H3(m,g){var E=yl();g=g===void 0?null:g;var A=E.memoizedState;return A!==null&&g!==null&&B2(g,A[1])?A[0]:(E.memoizedState=[m,g],m)}function G3(m,g){var E=yl();g=g===void 0?null:g;var A=E.memoizedState;return A!==null&&g!==null&&B2(g,A[1])?A[0]:(m=m(),E.memoizedState=[m,g],m)}function IK(m,g){var E=Kn;Kn=E!==0&&4>E?E:4,m(!0);var A=la.transition;la.transition={};try{m(!1),g()}finally{Kn=E,la.transition=A}}function q3(){return yl().memoizedState}function RK(m,g,E){var A=lu(m);E={lane:A,action:E,hasEagerState:!1,eagerState:null,next:null},X3(m)?K3(g,E):(Y3(m,g,E),E=Fs(),m=ca(m,A,E),m!==null&&Z3(m,g,A))}function PK(m,g,E){var A=lu(m),D={lane:A,action:E,hasEagerState:!1,eagerState:null,next:null};if(X3(m))K3(g,D);else{Y3(m,g,D);var U=m.alternate;if(m.lanes===0&&(U===null||U.lanes===0)&&(U=g.lastRenderedReducer,U!==null))try{var de=g.lastRenderedState,Ce=U(de,E);if(D.hasEagerState=!0,D.eagerState=Ce,so(Ce,de))return}catch{}finally{}E=Fs(),m=ca(m,A,E),m!==null&&Z3(m,g,A)}}function X3(m){var g=m.alternate;return m===li||g!==null&&g===li}function K3(m,g){qg=$x=!0;var E=m.pending;E===null?g.next=g:(g.next=E.next,E.next=g),m.pending=g}function Y3(m,g,E){Ei!==null&&m.mode&1&&!(Bn&2)?(m=g.interleaved,m===null?(E.next=E,sa===null?sa=[g]:sa.push(g)):(E.next=m.next,m.next=E),g.interleaved=E):(m=g.pending,m===null?E.next=E:(E.next=m.next,m.next=E),g.pending=E)}function Z3(m,g,E){if(E&4194240){var A=g.lanes;A&=m.pendingLanes,E|=A,g.lanes=E,zg(m,E)}}var Gx={readContext:Ds,useCallback:ds,useContext:ds,useEffect:ds,useImperativeHandle:ds,useInsertionEffect:ds,useLayoutEffect:ds,useMemo:ds,useReducer:ds,useRef:ds,useState:ds,useDebugValue:ds,useDeferredValue:ds,useTransition:ds,useMutableSource:ds,useSyncExternalStore:ds,useId:ds,unstable_isNewReconciler:!1},DK={readContext:Ds,useCallback:function(m,g){return lc().memoizedState=[m,g===void 0?null:g],m},useContext:Ds,useEffect:W2,useImperativeHandle:function(m,g,E){return E=E!=null?E.concat([m]):null,Wx(4194308,4,V3.bind(null,g,m),E)},useLayoutEffect:function(m,g){return Wx(4194308,4,m,g)},useInsertionEffect:function(m,g){return Wx(4,2,m,g)},useMemo:function(m,g){var E=lc();return g=g===void 0?null:g,m=m(),E.memoizedState=[m,g],m},useReducer:function(m,g,E){var A=lc();return g=E!==void 0?E(g):g,A.memoizedState=A.baseState=g,m={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:g},A.queue=m,m=m.dispatch=RK.bind(null,li,m),[A.memoizedState,m]},useRef:function(m){var g=lc();return m={current:m},g.memoizedState=m},useState:V2,useDebugValue:H2,useDeferredValue:function(m){var g=V2(m),E=g[0],A=g[1];return W2(function(){var D=la.transition;la.transition={};try{A(m)}finally{la.transition=D}},[m]),E},useTransition:function(){var m=V2(!1),g=m[0];return m=IK.bind(null,m[1]),lc().memoizedState=m,[g,m]},useMutableSource:function(){},useSyncExternalStore:function(m,g,E){var A=li,D=lc();if(Gt){if(E===void 0)throw Error(o(407));E=E()}else{if(E=g(),Ei===null)throw Error(o(349));tp&30||O3(A,g,E)}D.memoizedState=E;var U={value:E,getSnapshot:g};return D.queue=U,W2(z3.bind(null,A,U,m),[m]),A.flags|=2048,Kg(9,F3.bind(null,A,U,E,g),void 0,null),E},useId:function(){var m=lc(),g=Ei.identifierPrefix;if(Gt){var E=Pe,A=Se;E=(A&~(1<<32-dr(A)-1)).toString(32)+E,g=":"+g+"R"+E,E=Xg++,0<E&&(g+="H"+E.toString(32)),g+=":"}else E=kK++,g=":"+g+"r"+E.toString(32)+":";return m.memoizedState=g},unstable_isNewReconciler:!1},LK={readContext:Ds,useCallback:H3,useContext:Ds,useEffect:Yg,useImperativeHandle:W3,useInsertionEffect:$3,useLayoutEffect:j3,useMemo:G3,useReducer:jx,useRef:B3,useState:function(){return jx(Vd)},useDebugValue:H2,useDeferredValue:function(m){var g=jx(Vd),E=g[0],A=g[1];return Yg(function(){var D=la.transition;la.transition={};try{A(m)}finally{la.transition=D}},[m]),E},useTransition:function(){var m=jx(Vd)[0],g=yl().memoizedState;return[m,g]},useMutableSource:D3,useSyncExternalStore:L3,useId:q3,unstable_isNewReconciler:!1},OK={readContext:Ds,useCallback:H3,useContext:Ds,useEffect:Yg,useImperativeHandle:W3,useInsertionEffect:$3,useLayoutEffect:j3,useMemo:G3,useReducer:Vx,useRef:B3,useState:function(){return Vx(Vd)},useDebugValue:H2,useDeferredValue:function(m){var g=Vx(Vd),E=g[0],A=g[1];return Yg(function(){var D=la.transition;la.transition={};try{A(m)}finally{la.transition=D}},[m]),E},useTransition:function(){var m=Vx(Vd)[0],g=yl().memoizedState;return[m,g]},useMutableSource:D3,useSyncExternalStore:L3,useId:q3,unstable_isNewReconciler:!1};function G2(m,g){try{var E="",A=g;do E+=Ix(A),A=A.return;while(A);var D=E}catch(U){D=`
Error generating stack: `+U.message+`
`+U.stack}return{value:m,source:g,stack:D}}function q2(m,g){try{console.error(g.value)}catch(E){setTimeout(function(){throw E})}}var FK=typeof WeakMap=="function"?WeakMap:Map;function Q3(m,g,E){E=oa(-1,E),E.tag=3,E.payload={element:null};var A=g.value;return E.callback=function(){lw||(lw=!0,dE=A),q2(m,g)},E}function J3(m,g,E){E=oa(-1,E),E.tag=3;var A=m.type.getDerivedStateFromError;if(typeof A=="function"){var D=g.value;E.payload=function(){return A(D)},E.callback=function(){q2(m,g)}}var U=m.stateNode;return U!==null&&typeof U.componentDidCatch=="function"&&(E.callback=function(){q2(m,g),typeof A!="function"&&(ou===null?ou=new Set([this]):ou.add(this));var de=g.stack;this.componentDidCatch(g.value,{componentStack:de!==null?de:""})}),E}function eP(m,g,E){var A=m.pingCache;if(A===null){A=m.pingCache=new FK;var D=new Set;A.set(g,D)}else D=A.get(g),D===void 0&&(D=new Set,A.set(g,D));D.has(E)||(D.add(E),m=ZK.bind(null,m,g,E),g.then(m,m))}function tP(m){do{var g;if((g=m.tag===13)&&(g=m.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return m;m=m.return}while(m!==null);return null}function nP(m,g,E,A,D){return m.mode&1?(m.flags|=65536,m.lanes=D,m):(m===g?m.flags|=65536:(m.flags|=128,E.flags|=131072,E.flags&=-52805,E.tag===1&&(E.alternate===null?E.tag=17:(g=oa(-1,1),g.tag=2,ml(E,g))),E.lanes|=1),m)}function vl(m){m.flags|=4}function rP(m,g){if(m!==null&&m.child===g.child)return!0;if(g.flags&16)return!1;for(m=g.child;m!==null;){if(m.flags&12854||m.subtreeFlags&12854)return!1;m=m.sibling}return!0}var Zg,Qg,qx,Xx;if(Qe)Zg=function(m,g){for(var E=g.child;E!==null;){if(E.tag===5||E.tag===6)Te(m,E.stateNode);else if(E.tag!==4&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===g)break;for(;E.sibling===null;){if(E.return===null||E.return===g)return;E=E.return}E.sibling.return=E.return,E=E.sibling}},Qg=function(){},qx=function(m,g,E,A,D){if(m=m.memoizedProps,m!==A){var U=g.stateNode,de=gl(aa.current);E=_e(U,E,m,A,D,de),(g.updateQueue=E)&&vl(g)}},Xx=function(m,g,E,A){E!==A&&vl(g)};else if(ae){Zg=function(m,g,E,A){for(var D=g.child;D!==null;){if(D.tag===5){var U=D.stateNode;E&&A&&(U=ir(U,D.type,D.memoizedProps,D)),Te(m,U)}else if(D.tag===6)U=D.stateNode,E&&A&&(U=wr(U,D.memoizedProps,D)),Te(m,U);else if(D.tag!==4){if(D.tag===22&&D.memoizedState!==null)U=D.child,U!==null&&(U.return=D),Zg(m,D,!0,!0);else if(D.child!==null){D.child.return=D,D=D.child;continue}}if(D===g)break;for(;D.sibling===null;){if(D.return===null||D.return===g)return;D=D.return}D.sibling.return=D.return,D=D.sibling}};var iP=function(m,g,E,A){for(var D=g.child;D!==null;){if(D.tag===5){var U=D.stateNode;E&&A&&(U=ir(U,D.type,D.memoizedProps,D)),Pt(m,U)}else if(D.tag===6)U=D.stateNode,E&&A&&(U=wr(U,D.memoizedProps,D)),Pt(m,U);else if(D.tag!==4){if(D.tag===22&&D.memoizedState!==null)U=D.child,U!==null&&(U.return=D),iP(m,D,!0,!0);else if(D.child!==null){D.child.return=D,D=D.child;continue}}if(D===g)break;for(;D.sibling===null;){if(D.return===null||D.return===g)return;D=D.return}D.sibling.return=D.return,D=D.sibling}};Qg=function(m,g){var E=g.stateNode;if(!rP(m,g)){m=E.containerInfo;var A=Bt(m);iP(A,g,!1,!1),E.pendingChildren=A,vl(g),xn(m,A)}},qx=function(m,g,E,A,D){var U=m.stateNode,de=m.memoizedProps;if((m=rP(m,g))&&de===A)g.stateNode=U;else{var Ce=g.stateNode,qe=gl(aa.current),mt=null;de!==A&&(mt=_e(Ce,E,de,A,D,qe)),m&&mt===null?g.stateNode=U:(U=ht(U,mt,E,de,A,g,m,Ce),Xe(U,E,A,D,qe)&&vl(g),g.stateNode=U,m?vl(g):Zg(U,g,!1,!1))}},Xx=function(m,g,E,A){E!==A?(m=gl(Jf.current),E=gl(aa.current),g.stateNode=Fe(A,m,E,g),vl(g)):g.stateNode=m.stateNode}}else Qg=function(){},qx=function(){},Xx=function(){};function Jg(m,g){if(!Gt)switch(m.tailMode){case"hidden":g=m.tail;for(var E=null;g!==null;)g.alternate!==null&&(E=g),g=g.sibling;E===null?m.tail=null:E.sibling=null;break;case"collapsed":E=m.tail;for(var A=null;E!==null;)E.alternate!==null&&(A=E),E=E.sibling;A===null?g||m.tail===null?m.tail=null:m.tail.sibling=null:A.sibling=null}}function hs(m){var g=m.alternate!==null&&m.alternate.child===m.child,E=0,A=0;if(g)for(var D=m.child;D!==null;)E|=D.lanes|D.childLanes,A|=D.subtreeFlags&14680064,A|=D.flags&14680064,D.return=m,D=D.sibling;else for(D=m.child;D!==null;)E|=D.lanes|D.childLanes,A|=D.subtreeFlags,A|=D.flags,D.return=m,D=D.sibling;return m.subtreeFlags|=A,m.childLanes=E,g}function zK(m,g,E){var A=g.pendingProps;switch(Zt(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hs(g),null;case 1:return Tr(g.type)&&Hn(),hs(g),null;case 3:return A=g.stateNode,ep(),It(fn),It(an),U2(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(m===null||m.child===null)&&(oo(g)?vl(g):m===null||m.memoizedState.isDehydrated&&!(g.flags&256)||(g.flags|=1024,jn!==null&&(pE(jn),jn=null))),Qg(m,g),hs(g),null;case 5:F2(g),E=gl(Jf.current);var D=g.type;if(m!==null&&g.stateNode!=null)qx(m,g,D,A,E),m.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!A){if(g.stateNode===null)throw Error(o(166));return hs(g),null}if(m=gl(aa.current),oo(g)){if(!ze)throw Error(o(175));m=j(g.stateNode,g.type,g.memoizedProps,E,m,g,!hr),g.updateQueue=m,m!==null&&vl(g)}else{var U=ve(D,A,E,m,g);Zg(U,g,!1,!1),g.stateNode=U,Xe(U,D,A,E,m)&&vl(g)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return hs(g),null;case 6:if(m&&g.stateNode!=null)Xx(m,g,m.memoizedProps,A);else{if(typeof A!="string"&&g.stateNode===null)throw Error(o(166));if(m=gl(Jf.current),E=gl(aa.current),oo(g)){if(!ze)throw Error(o(176));if(m=g.stateNode,A=g.memoizedProps,(E=Z(m,A,g,!hr))&&(D=yt,D!==null))switch(U=(D.mode&1)!==0,D.tag){case 3:Le(D.stateNode.containerInfo,m,A,U);break;case 5:$e(D.type,D.memoizedProps,D.stateNode,m,A,U)}E&&vl(g)}else g.stateNode=Fe(A,m,E,g)}return hs(g),null;case 13:if(It(Kr),A=g.memoizedState,Gt&&Yt!==null&&g.mode&1&&!(g.flags&128)){for(m=Yt;m;)m=Xn(m);return su(),g.flags|=98560,g}if(A!==null&&A.dehydrated!==null){if(A=oo(g),m===null){if(!A)throw Error(o(318));if(!ze)throw Error(o(344));if(m=g.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(o(317));xe(m,g)}else su(),!(g.flags&128)&&(g.memoizedState=null),g.flags|=4;return hs(g),null}return jn!==null&&(pE(jn),jn=null),g.flags&128?(g.lanes=E,g):(A=A!==null,E=!1,m===null?oo(g):E=m.memoizedState!==null,A&&!E&&(g.child.flags|=8192,g.mode&1&&(m===null||Kr.current&1?Ri===0&&(Ri=3):gE())),g.updateQueue!==null&&(g.flags|=4),hs(g),null);case 4:return ep(),Qg(m,g),m===null&&Je(g.stateNode.containerInfo),hs(g),null;case 10:return $g(g.type._context),hs(g),null;case 17:return Tr(g.type)&&Hn(),hs(g),null;case 19:if(It(Kr),D=g.memoizedState,D===null)return hs(g),null;if(A=(g.flags&128)!==0,U=D.rendering,U===null)if(A)Jg(D,!1);else{if(Ri!==0||m!==null&&m.flags&128)for(m=g.child;m!==null;){if(U=Ux(m),U!==null){for(g.flags|=128,Jg(D,!1),m=U.updateQueue,m!==null&&(g.updateQueue=m,g.flags|=4),g.subtreeFlags=0,m=E,A=g.child;A!==null;)E=A,D=m,E.flags&=14680066,U=E.alternate,U===null?(E.childLanes=0,E.lanes=D,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=U.childLanes,E.lanes=U.lanes,E.child=U.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=U.memoizedProps,E.memoizedState=U.memoizedState,E.updateQueue=U.updateQueue,E.type=U.type,D=U.dependencies,E.dependencies=D===null?null:{lanes:D.lanes,firstContext:D.firstContext}),A=A.sibling;return bt(Kr,Kr.current&1|2),g.child}m=m.sibling}D.tail!==null&&ai()>uE&&(g.flags|=128,A=!0,Jg(D,!1),g.lanes=4194304)}else{if(!A)if(m=Ux(U),m!==null){if(g.flags|=128,A=!0,m=m.updateQueue,m!==null&&(g.updateQueue=m,g.flags|=4),Jg(D,!0),D.tail===null&&D.tailMode==="hidden"&&!U.alternate&&!Gt)return hs(g),null}else 2*ai()-D.renderingStartTime>uE&&E!==1073741824&&(g.flags|=128,A=!0,Jg(D,!1),g.lanes=4194304);D.isBackwards?(U.sibling=g.child,g.child=U):(m=D.last,m!==null?m.sibling=U:g.child=U,D.last=U)}return D.tail!==null?(g=D.tail,D.rendering=g,D.tail=g.sibling,D.renderingStartTime=ai(),g.sibling=null,m=Kr.current,bt(Kr,A?m&1|2:m&1),g):(hs(g),null);case 22:case 23:return mE(),A=g.memoizedState!==null,m!==null&&m.memoizedState!==null!==A&&(g.flags|=8192),A&&g.mode&1?Io&1073741824&&(hs(g),Qe&&g.subtreeFlags&6&&(g.flags|=8192)):hs(g),null;case 24:return null;case 25:return null}throw Error(o(156,g.tag))}var UK=a.ReactCurrentOwner,ko=!1;function Os(m,g,E,A){g.child=m===null?R3(g,null,E,A):Qf(g,m.child,E,A)}function sP(m,g,E,A,D){E=E.render;var U=g.ref;return fl(g,D),A=$2(m,g,E,A,U,D),E=j2(),m!==null&&!ko?(g.updateQueue=m.updateQueue,g.flags&=-2053,m.lanes&=~D,cc(m,g,D)):(Gt&&E&&un(g),g.flags|=1,Os(m,g,A,D),g.child)}function oP(m,g,E,A,D){if(m===null){var U=E.type;return typeof U=="function"&&!yE(U)&&U.defaultProps===void 0&&E.compare===null&&E.defaultProps===void 0?(g.tag=15,g.type=U,aP(m,g,U,A,D)):(m=mw(E.type,null,A,g,g.mode,D),m.ref=g.ref,m.return=g,g.child=m)}if(U=m.child,!(m.lanes&D)){var de=U.memoizedProps;if(E=E.compare,E=E!==null?E:Ud,E(de,A)&&m.ref===g.ref)return cc(m,g,D)}return g.flags|=1,m=uu(U,A),m.ref=g.ref,m.return=g,g.child=m}function aP(m,g,E,A,D){if(m!==null&&Ud(m.memoizedProps,A)&&m.ref===g.ref)if(ko=!1,(m.lanes&D)!==0)m.flags&131072&&(ko=!0);else return g.lanes=m.lanes,cc(m,g,D);return X2(m,g,E,A,D)}function lP(m,g,E){var A=g.pendingProps,D=A.children,U=m!==null?m.memoizedState:null;if(A.mode==="hidden")if(!(g.mode&1))g.memoizedState={baseLanes:0,cachePool:null},bt(np,Io),Io|=E;else if(E&1073741824)g.memoizedState={baseLanes:0,cachePool:null},A=U!==null?U.baseLanes:E,bt(np,Io),Io|=A;else return m=U!==null?U.baseLanes|E:E,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:m,cachePool:null},g.updateQueue=null,bt(np,Io),Io|=m,null;else U!==null?(A=U.baseLanes|E,g.memoizedState=null):A=E,bt(np,Io),Io|=A;return Os(m,g,D,E),g.child}function cP(m,g){var E=g.ref;(m===null&&E!==null||m!==null&&m.ref!==E)&&(g.flags|=512,g.flags|=2097152)}function X2(m,g,E,A,D){var U=Tr(E)?ur:an.current;return U=zr(g,U),fl(g,D),E=$2(m,g,E,A,U,D),A=j2(),m!==null&&!ko?(g.updateQueue=m.updateQueue,g.flags&=-2053,m.lanes&=~D,cc(m,g,D)):(Gt&&A&&un(g),g.flags|=1,Os(m,g,E,D),g.child)}function uP(m,g,E,A,D){if(Tr(E)){var U=!0;bn(g)}else U=!1;if(fl(g,D),g.stateNode===null)m!==null&&(m.alternate=null,g.alternate=null,g.flags|=2),Fx(g,E,A),Yf(g,E,A,D),A=!0;else if(m===null){var de=g.stateNode,Ce=g.memoizedProps;de.props=Ce;var qe=de.context,mt=E.contextType;typeof mt=="object"&&mt!==null?mt=Ds(mt):(mt=Tr(E)?ur:an.current,mt=zr(g,mt));var Wt=E.getDerivedStateFromProps,_n=typeof Wt=="function"||typeof de.getSnapshotBeforeUpdate=="function";_n||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(Ce!==A||qe!==mt)&&Vg(g,de,A,mt),pl=!1;var dn=g.memoizedState;de.state=dn,Xf(g,A,de,D),qe=g.memoizedState,Ce!==A||dn!==qe||fn.current||pl?(typeof Wt=="function"&&(iu(g,E,Wt,A),qe=g.memoizedState),(Ce=pl||Ox(g,E,Ce,A,dn,qe,mt))?(_n||typeof de.UNSAFE_componentWillMount!="function"&&typeof de.componentWillMount!="function"||(typeof de.componentWillMount=="function"&&de.componentWillMount(),typeof de.UNSAFE_componentWillMount=="function"&&de.UNSAFE_componentWillMount()),typeof de.componentDidMount=="function"&&(g.flags|=4194308)):(typeof de.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=A,g.memoizedState=qe),de.props=A,de.state=qe,de.context=mt,A=Ce):(typeof de.componentDidMount=="function"&&(g.flags|=4194308),A=!1)}else{de=g.stateNode,Px(m,g),Ce=g.memoizedProps,mt=g.type===g.elementType?Ce:No(g.type,Ce),de.props=mt,_n=g.pendingProps,dn=de.context,qe=E.contextType,typeof qe=="object"&&qe!==null?qe=Ds(qe):(qe=Tr(E)?ur:an.current,qe=zr(g,qe));var Mr=E.getDerivedStateFromProps;(Wt=typeof Mr=="function"||typeof de.getSnapshotBeforeUpdate=="function")||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(Ce!==_n||dn!==qe)&&Vg(g,de,A,qe),pl=!1,dn=g.memoizedState,de.state=dn,Xf(g,A,de,D);var sn=g.memoizedState;Ce!==_n||dn!==sn||fn.current||pl?(typeof Mr=="function"&&(iu(g,E,Mr,A),sn=g.memoizedState),(mt=pl||Ox(g,E,mt,A,dn,sn,qe)||!1)?(Wt||typeof de.UNSAFE_componentWillUpdate!="function"&&typeof de.componentWillUpdate!="function"||(typeof de.componentWillUpdate=="function"&&de.componentWillUpdate(A,sn,qe),typeof de.UNSAFE_componentWillUpdate=="function"&&de.UNSAFE_componentWillUpdate(A,sn,qe)),typeof de.componentDidUpdate=="function"&&(g.flags|=4),typeof de.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof de.componentDidUpdate!="function"||Ce===m.memoizedProps&&dn===m.memoizedState||(g.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||Ce===m.memoizedProps&&dn===m.memoizedState||(g.flags|=1024),g.memoizedProps=A,g.memoizedState=sn),de.props=A,de.state=sn,de.context=qe,A=mt):(typeof de.componentDidUpdate!="function"||Ce===m.memoizedProps&&dn===m.memoizedState||(g.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||Ce===m.memoizedProps&&dn===m.memoizedState||(g.flags|=1024),A=!1)}return K2(m,g,E,A,U,D)}function K2(m,g,E,A,D,U){cP(m,g);var de=(g.flags&128)!==0;if(!A&&!de)return D&&Un(g,E,!1),cc(m,g,U);A=g.stateNode,UK.current=g;var Ce=de&&typeof E.getDerivedStateFromError!="function"?null:A.render();return g.flags|=1,m!==null&&de?(g.child=Qf(g,m.child,null,U),g.child=Qf(g,null,Ce,U)):Os(m,g,Ce,U),g.memoizedState=A.state,D&&Un(g,E,!0),g.child}function dP(m){var g=m.stateNode;g.pendingContext?Nn(m,g.pendingContext,g.pendingContext!==g.context):g.context&&Nn(m,g.context,!1),O2(m,g.containerInfo)}function hP(m,g,E,A,D){return su(),Wg(D),g.flags|=256,Os(m,g,E,A),g.child}var Kx={dehydrated:null,treeContext:null,retryLane:0};function Yx(m){return{baseLanes:m,cachePool:null}}function fP(m,g,E){var A=g.pendingProps,D=Kr.current,U=!1,de=(g.flags&128)!==0,Ce;if((Ce=de)||(Ce=m!==null&&m.memoizedState===null?!1:(D&2)!==0),Ce?(U=!0,g.flags&=-129):(m===null||m.memoizedState!==null)&&(D|=1),bt(Kr,D&1),m===null)return Yn(g),m=g.memoizedState,m!==null&&(m=m.dehydrated,m!==null)?(g.mode&1?Is(m)?g.lanes=8:g.lanes=1073741824:g.lanes=1,null):(D=A.children,m=A.fallback,U?(A=g.mode,U=g.child,D={mode:"hidden",children:D},!(A&1)&&U!==null?(U.childLanes=0,U.pendingProps=D):U=gw(D,A,0,null),m=Kd(m,A,E,null),U.return=g,m.return=g,U.sibling=m,g.child=U,g.child.memoizedState=Yx(E),g.memoizedState=Kx,m):Y2(g,D));if(D=m.memoizedState,D!==null){if(Ce=D.dehydrated,Ce!==null){if(de)return g.flags&256?(g.flags&=-257,Zx(m,g,E,Error(o(422)))):g.memoizedState!==null?(g.child=m.child,g.flags|=128,null):(U=A.fallback,D=g.mode,A=gw({mode:"visible",children:A.children},D,0,null),U=Kd(U,D,E,null),U.flags|=2,A.return=g,U.return=g,A.sibling=U,g.child=A,g.mode&1&&Qf(g,m.child,null,E),g.child.memoizedState=Yx(E),g.memoizedState=Kx,U);if(!(g.mode&1))g=Zx(m,g,E,null);else if(Is(Ce))g=Zx(m,g,E,Error(o(419)));else if(A=(E&m.childLanes)!==0,ko||A){if(A=Ei,A!==null){switch(E&-E){case 4:U=2;break;case 16:U=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:U=32;break;case 536870912:U=268435456;break;default:U=0}A=U&(A.suspendedLanes|E)?0:U,A!==0&&A!==D.retryLane&&(D.retryLane=A,ca(m,A,-1))}gE(),g=Zx(m,g,E,Error(o(421)))}else bi(Ce)?(g.flags|=128,g.child=m.child,g=QK.bind(null,m),Rs(Ce,g),g=null):(E=D.treeContext,ze&&(Yt=tu(Ce),yt=g,Gt=!0,jn=null,hr=!1,E!==null&&(se[ue++]=Se,se[ue++]=Pe,se[ue++]=ce,Se=E.id,Pe=E.overflow,ce=g)),g=Y2(g,g.pendingProps.children),g.flags|=4096);return g}return U?(A=mP(m,g,A.children,A.fallback,E),U=g.child,D=m.child.memoizedState,U.memoizedState=D===null?Yx(E):{baseLanes:D.baseLanes|E,cachePool:null},U.childLanes=m.childLanes&~E,g.memoizedState=Kx,A):(E=pP(m,g,A.children,E),g.memoizedState=null,E)}return U?(A=mP(m,g,A.children,A.fallback,E),U=g.child,D=m.child.memoizedState,U.memoizedState=D===null?Yx(E):{baseLanes:D.baseLanes|E,cachePool:null},U.childLanes=m.childLanes&~E,g.memoizedState=Kx,A):(E=pP(m,g,A.children,E),g.memoizedState=null,E)}function Y2(m,g){return g=gw({mode:"visible",children:g},m.mode,0,null),g.return=m,m.child=g}function pP(m,g,E,A){var D=m.child;return m=D.sibling,E=uu(D,{mode:"visible",children:E}),!(g.mode&1)&&(E.lanes=A),E.return=g,E.sibling=null,m!==null&&(A=g.deletions,A===null?(g.deletions=[m],g.flags|=16):A.push(m)),g.child=E}function mP(m,g,E,A,D){var U=g.mode;m=m.child;var de=m.sibling,Ce={mode:"hidden",children:E};return!(U&1)&&g.child!==m?(E=g.child,E.childLanes=0,E.pendingProps=Ce,g.deletions=null):(E=uu(m,Ce),E.subtreeFlags=m.subtreeFlags&14680064),de!==null?A=uu(de,A):(A=Kd(A,U,D,null),A.flags|=2),A.return=g,E.return=g,E.sibling=A,g.child=E,A}function Zx(m,g,E,A){return A!==null&&Wg(A),Qf(g,m.child,null,E),m=Y2(g,g.pendingProps.children),m.flags|=2,g.memoizedState=null,m}function gP(m,g,E){m.lanes|=g;var A=m.alternate;A!==null&&(A.lanes|=g),Bd(m.return,g,E)}function Z2(m,g,E,A,D){var U=m.memoizedState;U===null?m.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:A,tail:E,tailMode:D}:(U.isBackwards=g,U.rendering=null,U.renderingStartTime=0,U.last=A,U.tail=E,U.tailMode=D)}function yP(m,g,E){var A=g.pendingProps,D=A.revealOrder,U=A.tail;if(Os(m,g,A.children,E),A=Kr.current,A&2)A=A&1|2,g.flags|=128;else{if(m!==null&&m.flags&128)e:for(m=g.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&gP(m,E,g);else if(m.tag===19)gP(m,E,g);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===g)break e;for(;m.sibling===null;){if(m.return===null||m.return===g)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}A&=1}if(bt(Kr,A),!(g.mode&1))g.memoizedState=null;else switch(D){case"forwards":for(E=g.child,D=null;E!==null;)m=E.alternate,m!==null&&Ux(m)===null&&(D=E),E=E.sibling;E=D,E===null?(D=g.child,g.child=null):(D=E.sibling,E.sibling=null),Z2(g,!1,D,E,U);break;case"backwards":for(E=null,D=g.child,g.child=null;D!==null;){if(m=D.alternate,m!==null&&Ux(m)===null){g.child=D;break}m=D.sibling,D.sibling=E,E=D,D=m}Z2(g,!0,E,null,U);break;case"together":Z2(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function cc(m,g,E){if(m!==null&&(g.dependencies=m.dependencies),rp|=g.lanes,!(E&g.childLanes))return null;if(m!==null&&g.child!==m.child)throw Error(o(153));if(g.child!==null){for(m=g.child,E=uu(m,m.pendingProps),g.child=E,E.return=g;m.sibling!==null;)m=m.sibling,E=E.sibling=uu(m,m.pendingProps),E.return=g;E.sibling=null}return g.child}function BK(m,g,E){switch(g.tag){case 3:dP(g),su();break;case 5:P3(g);break;case 1:Tr(g.type)&&bn(g);break;case 4:O2(g,g.stateNode.containerInfo);break;case 10:Rx(g,g.type._context,g.memoizedProps.value);break;case 13:var A=g.memoizedState;if(A!==null)return A.dehydrated!==null?(bt(Kr,Kr.current&1),g.flags|=128,null):E&g.child.childLanes?fP(m,g,E):(bt(Kr,Kr.current&1),m=cc(m,g,E),m!==null?m.sibling:null);bt(Kr,Kr.current&1);break;case 19:if(A=(E&g.childLanes)!==0,m.flags&128){if(A)return yP(m,g,E);g.flags|=128}var D=g.memoizedState;if(D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),bt(Kr,Kr.current),A)break;return null;case 22:case 23:return g.lanes=0,lP(m,g,E)}return cc(m,g,E)}function $K(m,g){switch(Zt(g),g.tag){case 1:return Tr(g.type)&&Hn(),m=g.flags,m&65536?(g.flags=m&-65537|128,g):null;case 3:return ep(),It(fn),It(an),U2(),m=g.flags,m&65536&&!(m&128)?(g.flags=m&-65537|128,g):null;case 5:return F2(g),null;case 13:if(It(Kr),m=g.memoizedState,m!==null&&m.dehydrated!==null){if(g.alternate===null)throw Error(o(340));su()}return m=g.flags,m&65536?(g.flags=m&-65537|128,g):null;case 19:return It(Kr),null;case 4:return ep(),null;case 10:return $g(g.type._context),null;case 22:case 23:return mE(),null;case 24:return null;default:return null}}var Qx=!1,Wd=!1,jK=typeof WeakSet=="function"?WeakSet:Set,Rt=null;function Jx(m,g){var E=m.ref;if(E!==null)if(typeof E=="function")try{E(null)}catch(A){co(m,g,A)}else E.current=null}function Q2(m,g,E){try{E()}catch(A){co(m,g,A)}}var vP=!1;function VK(m,g){for(X(m.containerInfo),Rt=g;Rt!==null;)if(m=Rt,g=m.child,(m.subtreeFlags&1028)!==0&&g!==null)g.return=m,Rt=g;else for(;Rt!==null;){m=Rt;try{var E=m.alternate;if(m.flags&1024)switch(m.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var A=E.memoizedProps,D=E.memoizedState,U=m.stateNode,de=U.getSnapshotBeforeUpdate(m.elementType===m.type?A:No(m.type,A),D);U.__reactInternalSnapshotBeforeUpdate=de}break;case 3:Qe&&ot(m.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Ce){co(m,m.return,Ce)}if(g=m.sibling,g!==null){g.return=m.return,Rt=g;break}Rt=m.return}return E=vP,vP=!1,E}function Hd(m,g,E){var A=g.updateQueue;if(A=A!==null?A.lastEffect:null,A!==null){var D=A=A.next;do{if((D.tag&m)===m){var U=D.destroy;D.destroy=void 0,U!==void 0&&Q2(g,E,U)}D=D.next}while(D!==A)}}function ey(m,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var E=g=g.next;do{if((E.tag&m)===m){var A=E.create;E.destroy=A()}E=E.next}while(E!==g)}}function J2(m){var g=m.ref;if(g!==null){var E=m.stateNode;switch(m.tag){case 5:m=Y(E);break;default:m=E}typeof g=="function"?g(m):g.current=m}}function xP(m,g,E){if(ra&&typeof ra.onCommitFiberUnmount=="function")try{ra.onCommitFiberUnmount($f,g)}catch{}switch(g.tag){case 0:case 11:case 14:case 15:if(m=g.updateQueue,m!==null&&(m=m.lastEffect,m!==null)){var A=m=m.next;do{var D=A,U=D.destroy;D=D.tag,U!==void 0&&(D&2||D&4)&&Q2(g,E,U),A=A.next}while(A!==m)}break;case 1:if(Jx(g,E),m=g.stateNode,typeof m.componentWillUnmount=="function")try{m.props=g.memoizedProps,m.state=g.memoizedState,m.componentWillUnmount()}catch(de){co(g,E,de)}break;case 5:Jx(g,E);break;case 4:Qe?CP(m,g,E):ae&&ae&&(g=g.stateNode.containerInfo,E=Bt(g),Dn(g,E))}}function wP(m,g,E){for(var A=g;;)if(xP(m,A,E),A.child===null||Qe&&A.tag===4){if(A===g)break;for(;A.sibling===null;){if(A.return===null||A.return===g)return;A=A.return}A.sibling.return=A.return,A=A.sibling}else A.child.return=A,A=A.child}function bP(m){var g=m.alternate;g!==null&&(m.alternate=null,bP(g)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(g=m.stateNode,g!==null&&Et(g)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}function SP(m){return m.tag===5||m.tag===3||m.tag===4}function _P(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||SP(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function EP(m){if(Qe){e:{for(var g=m.return;g!==null;){if(SP(g))break e;g=g.return}throw Error(o(160))}var E=g;switch(E.tag){case 5:g=E.stateNode,E.flags&32&&(He(g),E.flags&=-33),E=_P(m),tE(m,E,g);break;case 3:case 4:g=E.stateNode.containerInfo,E=_P(m),eE(m,E,g);break;default:throw Error(o(161))}}}function eE(m,g,E){var A=m.tag;if(A===5||A===6)m=m.stateNode,g?wt(E,m,g):dt(E,m);else if(A!==4&&(m=m.child,m!==null))for(eE(m,g,E),m=m.sibling;m!==null;)eE(m,g,E),m=m.sibling}function tE(m,g,E){var A=m.tag;if(A===5||A===6)m=m.stateNode,g?jt(E,m,g):Be(E,m);else if(A!==4&&(m=m.child,m!==null))for(tE(m,g,E),m=m.sibling;m!==null;)tE(m,g,E),m=m.sibling}function CP(m,g,E){for(var A=g,D=!1,U,de;;){if(!D){D=A.return;e:for(;;){if(D===null)throw Error(o(160));switch(U=D.stateNode,D.tag){case 5:de=!1;break e;case 3:U=U.containerInfo,de=!0;break e;case 4:U=U.containerInfo,de=!0;break e}D=D.return}D=!0}if(A.tag===5||A.tag===6)wP(m,A,E),de?ye(U,A.stateNode):Mt(U,A.stateNode);else if(A.tag===18)de?pe(U,A.stateNode):me(U,A.stateNode);else if(A.tag===4){if(A.child!==null){U=A.stateNode.containerInfo,de=!0,A.child.return=A,A=A.child;continue}}else if(xP(m,A,E),A.child!==null){A.child.return=A,A=A.child;continue}if(A===g)break;for(;A.sibling===null;){if(A.return===null||A.return===g)return;A=A.return,A.tag===4&&(D=!1)}A.sibling.return=A.return,A=A.sibling}}function nE(m,g){if(Qe){switch(g.tag){case 0:case 11:case 14:case 15:Hd(3,g,g.return),ey(3,g),Hd(5,g,g.return);return;case 1:return;case 5:var E=g.stateNode;if(E!=null){var A=g.memoizedProps;m=m!==null?m.memoizedProps:A;var D=g.type,U=g.updateQueue;g.updateQueue=null,U!==null&&cn(E,U,D,m,A,g)}return;case 6:if(g.stateNode===null)throw Error(o(162));E=g.memoizedProps,We(g.stateNode,m!==null?m.memoizedProps:E,E);return;case 3:ze&&m!==null&&m.memoizedState.isDehydrated&&re(g.stateNode.containerInfo);return;case 12:return;case 13:ew(g);return;case 19:ew(g);return;case 17:return}throw Error(o(163))}switch(g.tag){case 0:case 11:case 14:case 15:Hd(3,g,g.return),ey(3,g),Hd(5,g,g.return);return;case 12:return;case 13:ew(g);return;case 19:ew(g);return;case 3:ze&&m!==null&&m.memoizedState.isDehydrated&&re(g.stateNode.containerInfo);break;case 22:case 23:return}e:if(ae){switch(g.tag){case 1:case 5:case 6:break e;case 3:case 4:g=g.stateNode,Dn(g.containerInfo,g.pendingChildren);break e}throw Error(o(163))}}function ew(m){var g=m.updateQueue;if(g!==null){m.updateQueue=null;var E=m.stateNode;E===null&&(E=m.stateNode=new jK),g.forEach(function(A){var D=JK.bind(null,m,A);E.has(A)||(E.add(A),A.then(D,D))})}}function WK(m,g){for(Rt=g;Rt!==null;){g=Rt;var E=g.deletions;if(E!==null)for(var A=0;A<E.length;A++){var D=E[A];try{var U=m;Qe?CP(U,D,g):wP(U,D,g);var de=D.alternate;de!==null&&(de.return=null),D.return=null}catch(nn){co(D,g,nn)}}if(E=g.child,g.subtreeFlags&12854&&E!==null)E.return=g,Rt=E;else for(;Rt!==null;){g=Rt;try{var Ce=g.flags;if(Ce&32&&Qe&&He(g.stateNode),Ce&512){var qe=g.alternate;if(qe!==null){var mt=qe.ref;mt!==null&&(typeof mt=="function"?mt(null):mt.current=null)}}if(Ce&8192)switch(g.tag){case 13:if(g.memoizedState!==null){var Wt=g.alternate;(Wt===null||Wt.memoizedState===null)&&(cE=ai())}break;case 22:var _n=g.memoizedState!==null,dn=g.alternate,Mr=dn!==null&&dn.memoizedState!==null;if(E=g,Qe){e:if(A=E,D=_n,U=null,Qe)for(var sn=A;;){if(sn.tag===5){if(U===null){U=sn;var fs=sn.stateNode;D?st(fs):Ye(sn.stateNode,sn.memoizedProps)}}else if(sn.tag===6){if(U===null){var da=sn.stateNode;D?_t(da):fe(da,sn.memoizedProps)}}else if((sn.tag!==22&&sn.tag!==23||sn.memoizedState===null||sn===A)&&sn.child!==null){sn.child.return=sn,sn=sn.child;continue}if(sn===A)break;for(;sn.sibling===null;){if(sn.return===null||sn.return===A)break e;U===sn&&(U=null),sn=sn.return}U===sn&&(U=null),sn.sibling.return=sn.return,sn=sn.sibling}}if(_n&&!Mr&&E.mode&1){Rt=E;for(var De=E.child;De!==null;){for(E=Rt=De;Rt!==null;){A=Rt;var Ne=A.child;switch(A.tag){case 0:case 11:case 14:case 15:Hd(4,A,A.return);break;case 1:Jx(A,A.return);var Ve=A.stateNode;if(typeof Ve.componentWillUnmount=="function"){var Lt=A.return;try{Ve.props=A.memoizedProps,Ve.state=A.memoizedState,Ve.componentWillUnmount()}catch(nn){co(A,Lt,nn)}}break;case 5:Jx(A,A.return);break;case 22:if(A.memoizedState!==null){AP(E);continue}}Ne!==null?(Ne.return=A,Rt=Ne):AP(E)}De=De.sibling}}}switch(Ce&4102){case 2:EP(g),g.flags&=-3;break;case 6:EP(g),g.flags&=-3,nE(g.alternate,g);break;case 4096:g.flags&=-4097;break;case 4100:g.flags&=-4097,nE(g.alternate,g);break;case 4:nE(g.alternate,g)}}catch(nn){co(g,g.return,nn)}if(E=g.sibling,E!==null){E.return=g.return,Rt=E;break}Rt=g.return}}}function HK(m,g,E){Rt=m,TP(m)}function TP(m,g,E){for(var A=(m.mode&1)!==0;Rt!==null;){var D=Rt,U=D.child;if(D.tag===22&&A){var de=D.memoizedState!==null||Qx;if(!de){var Ce=D.alternate,qe=Ce!==null&&Ce.memoizedState!==null||Wd;Ce=Qx;var mt=Wd;if(Qx=de,(Wd=qe)&&!mt)for(Rt=D;Rt!==null;)de=Rt,qe=de.child,de.tag===22&&de.memoizedState!==null?NP(D):qe!==null?(qe.return=de,Rt=qe):NP(D);for(;U!==null;)Rt=U,TP(U),U=U.sibling;Rt=D,Qx=Ce,Wd=mt}MP(m)}else D.subtreeFlags&8772&&U!==null?(U.return=D,Rt=U):MP(m)}}function MP(m){for(;Rt!==null;){var g=Rt;if(g.flags&8772){var E=g.alternate;try{if(g.flags&8772)switch(g.tag){case 0:case 11:case 15:Wd||ey(5,g);break;case 1:var A=g.stateNode;if(g.flags&4&&!Wd)if(E===null)A.componentDidMount();else{var D=g.elementType===g.type?E.memoizedProps:No(g.type,E.memoizedProps);A.componentDidUpdate(D,E.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var U=g.updateQueue;U!==null&&Dx(g,U,A);break;case 3:var de=g.updateQueue;if(de!==null){if(E=null,g.child!==null)switch(g.child.tag){case 5:E=Y(g.child.stateNode);break;case 1:E=g.child.stateNode}Dx(g,de,E)}break;case 5:var Ce=g.stateNode;E===null&&g.flags&4&&Kt(Ce,g.type,g.memoizedProps,g);break;case 6:break;case 4:break;case 12:break;case 13:if(ze&&g.memoizedState===null){var qe=g.alternate;if(qe!==null){var mt=qe.memoizedState;if(mt!==null){var Wt=mt.dehydrated;Wt!==null&&le(Wt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}Wd||g.flags&512&&J2(g)}catch(_n){co(g,g.return,_n)}}if(g===m){Rt=null;break}if(E=g.sibling,E!==null){E.return=g.return,Rt=E;break}Rt=g.return}}function AP(m){for(;Rt!==null;){var g=Rt;if(g===m){Rt=null;break}var E=g.sibling;if(E!==null){E.return=g.return,Rt=E;break}Rt=g.return}}function NP(m){for(;Rt!==null;){var g=Rt;try{switch(g.tag){case 0:case 11:case 15:var E=g.return;try{ey(4,g)}catch(qe){co(g,E,qe)}break;case 1:var A=g.stateNode;if(typeof A.componentDidMount=="function"){var D=g.return;try{A.componentDidMount()}catch(qe){co(g,D,qe)}}var U=g.return;try{J2(g)}catch(qe){co(g,U,qe)}break;case 5:var de=g.return;try{J2(g)}catch(qe){co(g,de,qe)}}}catch(qe){co(g,g.return,qe)}if(g===m){Rt=null;break}var Ce=g.sibling;if(Ce!==null){Ce.return=g.return,Rt=Ce;break}Rt=g.return}}var tw=0,nw=1,rw=2,iw=3,sw=4;if(typeof Symbol=="function"&&Symbol.for){var ty=Symbol.for;tw=ty("selector.component"),nw=ty("selector.has_pseudo_class"),rw=ty("selector.role"),iw=ty("selector.test_id"),sw=ty("selector.text")}function rE(m){var g=Re(m);if(g!=null){if(typeof g.memoizedProps["data-testname"]!="string")throw Error(o(364));return g}if(m=ke(m),m===null)throw Error(o(362));return m.stateNode.current}function iE(m,g){switch(g.$$typeof){case tw:if(m.type===g.value)return!0;break;case nw:e:{g=g.value,m=[m,0];for(var E=0;E<m.length;){var A=m[E++],D=m[E++],U=g[D];if(A.tag!==5||!ee(A)){for(;U!=null&&iE(A,U);)D++,U=g[D];if(D===g.length){g=!0;break e}else for(A=A.child;A!==null;)m.push(A,D),A=A.sibling}}g=!1}return g;case rw:if(m.tag===5&&Ee(m.stateNode,g.value))return!0;break;case sw:if((m.tag===5||m.tag===6)&&(m=he(m),m!==null&&0<=m.indexOf(g.value)))return!0;break;case iw:if(m.tag===5&&(m=m.memoizedProps["data-testname"],typeof m=="string"&&m.toLowerCase()===g.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function sE(m){switch(m.$$typeof){case tw:return"<"+(k(m.value)||"Unknown")+">";case nw:return":has("+(sE(m)||"")+")";case rw:return'[role="'+m.value+'"]';case sw:return'"'+m.value+'"';case iw:return'[data-testname="'+m.value+'"]';default:throw Error(o(365))}}function kP(m,g){var E=[];m=[m,0];for(var A=0;A<m.length;){var D=m[A++],U=m[A++],de=g[U];if(D.tag!==5||!ee(D)){for(;de!=null&&iE(D,de);)U++,de=g[U];if(U===g.length)E.push(D);else for(D=D.child;D!==null;)m.push(D,U),D=D.sibling}}return E}function oE(m,g){if(!G)throw Error(o(363));m=rE(m),m=kP(m,g),g=[],m=Array.from(m);for(var E=0;E<m.length;){var A=m[E++];if(A.tag===5)ee(A)||g.push(A.stateNode);else for(A=A.child;A!==null;)m.push(A),A=A.sibling}return g}var GK=Math.ceil,ow=a.ReactCurrentDispatcher,aE=a.ReactCurrentOwner,mi=a.ReactCurrentBatchConfig,Bn=0,Ei=null,Ci=null,es=0,Io=0,np=on(0),Ri=0,ny=null,rp=0,aw=0,lE=0,ry=null,ao=null,cE=0,uE=1/0;function ip(){uE=ai()+500}var lw=!1,dE=null,ou=null,cw=!1,au=null,uw=0,iy=0,hE=null,dw=-1,hw=0;function Fs(){return Bn&6?ai():dw!==-1?dw:dw=ai()}function lu(m){return m.mode&1?Bn&2&&es!==0?es&-es:zd.transition!==null?(hw===0&&(m=Uf,Uf<<=1,!(Uf&4194240)&&(Uf=64),hw=m),hw):(m=Kn,m!==0?m:Ge()):1}function ca(m,g,E){if(50<iy)throw iy=0,hE=null,Error(o(185));var A=fw(m,g);return A===null?null:(Fd(A,g,E),(!(Bn&2)||A!==Ei)&&(A===Ei&&(!(Bn&2)&&(aw|=g),Ri===4&&cu(A,es)),lo(A,E),g===1&&Bn===0&&!(m.mode&1)&&(ip(),Pa&&ia())),A)}function fw(m,g){m.lanes|=g;var E=m.alternate;for(E!==null&&(E.lanes|=g),E=m,m=m.return;m!==null;)m.childLanes|=g,E=m.alternate,E!==null&&(E.childLanes|=g),E=m,m=m.return;return E.tag===3?E.stateNode:null}function lo(m,g){var E=m.callbackNode;Tx(m,g);var A=rc(m,m===Ei?es:0);if(A===0)E!==null&&Mx(E),m.callbackNode=null,m.callbackPriority=0;else if(g=A&-A,m.callbackPriority!==g){if(E!=null&&Mx(E),g===1)m.tag===0?L2(RP.bind(null,m)):Vf(RP.bind(null,m)),pt?Q(function(){Bn===0&&ia()}):Ug(Bf,ia),E=null;else{switch(ru(A)){case 1:E=Bf;break;case 4:E=Ax;break;case 16:E=sc;break;case 536870912:E=Mo;break;default:E=sc}E=$P(E,IP.bind(null,m))}m.callbackPriority=g,m.callbackNode=E}}function IP(m,g){if(dw=-1,hw=0,Bn&6)throw Error(o(327));var E=m.callbackNode;if(Xd()&&m.callbackNode!==E)return null;var A=rc(m,m===Ei?es:0);if(A===0)return null;if(A&30||A&m.expiredLanes||g)g=pw(m,A);else{g=A;var D=Bn;Bn|=2;var U=LP();(Ei!==m||es!==g)&&(ip(),Gd(m,g));do try{KK();break}catch(Ce){DP(m,Ce)}while(!0);Hf(),ow.current=U,Bn=D,Ci!==null?g=0:(Ei=null,es=0,g=Ri)}if(g!==0){if(g===2&&(D=ic(m),D!==0&&(A=D,g=fE(m,D))),g===1)throw E=ny,Gd(m,0),cu(m,A),lo(m,ai()),E;if(g===6)cu(m,A);else{if(D=m.current.alternate,!(A&30)&&!qK(D)&&(g=pw(m,A),g===2&&(U=ic(m),U!==0&&(A=U,g=fE(m,U))),g===1))throw E=ny,Gd(m,0),cu(m,A),lo(m,ai()),E;switch(m.finishedWork=D,m.finishedLanes=A,g){case 0:case 1:throw Error(o(345));case 2:qd(m,ao);break;case 3:if(cu(m,A),(A&130023424)===A&&(g=cE+500-ai(),10<g)){if(rc(m,0)!==0)break;if(D=m.suspendedLanes,(D&A)!==A){Fs(),m.pingedLanes|=m.suspendedLanes&D;break}m.timeoutHandle=Oe(qd.bind(null,m,ao),g);break}qd(m,ao);break;case 4:if(cu(m,A),(A&4194240)===A)break;for(g=m.eventTimes,D=-1;0<A;){var de=31-dr(A);U=1<<de,de=g[de],de>D&&(D=de),A&=~U}if(A=D,A=ai()-A,A=(120>A?120:480>A?480:1080>A?1080:1920>A?1920:3e3>A?3e3:4320>A?4320:1960*GK(A/1960))-A,10<A){m.timeoutHandle=Oe(qd.bind(null,m,ao),A);break}qd(m,ao);break;case 5:qd(m,ao);break;default:throw Error(o(329))}}}return lo(m,ai()),m.callbackNode===E?IP.bind(null,m):null}function fE(m,g){var E=ry;return m.current.memoizedState.isDehydrated&&(Gd(m,g).flags|=256),m=pw(m,g),m!==2&&(g=ao,ao=E,g!==null&&pE(g)),m}function pE(m){ao===null?ao=m:ao.push.apply(ao,m)}function qK(m){for(var g=m;;){if(g.flags&16384){var E=g.updateQueue;if(E!==null&&(E=E.stores,E!==null))for(var A=0;A<E.length;A++){var D=E[A],U=D.getSnapshot;D=D.value;try{if(!so(U(),D))return!1}catch{return!1}}}if(E=g.child,g.subtreeFlags&16384&&E!==null)E.return=g,g=E;else{if(g===m)break;for(;g.sibling===null;){if(g.return===null||g.return===m)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function cu(m,g){for(g&=~lE,g&=~aw,m.suspendedLanes|=g,m.pingedLanes&=~g,m=m.expirationTimes;0<g;){var E=31-dr(g),A=1<<E;m[E]=-1,g&=~A}}function RP(m){if(Bn&6)throw Error(o(327));Xd();var g=rc(m,0);if(!(g&1))return lo(m,ai()),null;var E=pw(m,g);if(m.tag!==0&&E===2){var A=ic(m);A!==0&&(g=A,E=fE(m,A))}if(E===1)throw E=ny,Gd(m,0),cu(m,g),lo(m,ai()),E;if(E===6)throw Error(o(345));return m.finishedWork=m.current.alternate,m.finishedLanes=g,qd(m,ao),lo(m,ai()),null}function PP(m){au!==null&&au.tag===0&&!(Bn&6)&&Xd();var g=Bn;Bn|=1;var E=mi.transition,A=Kn;try{if(mi.transition=null,Kn=1,m)return m()}finally{Kn=A,mi.transition=E,Bn=g,!(Bn&6)&&ia()}}function mE(){Io=np.current,It(np)}function Gd(m,g){m.finishedWork=null,m.finishedLanes=0;var E=m.timeoutHandle;if(E!==rt&&(m.timeoutHandle=rt,nt(E)),Ci!==null)for(E=Ci.return;E!==null;){var A=E;switch(Zt(A),A.tag){case 1:A=A.type.childContextTypes,A!=null&&Hn();break;case 3:ep(),It(fn),It(an),U2();break;case 5:F2(A);break;case 4:ep();break;case 13:It(Kr);break;case 19:It(Kr);break;case 10:$g(A.type._context);break;case 22:case 23:mE()}E=E.return}if(Ei=m,Ci=m=uu(m.current,null),es=Io=g,Ri=0,ny=null,lE=aw=rp=0,ao=ry=null,sa!==null){for(g=0;g<sa.length;g++)if(E=sa[g],A=E.interleaved,A!==null){E.interleaved=null;var D=A.next,U=E.pending;if(U!==null){var de=U.next;U.next=D,A.next=de}E.pending=A}sa=null}return m}function DP(m,g){do{var E=Ci;try{if(Hf(),Bx.current=Gx,$x){for(var A=li.memoizedState;A!==null;){var D=A.queue;D!==null&&(D.pending=null),A=A.next}$x=!1}if(tp=0,Hi=us=li=null,qg=!1,Xg=0,aE.current=null,E===null||E.return===null){Ri=1,ny=g,Ci=null;break}e:{var U=m,de=E.return,Ce=E,qe=g;if(g=es,Ce.flags|=32768,qe!==null&&typeof qe=="object"&&typeof qe.then=="function"){var mt=qe,Wt=Ce,_n=Wt.tag;if(!(Wt.mode&1)&&(_n===0||_n===11||_n===15)){var dn=Wt.alternate;dn?(Wt.updateQueue=dn.updateQueue,Wt.memoizedState=dn.memoizedState,Wt.lanes=dn.lanes):(Wt.updateQueue=null,Wt.memoizedState=null)}var Mr=tP(de);if(Mr!==null){Mr.flags&=-257,nP(Mr,de,Ce,U,g),Mr.mode&1&&eP(U,mt,g),g=Mr,qe=mt;var sn=g.updateQueue;if(sn===null){var fs=new Set;fs.add(qe),g.updateQueue=fs}else sn.add(qe);break e}else{if(!(g&1)){eP(U,mt,g),gE();break e}qe=Error(o(426))}}else if(Gt&&Ce.mode&1){var da=tP(de);if(da!==null){!(da.flags&65536)&&(da.flags|=256),nP(da,de,Ce,U,g),Wg(qe);break e}}U=qe,Ri!==4&&(Ri=2),ry===null?ry=[U]:ry.push(U),qe=G2(qe,Ce),Ce=de;do{switch(Ce.tag){case 3:Ce.flags|=65536,g&=-g,Ce.lanes|=g;var De=Q3(Ce,qe,g);qf(Ce,De);break e;case 1:U=qe;var Ne=Ce.type,Ve=Ce.stateNode;if(!(Ce.flags&128)&&(typeof Ne.getDerivedStateFromError=="function"||Ve!==null&&typeof Ve.componentDidCatch=="function"&&(ou===null||!ou.has(Ve)))){Ce.flags|=65536,g&=-g,Ce.lanes|=g;var Lt=J3(Ce,U,g);qf(Ce,Lt);break e}}Ce=Ce.return}while(Ce!==null)}FP(E)}catch(nn){g=nn,Ci===E&&E!==null&&(Ci=E=E.return);continue}break}while(!0)}function LP(){var m=ow.current;return ow.current=Gx,m===null?Gx:m}function gE(){(Ri===0||Ri===3||Ri===2)&&(Ri=4),Ei===null||!(rp&268435455)&&!(aw&268435455)||cu(Ei,es)}function pw(m,g){var E=Bn;Bn|=2;var A=LP();Ei===m&&es===g||Gd(m,g);do try{XK();break}catch(D){DP(m,D)}while(!0);if(Hf(),Bn=E,ow.current=A,Ci!==null)throw Error(o(261));return Ei=null,es=0,Ri}function XK(){for(;Ci!==null;)OP(Ci)}function KK(){for(;Ci!==null&&!P2();)OP(Ci)}function OP(m){var g=BP(m.alternate,m,Io);m.memoizedProps=m.pendingProps,g===null?FP(m):Ci=g,aE.current=null}function FP(m){var g=m;do{var E=g.alternate;if(m=g.return,g.flags&32768){if(E=$K(E,g),E!==null){E.flags&=32767,Ci=E;return}if(m!==null)m.flags|=32768,m.subtreeFlags=0,m.deletions=null;else{Ri=6,Ci=null;return}}else if(E=zK(E,g,Io),E!==null){Ci=E;return}if(g=g.sibling,g!==null){Ci=g;return}Ci=g=m}while(g!==null);Ri===0&&(Ri=5)}function qd(m,g){var E=Kn,A=mi.transition;try{mi.transition=null,Kn=1,YK(m,g,E)}finally{mi.transition=A,Kn=E}return null}function YK(m,g,E){do Xd();while(au!==null);if(Bn&6)throw Error(o(327));var A=m.finishedWork,D=m.finishedLanes;if(A===null)return null;if(m.finishedWork=null,m.finishedLanes=0,A===m.current)throw Error(o(177));m.callbackNode=null,m.callbackPriority=0;var U=A.lanes|A.childLanes;if(R2(m,U),m===Ei&&(Ci=Ei=null,es=0),!(A.subtreeFlags&2064)&&!(A.flags&2064)||cw||(cw=!0,$P(sc,function(){return Xd(),null})),U=(A.flags&15990)!==0,A.subtreeFlags&15990||U){U=mi.transition,mi.transition=null;var de=Kn;Kn=1;var Ce=Bn;Bn|=4,aE.current=null,VK(m,A),WK(m,A),oe(m.containerInfo),m.current=A,HK(A),D2(),Bn=Ce,Kn=de,mi.transition=U}else m.current=A;if(cw&&(cw=!1,au=m,uw=D),U=m.pendingLanes,U===0&&(ou=null),Nx(A.stateNode),lo(m,ai()),g!==null)for(E=m.onRecoverableError,A=0;A<g.length;A++)E(g[A]);if(lw)throw lw=!1,m=dE,dE=null,m;return uw&1&&m.tag!==0&&Xd(),U=m.pendingLanes,U&1?m===hE?iy++:(iy=0,hE=m):iy=0,ia(),null}function Xd(){if(au!==null){var m=ru(uw),g=mi.transition,E=Kn;try{if(mi.transition=null,Kn=16>m?16:m,au===null)var A=!1;else{if(m=au,au=null,uw=0,Bn&6)throw Error(o(331));var D=Bn;for(Bn|=4,Rt=m.current;Rt!==null;){var U=Rt,de=U.child;if(Rt.flags&16){var Ce=U.deletions;if(Ce!==null){for(var qe=0;qe<Ce.length;qe++){var mt=Ce[qe];for(Rt=mt;Rt!==null;){var Wt=Rt;switch(Wt.tag){case 0:case 11:case 15:Hd(8,Wt,U)}var _n=Wt.child;if(_n!==null)_n.return=Wt,Rt=_n;else for(;Rt!==null;){Wt=Rt;var dn=Wt.sibling,Mr=Wt.return;if(bP(Wt),Wt===mt){Rt=null;break}if(dn!==null){dn.return=Mr,Rt=dn;break}Rt=Mr}}}var sn=U.alternate;if(sn!==null){var fs=sn.child;if(fs!==null){sn.child=null;do{var da=fs.sibling;fs.sibling=null,fs=da}while(fs!==null)}}Rt=U}}if(U.subtreeFlags&2064&&de!==null)de.return=U,Rt=de;else e:for(;Rt!==null;){if(U=Rt,U.flags&2048)switch(U.tag){case 0:case 11:case 15:Hd(9,U,U.return)}var De=U.sibling;if(De!==null){De.return=U.return,Rt=De;break e}Rt=U.return}}var Ne=m.current;for(Rt=Ne;Rt!==null;){de=Rt;var Ve=de.child;if(de.subtreeFlags&2064&&Ve!==null)Ve.return=de,Rt=Ve;else e:for(de=Ne;Rt!==null;){if(Ce=Rt,Ce.flags&2048)try{switch(Ce.tag){case 0:case 11:case 15:ey(9,Ce)}}catch(nn){co(Ce,Ce.return,nn)}if(Ce===de){Rt=null;break e}var Lt=Ce.sibling;if(Lt!==null){Lt.return=Ce.return,Rt=Lt;break e}Rt=Ce.return}}if(Bn=D,ia(),ra&&typeof ra.onPostCommitFiberRoot=="function")try{ra.onPostCommitFiberRoot($f,m)}catch{}A=!0}return A}finally{Kn=E,mi.transition=g}}return!1}function zP(m,g,E){g=G2(E,g),g=Q3(m,g,1),ml(m,g),g=Fs(),m=fw(m,1),m!==null&&(Fd(m,1,g),lo(m,g))}function co(m,g,E){if(m.tag===3)zP(m,m,E);else for(;g!==null;){if(g.tag===3){zP(g,m,E);break}else if(g.tag===1){var A=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(ou===null||!ou.has(A))){m=G2(E,m),m=J3(g,m,1),ml(g,m),m=Fs(),g=fw(g,1),g!==null&&(Fd(g,1,m),lo(g,m));break}}g=g.return}}function ZK(m,g,E){var A=m.pingCache;A!==null&&A.delete(g),g=Fs(),m.pingedLanes|=m.suspendedLanes&E,Ei===m&&(es&E)===E&&(Ri===4||Ri===3&&(es&130023424)===es&&500>ai()-cE?Gd(m,0):lE|=E),lo(m,g)}function UP(m,g){g===0&&(m.mode&1?(g=Od,Od<<=1,!(Od&130023424)&&(Od=4194304)):g=1);var E=Fs();m=fw(m,g),m!==null&&(Fd(m,g,E),lo(m,E))}function QK(m){var g=m.memoizedState,E=0;g!==null&&(E=g.retryLane),UP(m,E)}function JK(m,g){var E=0;switch(m.tag){case 13:var A=m.stateNode,D=m.memoizedState;D!==null&&(E=D.retryLane);break;case 19:A=m.stateNode;break;default:throw Error(o(314))}A!==null&&A.delete(g),UP(m,E)}var BP;BP=function(m,g,E){if(m!==null)if(m.memoizedProps!==g.pendingProps||fn.current)ko=!0;else{if(!(m.lanes&E)&&!(g.flags&128))return ko=!1,BK(m,g,E);ko=!!(m.flags&131072)}else ko=!1,Gt&&g.flags&1048576&&St(g,V,g.index);switch(g.lanes=0,g.tag){case 2:var A=g.type;m!==null&&(m.alternate=null,g.alternate=null,g.flags|=2),m=g.pendingProps;var D=zr(g,an.current);fl(g,E),D=$2(null,g,A,m,D,E);var U=j2();return g.flags|=1,typeof D=="object"&&D!==null&&typeof D.render=="function"&&D.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,Tr(A)?(U=!0,bn(g)):U=!1,g.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,jg(g),D.updater=Kf,g.stateNode=D,D._reactInternals=g,Yf(g,A,m,E),g=K2(null,g,A,!0,U,E)):(g.tag=0,Gt&&U&&un(g),Os(null,g,D,E),g=g.child),g;case 16:A=g.elementType;e:{switch(m!==null&&(m.alternate=null,g.alternate=null,g.flags|=2),m=g.pendingProps,D=A._init,A=D(A._payload),g.type=A,D=g.tag=tY(A),m=No(A,m),D){case 0:g=X2(null,g,A,m,E);break e;case 1:g=uP(null,g,A,m,E);break e;case 11:g=sP(null,g,A,m,E);break e;case 14:g=oP(null,g,A,No(A.type,m),E);break e}throw Error(o(306,A,""))}return g;case 0:return A=g.type,D=g.pendingProps,D=g.elementType===A?D:No(A,D),X2(m,g,A,D,E);case 1:return A=g.type,D=g.pendingProps,D=g.elementType===A?D:No(A,D),uP(m,g,A,D,E);case 3:e:{if(dP(g),m===null)throw Error(o(387));A=g.pendingProps,U=g.memoizedState,D=U.element,Px(m,g),Xf(g,A,null,E);var de=g.memoizedState;if(A=de.element,ze&&U.isDehydrated)if(U={element:A,isDehydrated:!1,cache:de.cache,transitions:de.transitions},g.updateQueue.baseState=U,g.memoizedState=U,g.flags&256){D=Error(o(423)),g=hP(m,g,A,E,D);break e}else if(A!==D){D=Error(o(424)),g=hP(m,g,A,E,D);break e}else for(ze&&(Yt=Ra(g.stateNode.containerInfo),yt=g,Gt=!0,jn=null,hr=!1),E=R3(g,null,A,E),g.child=E;E;)E.flags=E.flags&-3|4096,E=E.sibling;else{if(su(),A===D){g=cc(m,g,E);break e}Os(m,g,A,E)}g=g.child}return g;case 5:return P3(g),m===null&&Yn(g),A=g.type,D=g.pendingProps,U=m!==null?m.memoizedProps:null,de=D.children,Ue(A,D)?de=null:U!==null&&Ue(A,U)&&(g.flags|=32),cP(m,g),Os(m,g,de,E),g.child;case 6:return m===null&&Yn(g),null;case 13:return fP(m,g,E);case 4:return O2(g,g.stateNode.containerInfo),A=g.pendingProps,m===null?g.child=Qf(g,null,A,E):Os(m,g,A,E),g.child;case 11:return A=g.type,D=g.pendingProps,D=g.elementType===A?D:No(A,D),sP(m,g,A,D,E);case 7:return Os(m,g,g.pendingProps,E),g.child;case 8:return Os(m,g,g.pendingProps.children,E),g.child;case 12:return Os(m,g,g.pendingProps.children,E),g.child;case 10:e:{if(A=g.type._context,D=g.pendingProps,U=g.memoizedProps,de=D.value,Rx(g,A,de),U!==null)if(so(U.value,de)){if(U.children===D.children&&!fn.current){g=cc(m,g,E);break e}}else for(U=g.child,U!==null&&(U.return=g);U!==null;){var Ce=U.dependencies;if(Ce!==null){de=U.child;for(var qe=Ce.firstContext;qe!==null;){if(qe.context===A){if(U.tag===1){qe=oa(-1,E&-E),qe.tag=2;var mt=U.updateQueue;if(mt!==null){mt=mt.shared;var Wt=mt.pending;Wt===null?qe.next=qe:(qe.next=Wt.next,Wt.next=qe),mt.pending=qe}}U.lanes|=E,qe=U.alternate,qe!==null&&(qe.lanes|=E),Bd(U.return,E,g),Ce.lanes|=E;break}qe=qe.next}}else if(U.tag===10)de=U.type===g.type?null:U.child;else if(U.tag===18){if(de=U.return,de===null)throw Error(o(341));de.lanes|=E,Ce=de.alternate,Ce!==null&&(Ce.lanes|=E),Bd(de,E,g),de=U.sibling}else de=U.child;if(de!==null)de.return=U;else for(de=U;de!==null;){if(de===g){de=null;break}if(U=de.sibling,U!==null){U.return=de.return,de=U;break}de=de.return}U=de}Os(m,g,D.children,E),g=g.child}return g;case 9:return D=g.type,A=g.pendingProps.children,fl(g,E),D=Ds(D),A=A(D),g.flags|=1,Os(m,g,A,E),g.child;case 14:return A=g.type,D=No(A,g.pendingProps),D=No(A.type,D),oP(m,g,A,D,E);case 15:return aP(m,g,g.type,g.pendingProps,E);case 17:return A=g.type,D=g.pendingProps,D=g.elementType===A?D:No(A,D),m!==null&&(m.alternate=null,g.alternate=null,g.flags|=2),g.tag=1,Tr(A)?(m=!0,bn(g)):m=!1,fl(g,E),Fx(g,A,D),Yf(g,A,D,E),K2(null,g,A,!0,m,E);case 19:return yP(m,g,E);case 22:return lP(m,g,E)}throw Error(o(156,g.tag))};function $P(m,g){return Ug(m,g)}function eY(m,g,E,A){this.tag=m,this.key=E,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ua(m,g,E,A){return new eY(m,g,E,A)}function yE(m){return m=m.prototype,!(!m||!m.isReactComponent)}function tY(m){if(typeof m=="function")return yE(m)?1:0;if(m!=null){if(m=m.$$typeof,m===x)return 11;if(m===b)return 14}return 2}function uu(m,g){var E=m.alternate;return E===null?(E=ua(m.tag,g,m.key,m.mode),E.elementType=m.elementType,E.type=m.type,E.stateNode=m.stateNode,E.alternate=m,m.alternate=E):(E.pendingProps=g,E.type=m.type,E.flags=0,E.subtreeFlags=0,E.deletions=null),E.flags=m.flags&14680064,E.childLanes=m.childLanes,E.lanes=m.lanes,E.child=m.child,E.memoizedProps=m.memoizedProps,E.memoizedState=m.memoizedState,E.updateQueue=m.updateQueue,g=m.dependencies,E.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},E.sibling=m.sibling,E.index=m.index,E.ref=m.ref,E}function mw(m,g,E,A,D,U){var de=2;if(A=m,typeof m=="function")yE(m)&&(de=1);else if(typeof m=="string")de=5;else e:switch(m){case u:return Kd(E.children,D,U,g);case d:de=8,D|=8;break;case h:return m=ua(12,E,g,D|2),m.elementType=h,m.lanes=U,m;case v:return m=ua(13,E,g,D),m.elementType=v,m.lanes=U,m;case y:return m=ua(19,E,g,D),m.elementType=y,m.lanes=U,m;case _:return gw(E,D,U,g);default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case f:de=10;break e;case p:de=9;break e;case x:de=11;break e;case b:de=14;break e;case S:de=16,A=null;break e}throw Error(o(130,m==null?m:typeof m,""))}return g=ua(de,E,g,D),g.elementType=m,g.type=A,g.lanes=U,g}function Kd(m,g,E,A){return m=ua(7,m,A,g),m.lanes=E,m}function gw(m,g,E,A){return m=ua(22,m,A,g),m.elementType=_,m.lanes=E,m.stateNode={},m}function vE(m,g,E){return m=ua(6,m,null,g),m.lanes=E,m}function xE(m,g,E){return g=ua(4,m.children!==null?m.children:[],m.key,g),g.lanes=E,g.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},g}function nY(m,g,E,A,D){this.tag=g,this.containerInfo=m,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=rt,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fg(0),this.expirationTimes=Fg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fg(0),this.identifierPrefix=A,this.onRecoverableError=D,ze&&(this.mutableSourceEagerHydrationData=null)}function jP(m,g,E,A,D,U,de,Ce,qe){return m=new nY(m,g,E,Ce,qe),g===1?(g=1,U===!0&&(g|=8)):g=0,U=ua(3,null,null,g),m.current=U,U.stateNode=m,U.memoizedState={element:A,isDehydrated:E,cache:null,transitions:null},jg(U),m}function VP(m){if(!m)return Cn;m=m._reactInternals;e:{if(z(m)!==m||m.tag!==1)throw Error(o(170));var g=m;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(Tr(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(o(171))}if(m.tag===1){var E=m.type;if(Tr(E))return $n(m,E,g)}return g}function WP(m){var g=m._reactInternals;if(g===void 0)throw typeof m.render=="function"?Error(o(188)):(m=Object.keys(m).join(","),Error(o(268,m)));return m=W(g),m===null?null:m.stateNode}function HP(m,g){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var E=m.retryLane;m.retryLane=E!==0&&E<g?E:g}}function wE(m,g){HP(m,g),(m=m.alternate)&&HP(m,g)}function rY(m){return m=W(m),m===null?null:m.stateNode}function iY(){return null}return t.attemptContinuousHydration=function(m){if(m.tag===13){var g=Fs();ca(m,134217728,g),wE(m,134217728)}},t.attemptHydrationAtCurrentPriority=function(m){if(m.tag===13){var g=Fs(),E=lu(m);ca(m,E,g),wE(m,E)}},t.attemptSynchronousHydration=function(m){switch(m.tag){case 3:var g=m.stateNode;if(g.current.memoizedState.isDehydrated){var E=nu(g.pendingLanes);E!==0&&(zg(g,E|1),lo(g,ai()),!(Bn&6)&&(ip(),ia()))}break;case 13:var A=Fs();PP(function(){return ca(m,1,A)}),wE(m,1)}},t.batchedUpdates=function(m,g){var E=Bn;Bn|=1;try{return m(g)}finally{Bn=E,Bn===0&&(ip(),Pa&&ia())}},t.createComponentSelector=function(m){return{$$typeof:tw,value:m}},t.createContainer=function(m,g,E,A,D,U,de){return jP(m,g,!1,null,E,A,D,U,de)},t.createHasPseudoClassSelector=function(m){return{$$typeof:nw,value:m}},t.createHydrationContainer=function(m,g,E,A,D,U,de,Ce,qe){return m=jP(E,A,!0,m,D,U,de,Ce,qe),m.context=VP(null),E=m.current,A=Fs(),D=lu(E),U=oa(A,D),U.callback=g??null,ml(E,U),m.current.lanes=D,Fd(m,D,A),lo(m,A),m},t.createPortal=function(m,g,E){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:A==null?null:""+A,children:m,containerInfo:g,implementation:E}},t.createRoleSelector=function(m){return{$$typeof:rw,value:m}},t.createTestNameSelector=function(m){return{$$typeof:iw,value:m}},t.createTextSelector=function(m){return{$$typeof:sw,value:m}},t.deferredUpdates=function(m){var g=Kn,E=mi.transition;try{return mi.transition=null,Kn=16,m()}finally{Kn=g,mi.transition=E}},t.discreteUpdates=function(m,g,E,A,D){var U=Kn,de=mi.transition;try{return mi.transition=null,Kn=1,m(g,E,A,D)}finally{Kn=U,mi.transition=de,Bn===0&&ip()}},t.findAllNodes=oE,t.findBoundingRects=function(m,g){if(!G)throw Error(o(363));g=oE(m,g),m=[];for(var E=0;E<g.length;E++)m.push(J(g[E]));for(g=m.length-1;0<g;g--){E=m[g];for(var A=E.x,D=A+E.width,U=E.y,de=U+E.height,Ce=g-1;0<=Ce;Ce--)if(g!==Ce){var qe=m[Ce],mt=qe.x,Wt=mt+qe.width,_n=qe.y,dn=_n+qe.height;if(A>=mt&&U>=_n&&D<=Wt&&de<=dn){m.splice(g,1);break}else if(A!==mt||E.width!==qe.width||dn<U||_n>de){if(!(U!==_n||E.height!==qe.height||Wt<A||mt>D)){mt>A&&(qe.width+=mt-A,qe.x=A),Wt<D&&(qe.width=D-mt),m.splice(g,1);break}}else{_n>U&&(qe.height+=_n-U,qe.y=U),dn<de&&(qe.height=de-_n),m.splice(g,1);break}}}return m},t.findHostInstance=WP,t.findHostInstanceWithNoPortals=function(m){return m=L(m),m=m!==null?$(m):null,m===null?null:m.stateNode},t.findHostInstanceWithWarning=function(m){return WP(m)},t.flushControlled=function(m){var g=Bn;Bn|=1;var E=mi.transition,A=Kn;try{mi.transition=null,Kn=1,m()}finally{Kn=A,mi.transition=E,Bn=g,Bn===0&&(ip(),ia())}},t.flushPassiveEffects=Xd,t.flushSync=PP,t.focusWithin=function(m,g){if(!G)throw Error(o(363));for(m=rE(m),g=kP(m,g),g=Array.from(g),m=0;m<g.length;){var E=g[m++];if(!ee(E)){if(E.tag===5&&Me(E.stateNode))return!0;for(E=E.child;E!==null;)g.push(E),E=E.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Kn},t.getFindAllNodesFailureDescription=function(m,g){if(!G)throw Error(o(363));var E=0,A=[];m=[rE(m),0];for(var D=0;D<m.length;){var U=m[D++],de=m[D++],Ce=g[de];if((U.tag!==5||!ee(U))&&(iE(U,Ce)&&(A.push(sE(Ce)),de++,de>E&&(E=de)),de<g.length))for(U=U.child;U!==null;)m.push(U,de),U=U.sibling}if(E<g.length){for(m=[];E<g.length;E++)m.push(sE(g[E]));return`findAllNodes was able to match part of the selector:
  `+(A.join(" > ")+`

No matching component was found for:
  `)+m.join(" > ")}return null},t.getPublicRootInstance=function(m){if(m=m.current,!m.child)return null;switch(m.child.tag){case 5:return Y(m.child.stateNode);default:return m.child.stateNode}},t.injectIntoDevTools=function(m){if(m={bundleType:m.bundleType,version:m.version,rendererPackageName:m.rendererPackageName,rendererConfig:m.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:rY,findFiberByHostInstance:m.findFiberByHostInstance||iY,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")m=!1;else{var g=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(g.isDisabled||!g.supportsFiber)m=!0;else{try{$f=g.inject(m),ra=g}catch{}m=!!g.checkDCE}}return m},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(m,g,E,A){if(!G)throw Error(o(363));m=oE(m,g);var D=Ae(m,E,A).disconnect;return{disconnect:function(){D()}}},t.registerMutableSourceForHydration=function(m,g){var E=g._getVersion;E=E(g._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[g,E]:m.mutableSourceEagerHydrationData.push(g,E)},t.runWithPriority=function(m,g){var E=Kn;try{return Kn=m,g()}finally{Kn=E}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(m,g,E,A){var D=g.current,U=Fs(),de=lu(D);return E=VP(E),g.context===null?g.context=E:g.pendingContext=E,g=oa(U,de),g.payload={element:m},A=A===void 0?null:A,A!==null&&(g.callback=A),ml(D,g),m=ca(D,de,U),m!==null&&Gf(m,D,de),de},t};wH.exports=_ge;var Ege=wH.exports;const Cge=B0(Ege),MR={},AR=n=>void Object.assign(MR,n);function Tge(n,e){function t(u,{args:d=[],attach:h,...f},p){let x=`${u[0].toUpperCase()}${u.slice(1)}`,v;if(u==="primitive"){if(f.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const y=f.object;v=Up(y,{type:u,root:p,attach:h,primitive:!0})}else{const y=MR[x];if(!y)throw new Error(`R3F: ${x} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(d))throw new Error("R3F: The args prop must be an array!");v=Up(new y(...d),{type:u,root:p,attach:h,memoizedProps:{args:d}})}return v.__r3f.attach===void 0&&(v.isBufferGeometry?v.__r3f.attach="geometry":v.isMaterial&&(v.__r3f.attach="material")),x!=="inject"&&YC(v,f),v}function r(u,d){let h=!1;if(d){var f,p;(f=d.__r3f)!=null&&f.attach?KC(u,d,d.__r3f.attach):d.isObject3D&&u.isObject3D&&(u.add(d),h=!0),h||(p=u.__r3f)==null||p.objects.push(d),d.__r3f||Up(d,{}),d.__r3f.parent=u,GA(d),Bp(d)}}function i(u,d,h){let f=!1;if(d){var p,x;if((p=d.__r3f)!=null&&p.attach)KC(u,d,d.__r3f.attach);else if(d.isObject3D&&u.isObject3D){d.parent=u,d.dispatchEvent({type:"added"}),u.dispatchEvent({type:"childadded",child:d});const v=u.children.filter(b=>b!==d),y=v.indexOf(h);u.children=[...v.slice(0,y),d,...v.slice(y)],f=!0}f||(x=u.__r3f)==null||x.objects.push(d),d.__r3f||Up(d,{}),d.__r3f.parent=u,GA(d),Bp(d)}}function s(u,d,h=!1){u&&[...u].forEach(f=>o(d,f,h))}function o(u,d,h){if(d){var f,p,x;if(d.__r3f&&(d.__r3f.parent=null),(f=u.__r3f)!=null&&f.objects&&(u.__r3f.objects=u.__r3f.objects.filter(_=>_!==d)),(p=d.__r3f)!=null&&p.attach)BF(u,d,d.__r3f.attach);else if(d.isObject3D&&u.isObject3D){var v;u.remove(d),(v=d.__r3f)!=null&&v.root&&Pge(vb(d),d)}const b=(x=d.__r3f)==null?void 0:x.primitive,S=!b&&(h===void 0?d.dispose!==null:h);if(!b){var y;s((y=d.__r3f)==null?void 0:y.objects,d,S),s(d.children,d,S)}if(delete d.__r3f,S&&d.dispose&&d.type!=="Scene"){const _=()=>{try{d.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?WA.unstable_scheduleCallback(WA.unstable_IdlePriority,_):_()}Bp(u)}}function a(u,d,h,f){var p;const x=(p=u.__r3f)==null?void 0:p.parent;if(!x)return;const v=t(d,h,u.__r3f.root);if(u.children){for(const y of u.children)y.__r3f&&r(v,y);u.children=u.children.filter(y=>!y.__r3f)}u.__r3f.objects.forEach(y=>r(v,y)),u.__r3f.objects=[],u.__r3f.autoRemovedBeforeAppend||o(x,u),v.parent&&(v.__r3f.autoRemovedBeforeAppend=!0),r(x,v),v.raycast&&v.__r3f.eventCount&&vb(v).getState().internal.interaction.push(v),[f,f.alternate].forEach(y=>{y!==null&&(y.stateNode=v,y.ref&&(typeof y.ref=="function"?y.ref(v):y.ref.current=v))})}const l=()=>{};return{reconciler:Cge({createInstance:t,removeChild:o,appendChild:r,appendInitialChild:r,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(u,d)=>{if(!d)return;const h=u.getState().scene;h.__r3f&&(h.__r3f.root=u,r(h,d))},removeChildFromContainer:(u,d)=>{d&&o(u.getState().scene,d)},insertInContainerBefore:(u,d,h)=>{if(!d||!h)return;const f=u.getState().scene;f.__r3f&&i(f,d,h)},getRootHostContext:()=>null,getChildHostContext:u=>u,finalizeInitialChildren(u){var d;return!!((d=u==null?void 0:u.__r3f)!=null?d:{}).handlers},prepareUpdate(u,d,h,f){var p;if(((p=u==null?void 0:u.__r3f)!=null?p:{}).primitive&&f.object&&f.object!==u)return[!0];{const{args:v=[],children:y,...b}=f,{args:S=[],children:_,...T}=h;if(!Array.isArray(v))throw new Error("R3F: the args prop must be an array!");if(v.some((k,P)=>k!==S[P]))return[!0];const M=NH(u,b,T,!0);return M.changes.length?[!1,M]:null}},commitUpdate(u,[d,h],f,p,x,v){d?a(u,f,x,v):YC(u,h)},commitMount(u,d,h,f){var p;const x=(p=u.__r3f)!=null?p:{};u.raycast&&x.handlers&&x.eventCount&&vb(u).getState().internal.interaction.push(u)},getPublicInstance:u=>u,prepareForCommit:()=>null,preparePortalMount:u=>Up(u.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(u){var d;const{attach:h,parent:f}=(d=u.__r3f)!=null?d:{};h&&f&&BF(f,u,h),u.isObject3D&&(u.visible=!1),Bp(u)},unhideInstance(u,d){var h;const{attach:f,parent:p}=(h=u.__r3f)!=null?h:{};f&&p&&KC(p,u,f),(u.isObject3D&&d.visible==null||d.visible)&&(u.visible=!0),Bp(u)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():cm.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Rr.fun(performance.now)?performance.now:Rr.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Rr.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Rr.fun(clearTimeout)?clearTimeout:void 0}),applyProps:YC}}var OF,FF;const XC=n=>"colorSpace"in n||"outputColorSpace"in n,_H=()=>{var n;return(n=MR.ColorManagement)!=null?n:null},EH=n=>n&&n.isOrthographicCamera,Mge=n=>n&&n.hasOwnProperty("current"),mx=typeof window<"u"&&((OF=window.document)!=null&&OF.createElement||((FF=window.navigator)==null?void 0:FF.product)==="ReactNative")?N.useLayoutEffect:N.useEffect;function CH(n){const e=N.useRef(n);return mx(()=>void(e.current=n),[n]),e}function Age({set:n}){return mx(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class TH extends N.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}TH.getDerivedStateFromError=()=>({error:!0});const MH="__default",zF=new Map,Nge=n=>n&&!!n.memoized&&!!n.changes;function AH(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}const Ny=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()};function vb(n){let e=n.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const Rr={obj:n=>n===Object(n)&&!Rr.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:r="reference",strict:i=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(Rr.str(n)||Rr.num(n)||Rr.boo(n))return n===e;const s=Rr.obj(n);if(s&&r==="reference")return n===e;const o=Rr.arr(n);if(o&&t==="reference")return n===e;if((o||s)&&n===e)return!0;let a;for(a in n)if(!(a in e))return!1;if(s&&t==="shallow"&&r==="shallow"){for(a in i?e:n)if(!Rr.equ(n[a],e[a],{strict:i,objects:"reference"}))return!1}else for(a in i?e:n)if(n[a]!==e[a])return!1;if(Rr.und(a)){if(o&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function kge(n){const e={nodes:{},materials:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function Ige(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function Up(n,e){const t=n;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function HA(n,e){let t=n;if(e.includes("-")){const r=e.split("-"),i=r.pop();return t=r.reduce((s,o)=>s[o],n),{target:t,key:i}}else return{target:t,key:e}}const UF=/-\d+$/;function KC(n,e,t){if(Rr.str(t)){if(UF.test(t)){const s=t.replace(UF,""),{target:o,key:a}=HA(n,s);Array.isArray(o[a])||(o[a]=[])}const{target:r,key:i}=HA(n,t);e.__r3f.previousAttach=r[i],r[i]=e}else e.__r3f.previousAttach=t(n,e)}function BF(n,e,t){var r,i;if(Rr.str(t)){const{target:s,key:o}=HA(n,t),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(r=e.__r3f)==null||r.previousAttach==null||r.previousAttach(n,e);(i=e.__r3f)==null||delete i.previousAttach}function NH(n,{children:e,key:t,ref:r,...i},{children:s,key:o,ref:a,...l}={},c=!1){const u=n.__r3f,d=Object.entries(i),h=[];if(c){const p=Object.keys(l);for(let x=0;x<p.length;x++)i.hasOwnProperty(p[x])||d.unshift([p[x],MH+"remove"])}d.forEach(([p,x])=>{var v;if((v=n.__r3f)!=null&&v.primitive&&p==="object"||Rr.equ(x,l[p]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(p))return h.push([p,x,!0,[]]);let y=[];p.includes("-")&&(y=p.split("-")),h.push([p,x,!1,y]);for(const b in i){const S=i[b];b.startsWith(`${p}-`)&&h.push([b,S,!1,b.split("-")])}});const f={...i};return u!=null&&u.memoizedProps&&u!=null&&u.memoizedProps.args&&(f.args=u.memoizedProps.args),u!=null&&u.memoizedProps&&u!=null&&u.memoizedProps.attach&&(f.attach=u.memoizedProps.attach),{memoized:f,changes:h}}function YC(n,e){var t;const r=n.__r3f,i=r==null?void 0:r.root,s=i==null||i.getState==null?void 0:i.getState(),{memoized:o,changes:a}=Nge(e)?e:NH(n,e),l=r==null?void 0:r.eventCount;n.__r3f&&(n.__r3f.memoizedProps=o);for(let h=0;h<a.length;h++){let[f,p,x,v]=a[h];if(XC(n)){const _="srgb",T="srgb-linear";f==="encoding"?(f="colorSpace",p=p===3001?_:T):f==="outputEncoding"&&(f="outputColorSpace",p=p===3001?_:T)}let y=n,b=y[f];if(v.length&&(b=v.reduce((S,_)=>S[_],n),!(b&&b.set))){const[S,..._]=v.reverse();y=_.reverse().reduce((T,M)=>T[M],n),f=S}if(p===MH+"remove")if(y.constructor){let S=zF.get(y.constructor);S||(S=new y.constructor,zF.set(y.constructor,S)),p=S[f]}else p=0;if(x&&r)p?r.handlers[f]=p:delete r.handlers[f],r.eventCount=Object.keys(r.handlers).length;else if(b&&b.set&&(b.copy||b instanceof Hh)){if(Array.isArray(p))b.fromArray?b.fromArray(p):b.set(...p);else if(b.copy&&p&&p.constructor&&b.constructor===p.constructor)b.copy(p);else if(p!==void 0){var c;const S=(c=b)==null?void 0:c.isColor;!S&&b.setScalar?b.setScalar(p):b instanceof Hh&&p instanceof Hh?b.mask=p.mask:b.set(p),!_H()&&s&&!s.linear&&S&&b.convertSRGBToLinear()}}else{var u;if(y[f]=p,(u=y[f])!=null&&u.isTexture&&y[f].format===Ii&&y[f].type===Wo&&s){const S=y[f];XC(S)&&XC(s.gl)?S.colorSpace=s.gl.outputColorSpace:S.encoding=s.gl.outputEncoding}}Bp(n)}if(r&&r.parent&&n.raycast&&l!==r.eventCount){const h=vb(n).getState().internal,f=h.interaction.indexOf(n);f>-1&&h.interaction.splice(f,1),r.eventCount&&h.interaction.push(n)}return!(a.length===1&&a[0][0]==="onUpdate")&&a.length&&(t=n.__r3f)!=null&&t.parent&&GA(n),n}function Bp(n){var e,t;const r=(e=n.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();r&&r.internal.frames===0&&r.invalidate()}function GA(n){n.onUpdate==null||n.onUpdate(n)}function kH(n,e){n.manual||(EH(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function P1(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function Rge(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return cm.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return cm.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return cm.ContinuousEventPriority;default:return cm.DefaultEventPriority}}function IH(n,e,t,r){const i=t.get(e);i&&(t.delete(e),t.size===0&&(n.delete(r),i.target.releasePointerCapture(r)))}function Pge(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(r=>r!==e),t.initialHits=t.initialHits.filter(r=>r!==e),t.hovered.forEach((r,i)=>{(r.eventObject===e||r.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((r,i)=>{IH(t.capturedMap,e,r,i)})}function Dge(n){function e(l){const{internal:c}=n.getState(),u=l.offsetX-c.initialClick[0],d=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(u*u+d*d))}function t(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(u=>{var d;return(d=c.__r3f)==null?void 0:d.handlers["onPointer"+u]}))}function r(l,c){const u=n.getState(),d=new Set,h=[],f=c?c(u.internal.interaction):u.internal.interaction;for(let y=0;y<f.length;y++){const b=Ny(f[y]);b&&(b.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(l,u);function p(y){const b=Ny(y);if(!b||!b.events.enabled||b.raycaster.camera===null)return[];if(b.raycaster.camera===void 0){var S;b.events.compute==null||b.events.compute(l,b,(S=b.previousRoot)==null?void 0:S.getState()),b.raycaster.camera===void 0&&(b.raycaster.camera=null)}return b.raycaster.camera?b.raycaster.intersectObject(y,!0):[]}let x=f.flatMap(p).sort((y,b)=>{const S=Ny(y.object),_=Ny(b.object);return!S||!_?y.distance-b.distance:_.events.priority-S.events.priority||y.distance-b.distance}).filter(y=>{const b=P1(y);return d.has(b)?!1:(d.add(b),!0)});u.events.filter&&(x=u.events.filter(x,u));for(const y of x){let b=y.object;for(;b;){var v;(v=b.__r3f)!=null&&v.eventCount&&h.push({...y,eventObject:b}),b=b.parent}}if("pointerId"in l&&u.internal.capturedMap.has(l.pointerId))for(let y of u.internal.capturedMap.get(l.pointerId).values())d.has(P1(y.intersection))||h.push(y.intersection);return h}function i(l,c,u,d){const h=n.getState();if(l.length){const f={stopped:!1};for(const p of l){const x=Ny(p.object)||h,{raycaster:v,pointer:y,camera:b,internal:S}=x,_=new ie(y.x,y.y,0).unproject(b),T=I=>{var L,W;return(L=(W=S.capturedMap.get(I))==null?void 0:W.has(p.eventObject))!=null?L:!1},M=I=>{const L={intersection:p,target:c.target};S.capturedMap.has(I)?S.capturedMap.get(I).set(p.eventObject,L):S.capturedMap.set(I,new Map([[p.eventObject,L]])),c.target.setPointerCapture(I)},k=I=>{const L=S.capturedMap.get(I);L&&IH(S.capturedMap,p.eventObject,L,I)};let P={};for(let I in c){let L=c[I];typeof L!="function"&&(P[I]=L)}let z={...p,...P,pointer:y,intersections:l,stopped:f.stopped,delta:u,unprojectedPoint:_,ray:v.ray,camera:b,stopPropagation(){const I="pointerId"in c&&S.capturedMap.get(c.pointerId);if((!I||I.has(p.eventObject))&&(z.stopped=f.stopped=!0,S.hovered.size&&Array.from(S.hovered.values()).find(L=>L.eventObject===p.eventObject))){const L=l.slice(0,l.indexOf(p));s([...L,p])}},target:{hasPointerCapture:T,setPointerCapture:M,releasePointerCapture:k},currentTarget:{hasPointerCapture:T,setPointerCapture:M,releasePointerCapture:k},nativeEvent:c};if(d(z),f.stopped===!0)break}}return l}function s(l){const{internal:c}=n.getState();for(const u of c.hovered.values())if(!l.length||!l.find(d=>d.object===u.object&&d.index===u.index&&d.instanceId===u.instanceId)){const h=u.eventObject.__r3f,f=h==null?void 0:h.handlers;if(c.hovered.delete(P1(u)),h!=null&&h.eventCount){const p={...u,intersections:l};f.onPointerOut==null||f.onPointerOut(p),f.onPointerLeave==null||f.onPointerLeave(p)}}}function o(l,c){for(let u=0;u<c.length;u++){const d=c[u].__r3f;d==null||d.handlers.onPointerMissed==null||d.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:u}=n.getState();"pointerId"in c&&u.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(c.pointerId)&&(u.capturedMap.delete(c.pointerId),s([]))})}}return function(u){const{onPointerMissed:d,internal:h}=n.getState();h.lastEvent.current=u;const f=l==="onPointerMove",p=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",v=r(u,f?t:void 0),y=p?e(u):0;l==="onPointerDown"&&(h.initialClick=[u.offsetX,u.offsetY],h.initialHits=v.map(S=>S.eventObject)),p&&!v.length&&y<=2&&(o(u,h.interaction),d&&d(u)),f&&s(v);function b(S){const _=S.eventObject,T=_.__r3f,M=T==null?void 0:T.handlers;if(T!=null&&T.eventCount)if(f){if(M.onPointerOver||M.onPointerEnter||M.onPointerOut||M.onPointerLeave){const k=P1(S),P=h.hovered.get(k);P?P.stopped&&S.stopPropagation():(h.hovered.set(k,S),M.onPointerOver==null||M.onPointerOver(S),M.onPointerEnter==null||M.onPointerEnter(S))}M.onPointerMove==null||M.onPointerMove(S)}else{const k=M[l];k?(!p||h.initialHits.includes(_))&&(o(u,h.interaction.filter(P=>!h.initialHits.includes(P))),k(S)):p&&h.initialHits.includes(_)&&o(u,h.interaction.filter(P=>!h.initialHits.includes(P)))}}i(v,u,y,b)}}return{handlePointer:a}}const Lge=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],RH=n=>!!(n!=null&&n.render),NR=N.createContext(null),Oge=(n,e)=>{const t=yH((a,l)=>{const c=new ie,u=new ie,d=new ie;function h(y=l().camera,b=u,S=l().size){const{width:_,height:T,top:M,left:k}=S,P=_/T;b.isVector3?d.copy(b):d.set(...b);const z=y.getWorldPosition(c).distanceTo(d);if(EH(y))return{width:_/y.zoom,height:T/y.zoom,top:M,left:k,factor:1,distance:z,aspect:P};{const I=y.fov*Math.PI/180,L=2*Math.tan(I/2)*z,W=L*(_/T);return{width:W,height:L,top:M,left:k,factor:_/W,distance:z,aspect:P}}}let f;const p=y=>a(b=>({performance:{...b.performance,current:y}})),x=new Ze;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(y=1)=>n(l(),y),advance:(y,b)=>e(y,b,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new _R,pointer:x,mouse:x,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const y=l();f&&clearTimeout(f),y.performance.current!==y.performance.min&&p(y.performance.min),f=setTimeout(()=>p(l().performance.max),y.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:h},setEvents:y=>a(b=>({...b,events:{...b.events,...y}})),setSize:(y,b,S,_,T)=>{const M=l().camera,k={width:y,height:b,top:_||0,left:T||0,updateStyle:S};a(P=>({size:k,viewport:{...P.viewport,...h(M,u,k)}}))},setDpr:y=>a(b=>{const S=AH(y);return{viewport:{...b.viewport,dpr:S,initialDpr:b.viewport.initialDpr||S}}}),setFrameloop:(y="always")=>{const b=l().clock;b.stop(),b.elapsedTime=0,y!=="never"&&(b.start(),b.elapsedTime=0),a(()=>({frameloop:y}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:N.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(y,b,S)=>{const _=l().internal;return _.priority=_.priority+(b>0?1:0),_.subscribers.push({ref:y,priority:b,store:S}),_.subscribers=_.subscribers.sort((T,M)=>T.priority-M.priority),()=>{const T=l().internal;T!=null&&T.subscribers&&(T.priority=T.priority-(b>0?1:0),T.subscribers=T.subscribers.filter(M=>M.ref!==y))}}}}}),r=t.getState();let i=r.size,s=r.viewport.dpr,o=r.camera;return t.subscribe(()=>{const{camera:a,size:l,viewport:c,gl:u,set:d}=t.getState();if(l.width!==i.width||l.height!==i.height||c.dpr!==s){var h;i=l,s=c.dpr,kH(a,l),u.setPixelRatio(c.dpr);const f=(h=l.updateStyle)!=null?h:typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(l.width,l.height,f)}a!==o&&(o=a,d(f=>({viewport:{...f.viewport,...f.viewport.getCurrentViewport(a)}})))}),t.subscribe(a=>n(a)),t};let D1,Fge=new Set,zge=new Set,Uge=new Set;function ZC(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function ky(n,e){switch(n){case"before":return ZC(Fge,e);case"after":return ZC(zge,e);case"tail":return ZC(Uge,e)}}let QC,JC;function eT(n,e,t){let r=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(r=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),QC=e.internal.subscribers,D1=0;D1<QC.length;D1++)JC=QC[D1],JC.ref.current(JC.store.getState(),r,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function Bge(n){let e=!1,t=!1,r,i,s;function o(c){i=requestAnimationFrame(o),e=!0,r=0,ky("before",c),t=!0;for(const d of n.values()){var u;s=d.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((u=s.gl.xr)!=null&&u.isPresenting)&&(r+=eT(c,s))}if(t=!1,ky("after",c),r===0)return ky("tail",c),e=!1,cancelAnimationFrame(i)}function a(c,u=1){var d;if(!c)return n.forEach(h=>a(h.store.getState(),u));(d=c.gl.xr)!=null&&d.isPresenting||!c.internal.active||c.frameloop==="never"||(u>1?c.internal.frames=Math.min(60,c.internal.frames+u):t?c.internal.frames=2:c.internal.frames=1,e||(e=!0,requestAnimationFrame(o)))}function l(c,u=!0,d,h){if(u&&ky("before",c),d)eT(c,d,h);else for(const f of n.values())eT(c,f.store.getState());u&&ky("after",c)}return{loop:o,invalidate:a,advance:l}}function kR(){const n=N.useContext(NR);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function Yi(n=t=>t,e){return kR()(n,e)}function u2(n,e=0){const t=kR(),r=t.getState().internal.subscribe,i=CH(n);return mx(()=>r(i,e,t),[e,r,t]),null}const $F=new WeakMap;function PH(n,e){return function(t,...r){let i=$F.get(t);return i||(i=new t,$F.set(t,i)),n&&n(i),Promise.all(r.map(s=>new Promise((o,a)=>i.load(s,l=>{l.scene&&Object.assign(l,kge(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l==null?void 0:l.message}`))))))}}function qm(n,e,t,r){const i=Array.isArray(e)?e:[e],s=wge(PH(t,r),[n,...i],{equal:Rr.equ});return Array.isArray(e)?s:s[0]}qm.preload=function(n,e,t){const r=Array.isArray(e)?e:[e];return bge(PH(t),[n,...r])};qm.clear=function(n,e){const t=Array.isArray(e)?e:[e];return Sge([n,...t])};const Xm=new Map,{invalidate:jF,advance:VF}=Bge(Xm),{reconciler:_0,applyProps:Nu}=Tge(Xm,Rge),Ip={objects:"shallow",strict:!1},$ge=(n,e)=>{const t=typeof n=="function"?n(e):n;return RH(t)?t:new cx({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function jge(n,e){const t=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:r,height:i,top:s,left:o,updateStyle:a=t}=e;return{width:r,height:i,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:r,height:i,top:s,left:o}=n.parentElement.getBoundingClientRect();return{width:r,height:i,top:s,left:o,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function Vge(n){const e=Xm.get(n),t=e==null?void 0:e.fiber,r=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=r||Oge(jF,VF),o=t||_0.createContainer(s,cm.ConcurrentRoot,null,!1,null,"",i,null);e||Xm.set(n,{fiber:o,store:s});let a,l=!1,c;return{configure(u={}){let{gl:d,size:h,scene:f,events:p,onCreated:x,shadows:v=!1,linear:y=!1,flat:b=!1,legacy:S=!1,orthographic:_=!1,frameloop:T="always",dpr:M=[1,2],performance:k,raycaster:P,camera:z,onPointerMissed:I}=u,L=s.getState(),W=L.gl;L.gl||L.set({gl:W=$ge(d,n)});let q=L.raycaster;q||L.set({raycaster:q=new c2});const{params:$,...ne}=P||{};if(Rr.equ(ne,q,Ip)||Nu(q,{...ne}),Rr.equ($,q.params,Ip)||Nu(q,{params:{...q.params,...$}}),!L.camera||L.camera===c&&!Rr.equ(c,z,Ip)){c=z;const oe=z instanceof ox,ve=oe?z:_?new Ic(0,0,0,0,.1,1e3):new hi(75,0,.1,1e3);oe||(ve.position.z=5,z&&(Nu(ve,z),("aspect"in z||"left"in z||"right"in z||"bottom"in z||"top"in z)&&(ve.manual=!0,ve.updateProjectionMatrix())),!L.camera&&!(z!=null&&z.rotation)&&ve.lookAt(0,0,0)),L.set({camera:ve}),q.camera=ve}if(!L.scene){let oe;f!=null&&f.isScene?oe=f:(oe=new Tg,f&&Nu(oe,f)),L.set({scene:Up(oe)})}if(!L.xr){var Y;const oe=(Xe,_e)=>{const Ue=s.getState();Ue.frameloop!=="never"&&VF(Xe,!0,Ue,_e)},ve=()=>{const Xe=s.getState();Xe.gl.xr.enabled=Xe.gl.xr.isPresenting,Xe.gl.xr.setAnimationLoop(Xe.gl.xr.isPresenting?oe:null),Xe.gl.xr.isPresenting||jF(Xe)},Te={connect(){const Xe=s.getState().gl;Xe.xr.addEventListener("sessionstart",ve),Xe.xr.addEventListener("sessionend",ve)},disconnect(){const Xe=s.getState().gl;Xe.xr.removeEventListener("sessionstart",ve),Xe.xr.removeEventListener("sessionend",ve)}};typeof((Y=W.xr)==null?void 0:Y.addEventListener)=="function"&&Te.connect(),L.set({xr:Te})}if(W.shadowMap){const oe=W.shadowMap.enabled,ve=W.shadowMap.type;if(W.shadowMap.enabled=!!v,Rr.boo(v))W.shadowMap.type=Sm;else if(Rr.str(v)){var we;const Te={basic:u6,percentage:P_,soft:Sm,variance:$a};W.shadowMap.type=(we=Te[v])!=null?we:Sm}else Rr.obj(v)&&Object.assign(W.shadowMap,v);(oe!==W.shadowMap.enabled||ve!==W.shadowMap.type)&&(W.shadowMap.needsUpdate=!0)}const H=_H();H&&("enabled"in H?H.enabled=!S:"legacyMode"in H&&(H.legacyMode=S)),l||Nu(W,{outputEncoding:y?3e3:3001,toneMapping:b?Ul:FI}),L.legacy!==S&&L.set(()=>({legacy:S})),L.linear!==y&&L.set(()=>({linear:y})),L.flat!==b&&L.set(()=>({flat:b})),d&&!Rr.fun(d)&&!RH(d)&&!Rr.equ(d,W,Ip)&&Nu(W,d),p&&!L.events.handlers&&L.set({events:p(s)});const X=jge(n,h);return Rr.equ(X,L.size,Ip)||L.setSize(X.width,X.height,X.updateStyle,X.top,X.left),M&&L.viewport.dpr!==AH(M)&&L.setDpr(M),L.frameloop!==T&&L.setFrameloop(T),L.onPointerMissed||L.set({onPointerMissed:I}),k&&!Rr.equ(k,L.performance,Ip)&&L.set(oe=>({performance:{...oe.performance,...k}})),a=x,l=!0,this},render(u){return l||this.configure(),_0.updateContainer(w.jsx(Wge,{store:s,children:u,onCreated:a,rootElement:n}),o,null,()=>{}),s},unmount(){DH(n)}}}function Wge({store:n,children:e,onCreated:t,rootElement:r}){return mx(()=>{const i=n.getState();i.set(s=>({internal:{...s.internal,active:!0}})),t&&t(i),n.getState().events.connected||i.events.connect==null||i.events.connect(r)},[]),w.jsx(NR.Provider,{value:n,children:e})}function DH(n,e){const t=Xm.get(n),r=t==null?void 0:t.fiber;if(r){const i=t==null?void 0:t.store.getState();i&&(i.internal.active=!1),_0.updateContainer(null,r,null,()=>{i&&setTimeout(()=>{try{var s,o,a,l;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=i.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=i.gl)!=null&&l.xr&&i.xr.disconnect(),Ige(i),Xm.delete(n)}catch{}},500)})}}function Hge(n,e,t){return w.jsx(Gge,{children:n,container:e,state:t},e.uuid)}function Gge({state:n={},children:e,container:t}){const{events:r,size:i,...s}=n,o=kR(),[a]=N.useState(()=>new c2),[l]=N.useState(()=>new Ze),c=N.useCallback((d,h)=>{const f={...d};Object.keys(d).forEach(x=>{(Lge.includes(x)||d[x]!==h[x]&&h[x])&&delete f[x]});let p;if(h&&i){const x=h.camera;p=d.viewport.getCurrentViewport(x,new ie,i),x!==d.camera&&kH(x,i)}return{...f,scene:t,raycaster:a,pointer:l,mouse:l,previousRoot:o,events:{...d.events,...h==null?void 0:h.events,...r},size:{...d.size,...i},viewport:{...d.viewport,...p},...s}},[n]),[u]=N.useState(()=>{const d=o.getState();return yH((f,p)=>({...d,scene:t,raycaster:a,pointer:l,mouse:l,previousRoot:o,events:{...d.events,...r},size:{...d.size,...i},...s,set:f,get:p,setEvents:x=>f(v=>({...v,events:{...v.events,...x}}))}))});return N.useEffect(()=>{const d=o.subscribe(h=>u.setState(f=>c(h,f)));return()=>{d()}},[c]),N.useEffect(()=>{u.setState(d=>c(o.getState(),d))},[c]),N.useEffect(()=>()=>{u.destroy()},[]),w.jsx(w.Fragment,{children:_0.createPortal(w.jsx(NR.Provider,{value:u,children:e}),u,null)})}_0.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:N.version});const tT={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function qge(n){const{handlePointer:e}=Dge(n);return{priority:1,enabled:!0,compute(t,r,i){r.pointer.set(t.offsetX/r.size.width*2-1,-(t.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(tT).reduce((t,r)=>({...t,[r]:e(r)}),{}),update:()=>{var t;const{events:r,internal:i}=n.getState();(t=i.lastEvent)!=null&&t.current&&r.handlers&&r.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var r;const{set:i,events:s}=n.getState();s.disconnect==null||s.disconnect(),i(o=>({events:{...o.events,connected:t}})),Object.entries((r=s.handlers)!=null?r:[]).forEach(([o,a])=>{const[l,c]=tT[o];t.addEventListener(l,a,{passive:c})})},disconnect:()=>{const{set:t,events:r}=n.getState();if(r.connected){var i;Object.entries((i=r.handlers)!=null?i:[]).forEach(([s,o])=>{if(r&&r.connected instanceof HTMLElement){const[a]=tT[s];r.connected.removeEventListener(a,o)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}function WF(n,e){let t;return(...r)=>{window.clearTimeout(t),t=window.setTimeout(()=>n(...r),e)}}function Xge({debounce:n,scroll:e,polyfill:t,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,o]=N.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=N.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=n?typeof n=="number"?n:n.scroll:null,c=n?typeof n=="number"?n:n.resize:null,u=N.useRef(!1);N.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[d,h,f]=N.useMemo(()=>{const y=()=>{if(!a.current.element)return;const{left:b,top:S,width:_,height:T,bottom:M,right:k,x:P,y:z}=a.current.element.getBoundingClientRect(),I={left:b,top:S,width:_,height:T,bottom:M,right:k,x:P,y:z};a.current.element instanceof HTMLElement&&r&&(I.height=a.current.element.offsetHeight,I.width=a.current.element.offsetWidth),Object.freeze(I),u.current&&!Qge(a.current.lastBounds,I)&&o(a.current.lastBounds=I)};return[y,c?WF(y,c):y,l?WF(y,l):y]},[o,r,l,c]);function p(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(y=>y.removeEventListener("scroll",f,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function x(){a.current.element&&(a.current.resizeObserver=new i(f),a.current.resizeObserver.observe(a.current.element),e&&a.current.scrollContainers&&a.current.scrollContainers.forEach(y=>y.addEventListener("scroll",f,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{f()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}const v=y=>{!y||y===a.current.element||(p(),a.current.element=y,a.current.scrollContainers=LH(y),x())};return Yge(f,!!e),Kge(h),N.useEffect(()=>{p(),x()},[e,f,h]),N.useEffect(()=>p,[]),[v,s,d]}function Kge(n){N.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function Yge(n,e){N.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function LH(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:r,overflowY:i}=window.getComputedStyle(n);return[t,r,i].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...LH(n.parentElement)]}const Zge=["x","y","top","bottom","left","right","width","height"],Qge=(n,e)=>Zge.every(t=>n[t]===e[t]);var Jge=Object.defineProperty,eye=Object.defineProperties,tye=Object.getOwnPropertyDescriptors,HF=Object.getOwnPropertySymbols,nye=Object.prototype.hasOwnProperty,rye=Object.prototype.propertyIsEnumerable,GF=(n,e,t)=>e in n?Jge(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,qF=(n,e)=>{for(var t in e||(e={}))nye.call(e,t)&&GF(n,t,e[t]);if(HF)for(var t of HF(e))rye.call(e,t)&&GF(n,t,e[t]);return n},iye=(n,e)=>eye(n,tye(e)),XF,KF;typeof window<"u"&&((XF=window.document)!=null&&XF.createElement||((KF=window.navigator)==null?void 0:KF.product)==="ReactNative")?N.useLayoutEffect:N.useEffect;function OH(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=n.child;for(;r;){const i=OH(r,e,t);if(i)return i;r=r.sibling}}function FH(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const YF=console.error;console.error=function(){const n=[...arguments].join("");if(n!=null&&n.startsWith("Warning:")&&n.includes("useContext")){console.error=YF;return}return YF.apply(this,arguments)};const IR=FH(N.createContext(null));class zH extends N.Component{render(){return N.createElement(IR.Provider,{value:this._reactInternals},this.props.children)}}function sye(){const n=N.useContext(IR);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=N.useId();return N.useMemo(()=>{for(const r of[n,n==null?void 0:n.alternate]){if(!r)continue;const i=OH(r,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[n,e])}function oye(){const n=sye(),[e]=N.useState(()=>new Map);e.clear();let t=n;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==IR&&!e.has(i)&&e.set(i,N.useContext(FH(i)))}t=t.return}return e}function aye(){const n=oye();return N.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>N.createElement(e,null,N.createElement(t.Provider,iye(qF({},r),{value:n.get(t)}))),e=>N.createElement(zH,qF({},e))),[n])}const lye=N.forwardRef(function({children:e,fallback:t,resize:r,style:i,gl:s,events:o=qge,eventSource:a,eventPrefix:l,shadows:c,linear:u,flat:d,legacy:h,orthographic:f,frameloop:p,dpr:x,performance:v,raycaster:y,camera:b,scene:S,onPointerMissed:_,onCreated:T,...M},k){N.useMemo(()=>AR(gge),[]);const P=aye(),[z,I]=Xge({scroll:!0,debounce:{scroll:50,resize:0},...r}),L=N.useRef(null),W=N.useRef(null);N.useImperativeHandle(k,()=>L.current);const q=CH(_),[$,ne]=N.useState(!1),[Y,we]=N.useState(!1);if($)throw $;if(Y)throw Y;const H=N.useRef(null);mx(()=>{const oe=L.current;I.width>0&&I.height>0&&oe&&(H.current||(H.current=Vge(oe)),H.current.configure({gl:s,events:o,shadows:c,linear:u,flat:d,legacy:h,orthographic:f,frameloop:p,dpr:x,performance:v,raycaster:y,camera:b,scene:S,size:I,onPointerMissed:(...ve)=>q.current==null?void 0:q.current(...ve),onCreated:ve=>{ve.events.connect==null||ve.events.connect(a?Mge(a)?a.current:a:W.current),l&&ve.setEvents({compute:(Te,Xe)=>{const _e=Te[l+"X"],Ue=Te[l+"Y"];Xe.pointer.set(_e/Xe.size.width*2-1,-(Ue/Xe.size.height)*2+1),Xe.raycaster.setFromCamera(Xe.pointer,Xe.camera)}}),T==null||T(ve)}}),H.current.render(w.jsx(P,{children:w.jsx(TH,{set:we,children:w.jsx(N.Suspense,{fallback:w.jsx(Age,{set:ne}),children:e??null})})})))}),N.useEffect(()=>{const oe=L.current;if(oe)return()=>DH(oe)},[]);const X=a?"none":"auto";return w.jsx("div",{ref:W,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:X,...i},...M,children:w.jsx("div",{ref:z,style:{width:"100%",height:"100%"},children:w.jsx("canvas",{ref:L,style:{display:"block"},children:t})})})}),UH=N.forwardRef(function(e,t){return w.jsx(zH,{children:w.jsx(lye,{...e,ref:t})})});function hf(){return hf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},hf.apply(null,arguments)}const BH=parseInt(Sg.replace(/\D+/g,""));var ya=Uint8Array,Fu=Uint16Array,qA=Uint32Array,$H=new ya([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),jH=new ya([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cye=new ya([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),VH=function(n,e){for(var t=new Fu(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var i=new qA(t[30]),r=1;r<30;++r)for(var s=t[r];s<t[r+1];++s)i[s]=s-t[r]<<5|r;return[t,i]},WH=VH($H,2),HH=WH[0],uye=WH[1];HH[28]=258,uye[258]=28;var dye=VH(jH,0),hye=dye[0],XA=new Fu(32768);for(var jr=0;jr<32768;++jr){var _u=(jr&43690)>>>1|(jr&21845)<<1;_u=(_u&52428)>>>2|(_u&13107)<<2,_u=(_u&61680)>>>4|(_u&3855)<<4,XA[jr]=((_u&65280)>>>8|(_u&255)<<8)>>>1}var hv=function(n,e,t){for(var r=n.length,i=0,s=new Fu(e);i<r;++i)++s[n[i]-1];var o=new Fu(e);for(i=0;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;var a;if(t){a=new Fu(1<<e);var l=15-e;for(i=0;i<r;++i)if(n[i])for(var c=i<<4|n[i],u=e-n[i],d=o[n[i]-1]++<<u,h=d|(1<<u)-1;d<=h;++d)a[XA[d]>>>l]=c}else for(a=new Fu(r),i=0;i<r;++i)n[i]&&(a[i]=XA[o[n[i]-1]++]>>>15-n[i]);return a},gx=new ya(288);for(var jr=0;jr<144;++jr)gx[jr]=8;for(var jr=144;jr<256;++jr)gx[jr]=9;for(var jr=256;jr<280;++jr)gx[jr]=7;for(var jr=280;jr<288;++jr)gx[jr]=8;var GH=new ya(32);for(var jr=0;jr<32;++jr)GH[jr]=5;var fye=hv(gx,9,1),pye=hv(GH,5,1),nT=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},za=function(n,e,t){var r=e/8|0;return(n[r]|n[r+1]<<8)>>(e&7)&t},rT=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},mye=function(n){return(n/8|0)+(n&7&&1)},gye=function(n,e,t){(t==null||t>n.length)&&(t=n.length);var r=new(n instanceof Fu?Fu:n instanceof qA?qA:ya)(t-e);return r.set(n.subarray(e,t)),r},yye=function(n,e,t){var r=n.length;if(!r||t&&!t.l&&r<5)return e||new ya(0);var i=!e||t,s=!t||t.i;t||(t={}),e||(e=new ya(r*3));var o=function(Fe){var Oe=e.length;if(Fe>Oe){var nt=new ya(Math.max(Oe*2,Fe));nt.set(e),e=nt}},a=t.f||0,l=t.p||0,c=t.b||0,u=t.l,d=t.d,h=t.m,f=t.n,p=r*8;do{if(!u){t.f=a=za(n,l,1);var x=za(n,l+1,3);if(l+=3,x)if(x==1)u=fye,d=pye,h=9,f=5;else if(x==2){var S=za(n,l,31)+257,_=za(n,l+10,15)+4,T=S+za(n,l+5,31)+1;l+=14;for(var M=new ya(T),k=new ya(19),P=0;P<_;++P)k[cye[P]]=za(n,l+P*3,7);l+=_*3;for(var z=nT(k),I=(1<<z)-1,L=hv(k,z,1),P=0;P<T;){var W=L[za(n,l,I)];l+=W&15;var v=W>>>4;if(v<16)M[P++]=v;else{var q=0,$=0;for(v==16?($=3+za(n,l,3),l+=2,q=M[P-1]):v==17?($=3+za(n,l,7),l+=3):v==18&&($=11+za(n,l,127),l+=7);$--;)M[P++]=q}}var ne=M.subarray(0,S),Y=M.subarray(S);h=nT(ne),f=nT(Y),u=hv(ne,h,1),d=hv(Y,f,1)}else throw"invalid block type";else{var v=mye(l)+4,y=n[v-4]|n[v-3]<<8,b=v+y;if(b>r){if(s)throw"unexpected EOF";break}i&&o(c+y),e.set(n.subarray(v,b),c),t.b=c+=y,t.p=l=b*8;continue}if(l>p){if(s)throw"unexpected EOF";break}}i&&o(c+131072);for(var we=(1<<h)-1,H=(1<<f)-1,X=l;;X=l){var q=u[rT(n,l)&we],oe=q>>>4;if(l+=q&15,l>p){if(s)throw"unexpected EOF";break}if(!q)throw"invalid length/literal";if(oe<256)e[c++]=oe;else if(oe==256){X=l,u=null;break}else{var ve=oe-254;if(oe>264){var P=oe-257,Te=$H[P];ve=za(n,l,(1<<Te)-1)+HH[P],l+=Te}var Xe=d[rT(n,l)&H],_e=Xe>>>4;if(!Xe)throw"invalid distance";l+=Xe&15;var Y=hye[_e];if(_e>3){var Te=jH[_e];Y+=rT(n,l)&(1<<Te)-1,l+=Te}if(l>p){if(s)throw"unexpected EOF";break}i&&o(c+131072);for(var Ue=c+ve;c<Ue;c+=4)e[c]=e[c-Y],e[c+1]=e[c+1-Y],e[c+2]=e[c+2-Y],e[c+3]=e[c+3-Y];c=Ue}}t.l=u,t.p=X,t.b=c,u&&(a=1,t.m=h,t.d=d,t.n=f)}while(!a);return c==e.length?e:gye(e,0,c)},vye=new ya(0),xye=function(n){if((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(n[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function L1(n,e){return yye((xye(n),n.subarray(2,-4)),e)}var wye=typeof TextDecoder<"u"&&new TextDecoder,bye=0;try{wye.decode(vye,{stream:!0}),bye=1}catch{}const Sye=n=>n&&n.isCubeTexture;class _ye extends ri{constructor(e,t){var r,i;const s=Sye(e),a=((i=s?(r=e.image[0])==null?void 0:r.width:e.image.width)!=null?i:1024)/4,l=Math.floor(Math.log2(a)),c=Math.pow(2,l),u=3*Math.max(c,16*7),d=4*c,h=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/u}`,`#define CUBEUV_TEXEL_HEIGHT ${1/d}`,`#define CUBEUV_MAX_MIP ${l}.0`],f=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,p=h.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${BH>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,x={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},v=new dx(1,16),y=new Ys({uniforms:x,fragmentShader:p,vertexShader:f,side:Ka});super(v,y)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var Eye=Object.defineProperty,Cye=(n,e,t)=>e in n?Eye(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Tye=(n,e,t)=>(Cye(n,e+"",t),t);let Mye=class{constructor(){Tye(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}};var Aye=Object.defineProperty,Nye=(n,e,t)=>e in n?Aye(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,hn=(n,e,t)=>(Nye(n,typeof e!="symbol"?e+"":e,t),t);const O1=new Mf,ZF=new Wa,kye=Math.cos(70*(Math.PI/180)),QF=(n,e)=>(n%e+e)%e;let Iye=class extends Mye{constructor(e,t){super(),hn(this,"object"),hn(this,"domElement"),hn(this,"enabled",!0),hn(this,"target",new ie),hn(this,"minDistance",0),hn(this,"maxDistance",1/0),hn(this,"minZoom",0),hn(this,"maxZoom",1/0),hn(this,"minPolarAngle",0),hn(this,"maxPolarAngle",Math.PI),hn(this,"minAzimuthAngle",-1/0),hn(this,"maxAzimuthAngle",1/0),hn(this,"enableDamping",!1),hn(this,"dampingFactor",.05),hn(this,"enableZoom",!0),hn(this,"zoomSpeed",1),hn(this,"enableRotate",!0),hn(this,"rotateSpeed",1),hn(this,"enablePan",!0),hn(this,"panSpeed",1),hn(this,"screenSpacePanning",!0),hn(this,"keyPanSpeed",7),hn(this,"zoomToCursor",!1),hn(this,"autoRotate",!1),hn(this,"autoRotateSpeed",2),hn(this,"reverseOrbit",!1),hn(this,"reverseHorizontalOrbit",!1),hn(this,"reverseVerticalOrbit",!1),hn(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),hn(this,"mouseButtons",{LEFT:uh.ROTATE,MIDDLE:uh.DOLLY,RIGHT:uh.PAN}),hn(this,"touches",{ONE:dh.ROTATE,TWO:dh.DOLLY_PAN}),hn(this,"target0"),hn(this,"position0"),hn(this,"zoom0"),hn(this,"_domElementKeyEvents",null),hn(this,"getPolarAngle"),hn(this,"getAzimuthalAngle"),hn(this,"setPolarAngle"),hn(this,"setAzimuthalAngle"),hn(this,"getDistance"),hn(this,"getZoomScale"),hn(this,"listenToKeyEvents"),hn(this,"stopListenToKeyEvents"),hn(this,"saveState"),hn(this,"reset"),hn(this,"update"),hn(this,"connect"),hn(this,"dispose"),hn(this,"dollyIn"),hn(this,"dollyOut"),hn(this,"getScale"),hn(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=ye=>{let He=QF(ye,2*Math.PI),st=u.phi;st<0&&(st+=2*Math.PI),He<0&&(He+=2*Math.PI);let _t=Math.abs(He-st);2*Math.PI-_t<_t&&(He<st?He+=2*Math.PI:st+=2*Math.PI),d.phi=He-st,r.update()},this.setAzimuthalAngle=ye=>{let He=QF(ye,2*Math.PI),st=u.theta;st<0&&(st+=2*Math.PI),He<0&&(He+=2*Math.PI);let _t=Math.abs(He-st);2*Math.PI-_t<_t&&(He<st?He+=2*Math.PI:st+=2*Math.PI),d.theta=He-st,r.update()},this.getDistance=()=>r.object.position.distanceTo(r.target),this.listenToKeyEvents=ye=>{ye.addEventListener("keydown",Be),this._domElementKeyEvents=ye},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Be),this._domElementKeyEvents=null},this.saveState=()=>{r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=()=>{r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(i),r.update(),l=a.NONE},this.update=(()=>{const ye=new ie,He=new ie(0,1,0),st=new Ts().setFromUnitVectors(e.up,He),_t=st.clone().invert(),Ye=new ie,fe=new Ts,ot=2*Math.PI;return function(){const Bt=r.object.position;st.setFromUnitVectors(e.up,He),_t.copy(st).invert(),ye.copy(Bt).sub(r.target),ye.applyQuaternion(st),u.setFromVector3(ye),r.autoRotate&&l===a.NONE&&$(W()),r.enableDamping?(u.theta+=d.theta*r.dampingFactor,u.phi+=d.phi*r.dampingFactor):(u.theta+=d.theta,u.phi+=d.phi);let Pt=r.minAzimuthAngle,xn=r.maxAzimuthAngle;isFinite(Pt)&&isFinite(xn)&&(Pt<-Math.PI?Pt+=ot:Pt>Math.PI&&(Pt-=ot),xn<-Math.PI?xn+=ot:xn>Math.PI&&(xn-=ot),Pt<=xn?u.theta=Math.max(Pt,Math.min(xn,u.theta)):u.theta=u.theta>(Pt+xn)/2?Math.max(Pt,u.theta):Math.min(xn,u.theta)),u.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,u.phi)),u.makeSafe(),r.enableDamping===!0?r.target.addScaledVector(f,r.dampingFactor):r.target.add(f),r.zoomToCursor&&z||r.object.isOrthographicCamera?u.radius=Xe(u.radius):u.radius=Xe(u.radius*h),ye.setFromSpherical(u),ye.applyQuaternion(_t),Bt.copy(r.target).add(ye),r.object.matrixAutoUpdate||r.object.updateMatrix(),r.object.lookAt(r.target),r.enableDamping===!0?(d.theta*=1-r.dampingFactor,d.phi*=1-r.dampingFactor,f.multiplyScalar(1-r.dampingFactor)):(d.set(0,0,0),f.set(0,0,0));let Dn=!1;if(r.zoomToCursor&&z){let ir=null;if(r.object instanceof hi&&r.object.isPerspectiveCamera){const wr=ye.length();ir=Xe(wr*h);const Wn=wr-ir;r.object.position.addScaledVector(k,Wn),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){const wr=new ie(P.x,P.y,0);wr.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/h)),r.object.updateProjectionMatrix(),Dn=!0;const Wn=new ie(P.x,P.y,0);Wn.unproject(r.object),r.object.position.sub(Wn).add(wr),r.object.updateMatrixWorld(),ir=ye.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;ir!==null&&(r.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(ir).add(r.object.position):(O1.origin.copy(r.object.position),O1.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(O1.direction))<kye?e.lookAt(r.target):(ZF.setFromNormalAndCoplanarPoint(r.object.up,r.target),O1.intersectPlane(ZF,r.target))))}else r.object instanceof Ic&&r.object.isOrthographicCamera&&(Dn=h!==1,Dn&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/h)),r.object.updateProjectionMatrix()));return h=1,z=!1,Dn||Ye.distanceToSquared(r.object.position)>c||8*(1-fe.dot(r.object.quaternion))>c?(r.dispatchEvent(i),Ye.copy(r.object.position),fe.copy(r.object.quaternion),Dn=!1,!0):!1}})(),this.connect=ye=>{r.domElement=ye,r.domElement.style.touchAction="none",r.domElement.addEventListener("contextmenu",Kt),r.domElement.addEventListener("pointerdown",J),r.domElement.addEventListener("pointercancel",ee),r.domElement.addEventListener("wheel",Ae)},this.dispose=()=>{var ye,He,st,_t,Ye,fe;r.domElement&&(r.domElement.style.touchAction="auto"),(ye=r.domElement)==null||ye.removeEventListener("contextmenu",Kt),(He=r.domElement)==null||He.removeEventListener("pointerdown",J),(st=r.domElement)==null||st.removeEventListener("pointercancel",ee),(_t=r.domElement)==null||_t.removeEventListener("wheel",Ae),(Ye=r.domElement)==null||Ye.ownerDocument.removeEventListener("pointermove",he),(fe=r.domElement)==null||fe.ownerDocument.removeEventListener("pointerup",ee),r._domElementKeyEvents!==null&&r._domElementKeyEvents.removeEventListener("keydown",Be)};const r=this,i={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,u=new VA,d=new VA;let h=1;const f=new ie,p=new Ze,x=new Ze,v=new Ze,y=new Ze,b=new Ze,S=new Ze,_=new Ze,T=new Ze,M=new Ze,k=new ie,P=new Ze;let z=!1;const I=[],L={};function W(){return 2*Math.PI/60/60*r.autoRotateSpeed}function q(){return Math.pow(.95,r.zoomSpeed)}function $(ye){r.reverseOrbit||r.reverseHorizontalOrbit?d.theta+=ye:d.theta-=ye}function ne(ye){r.reverseOrbit||r.reverseVerticalOrbit?d.phi+=ye:d.phi-=ye}const Y=(()=>{const ye=new ie;return function(st,_t){ye.setFromMatrixColumn(_t,0),ye.multiplyScalar(-st),f.add(ye)}})(),we=(()=>{const ye=new ie;return function(st,_t){r.screenSpacePanning===!0?ye.setFromMatrixColumn(_t,1):(ye.setFromMatrixColumn(_t,0),ye.crossVectors(r.object.up,ye)),ye.multiplyScalar(st),f.add(ye)}})(),H=(()=>{const ye=new ie;return function(st,_t){const Ye=r.domElement;if(Ye&&r.object instanceof hi&&r.object.isPerspectiveCamera){const fe=r.object.position;ye.copy(fe).sub(r.target);let ot=ye.length();ot*=Math.tan(r.object.fov/2*Math.PI/180),Y(2*st*ot/Ye.clientHeight,r.object.matrix),we(2*_t*ot/Ye.clientHeight,r.object.matrix)}else Ye&&r.object instanceof Ic&&r.object.isOrthographicCamera?(Y(st*(r.object.right-r.object.left)/r.object.zoom/Ye.clientWidth,r.object.matrix),we(_t*(r.object.top-r.object.bottom)/r.object.zoom/Ye.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}})();function X(ye){r.object instanceof hi&&r.object.isPerspectiveCamera||r.object instanceof Ic&&r.object.isOrthographicCamera?h=ye:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function oe(ye){X(h/ye)}function ve(ye){X(h*ye)}function Te(ye){if(!r.zoomToCursor||!r.domElement)return;z=!0;const He=r.domElement.getBoundingClientRect(),st=ye.clientX-He.left,_t=ye.clientY-He.top,Ye=He.width,fe=He.height;P.x=st/Ye*2-1,P.y=-(_t/fe)*2+1,k.set(P.x,P.y,1).unproject(r.object).sub(r.object.position).normalize()}function Xe(ye){return Math.max(r.minDistance,Math.min(r.maxDistance,ye))}function _e(ye){p.set(ye.clientX,ye.clientY)}function Ue(ye){Te(ye),_.set(ye.clientX,ye.clientY)}function Fe(ye){y.set(ye.clientX,ye.clientY)}function Oe(ye){x.set(ye.clientX,ye.clientY),v.subVectors(x,p).multiplyScalar(r.rotateSpeed);const He=r.domElement;He&&($(2*Math.PI*v.x/He.clientHeight),ne(2*Math.PI*v.y/He.clientHeight)),p.copy(x),r.update()}function nt(ye){T.set(ye.clientX,ye.clientY),M.subVectors(T,_),M.y>0?oe(q()):M.y<0&&ve(q()),_.copy(T),r.update()}function rt(ye){b.set(ye.clientX,ye.clientY),S.subVectors(b,y).multiplyScalar(r.panSpeed),H(S.x,S.y),y.copy(b),r.update()}function ut(ye){Te(ye),ye.deltaY<0?ve(q()):ye.deltaY>0&&oe(q()),r.update()}function Qe(ye){let He=!1;switch(ye.code){case r.keys.UP:H(0,r.keyPanSpeed),He=!0;break;case r.keys.BOTTOM:H(0,-r.keyPanSpeed),He=!0;break;case r.keys.LEFT:H(r.keyPanSpeed,0),He=!0;break;case r.keys.RIGHT:H(-r.keyPanSpeed,0),He=!0;break}He&&(ye.preventDefault(),r.update())}function ae(){if(I.length==1)p.set(I[0].pageX,I[0].pageY);else{const ye=.5*(I[0].pageX+I[1].pageX),He=.5*(I[0].pageY+I[1].pageY);p.set(ye,He)}}function ze(){if(I.length==1)y.set(I[0].pageX,I[0].pageY);else{const ye=.5*(I[0].pageX+I[1].pageX),He=.5*(I[0].pageY+I[1].pageY);y.set(ye,He)}}function Re(){const ye=I[0].pageX-I[1].pageX,He=I[0].pageY-I[1].pageY,st=Math.sqrt(ye*ye+He*He);_.set(0,st)}function Je(){r.enableZoom&&Re(),r.enablePan&&ze()}function Ge(){r.enableZoom&&Re(),r.enableRotate&&ae()}function Et(ye){if(I.length==1)x.set(ye.pageX,ye.pageY);else{const st=Mt(ye),_t=.5*(ye.pageX+st.x),Ye=.5*(ye.pageY+st.y);x.set(_t,Ye)}v.subVectors(x,p).multiplyScalar(r.rotateSpeed);const He=r.domElement;He&&($(2*Math.PI*v.x/He.clientHeight),ne(2*Math.PI*v.y/He.clientHeight)),p.copy(x)}function pt(ye){if(I.length==1)b.set(ye.pageX,ye.pageY);else{const He=Mt(ye),st=.5*(ye.pageX+He.x),_t=.5*(ye.pageY+He.y);b.set(st,_t)}S.subVectors(b,y).multiplyScalar(r.panSpeed),H(S.x,S.y),y.copy(b)}function Q(ye){const He=Mt(ye),st=ye.pageX-He.x,_t=ye.pageY-He.y,Ye=Math.sqrt(st*st+_t*_t);T.set(0,Ye),M.set(0,Math.pow(T.y/_.y,r.zoomSpeed)),oe(M.y),_.copy(T)}function G(ye){r.enableZoom&&Q(ye),r.enablePan&&pt(ye)}function ke(ye){r.enableZoom&&Q(ye),r.enableRotate&&Et(ye)}function J(ye){var He,st;r.enabled!==!1&&(I.length===0&&((He=r.domElement)==null||He.ownerDocument.addEventListener("pointermove",he),(st=r.domElement)==null||st.ownerDocument.addEventListener("pointerup",ee)),cn(ye),ye.pointerType==="touch"?dt(ye):Ee(ye))}function he(ye){r.enabled!==!1&&(ye.pointerType==="touch"?We(ye):Me(ye))}function ee(ye){var He,st,_t;jt(ye),I.length===0&&((He=r.domElement)==null||He.releasePointerCapture(ye.pointerId),(st=r.domElement)==null||st.ownerDocument.removeEventListener("pointermove",he),(_t=r.domElement)==null||_t.ownerDocument.removeEventListener("pointerup",ee)),r.dispatchEvent(o),l=a.NONE}function Ee(ye){let He;switch(ye.button){case 0:He=r.mouseButtons.LEFT;break;case 1:He=r.mouseButtons.MIDDLE;break;case 2:He=r.mouseButtons.RIGHT;break;default:He=-1}switch(He){case uh.DOLLY:if(r.enableZoom===!1)return;Ue(ye),l=a.DOLLY;break;case uh.ROTATE:if(ye.ctrlKey||ye.metaKey||ye.shiftKey){if(r.enablePan===!1)return;Fe(ye),l=a.PAN}else{if(r.enableRotate===!1)return;_e(ye),l=a.ROTATE}break;case uh.PAN:if(ye.ctrlKey||ye.metaKey||ye.shiftKey){if(r.enableRotate===!1)return;_e(ye),l=a.ROTATE}else{if(r.enablePan===!1)return;Fe(ye),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(s)}function Me(ye){if(r.enabled!==!1)switch(l){case a.ROTATE:if(r.enableRotate===!1)return;Oe(ye);break;case a.DOLLY:if(r.enableZoom===!1)return;nt(ye);break;case a.PAN:if(r.enablePan===!1)return;rt(ye);break}}function Ae(ye){r.enabled===!1||r.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(ye.preventDefault(),r.dispatchEvent(s),ut(ye),r.dispatchEvent(o))}function Be(ye){r.enabled===!1||r.enablePan===!1||Qe(ye)}function dt(ye){switch(wt(ye),I.length){case 1:switch(r.touches.ONE){case dh.ROTATE:if(r.enableRotate===!1)return;ae(),l=a.TOUCH_ROTATE;break;case dh.PAN:if(r.enablePan===!1)return;ze(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(r.touches.TWO){case dh.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;Je(),l=a.TOUCH_DOLLY_PAN;break;case dh.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;Ge(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(s)}function We(ye){switch(wt(ye),l){case a.TOUCH_ROTATE:if(r.enableRotate===!1)return;Et(ye),r.update();break;case a.TOUCH_PAN:if(r.enablePan===!1)return;pt(ye),r.update();break;case a.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;G(ye),r.update();break;case a.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;ke(ye),r.update();break;default:l=a.NONE}}function Kt(ye){r.enabled!==!1&&ye.preventDefault()}function cn(ye){I.push(ye)}function jt(ye){delete L[ye.pointerId];for(let He=0;He<I.length;He++)if(I[He].pointerId==ye.pointerId){I.splice(He,1);return}}function wt(ye){let He=L[ye.pointerId];He===void 0&&(He=new Ze,L[ye.pointerId]=He),He.set(ye.pageX,ye.pageY)}function Mt(ye){const He=ye.pointerId===I[0].pointerId?I[1]:I[0];return L[He.pointerId]}this.dollyIn=(ye=q())=>{ve(ye),r.update()},this.dollyOut=(ye=q())=>{oe(ye),r.update()},this.getScale=()=>h,this.setScale=ye=>{X(ye),r.update()},this.getZoomScale=()=>q(),t!==void 0&&this.connect(t),this.update()}};class Rye extends vR{constructor(e){super(e),this.type=Fi}parse(e){const o=function(P,z){switch(P){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(z||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(z||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(z||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(z||""))}},u=`
`,d=function(P,z,I){z=z||1024;let W=P.pos,q=-1,$=0,ne="",Y=String.fromCharCode.apply(null,new Uint16Array(P.subarray(W,W+128)));for(;0>(q=Y.indexOf(u))&&$<z&&W<P.byteLength;)ne+=Y,$+=Y.length,W+=128,Y+=String.fromCharCode.apply(null,new Uint16Array(P.subarray(W,W+128)));return-1<q?(P.pos+=$+q+1,ne+Y.slice(0,q)):!1},h=function(P){const z=/^#\?(\S+)/,I=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,L=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,W=/^\s*FORMAT=(\S+)\s*$/,q=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,$={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let ne,Y;for((P.pos>=P.byteLength||!(ne=d(P)))&&o(1,"no header found"),(Y=ne.match(z))||o(3,"bad initial token"),$.valid|=1,$.programtype=Y[1],$.string+=ne+`
`;ne=d(P),ne!==!1;){if($.string+=ne+`
`,ne.charAt(0)==="#"){$.comments+=ne+`
`;continue}if((Y=ne.match(I))&&($.gamma=parseFloat(Y[1])),(Y=ne.match(L))&&($.exposure=parseFloat(Y[1])),(Y=ne.match(W))&&($.valid|=2,$.format=Y[1]),(Y=ne.match(q))&&($.valid|=4,$.height=parseInt(Y[1],10),$.width=parseInt(Y[2],10)),$.valid&2&&$.valid&4)break}return $.valid&2||o(3,"missing format specifier"),$.valid&4||o(3,"missing image size specifier"),$},f=function(P,z,I){const L=z;if(L<8||L>32767||P[0]!==2||P[1]!==2||P[2]&128)return new Uint8Array(P);L!==(P[2]<<8|P[3])&&o(3,"wrong scanline width");const W=new Uint8Array(4*z*I);W.length||o(4,"unable to allocate buffer space");let q=0,$=0;const ne=4*L,Y=new Uint8Array(4),we=new Uint8Array(ne);let H=I;for(;H>0&&$<P.byteLength;){$+4>P.byteLength&&o(1),Y[0]=P[$++],Y[1]=P[$++],Y[2]=P[$++],Y[3]=P[$++],(Y[0]!=2||Y[1]!=2||(Y[2]<<8|Y[3])!=L)&&o(3,"bad rgbe scanline format");let X=0,oe;for(;X<ne&&$<P.byteLength;){oe=P[$++];const Te=oe>128;if(Te&&(oe-=128),(oe===0||X+oe>ne)&&o(3,"bad scanline data"),Te){const Xe=P[$++];for(let _e=0;_e<oe;_e++)we[X++]=Xe}else we.set(P.subarray($,$+oe),X),X+=oe,$+=oe}const ve=L;for(let Te=0;Te<ve;Te++){let Xe=0;W[q]=we[Te+Xe],Xe+=L,W[q+1]=we[Te+Xe],Xe+=L,W[q+2]=we[Te+Xe],Xe+=L,W[q+3]=we[Te+Xe],q+=4}H--}return W},p=function(P,z,I,L){const W=P[z+3],q=Math.pow(2,W-128)/255;I[L+0]=P[z+0]*q,I[L+1]=P[z+1]*q,I[L+2]=P[z+2]*q,I[L+3]=1},x=function(P,z,I,L){const W=P[z+3],q=Math.pow(2,W-128)/255;I[L+0]=Ih.toHalfFloat(Math.min(P[z+0]*q,65504)),I[L+1]=Ih.toHalfFloat(Math.min(P[z+1]*q,65504)),I[L+2]=Ih.toHalfFloat(Math.min(P[z+2]*q,65504)),I[L+3]=Ih.toHalfFloat(1)},v=new Uint8Array(e);v.pos=0;const y=h(v),b=y.width,S=y.height,_=f(v.subarray(v.pos),b,S);let T,M,k;switch(this.type){case fi:k=_.length/4;const P=new Float32Array(k*4);for(let I=0;I<k;I++)p(_,I*4,P,I*4);T=P,M=fi;break;case Fi:k=_.length/4;const z=new Uint16Array(k*4);for(let I=0;I<k;I++)x(_,I*4,z,I*4);T=z,M=Fi;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:b,height:S,data:T,header:y.string,gamma:y.gamma,exposure:y.exposure,type:M}}setDataType(e){return this.type=e,this}load(e,t,r,i){function s(o,a){switch(o.type){case fi:case Fi:"colorSpace"in o?o.colorSpace="srgb-linear":o.encoding=3e3,o.minFilter=Jn,o.magFilter=Jn,o.generateMipmaps=!1,o.flipY=!0;break}t&&t(o,a)}return super.load(e,s,r,i)}}const Iy=BH>=152;class Pye extends vR{constructor(e){super(e),this.type=Fi}parse(e){const z=Math.pow(2.7182818,2.2);function I(j,Z){for(var xe=0,B=0;B<65536;++B)(B==0||j[B>>3]&1<<(B&7))&&(Z[xe++]=B);for(var re=xe-1;xe<65536;)Z[xe++]=0;return re}function L(j){for(var Z=0;Z<16384;Z++)j[Z]={},j[Z].len=0,j[Z].lit=0,j[Z].p=null}const W={l:0,c:0,lc:0};function q(j,Z,xe,B,re){for(;xe<j;)Z=Z<<8|Mt(B,re),xe+=8;xe-=j,W.l=Z>>xe&(1<<j)-1,W.c=Z,W.lc=xe}const $=new Array(59);function ne(j){for(var Z=0;Z<=58;++Z)$[Z]=0;for(var Z=0;Z<65537;++Z)$[j[Z]]+=1;for(var xe=0,Z=58;Z>0;--Z){var B=xe+$[Z]>>1;$[Z]=xe,xe=B}for(var Z=0;Z<65537;++Z){var re=j[Z];re>0&&(j[Z]=re|$[re]++<<6)}}function Y(j,Z,xe,B,re,le,me){for(var pe=xe,Ie=0,Le=0;re<=le;re++){if(pe.value-xe.value>B)return!1;q(6,Ie,Le,j,pe);var $e=W.l;if(Ie=W.c,Le=W.lc,me[re]=$e,$e==63){if(pe.value-xe.value>B)throw"Something wrong with hufUnpackEncTable";q(8,Ie,Le,j,pe);var je=W.l+6;if(Ie=W.c,Le=W.lc,re+je>le+1)throw"Something wrong with hufUnpackEncTable";for(;je--;)me[re++]=0;re--}else if($e>=59){var je=$e-59+2;if(re+je>le+1)throw"Something wrong with hufUnpackEncTable";for(;je--;)me[re++]=0;re--}}ne(me)}function we(j){return j&63}function H(j){return j>>6}function X(j,Z,xe,B){for(;Z<=xe;Z++){var re=H(j[Z]),le=we(j[Z]);if(re>>le)throw"Invalid table entry";if(le>14){var me=B[re>>le-14];if(me.len)throw"Invalid table entry";if(me.lit++,me.p){var pe=me.p;me.p=new Array(me.lit);for(var Ie=0;Ie<me.lit-1;++Ie)me.p[Ie]=pe[Ie]}else me.p=new Array(1);me.p[me.lit-1]=Z}else if(le)for(var Le=0,Ie=1<<14-le;Ie>0;Ie--){var me=B[(re<<14-le)+Le];if(me.len||me.p)throw"Invalid table entry";me.len=le,me.lit=Z,Le++}}return!0}const oe={c:0,lc:0};function ve(j,Z,xe,B){j=j<<8|Mt(xe,B),Z+=8,oe.c=j,oe.lc=Z}const Te={c:0,lc:0};function Xe(j,Z,xe,B,re,le,me,pe,Ie,Le){if(j==Z){B<8&&(ve(xe,B,re,me),xe=oe.c,B=oe.lc),B-=8;var $e=xe>>B,$e=new Uint8Array([$e])[0];if(Ie.value+$e>Le)return!1;for(var je=pe[Ie.value-1];$e-- >0;)pe[Ie.value++]=je}else if(Ie.value<Le)pe[Ie.value++]=j;else return!1;Te.c=xe,Te.lc=B}function _e(j){return j&65535}function Ue(j){var Z=_e(j);return Z>32767?Z-65536:Z}const Fe={a:0,b:0};function Oe(j,Z){var xe=Ue(j),B=Ue(Z),re=B,le=xe+(re&1)+(re>>1),me=le,pe=le-re;Fe.a=me,Fe.b=pe}function nt(j,Z){var xe=_e(j),B=_e(Z),re=xe-(B>>1)&65535,le=B+re-32768&65535;Fe.a=le,Fe.b=re}function rt(j,Z,xe,B,re,le,me){for(var pe=me<16384,Ie=xe>re?re:xe,Le=1,$e;Le<=Ie;)Le<<=1;for(Le>>=1,$e=Le,Le>>=1;Le>=1;){for(var je=0,Dt=je+le*(re-$e),et=le*Le,it=le*$e,At=B*Le,en=B*$e,tn,on,It,bt;je<=Dt;je+=it){for(var Cn=je,an=je+B*(xe-$e);Cn<=an;Cn+=en){var fn=Cn+At,ur=Cn+et,zr=ur+At;pe?(Oe(j[Cn+Z],j[ur+Z]),tn=Fe.a,It=Fe.b,Oe(j[fn+Z],j[zr+Z]),on=Fe.a,bt=Fe.b,Oe(tn,on),j[Cn+Z]=Fe.a,j[fn+Z]=Fe.b,Oe(It,bt),j[ur+Z]=Fe.a,j[zr+Z]=Fe.b):(nt(j[Cn+Z],j[ur+Z]),tn=Fe.a,It=Fe.b,nt(j[fn+Z],j[zr+Z]),on=Fe.a,bt=Fe.b,nt(tn,on),j[Cn+Z]=Fe.a,j[fn+Z]=Fe.b,nt(It,bt),j[ur+Z]=Fe.a,j[zr+Z]=Fe.b)}if(xe&Le){var ur=Cn+et;pe?Oe(j[Cn+Z],j[ur+Z]):nt(j[Cn+Z],j[ur+Z]),tn=Fe.a,j[ur+Z]=Fe.b,j[Cn+Z]=tn}}if(re&Le)for(var Cn=je,an=je+B*(xe-$e);Cn<=an;Cn+=en){var fn=Cn+At;pe?Oe(j[Cn+Z],j[fn+Z]):nt(j[Cn+Z],j[fn+Z]),tn=Fe.a,j[fn+Z]=Fe.b,j[Cn+Z]=tn}$e=Le,Le>>=1}return je}function ut(j,Z,xe,B,re,le,me,pe,Ie,Le){for(var $e=0,je=0,Dt=pe,et=Math.trunc(re.value+(le+7)/8);re.value<et;)for(ve($e,je,xe,re),$e=oe.c,je=oe.lc;je>=14;){var it=$e>>je-14&16383,At=Z[it];if(At.len)je-=At.len,Xe(At.lit,me,$e,je,xe,B,re,Ie,Le,Dt),$e=Te.c,je=Te.lc;else{if(!At.p)throw"hufDecode issues";var en;for(en=0;en<At.lit;en++){for(var tn=we(j[At.p[en]]);je<tn&&re.value<et;)ve($e,je,xe,re),$e=oe.c,je=oe.lc;if(je>=tn&&H(j[At.p[en]])==($e>>je-tn&(1<<tn)-1)){je-=tn,Xe(At.p[en],me,$e,je,xe,B,re,Ie,Le,Dt),$e=Te.c,je=Te.lc;break}}if(en==At.lit)throw"hufDecode issues"}}var on=8-le&7;for($e>>=on,je-=on;je>0;){var At=Z[$e<<14-je&16383];if(At.len)je-=At.len,Xe(At.lit,me,$e,je,xe,B,re,Ie,Le,Dt),$e=Te.c,je=Te.lc;else throw"hufDecode issues"}return!0}function Qe(j,Z,xe,B,re,le){var me={value:0},pe=xe.value,Ie=wt(Z,xe),Le=wt(Z,xe);xe.value+=4;var $e=wt(Z,xe);if(xe.value+=4,Ie<0||Ie>=65537||Le<0||Le>=65537)throw"Something wrong with HUF_ENCSIZE";var je=new Array(65537),Dt=new Array(16384);L(Dt);var et=B-(xe.value-pe);if(Y(j,Z,xe,et,Ie,Le,je),$e>8*(B-(xe.value-pe)))throw"Something wrong with hufUncompress";X(je,Ie,Le,Dt),ut(je,Dt,j,Z,xe,$e,Le,le,re,me)}function ae(j,Z,xe){for(var B=0;B<xe;++B)Z[B]=j[Z[B]]}function ze(j){for(var Z=1;Z<j.length;Z++){var xe=j[Z-1]+j[Z]-128;j[Z]=xe}}function Re(j,Z){for(var xe=0,B=Math.floor((j.length+1)/2),re=0,le=j.length-1;!(re>le||(Z[re++]=j[xe++],re>le));)Z[re++]=j[B++]}function Je(j){for(var Z=j.byteLength,xe=new Array,B=0,re=new DataView(j);Z>0;){var le=re.getInt8(B++);if(le<0){var me=-le;Z-=me+1;for(var pe=0;pe<me;pe++)xe.push(re.getUint8(B++))}else{var me=le;Z-=2;for(var Ie=re.getUint8(B++),pe=0;pe<me+1;pe++)xe.push(Ie)}}return xe}function Ge(j,Z,xe,B,re,le){var fn=new DataView(le.buffer),me=xe[j.idx[0]].width,pe=xe[j.idx[0]].height,Ie=3,Le=Math.floor(me/8),$e=Math.ceil(me/8),je=Math.ceil(pe/8),Dt=me-($e-1)*8,et=pe-(je-1)*8,it={value:0},At=new Array(Ie),en=new Array(Ie),tn=new Array(Ie),on=new Array(Ie),It=new Array(Ie);for(let Nn=0;Nn<Ie;++Nn)It[Nn]=Z[j.idx[Nn]],At[Nn]=Nn<1?0:At[Nn-1]+$e*je,en[Nn]=new Float32Array(64),tn[Nn]=new Uint16Array(64),on[Nn]=new Uint16Array($e*64);for(let Nn=0;Nn<je;++Nn){var bt=8;Nn==je-1&&(bt=et);var Cn=8;for(let bn=0;bn<$e;++bn){bn==$e-1&&(Cn=Dt);for(let Un=0;Un<Ie;++Un)tn[Un].fill(0),tn[Un][0]=re[At[Un]++],Et(it,B,tn[Un]),pt(tn[Un],en[Un]),Q(en[Un]);G(en);for(let Un=0;Un<Ie;++Un)ke(en[Un],on[Un],bn*64)}let $n=0;for(let bn=0;bn<Ie;++bn){const Un=xe[j.idx[bn]].type;for(let dr=8*Nn;dr<8*Nn+bt;++dr){$n=It[bn][dr];for(let Ps=0;Ps<Le;++Ps){const Vi=Ps*64+(dr&7)*8;fn.setUint16($n+0*2*Un,on[bn][Vi+0],!0),fn.setUint16($n+1*2*Un,on[bn][Vi+1],!0),fn.setUint16($n+2*2*Un,on[bn][Vi+2],!0),fn.setUint16($n+3*2*Un,on[bn][Vi+3],!0),fn.setUint16($n+4*2*Un,on[bn][Vi+4],!0),fn.setUint16($n+5*2*Un,on[bn][Vi+5],!0),fn.setUint16($n+6*2*Un,on[bn][Vi+6],!0),fn.setUint16($n+7*2*Un,on[bn][Vi+7],!0),$n+=8*2*Un}}if(Le!=$e)for(let dr=8*Nn;dr<8*Nn+bt;++dr){const Ps=It[bn][dr]+8*Le*2*Un,Vi=Le*64+(dr&7)*8;for(let na=0;na<Cn;++na)fn.setUint16(Ps+na*2*Un,on[bn][Vi+na],!0)}}}for(var an=new Uint16Array(me),fn=new DataView(le.buffer),ur=0;ur<Ie;++ur){xe[j.idx[ur]].decoded=!0;var zr=xe[j.idx[ur]].type;if(xe[ur].type==2)for(var Tr=0;Tr<pe;++Tr){const Nn=It[ur][Tr];for(var Hn=0;Hn<me;++Hn)an[Hn]=fn.getUint16(Nn+Hn*2*zr,!0);for(var Hn=0;Hn<me;++Hn)fn.setFloat32(Nn+Hn*2*zr,Ye(an[Hn]),!0)}}}function Et(j,Z,xe){for(var B,re=1;re<64;)B=Z[j.value],B==65280?re=64:B>>8==255?re+=B&255:(xe[re]=B,re++),j.value++}function pt(j,Z){Z[0]=Ye(j[0]),Z[1]=Ye(j[1]),Z[2]=Ye(j[5]),Z[3]=Ye(j[6]),Z[4]=Ye(j[14]),Z[5]=Ye(j[15]),Z[6]=Ye(j[27]),Z[7]=Ye(j[28]),Z[8]=Ye(j[2]),Z[9]=Ye(j[4]),Z[10]=Ye(j[7]),Z[11]=Ye(j[13]),Z[12]=Ye(j[16]),Z[13]=Ye(j[26]),Z[14]=Ye(j[29]),Z[15]=Ye(j[42]),Z[16]=Ye(j[3]),Z[17]=Ye(j[8]),Z[18]=Ye(j[12]),Z[19]=Ye(j[17]),Z[20]=Ye(j[25]),Z[21]=Ye(j[30]),Z[22]=Ye(j[41]),Z[23]=Ye(j[43]),Z[24]=Ye(j[9]),Z[25]=Ye(j[11]),Z[26]=Ye(j[18]),Z[27]=Ye(j[24]),Z[28]=Ye(j[31]),Z[29]=Ye(j[40]),Z[30]=Ye(j[44]),Z[31]=Ye(j[53]),Z[32]=Ye(j[10]),Z[33]=Ye(j[19]),Z[34]=Ye(j[23]),Z[35]=Ye(j[32]),Z[36]=Ye(j[39]),Z[37]=Ye(j[45]),Z[38]=Ye(j[52]),Z[39]=Ye(j[54]),Z[40]=Ye(j[20]),Z[41]=Ye(j[22]),Z[42]=Ye(j[33]),Z[43]=Ye(j[38]),Z[44]=Ye(j[46]),Z[45]=Ye(j[51]),Z[46]=Ye(j[55]),Z[47]=Ye(j[60]),Z[48]=Ye(j[21]),Z[49]=Ye(j[34]),Z[50]=Ye(j[37]),Z[51]=Ye(j[47]),Z[52]=Ye(j[50]),Z[53]=Ye(j[56]),Z[54]=Ye(j[59]),Z[55]=Ye(j[61]),Z[56]=Ye(j[35]),Z[57]=Ye(j[36]),Z[58]=Ye(j[48]),Z[59]=Ye(j[49]),Z[60]=Ye(j[57]),Z[61]=Ye(j[58]),Z[62]=Ye(j[62]),Z[63]=Ye(j[63])}function Q(j){const Z=.5*Math.cos(.7853975),xe=.5*Math.cos(3.14159/16),B=.5*Math.cos(3.14159/8),re=.5*Math.cos(3*3.14159/16),le=.5*Math.cos(5*3.14159/16),me=.5*Math.cos(3*3.14159/8),pe=.5*Math.cos(7*3.14159/16);for(var Ie=new Array(4),Le=new Array(4),$e=new Array(4),je=new Array(4),Dt=0;Dt<8;++Dt){var et=Dt*8;Ie[0]=B*j[et+2],Ie[1]=me*j[et+2],Ie[2]=B*j[et+6],Ie[3]=me*j[et+6],Le[0]=xe*j[et+1]+re*j[et+3]+le*j[et+5]+pe*j[et+7],Le[1]=re*j[et+1]-pe*j[et+3]-xe*j[et+5]-le*j[et+7],Le[2]=le*j[et+1]-xe*j[et+3]+pe*j[et+5]+re*j[et+7],Le[3]=pe*j[et+1]-le*j[et+3]+re*j[et+5]-xe*j[et+7],$e[0]=Z*(j[et+0]+j[et+4]),$e[3]=Z*(j[et+0]-j[et+4]),$e[1]=Ie[0]+Ie[3],$e[2]=Ie[1]-Ie[2],je[0]=$e[0]+$e[1],je[1]=$e[3]+$e[2],je[2]=$e[3]-$e[2],je[3]=$e[0]-$e[1],j[et+0]=je[0]+Le[0],j[et+1]=je[1]+Le[1],j[et+2]=je[2]+Le[2],j[et+3]=je[3]+Le[3],j[et+4]=je[3]-Le[3],j[et+5]=je[2]-Le[2],j[et+6]=je[1]-Le[1],j[et+7]=je[0]-Le[0]}for(var it=0;it<8;++it)Ie[0]=B*j[16+it],Ie[1]=me*j[16+it],Ie[2]=B*j[48+it],Ie[3]=me*j[48+it],Le[0]=xe*j[8+it]+re*j[24+it]+le*j[40+it]+pe*j[56+it],Le[1]=re*j[8+it]-pe*j[24+it]-xe*j[40+it]-le*j[56+it],Le[2]=le*j[8+it]-xe*j[24+it]+pe*j[40+it]+re*j[56+it],Le[3]=pe*j[8+it]-le*j[24+it]+re*j[40+it]-xe*j[56+it],$e[0]=Z*(j[it]+j[32+it]),$e[3]=Z*(j[it]-j[32+it]),$e[1]=Ie[0]+Ie[3],$e[2]=Ie[1]-Ie[2],je[0]=$e[0]+$e[1],je[1]=$e[3]+$e[2],je[2]=$e[3]-$e[2],je[3]=$e[0]-$e[1],j[0+it]=je[0]+Le[0],j[8+it]=je[1]+Le[1],j[16+it]=je[2]+Le[2],j[24+it]=je[3]+Le[3],j[32+it]=je[3]-Le[3],j[40+it]=je[2]-Le[2],j[48+it]=je[1]-Le[1],j[56+it]=je[0]-Le[0]}function G(j){for(var Z=0;Z<64;++Z){var xe=j[0][Z],B=j[1][Z],re=j[2][Z];j[0][Z]=xe+1.5747*re,j[1][Z]=xe-.1873*B-.4682*re,j[2][Z]=xe+1.8556*B}}function ke(j,Z,xe){for(var B=0;B<64;++B)Z[xe+B]=Ih.toHalfFloat(J(j[B]))}function J(j){return j<=1?Math.sign(j)*Math.pow(Math.abs(j),2.2):Math.sign(j)*Math.pow(z,Math.abs(j)-1)}function he(j){return new DataView(j.array.buffer,j.offset.value,j.size)}function ee(j){var Z=j.viewer.buffer.slice(j.offset.value,j.offset.value+j.size),xe=new Uint8Array(Je(Z)),B=new Uint8Array(xe.length);return ze(xe),Re(xe,B),new DataView(B.buffer)}function Ee(j){var Z=j.array.slice(j.offset.value,j.offset.value+j.size),xe=L1(Z),B=new Uint8Array(xe.length);return ze(xe),Re(xe,B),new DataView(B.buffer)}function Me(j){for(var Z=j.viewer,xe={value:j.offset.value},B=new Uint16Array(j.width*j.scanlineBlockSize*(j.channels*j.type)),re=new Uint8Array(8192),le=0,me=new Array(j.channels),pe=0;pe<j.channels;pe++)me[pe]={},me[pe].start=le,me[pe].end=me[pe].start,me[pe].nx=j.width,me[pe].ny=j.lines,me[pe].size=j.type,le+=me[pe].nx*me[pe].ny*me[pe].size;var Ie=fe(Z,xe),Le=fe(Z,xe);if(Le>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(Ie<=Le)for(var pe=0;pe<Le-Ie+1;pe++)re[pe+Ie]=ye(Z,xe);var $e=new Uint16Array(65536),je=I(re,$e),Dt=wt(Z,xe);Qe(j.array,Z,xe,Dt,B,le);for(var pe=0;pe<j.channels;++pe)for(var et=me[pe],it=0;it<me[pe].size;++it)rt(B,et.start+it,et.nx,et.size,et.ny,et.nx*et.size,je);ae($e,B,le);for(var At=0,en=new Uint8Array(B.buffer.byteLength),tn=0;tn<j.lines;tn++)for(var on=0;on<j.channels;on++){var et=me[on],It=et.nx*et.size,bt=new Uint8Array(B.buffer,et.end*2,It*2);en.set(bt,At),At+=It*2,et.end+=It}return new DataView(en.buffer)}function Ae(j){var Z=j.array.slice(j.offset.value,j.offset.value+j.size),xe=L1(Z);const B=j.lines*j.channels*j.width,re=j.type==1?new Uint16Array(B):new Uint32Array(B);let le=0,me=0;const pe=new Array(4);for(let Ie=0;Ie<j.lines;Ie++)for(let Le=0;Le<j.channels;Le++){let $e=0;switch(j.type){case 1:pe[0]=le,pe[1]=pe[0]+j.width,le=pe[1]+j.width;for(let je=0;je<j.width;++je){const Dt=xe[pe[0]++]<<8|xe[pe[1]++];$e+=Dt,re[me]=$e,me++}break;case 2:pe[0]=le,pe[1]=pe[0]+j.width,pe[2]=pe[1]+j.width,le=pe[2]+j.width;for(let je=0;je<j.width;++je){const Dt=xe[pe[0]++]<<24|xe[pe[1]++]<<16|xe[pe[2]++]<<8;$e+=Dt,re[me]=$e,me++}break}}return new DataView(re.buffer)}function Be(j){var Z=j.viewer,xe={value:j.offset.value},B=new Uint8Array(j.width*j.lines*(j.channels*j.type*2)),re={version:He(Z,xe),unknownUncompressedSize:He(Z,xe),unknownCompressedSize:He(Z,xe),acCompressedSize:He(Z,xe),dcCompressedSize:He(Z,xe),rleCompressedSize:He(Z,xe),rleUncompressedSize:He(Z,xe),rleRawSize:He(Z,xe),totalAcUncompressedCount:He(Z,xe),totalDcUncompressedCount:He(Z,xe),acCompression:He(Z,xe)};if(re.version<2)throw"EXRLoader.parse: "+Xn.compression+" version "+re.version+" is unsupported";for(var le=new Array,me=fe(Z,xe)-2;me>0;){var pe=dt(Z.buffer,xe),Ie=ye(Z,xe),Le=Ie>>2&3,$e=(Ie>>4)-1,je=new Int8Array([$e])[0],Dt=ye(Z,xe);le.push({name:pe,index:je,type:Dt,compression:Le}),me-=pe.length+3}for(var et=Xn.channels,it=new Array(j.channels),At=0;At<j.channels;++At){var en=it[At]={},tn=et[At];en.name=tn.name,en.compression=0,en.decoded=!1,en.type=tn.pixelType,en.pLinear=tn.pLinear,en.width=j.width,en.height=j.lines}for(var on={idx:new Array(3)},It=0;It<j.channels;++It)for(var en=it[It],At=0;At<le.length;++At){var bt=le[At];en.name==bt.name&&(en.compression=bt.compression,bt.index>=0&&(on.idx[bt.index]=It),en.offset=It)}if(re.acCompressedSize>0)switch(re.acCompression){case 0:var fn=new Uint16Array(re.totalAcUncompressedCount);Qe(j.array,Z,xe,re.acCompressedSize,fn,re.totalAcUncompressedCount);break;case 1:var Cn=j.array.slice(xe.value,xe.value+re.totalAcUncompressedCount),an=L1(Cn),fn=new Uint16Array(an.buffer);xe.value+=re.totalAcUncompressedCount;break}if(re.dcCompressedSize>0){var ur={array:j.array,offset:xe,size:re.dcCompressedSize},zr=new Uint16Array(Ee(ur).buffer);xe.value+=re.dcCompressedSize}if(re.rleRawSize>0){var Cn=j.array.slice(xe.value,xe.value+re.rleCompressedSize),an=L1(Cn),Tr=Je(an.buffer);xe.value+=re.rleCompressedSize}for(var Hn=0,Nn=new Array(it.length),At=0;At<Nn.length;++At)Nn[At]=new Array;for(var $n=0;$n<j.lines;++$n)for(var bn=0;bn<it.length;++bn)Nn[bn].push(Hn),Hn+=it[bn].width*j.type*2;Ge(on,Nn,it,fn,zr,B);for(var At=0;At<it.length;++At){var en=it[At];if(!en.decoded)switch(en.compression){case 2:for(var Un=0,dr=0,$n=0;$n<j.lines;++$n){for(var Ps=Nn[At][Un],Vi=0;Vi<en.width;++Vi){for(var na=0;na<2*en.type;++na)B[Ps++]=Tr[dr+na*en.width*en.height];dr++}Un++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(B.buffer)}function dt(j,Z){for(var xe=new Uint8Array(j),B=0;xe[Z.value+B]!=0;)B+=1;var re=new TextDecoder().decode(xe.slice(Z.value,Z.value+B));return Z.value=Z.value+B+1,re}function We(j,Z,xe){var B=new TextDecoder().decode(new Uint8Array(j).slice(Z.value,Z.value+xe));return Z.value=Z.value+xe,B}function Kt(j,Z){var xe=jt(j,Z),B=wt(j,Z);return[xe,B]}function cn(j,Z){var xe=wt(j,Z),B=wt(j,Z);return[xe,B]}function jt(j,Z){var xe=j.getInt32(Z.value,!0);return Z.value=Z.value+4,xe}function wt(j,Z){var xe=j.getUint32(Z.value,!0);return Z.value=Z.value+4,xe}function Mt(j,Z){var xe=j[Z.value];return Z.value=Z.value+1,xe}function ye(j,Z){var xe=j.getUint8(Z.value);return Z.value=Z.value+1,xe}const He=function(j,Z){let xe;return"getBigInt64"in DataView.prototype?xe=Number(j.getBigInt64(Z.value,!0)):xe=j.getUint32(Z.value+4,!0)+Number(j.getUint32(Z.value,!0)<<32),Z.value+=8,xe};function st(j,Z){var xe=j.getFloat32(Z.value,!0);return Z.value+=4,xe}function _t(j,Z){return Ih.toHalfFloat(st(j,Z))}function Ye(j){var Z=(j&31744)>>10,xe=j&1023;return(j>>15?-1:1)*(Z?Z===31?xe?NaN:1/0:Math.pow(2,Z-15)*(1+xe/1024):6103515625e-14*(xe/1024))}function fe(j,Z){var xe=j.getUint16(Z.value,!0);return Z.value+=2,xe}function ot(j,Z){return Ye(fe(j,Z))}function ht(j,Z,xe,B){for(var re=xe.value,le=[];xe.value<re+B-1;){var me=dt(Z,xe),pe=jt(j,xe),Ie=ye(j,xe);xe.value+=3;var Le=jt(j,xe),$e=jt(j,xe);le.push({name:me,pixelType:pe,pLinear:Ie,xSampling:Le,ySampling:$e})}return xe.value+=1,le}function Bt(j,Z){var xe=st(j,Z),B=st(j,Z),re=st(j,Z),le=st(j,Z),me=st(j,Z),pe=st(j,Z),Ie=st(j,Z),Le=st(j,Z);return{redX:xe,redY:B,greenX:re,greenY:le,blueX:me,blueY:pe,whiteX:Ie,whiteY:Le}}function Pt(j,Z){var xe=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],B=ye(j,Z);return xe[B]}function xn(j,Z){var xe=wt(j,Z),B=wt(j,Z),re=wt(j,Z),le=wt(j,Z);return{xMin:xe,yMin:B,xMax:re,yMax:le}}function Dn(j,Z){var xe=["INCREASING_Y"],B=ye(j,Z);return xe[B]}function ir(j,Z){var xe=st(j,Z),B=st(j,Z);return[xe,B]}function wr(j,Z){var xe=st(j,Z),B=st(j,Z),re=st(j,Z);return[xe,B,re]}function Wn(j,Z,xe,B,re){if(B==="string"||B==="stringvector"||B==="iccProfile")return We(Z,xe,re);if(B==="chlist")return ht(j,Z,xe,re);if(B==="chromaticities")return Bt(j,xe);if(B==="compression")return Pt(j,xe);if(B==="box2i")return xn(j,xe);if(B==="lineOrder")return Dn(j,xe);if(B==="float")return st(j,xe);if(B==="v2f")return ir(j,xe);if(B==="v3f")return wr(j,xe);if(B==="int")return jt(j,xe);if(B==="rational")return Kt(j,xe);if(B==="timecode")return cn(j,xe);if(B==="preview")return xe.value+=re,"skipped";xe.value+=re}function kr(j,Z,xe){const B={};if(j.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";B.version=j.getUint8(4);const re=j.getUint8(5);B.spec={singleTile:!!(re&2),longName:!!(re&4),deepFormat:!!(re&8),multiPart:!!(re&16)},xe.value=8;for(var le=!0;le;){var me=dt(Z,xe);if(me==0)le=!1;else{var pe=dt(Z,xe),Ie=wt(j,xe),Le=Wn(j,Z,xe,pe,Ie);Le===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${pe}'.`):B[me]=Le}}if(re&-5)throw console.error("EXRHeader:",B),"THREE.EXRLoader: provided file is currently unsupported.";return B}function cs(j,Z,xe,B,re){const le={size:0,viewer:Z,array:xe,offset:B,width:j.dataWindow.xMax-j.dataWindow.xMin+1,height:j.dataWindow.yMax-j.dataWindow.yMin+1,channels:j.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:j.channels[0].pixelType,uncompress:null,getter:null,format:null,[Iy?"colorSpace":"encoding"]:null};switch(j.compression){case"NO_COMPRESSION":le.lines=1,le.uncompress=he;break;case"RLE_COMPRESSION":le.lines=1,le.uncompress=ee;break;case"ZIPS_COMPRESSION":le.lines=1,le.uncompress=Ee;break;case"ZIP_COMPRESSION":le.lines=16,le.uncompress=Ee;break;case"PIZ_COMPRESSION":le.lines=32,le.uncompress=Me;break;case"PXR24_COMPRESSION":le.lines=16,le.uncompress=Ae;break;case"DWAA_COMPRESSION":le.lines=32,le.uncompress=Be;break;case"DWAB_COMPRESSION":le.lines=256,le.uncompress=Be;break;default:throw"EXRLoader.parse: "+j.compression+" is unsupported"}if(le.scanlineBlockSize=le.lines,le.type==1)switch(re){case fi:le.getter=ot,le.inputSize=2;break;case Fi:le.getter=fe,le.inputSize=2;break}else if(le.type==2)switch(re){case fi:le.getter=st,le.inputSize=4;break;case Fi:le.getter=_t,le.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+le.type+" for "+j.compression+".";le.blockCount=(j.dataWindow.yMax+1)/le.scanlineBlockSize;for(var me=0;me<le.blockCount;me++)He(Z,B);le.outputChannels=le.channels==3?4:le.channels;const pe=le.width*le.height*le.outputChannels;switch(re){case fi:le.byteArray=new Float32Array(pe),le.channels<le.outputChannels&&le.byteArray.fill(1,0,pe);break;case Fi:le.byteArray=new Uint16Array(pe),le.channels<le.outputChannels&&le.byteArray.fill(15360,0,pe);break;default:console.error("THREE.EXRLoader: unsupported type: ",re);break}return le.bytesPerLine=le.width*le.inputSize*le.channels,le.outputChannels==4?le.format=Ii:le.format=jI,Iy?le.colorSpace="srgb-linear":le.encoding=3e3,le}const bi=new DataView(e),Is=new Uint8Array(e),Rs={value:0},Xn=kr(bi,e,Rs),ln=cs(Xn,bi,Is,Rs,this.type),Ra={value:0},tu={R:0,G:1,B:2,A:3,Y:0};for(let j=0;j<ln.height/ln.scanlineBlockSize;j++){const Z=wt(bi,Rs);ln.size=wt(bi,Rs),ln.lines=Z+ln.scanlineBlockSize>ln.height?ln.height-Z:ln.scanlineBlockSize;const B=ln.size<ln.lines*ln.bytesPerLine?ln.uncompress(ln):he(ln);Rs.value+=ln.size;for(let re=0;re<ln.scanlineBlockSize;re++){const le=re+j*ln.scanlineBlockSize;if(le>=ln.height)break;for(let me=0;me<ln.channels;me++){const pe=tu[Xn.channels[me].name];for(let Ie=0;Ie<ln.width;Ie++){Ra.value=(re*(ln.channels*ln.width)+me*ln.width+Ie)*ln.inputSize;const Le=(ln.height-1-le)*(ln.width*ln.outputChannels)+Ie*ln.outputChannels+pe;ln.byteArray[Le]=ln.getter(B,Ra)}}}}return{header:Xn,width:ln.width,height:ln.height,data:ln.byteArray,format:ln.format,[Iy?"colorSpace":"encoding"]:ln[Iy?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,r,i){function s(o,a){Iy?o.colorSpace=a.colorSpace:o.encoding=a.encoding,o.minFilter=Jn,o.magFilter=Jn,o.generateMipmaps=!1,o.flipY=!1,t&&t(o,a)}return super.load(e,s,r,i)}}function Dye(n,e,t,r){const i=class extends Ys{constructor(o={}){const a=Object.entries(n);super({uniforms:a.reduce((l,[c,u])=>{const d=tR.clone({[c]:{value:u}});return{...l,...d}},{}),vertexShader:e,fragmentShader:t}),this.key="",a.forEach(([l])=>Object.defineProperty(this,l,{get:()=>this.uniforms[l].value,set:c=>this.uniforms[l].value=c})),Object.assign(this,o)}};return i.key=oW.generateUUID(),i}const Lye=()=>parseInt(Sg.replace(/\D+/g,"")),Oye=Lye();function Fye(n,e,t){const r=Yi(h=>h.size),i=Yi(h=>h.viewport),s=typeof n=="number"?n:r.width*i.dpr,o=r.height*i.dpr,a=(typeof n=="number"?t:n)||{},{samples:l=0,depth:c,...u}=a,d=N.useMemo(()=>{const h=new Eo(s,o,{minFilter:Jn,magFilter:Jn,type:Fi,...u});return c&&(h.depthTexture=new U_(s,o,fi)),h.samples=l,h},[]);return N.useLayoutEffect(()=>{d.setSize(s,o),l&&(d.samples=l)},[l,d,s,o]),N.useEffect(()=>()=>d.dispose(),[]),d}const zye=n=>typeof n=="function",Uye=N.forwardRef(({envMap:n,resolution:e=256,frames:t=1/0,makeDefault:r,children:i,...s},o)=>{const a=Yi(({set:v})=>v),l=Yi(({camera:v})=>v),c=Yi(({size:v})=>v),u=N.useRef(null);N.useImperativeHandle(o,()=>u.current,[]);const d=N.useRef(null),h=Fye(e);N.useLayoutEffect(()=>{s.manual||(u.current.aspect=c.width/c.height)},[c,s]),N.useLayoutEffect(()=>{u.current.updateProjectionMatrix()});let f=0,p=null;const x=zye(i);return u2(v=>{x&&(t===1/0||f<t)&&(d.current.visible=!1,v.gl.setRenderTarget(h),p=v.scene.background,n&&(v.scene.background=n),v.gl.render(v.scene,u.current),v.scene.background=p,v.gl.setRenderTarget(null),d.current.visible=!0,f++)}),N.useLayoutEffect(()=>{if(r){const v=l;return a(()=>({camera:u.current})),()=>a(()=>({camera:v}))}},[u,r,a]),N.createElement(N.Fragment,null,N.createElement("perspectiveCamera",hf({ref:u},s),!x&&i),N.createElement("group",{ref:d},x&&i(h.texture)))}),KA=N.forwardRef(({makeDefault:n,camera:e,regress:t,domElement:r,enableDamping:i=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:l,...c},u)=>{const d=Yi(M=>M.invalidate),h=Yi(M=>M.camera),f=Yi(M=>M.gl),p=Yi(M=>M.events),x=Yi(M=>M.setEvents),v=Yi(M=>M.set),y=Yi(M=>M.get),b=Yi(M=>M.performance),S=e||h,_=r||p.connected||f.domElement,T=N.useMemo(()=>new Iye(S),[S]);return u2(()=>{T.enabled&&T.update()},-1),N.useEffect(()=>(s&&T.connect(s===!0?_:s),T.connect(_),()=>void T.dispose()),[s,_,t,T,d]),N.useEffect(()=>{const M=z=>{d(),t&&b.regress(),o&&o(z)},k=z=>{a&&a(z)},P=z=>{l&&l(z)};return T.addEventListener("change",M),T.addEventListener("start",k),T.addEventListener("end",P),()=>{T.removeEventListener("start",k),T.removeEventListener("end",P),T.removeEventListener("change",M)}},[o,a,l,T,d,x]),N.useEffect(()=>{if(n){const M=y().controls;return v({controls:T}),()=>v({controls:M})}},[n,T]),N.createElement("primitive",hf({ref:u,object:T,enableDamping:i},c))}),Bye=Dye({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new Ut,sectionColor:new Ut,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new ie,worldPlanePosition:new ie},`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform vec3 worldPlanePosition;
    uniform float fadeDistance;
    uniform bool infiniteGrid;
    uniform bool followCamera;

    void main() {
      localPosition = position.xzy;
      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;
      
      worldPosition = modelMatrix * vec4(localPosition, 1.0);
      if (followCamera) {
        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);
        localPosition = (inverse(modelMatrix) * worldPosition).xyz;
      }

      gl_Position = projectionMatrix * viewMatrix * worldPosition;
    }
  `,`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform float cellSize;
    uniform float sectionSize;
    uniform vec3 cellColor;
    uniform vec3 sectionColor;
    uniform float fadeDistance;
    uniform float fadeStrength;
    uniform float fadeFrom;
    uniform float cellThickness;
    uniform float sectionThickness;

    float getGrid(float size, float thickness) {
      vec2 r = localPosition.xz / size;
      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
      float line = min(grid.x, grid.y) + 1.0 - thickness;
      return 1.0 - min(line, 1.0);
    }

    void main() {
      float g1 = getGrid(cellSize, cellThickness);
      float g2 = getGrid(sectionSize, sectionThickness);

      vec3 from = worldCamProjPosition*vec3(fadeFrom);
      float dist = distance(from, worldPosition.xyz);
      float d = 1.0 - min(dist / fadeDistance, 1.0);
      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));

      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));
      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);
      if (gl_FragColor.a <= 0.0) discard;

      #include <tonemapping_fragment>
      #include <${Oye>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `),$ye=N.forwardRef(({args:n,cellColor:e="#000000",sectionColor:t="#2080ff",cellSize:r=.5,sectionSize:i=1,followCamera:s=!1,infiniteGrid:o=!1,fadeDistance:a=100,fadeStrength:l=1,fadeFrom:c=1,cellThickness:u=.5,sectionThickness:d=1,side:h=Cs,...f},p)=>{AR({GridMaterial:Bye});const x=N.useRef(null);N.useImperativeHandle(p,()=>x.current,[]);const v=new Wa,y=new ie(0,1,0),b=new ie(0,0,0);u2(T=>{v.setFromNormalAndCoplanarPoint(y,b).applyMatrix4(x.current.matrixWorld);const M=x.current.material,k=M.uniforms.worldCamProjPosition,P=M.uniforms.worldPlanePosition;v.projectPoint(T.camera.position,k.value),P.value.set(0,0,0).applyMatrix4(x.current.matrixWorld)});const S={cellSize:r,sectionSize:i,cellColor:e,sectionColor:t,cellThickness:u,sectionThickness:d},_={fadeDistance:a,fadeStrength:l,fadeFrom:c,infiniteGrid:o,followCamera:s};return N.createElement("mesh",hf({ref:x,frustumCulled:!1},f),N.createElement("gridMaterial",hf({transparent:!0,"extensions-derivatives":!0,side:h},S,_)),N.createElement("planeGeometry",{args:n}))});var qH={exports:{}},jye="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Vye=jye,Wye=Vye;function XH(){}function KH(){}KH.resetWarningCache=XH;var Hye=function(){function n(r,i,s,o,a,l){if(l!==Wye){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:KH,resetWarningCache:XH};return t.PropTypes=t,t};qH.exports=Hye();var Gye=qH.exports;const Ar=B0(Gye),qye=3e3,Xye=3001,YH=(n,e,t)=>{let r;switch(n){case Wo:r=new Uint8ClampedArray(e*t*4);break;case Fi:r=new Uint16Array(e*t*4);break;case kl:r=new Uint32Array(e*t*4);break;case zI:r=new Int8Array(e*t*4);break;case UI:r=new Int16Array(e*t*4);break;case L_:r=new Int32Array(e*t*4);break;case fi:r=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return r};let F1;const Kye=(n,e,t,r)=>{if(F1!==void 0)return F1;const i=new Eo(1,1,r);e.setRenderTarget(i);const s=new ri(new Ad,new ec({color:16777215}));e.render(s,t),e.setRenderTarget(null);const o=YH(n,i.width,i.height);return e.readRenderTargetPixels(i,0,0,i.width,i.height,o),i.dispose(),s.geometry.dispose(),s.material.dispose(),F1=o[0]!==0,F1};class RR{constructor(e){var t,r,i,s,o,a,l,c,u,d,h,f,p,x,v,y;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(S){throw this._renderer.setRenderTarget(null),S}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const b={format:Ii,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((t=e.renderTargetOptions)===null||t===void 0?void 0:t.anisotropy)!==void 0?(r=e.renderTargetOptions)===null||r===void 0?void 0:r.anisotropy:1,generateMipmaps:((i=e.renderTargetOptions)===null||i===void 0?void 0:i.generateMipmaps)!==void 0?(s=e.renderTargetOptions)===null||s===void 0?void 0:s.generateMipmaps:!1,magFilter:((o=e.renderTargetOptions)===null||o===void 0?void 0:o.magFilter)!==void 0?(a=e.renderTargetOptions)===null||a===void 0?void 0:a.magFilter:Jn,minFilter:((l=e.renderTargetOptions)===null||l===void 0?void 0:l.minFilter)!==void 0?(c=e.renderTargetOptions)===null||c===void 0?void 0:c.minFilter:Jn,samples:((u=e.renderTargetOptions)===null||u===void 0?void 0:u.samples)!==void 0?(d=e.renderTargetOptions)===null||d===void 0?void 0:d.samples:void 0,wrapS:((h=e.renderTargetOptions)===null||h===void 0?void 0:h.wrapS)!==void 0?(f=e.renderTargetOptions)===null||f===void 0?void 0:f.wrapS:Gr,wrapT:((p=e.renderTargetOptions)===null||p===void 0?void 0:p.wrapT)!==void 0?(x=e.renderTargetOptions)===null||x===void 0?void 0:x.wrapT:Gr};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=RR.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Tg,this._camera=new Ic,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!Kye(this._type,this._renderer,this._camera,b)){let S;switch(this._type){case Fi:S=this._renderer.extensions.has("EXT_color_buffer_float")?fi:void 0;break}S!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${fi}`),this._type=S):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new ri(new Ad,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new Eo(this.width,this.height,b),this._renderTarget.texture.mapping=((v=e.renderTargetOptions)===null||v===void 0?void 0:v.mapping)!==void 0?(y=e.renderTargetOptions)===null||y===void 0?void 0:y.mapping:pd}static instantiateRenderer(){const e=new cx;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=YH(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new Qu(this.toArray(),this.width,this.height,Ii,this._type,(e==null?void 0:e.mapping)||pd,(e==null?void 0:e.wrapS)||Gr,(e==null?void 0:e.wrapT)||Gr,(e==null?void 0:e.magFilter)||Jn,(e==null?void 0:e.minFilter)||Jn,(e==null?void 0:e.anisotropy)||1,Ko);return t.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof Ys&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof qr&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof qr&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const Yye=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,Zye=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class Qye extends Ys{constructor({gamma:e,offsetHdr:t,offsetSdr:r,gainMapMin:i,gainMapMax:s,maxDisplayBoost:o,hdrCapacityMin:a,hdrCapacityMax:l,sdr:c,gainMap:u}){super({name:"GainMapDecoderMaterial",vertexShader:Yye,fragmentShader:Zye,uniforms:{sdr:{value:c},gainMap:{value:u},gamma:{value:new ie(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new ie().fromArray(t)},offsetSdr:{value:new ie().fromArray(r)},gainMapMin:{value:new ie().fromArray(i)},gainMapMax:{value:new ie().fromArray(s)},weightFactor:{value:(Math.log2(o)-a)/(l-a)}},blending:zl,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=o,this._hdrCapacityMin=a,this._hdrCapacityMax=l,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class ZH extends Error{}class QH extends Error{}const Ry=(n,e,t)=>{const r=new RegExp(`${e}="([^"]*)"`,"i").exec(n);if(r)return r[1];const i=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(n);if(i){const s=i[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return s&&s.length===3?s.map(o=>o.replace(/<\/?rdf:li>/g,"")):i[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},Jye=n=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(n):e=n.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const r=e.indexOf("x:xmpmeta>",t),i=e.slice(t,r+10);try{const s=Ry(i,"hdrgm:GainMapMin","0"),o=Ry(i,"hdrgm:GainMapMax"),a=Ry(i,"hdrgm:Gamma","1"),l=Ry(i,"hdrgm:OffsetSDR","0.015625"),c=Ry(i,"hdrgm:OffsetHDR","0.015625"),u=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(i),d=u?u[1]:"0",h=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(i);if(!h)throw new Error("Incomplete gainmap metadata");const f=h[1];return{gainMapMin:Array.isArray(s)?s.map(p=>parseFloat(p)):[parseFloat(s),parseFloat(s),parseFloat(s)],gainMapMax:Array.isArray(o)?o.map(p=>parseFloat(p)):[parseFloat(o),parseFloat(o),parseFloat(o)],gamma:Array.isArray(a)?a.map(p=>parseFloat(p)):[parseFloat(a),parseFloat(a),parseFloat(a)],offsetSdr:Array.isArray(l)?l.map(p=>parseFloat(p)):[parseFloat(l),parseFloat(l),parseFloat(l)],offsetHdr:Array.isArray(c)?c.map(p=>parseFloat(p)):[parseFloat(c),parseFloat(c),parseFloat(c)],hdrCapacityMin:parseFloat(d),hdrCapacityMax:parseFloat(f)}}catch{}t=e.indexOf("<x:xmpmeta",r)}};class eve{constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,r)=>{const i=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){r(new Error("Not a valid jpeg"));return}const o=s.byteLength;let a=2,l=0,c;for(;a<o;){if(++l>250){r(new Error(`Found no marker after ${l} loops 😵`));return}if(s.getUint8(a)!==255){r(new Error(`Not a valid marker at offset 0x${a.toString(16)}, found: 0x${s.getUint8(a).toString(16)}`));return}if(c=s.getUint8(a+1),i&&console.log(`Marker: ${c.toString(16)}`),c===226){i&&console.log("Found APP2 marker (0xffe2)");const u=a+4;if(s.getUint32(u)===1297106432){const d=u+4;let h;if(s.getUint16(d)===18761)h=!1;else if(s.getUint16(d)===19789)h=!0;else{r(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(d+2,!h)!==42){r(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const f=s.getUint32(d+4,!h);if(f<8){r(new Error("Not valid TIFF data! (First offset less than 8)"));return}const p=d+f,x=s.getUint16(p,!h),v=p+2;let y=0;for(let T=v;T<v+12*x;T+=12)s.getUint16(T,!h)===45057&&(y=s.getUint32(T+8,!h));const S=p+2+x*12+4,_=[];for(let T=S;T<S+y*16;T+=16){const M={MPType:s.getUint32(T,!h),size:s.getUint32(T+4,!h),dataOffset:s.getUint32(T+8,!h),dependantImages:s.getUint32(T+12,!h),start:-1,end:-1,isFII:!1};M.dataOffset?(M.start=d+M.dataOffset,M.isFII=!1):(M.start=0,M.isFII=!0),M.end=M.start+M.size,_.push(M)}if(this.options.extractNonFII&&_.length){const T=new Blob([s]),M=[];for(const k of _){if(k.isFII&&!this.options.extractFII)continue;const P=T.slice(k.start,k.end+1,"image/jpeg");M.push(P)}t(M)}}}a+=2+s.getUint16(a+2)}})}}const tve=async n=>{const e=Jye(n);if(!e)throw new QH("Gain map XMP metadata not found");const r=await new eve({extractFII:!0,extractNonFII:!0}).extract(n);if(r.length!==2)throw new ZH("Gain map recovery image not found");return{sdr:new Uint8Array(await r[0].arrayBuffer()),gainMap:new Uint8Array(await r[1].arrayBuffer()),metadata:e}},JF=n=>new Promise((e,t)=>{const r=document.createElement("img");r.onload=()=>{e(r)},r.onerror=i=>{t(i)},r.src=URL.createObjectURL(n)});class JH extends ro{constructor(e,t){super(t),e&&(this._renderer=e),this._internalLoadingManager=new a2}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=new Qye({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new qr,sdr:new qr});return new RR({width:16,height:16,type:Fi,colorSpace:Ko,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,t,r,i){const s=i?new Blob([i],{type:"image/jpeg"}):void 0,o=new Blob([r],{type:"image/jpeg"});let a,l,c=!1;if(typeof createImageBitmap>"u"){const h=await Promise.all([s?JF(s):Promise.resolve(void 0),JF(o)]);l=h[0],a=h[1],c=!0}else{const h=await Promise.all([s?createImageBitmap(s,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(o,{imageOrientation:"flipY"})]);l=h[0],a=h[1]}const u=new qr(l||new ImageData(2,2),pd,Gr,Gr,Jn,oA,Ii,Wo,1,Ko);u.flipY=c,u.needsUpdate=!0;const d=new qr(a,pd,Gr,Gr,Jn,oA,Ii,Wo,1,Ai);d.flipY=c,d.needsUpdate=!0,e.width=a.width,e.height=a.height,e.material.gainMap=u,e.material.sdr=d,e.material.gainMapMin=t.gainMapMin,e.material.gainMapMax=t.gainMapMax,e.material.offsetHdr=t.offsetHdr,e.material.offsetSdr=t.offsetSdr,e.material.gamma=t.gamma,e.material.hdrCapacityMin=t.hdrCapacityMin,e.material.hdrCapacityMax=t.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,t.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class nve extends JH{load([e,t,r],i,s,o){const a=this.prepareQuadRenderer();let l,c,u;const d=async()=>{if(l&&c&&u){try{await this.render(a,u,l,c)}catch(z){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(r),typeof o=="function"&&o(z),a.disposeOnDemandRenderer();return}typeof i=="function"&&i(a),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(r),a.disposeOnDemandRenderer()}};let h=!0,f=0,p=0,x=!0,v=0,y=0,b=!0,S=0,_=0;const T=()=>{if(typeof s=="function"){const z=f+v+S,I=p+y+_,L=h&&x&&b;s(new ProgressEvent("progress",{lengthComputable:L,loaded:I,total:z}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(r);const M=new Go(this._internalLoadingManager);M.setResponseType("arraybuffer"),M.setRequestHeader(this.requestHeader),M.setPath(this.path),M.setWithCredentials(this.withCredentials),M.load(e,async z=>{if(typeof z=="string")throw new Error("Invalid sdr buffer");l=z,await d()},z=>{h=z.lengthComputable,p=z.loaded,f=z.total,T()},z=>{this.manager.itemError(e),typeof o=="function"&&o(z)});const k=new Go(this._internalLoadingManager);k.setResponseType("arraybuffer"),k.setRequestHeader(this.requestHeader),k.setPath(this.path),k.setWithCredentials(this.withCredentials),k.load(t,async z=>{if(typeof z=="string")throw new Error("Invalid gainmap buffer");c=z,await d()},z=>{x=z.lengthComputable,y=z.loaded,v=z.total,T()},z=>{this.manager.itemError(t),typeof o=="function"&&o(z)});const P=new Go(this._internalLoadingManager);return P.setRequestHeader(this.requestHeader),P.setPath(this.path),P.setWithCredentials(this.withCredentials),P.load(r,async z=>{if(typeof z!="string")throw new Error("Invalid metadata string");u=JSON.parse(z),await d()},z=>{b=z.lengthComputable,_=z.loaded,S=z.total,T()},z=>{this.manager.itemError(r),typeof o=="function"&&o(z)}),a}}class rve extends JH{load(e,t,r,i){const s=this.prepareQuadRenderer(),o=new Go(this._internalLoadingManager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(this.withCredentials),this.manager.itemStart(e),o.load(e,async a=>{if(typeof a=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const l=new Uint8Array(a);let c,u,d;try{const h=await tve(l);c=h.sdr,u=h.gainMap,d=h.metadata}catch(h){if(h instanceof QH||h instanceof ZH)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),d={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},c=l;else throw h}try{await this.render(s,d,c,u)}catch(h){this.manager.itemError(e),typeof i=="function"&&i(h),s.disposeOnDemandRenderer();return}typeof t=="function"&&t(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},r,a=>{this.manager.itemError(e),typeof i=="function"&&i(a)}),s}}const E0={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},eG="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",Em=n=>Array.isArray(n),PR=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function d2({files:n=PR,path:e="",preset:t=void 0,encoding:r=void 0,extensions:i}={}){let s=null,o=!1;t&&(DR(t),n=E0[t],e=eG),o=Em(n);const{extension:a,isCubemap:l}=LR(n);if(s=OR(a),!s)throw new Error("useEnvironment: Unrecognized file extension: "+n);const c=Yi(f=>f.gl);N.useLayoutEffect(()=>{if(a!=="webp"&&a!=="jpg"&&a!=="jpeg")return;function f(){qm.clear(s,o?[n]:n)}c.domElement.addEventListener("webglcontextlost",f,{once:!0})},[n,c.domElement]);const u=qm(s,o?[n]:n,f=>{(a==="webp"||a==="jpg"||a==="jpeg")&&f.setRenderer(c),f.setPath==null||f.setPath(e),i&&i(f)});let d=o?u[0]:u;if(a==="jpg"||a==="jpeg"||a==="webp"){var h;d=(h=d.renderTarget)==null?void 0:h.texture}return d.mapping=l?ql:jm,"colorSpace"in d?d.colorSpace=r??l?"srgb":"srgb-linear":d.encoding=r??l?Xye:qye,d}const ive={files:PR,path:"",preset:void 0,extensions:void 0};d2.preload=n=>{const e={...ive,...n};let{files:t,path:r=""}=e;const{preset:i,extensions:s}=e;i&&(DR(i),t=E0[i],r=eG);const{extension:o}=LR(t);if(o==="webp"||o==="jpg"||o==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const a=OR(o);if(!a)throw new Error("useEnvironment: Unrecognized file extension: "+t);qm.preload(a,Em(t)?[t]:t,l=>{l.setPath==null||l.setPath(r),s&&s(l)})};const sve={files:PR,preset:void 0};d2.clear=n=>{const e={...sve,...n};let{files:t}=e;const{preset:r}=e;r&&(DR(r),t=E0[r]);const{extension:i}=LR(t),s=OR(i);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+t);qm.clear(s,Em(t)?[t]:t)};function DR(n){if(!(n in E0))throw new Error("Preset must be one of: "+Object.keys(E0).join(", "))}function LR(n){var e;const t=Em(n)&&n.length===6,r=Em(n)&&n.length===3&&n.some(o=>o.endsWith("json")),i=Em(n)?n[0]:n;return{extension:t?"cube":r?"webp":i.startsWith("data:application/exr")?"exr":i.startsWith("data:application/hdr")?"hdr":i.startsWith("data:image/jpeg")?"jpg":(e=i.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:r}}function OR(n){return n==="cube"?nH:n==="hdr"?Rye:n==="exr"?Pye:n==="jpg"||n==="jpeg"?rve:n==="webp"?nve:null}const ove=n=>n.current&&n.current.isScene,ave=n=>ove(n)?n.current:n;function FR(n,e,t,r,i={}){var s,o,a,l;i={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...i};const c=ave(e||t),u=c.background,d=c.environment,h={backgroundBlurriness:c.backgroundBlurriness,backgroundIntensity:c.backgroundIntensity,backgroundRotation:(s=(o=c.backgroundRotation)==null||o.clone==null?void 0:o.clone())!==null&&s!==void 0?s:[0,0,0],environmentIntensity:c.environmentIntensity,environmentRotation:(a=(l=c.environmentRotation)==null||l.clone==null?void 0:l.clone())!==null&&a!==void 0?a:[0,0,0]};return n!=="only"&&(c.environment=r),n&&(c.background=r),Nu(c,i),()=>{n!=="only"&&(c.environment=d),n&&(c.background=u),Nu(c,h)}}function zR({scene:n,background:e=!1,map:t,...r}){const i=Yi(s=>s.scene);return N.useLayoutEffect(()=>{if(t)return FR(e,n,i,t,r)}),null}function tG({background:n=!1,scene:e,blur:t,backgroundBlurriness:r,backgroundIntensity:i,backgroundRotation:s,environmentIntensity:o,environmentRotation:a,...l}){const c=d2(l),u=Yi(d=>d.scene);return N.useLayoutEffect(()=>FR(n,e,u,c,{backgroundBlurriness:t??r,backgroundIntensity:i,backgroundRotation:s,environmentIntensity:o,environmentRotation:a})),N.useEffect(()=>()=>{c.dispose()},[c]),null}function lve({children:n,near:e=.1,far:t=1e3,resolution:r=256,frames:i=1,map:s,background:o=!1,blur:a,backgroundBlurriness:l,backgroundIntensity:c,backgroundRotation:u,environmentIntensity:d,environmentRotation:h,scene:f,files:p,path:x,preset:v=void 0,extensions:y}){const b=Yi(P=>P.gl),S=Yi(P=>P.scene),_=N.useRef(null),[T]=N.useState(()=>new Tg),M=N.useMemo(()=>{const P=new nR(r);return P.texture.type=Fi,P},[r]);N.useEffect(()=>()=>{M.dispose()},[M]),N.useLayoutEffect(()=>{if(i===1){const P=b.autoClear;b.autoClear=!0,_.current.update(b,T),b.autoClear=P}return FR(o,f,S,M.texture,{backgroundBlurriness:a??l,backgroundIntensity:c,backgroundRotation:u,environmentIntensity:d,environmentRotation:h})},[n,T,M.texture,f,S,o,i,b]);let k=1;return u2(()=>{if(i===1/0||k<i){const P=b.autoClear;b.autoClear=!0,_.current.update(b,T),b.autoClear=P,k++}}),N.createElement(N.Fragment,null,Hge(N.createElement(N.Fragment,null,n,N.createElement("cubeCamera",{ref:_,args:[e,t,M]}),p||v?N.createElement(tG,{background:!0,files:p,preset:v,path:x,extensions:y}):s?N.createElement(zR,{background:!0,map:s,extensions:y}):null),T))}function cve(n){var e,t,r,i;const s=d2(n),o=n.map||s;N.useMemo(()=>AR({GroundProjectedEnvImpl:_ye}),[]),N.useEffect(()=>()=>{s.dispose()},[s]);const a=N.useMemo(()=>[o],[o]),l=(e=n.ground)==null?void 0:e.height,c=(t=n.ground)==null?void 0:t.radius,u=(r=(i=n.ground)==null?void 0:i.scale)!==null&&r!==void 0?r:1e3;return N.createElement(N.Fragment,null,N.createElement(zR,hf({},n,{map:o})),N.createElement("groundProjectedEnvImpl",{args:a,scale:u,height:l,radius:c}))}function nG(n){return n.ground?N.createElement(cve,n):n.map?N.createElement(zR,n):n.children?N.createElement(lve,n):N.createElement(tG,n)}var rG={exports:{}},iG={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Km=N;function uve(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var dve=typeof Object.is=="function"?Object.is:uve,hve=Km.useState,fve=Km.useEffect,pve=Km.useLayoutEffect,mve=Km.useDebugValue;function gve(n,e){var t=e(),r=hve({inst:{value:t,getSnapshot:e}}),i=r[0].inst,s=r[1];return pve(function(){i.value=t,i.getSnapshot=e,iT(i)&&s({inst:i})},[n,t,e]),fve(function(){return iT(i)&&s({inst:i}),n(function(){iT(i)&&s({inst:i})})},[n]),mve(t),t}function iT(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!dve(n,t)}catch{return!0}}function yve(n,e){return e()}var vve=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?yve:gve;iG.useSyncExternalStore=Km.useSyncExternalStore!==void 0?Km.useSyncExternalStore:vve;rG.exports=iG;var xve=rG.exports;const ez=({position:n,onClick:e})=>{const t=N.useRef(null);return w.jsxs("mesh",{ref:t,position:n,onClick:e,children:[w.jsx("boxGeometry",{args:[1,1,1]}),w.jsx("meshStandardMaterial",{color:"#8B4513"})]})},wve=()=>w.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-gray-700",children:w.jsxs("div",{className:"text-gray-600 dark:text-gray-300",children:[w.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),w.jsx("div",{children:"Загрузка 3D сцены..."})]})}),bve=({showGrid:n,zoom:e,selectedObject:t,onObjectSelect:r})=>w.jsxs("div",{className:"w-full h-full relative",children:[w.jsx(N.Suspense,{fallback:w.jsx(wve,{}),children:w.jsxs(UH,{shadows:!0,camera:{position:[5,5,5],fov:75},style:{background:"linear-gradient(to bottom, #e0f2fe, #f5f5f5)"},children:[w.jsx("ambientLight",{intensity:.4}),w.jsx("directionalLight",{position:[10,10,5],intensity:.8,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048}),w.jsx("pointLight",{position:[-10,-10,-10],intensity:.3}),w.jsx(Uye,{makeDefault:!0,position:[5,5,5]}),w.jsx(KA,{enablePan:!0,enableZoom:!0,enableRotate:!0,minDistance:2,maxDistance:20,maxPolarAngle:Math.PI/2}),n&&w.jsx($ye,{position:[0,0,0],args:[20,20],cellSize:1,cellThickness:.5,cellColor:"#999999",sectionSize:5,sectionThickness:1,sectionColor:"#666666",fadeDistance:30,fadeStrength:1,followCamera:!1,infiniteGrid:!0}),w.jsxs("mesh",{position:[0,-.01,0],rotation:[-Math.PI/2,0,0],receiveShadow:!0,children:[w.jsx("planeGeometry",{args:[20,20]}),w.jsx("meshStandardMaterial",{color:"#f0f0f0",transparent:!0,opacity:.8})]}),w.jsx(ez,{position:[0,.5,0],onClick:()=>r("demo-cube-1")}),w.jsx(ez,{position:[2,.5,2],onClick:()=>r("demo-cube-2")}),w.jsx(nG,{preset:"studio"})]})}),w.jsx("div",{className:"absolute bottom-4 right-4 bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded-lg p-3 text-sm",children:w.jsxs("div",{className:"text-gray-600 dark:text-gray-300",children:[w.jsx("div",{children:"Управление:"}),w.jsx("div",{children:"• ЛКМ - поворот"}),w.jsx("div",{children:"• ПКМ - панорама"}),w.jsx("div",{children:"• Колесо - масштаб"})]})})]});async function Sve(n){try{return(await(await fetch("http://localhost:11434/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"llama3",prompt:`Ты — помощник по 3D-моделированию мебели. Если пользователь просит создать объект, верни JSON вида {"type":"шкаф","width":120,"height":200,"depth":60,"material":"oak"} без пояснений. Если вопрос обычный — просто ответь текстом. Запрос: ${n}`,stream:!1})})).json()).response||"Нет ответа от ИИ."}catch{return"Ошибка соединения с Ollama."}}const _ve=()=>{const[n,e]=N.useState([{from:"ruv",text:"Здравствуйте! Я РУВ — ваш помощник по проектированию мебели. Чем могу помочь?"}]),[t,r]=N.useState(""),i=N.useRef(null);N.useEffect(()=>{var o;(o=i.current)==null||o.scrollTo(0,i.current.scrollHeight)},[n]);const s=async()=>{var l;if(!t.trim())return;e(c=>[...c,{from:"user",text:t}]),r(""),e(c=>[...c,{from:"ruv",text:"Печатаю ответ..."}]);const o=await Sve(t);let a=null;try{a=JSON.parse(o)}catch{}a&&a.type?((l=window.create3DModelFromAI)==null||l.call(window,a),e(c=>[...c.slice(0,-1),{from:"ruv",text:`Создаю ${a.type} с параметрами: ширина ${a.width}, высота ${a.height}, глубина ${a.depth}, материал ${a.material}`}])):e(c=>[...c.slice(0,-1),{from:"ruv",text:o}])};return w.jsxs("div",{className:"fixed bottom-6 right-6 bg-white rounded-xl shadow-2xl w-96 max-w-full z-50",children:[w.jsx("div",{className:"bg-orange-500 text-white px-4 py-2 rounded-t-xl font-bold flex justify-between items-center",children:"🤖 РУВ — ассистент"}),w.jsx("div",{ref:i,className:"p-4 h-64 overflow-y-auto",children:n.map((o,a)=>w.jsx("div",{className:`mb-2 ${o.from==="ruv"?"text-left":"text-right"}`,children:w.jsx("span",{className:`inline-block px-3 py-2 rounded-lg ${o.from==="ruv"?"bg-gray-100 text-gray-800":"bg-orange-100 text-orange-800"}`,children:o.text})},a))}),w.jsxs("div",{className:"flex border-t p-2",children:[w.jsx("input",{className:"flex-1 border rounded-l-lg px-3 py-2 outline-none",value:t,onChange:o=>r(o.target.value),onKeyDown:o=>o.key==="Enter"&&s(),placeholder:"Спросите РУВ..."}),w.jsx("button",{className:"bg-orange-500 text-white px-4 py-2 rounded-r-lg",onClick:s,children:"Отправить"})]})]})},tz=()=>{const{projectId:n}=bJ(),e=Zc(),{currentProject:t,openProject:r,saveProject:i,projects:s}=R$(),[o,a]=N.useState("select"),[l,c]=N.useState(!1),[u,d]=N.useState(100),[h,f]=N.useState(null),[p,x]=N.useState(!0),[v,y]=N.useState(300),[b,S]=N.useState(300);N.useEffect(()=>{n&&!t&&(s.find(L=>L.id===n)?r(n):e("/dashboard"))},[n,t,s,r,e]);const _=[{id:"select",name:"Выбрать",icon:hL,shortcut:"V"},{id:"move",name:"Переместить",icon:hL,shortcut:"G"},{id:"rotate",name:"Повернуть",icon:Gee,shortcut:"R"},{id:"scale",name:"Масштаб",icon:Xee,shortcut:"S"}],T=[{id:"chair",name:"Стул",category:"Мебель"},{id:"table",name:"Стол",category:"Мебель"},{id:"sofa",name:"Диван",category:"Мебель"},{id:"cabinet",name:"Шкаф",category:"Мебель"},{id:"bookshelf",name:"Книжная полка",category:"Мебель"},{id:"coffee-table",name:"Журнальный столик",category:"Мебель"}],M=[{id:"wood-oak",name:"Дуб",color:"#D2B48C",metalness:0,roughness:.8},{id:"wood-pine",name:"Сосна",color:"#F5DEB3",metalness:0,roughness:.7},{id:"metal-steel",name:"Сталь",color:"#C0C0C0",metalness:1,roughness:.2},{id:"fabric-cotton",name:"Хлопок",color:"#F0F8FF",metalness:0,roughness:.9},{id:"glass-clear",name:"Стекло прозрачное",color:"#F0F8FF",metalness:0,roughness:.05},{id:"ceramic-white",name:"Керамика белая",color:"#FFFEF7",metalness:0,roughness:.3},{id:"plastic-black",name:"Пластик чёрный",color:"#1C1C1C",metalness:0,roughness:.1}],k=async()=>{if(t)try{await i()}catch(I){console.error("Ошибка сохранения:",I)}},P=I=>{console.log("Добавление мебели:",I)},z=I=>{a(I)};return w.jsxs("div",{className:"h-screen flex flex-col bg-gray-50 dark:bg-gray-900",children:[w.jsx("header",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-3",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center space-x-4",children:[w.jsxs(zt,{variant:"ghost",size:"sm",onClick:()=>e("/dashboard"),children:[w.jsx(Cee,{className:"w-4 h-4 mr-2"}),"Назад"]}),w.jsx(Tu,{orientation:"vertical",className:"h-6"}),w.jsx("h1",{className:"text-lg font-semibold",children:(t==null?void 0:t.name)||"Загрузка..."})]}),w.jsxs("div",{className:"flex items-center space-x-2",children:[w.jsx("div",{className:"flex items-center space-x-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:_.map(I=>w.jsx(zt,{variant:o===I.id?"default":"ghost",size:"sm",onClick:()=>z(I.id),title:`${I.name} (${I.shortcut})`,className:"w-8 h-8 p-0",children:w.jsx(I.icon,{className:"w-4 h-4"})},I.id))}),w.jsx(Tu,{orientation:"vertical",className:"h-6"}),w.jsx(zt,{variant:"ghost",size:"sm",disabled:!0,children:w.jsx(ete,{className:"w-4 h-4"})}),w.jsx(zt,{variant:"ghost",size:"sm",disabled:!0,children:w.jsx(Wee,{className:"w-4 h-4"})}),w.jsx(Tu,{orientation:"vertical",className:"h-6"}),w.jsx(zt,{variant:"ghost",size:"sm",onClick:()=>c(!l),children:l?w.jsx(jee,{className:"w-4 h-4"}):w.jsx(Vee,{className:"w-4 h-4"})}),w.jsx(Tu,{orientation:"vertical",className:"h-6"}),w.jsx(zt,{variant:p?"default":"ghost",size:"sm",onClick:()=>x(!p),children:w.jsx(gh,{className:"w-4 h-4"})}),w.jsx(zt,{variant:"ghost",size:"sm",children:w.jsx(rte,{className:"w-4 h-4"})}),w.jsxs("span",{className:"text-sm font-mono w-12 text-center",children:[u,"%"]}),w.jsx(zt,{variant:"ghost",size:"sm",children:w.jsx(nte,{className:"w-4 h-4"})}),w.jsx(Tu,{orientation:"vertical",className:"h-6"}),w.jsxs(zt,{onClick:k,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[w.jsx(qee,{className:"w-4 h-4 mr-2"}),"Сохранить"]})]})]})}),w.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[w.jsx("div",{className:"bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col",style:{width:v},children:w.jsxs(ule,{defaultValue:"objects",className:"flex-1 flex flex-col",children:[w.jsxs(H5,{className:"grid grid-cols-3 w-full",children:[w.jsx(lb,{value:"objects",children:"Объекты"}),w.jsx(lb,{value:"materials",children:"Материалы"}),w.jsx(lb,{value:"layers",children:"Слои"})]}),w.jsxs(cb,{value:"objects",className:"flex-1 p-4 space-y-4",children:[w.jsxs("div",{children:[w.jsx("h3",{className:"font-semibold mb-3",children:"Добавить мебель"}),w.jsx("div",{className:"space-y-2",children:T.map(I=>w.jsxs(zt,{variant:"outline",className:"w-full justify-start",onClick:()=>P(I.id),children:[w.jsx(Om,{className:"w-4 h-4 mr-2"}),I.name]},I.id))})]}),w.jsx(Tu,{}),w.jsxs("div",{children:[w.jsx("h3",{className:"font-semibold mb-3",children:"Объекты сцены"}),w.jsx("div",{className:"space-y-1",children:w.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Объекты будут отображаться здесь"})})]})]}),w.jsxs(cb,{value:"materials",className:"flex-1 p-4 space-y-4",children:[w.jsx("h3",{className:"font-semibold mb-3",children:"Библиотека материалов"}),w.jsx("div",{className:"grid grid-cols-2 gap-2",children:M.map(I=>w.jsxs(zt,{variant:"outline",className:"h-16 flex flex-col p-2",children:[w.jsx("div",{className:"w-8 h-8 rounded mb-1",style:{backgroundColor:I.color}}),w.jsx("span",{className:"text-xs",children:I.name})]},I.id))})]}),w.jsxs(cb,{value:"layers",className:"flex-1 p-4",children:[w.jsxs("div",{className:"flex items-center justify-between mb-3",children:[w.jsx("h3",{className:"font-semibold",children:"Слои"}),w.jsx(zt,{size:"sm",variant:"ghost",children:w.jsx(Om,{className:"w-4 h-4"})})]}),w.jsx("div",{className:"space-y-1",children:w.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded",children:[w.jsx(ym,{className:"w-4 h-4"}),w.jsx("span",{className:"flex-1 text-sm",children:"Основной слой"}),w.jsx(zt,{size:"sm",variant:"ghost",className:"w-6 h-6 p-0",children:w.jsx(zv,{className:"w-3 h-3"})})]})})]})]})}),w.jsxs("div",{className:"flex-1 relative bg-gray-100 dark:bg-gray-700",children:[w.jsx(bve,{showGrid:p,zoom:u,selectedObject:h,onObjectSelect:f}),w.jsx("div",{className:"absolute top-4 left-4 bg-black/50 text-white px-3 py-2 rounded text-sm",children:"3D Редактор CraftRuv"}),w.jsx("div",{className:"absolute bottom-4 left-4 space-y-2",children:w.jsx(zt,{size:"sm",variant:"secondary",children:w.jsx(Hee,{className:"w-4 h-4"})})})]}),w.jsx("div",{className:"bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700",style:{width:b},children:w.jsxs("div",{className:"p-4",children:[w.jsx("h3",{className:"font-semibold mb-4",children:"Свойства"}),h?w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx(tr,{children:"Позиция X"}),w.jsx(zp,{defaultValue:[0],max:10,min:-10,step:.1,className:"mt-2"})]}),w.jsxs("div",{children:[w.jsx(tr,{children:"Позиция Y"}),w.jsx(zp,{defaultValue:[0],max:10,min:-10,step:.1,className:"mt-2"})]}),w.jsxs("div",{children:[w.jsx(tr,{children:"Позиция Z"}),w.jsx(zp,{defaultValue:[0],max:10,min:-10,step:.1,className:"mt-2"})]}),w.jsx(Tu,{}),w.jsxs("div",{children:[w.jsx(tr,{children:"Поворот X"}),w.jsx(zp,{defaultValue:[0],max:360,min:0,step:1,className:"mt-2"})]}),w.jsxs("div",{children:[w.jsx(tr,{children:"Масштаб"}),w.jsx(zp,{defaultValue:[1],max:3,min:.1,step:.1,className:"mt-2"})]})]}):w.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Выберите объект для редактирования свойств"})]})})]}),w.jsx(_ve,{})]})};var Eve="VisuallyHidden",sG=N.forwardRef((n,e)=>w.jsx(rr.span,{...n,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...n.style}}));sG.displayName=Eve;var Cve=[" ","Enter","ArrowUp","ArrowDown"],Tve=[" ","Enter"],yx="Select",[h2,f2,Mve]=sI(yx),[Ng,FBe]=Qo(yx,[Mve,b_]),p2=b_(),[Ave,Id]=Ng(yx),[Nve,kve]=Ng(yx),oG=n=>{const{__scopeSelect:e,children:t,open:r,defaultOpen:i,onOpenChange:s,value:o,defaultValue:a,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:f,form:p}=n,x=p2(e),[v,y]=N.useState(null),[b,S]=N.useState(null),[_,T]=N.useState(!1),M=pg(c),[k=!1,P]=Uv({prop:r,defaultProp:i,onChange:s}),[z,I]=Uv({prop:o,defaultProp:a,onChange:l}),L=N.useRef(null),W=v?p||!!v.closest("form"):!0,[q,$]=N.useState(new Set),ne=Array.from(q).map(Y=>Y.props.value).join(";");return w.jsx(Sj,{...x,children:w.jsxs(Ave,{required:f,scope:e,trigger:v,onTriggerChange:y,valueNode:b,onValueNodeChange:S,valueNodeHasChildren:_,onValueNodeHasChildrenChange:T,contentId:Ja(),value:z,onValueChange:I,open:k,onOpenChange:P,dir:M,triggerPointerDownPosRef:L,disabled:h,children:[w.jsx(h2.Provider,{scope:e,children:w.jsx(Nve,{scope:n.__scopeSelect,onNativeOptionAdd:N.useCallback(Y=>{$(we=>new Set(we).add(Y))},[]),onNativeOptionRemove:N.useCallback(Y=>{$(we=>{const H=new Set(we);return H.delete(Y),H})},[]),children:t})}),W?w.jsxs(IG,{"aria-hidden":!0,required:f,tabIndex:-1,name:u,autoComplete:d,value:z,onChange:Y=>I(Y.target.value),disabled:h,form:p,children:[z===void 0?w.jsx("option",{value:""}):null,Array.from(q)]},ne):null]})})};oG.displayName=yx;var aG="SelectTrigger",lG=N.forwardRef((n,e)=>{const{__scopeSelect:t,disabled:r=!1,...i}=n,s=p2(t),o=Id(aG,t),a=o.disabled||r,l=Gn(e,o.onTriggerChange),c=f2(t),u=N.useRef("touch"),[d,h,f]=RG(x=>{const v=c().filter(S=>!S.disabled),y=v.find(S=>S.value===o.value),b=PG(v,x,y);b!==void 0&&o.onValueChange(b.value)}),p=x=>{a||(o.onOpenChange(!0),f()),x&&(o.triggerPointerDownPosRef.current={x:Math.round(x.pageX),y:Math.round(x.pageY)})};return w.jsx(_j,{asChild:!0,...s,children:w.jsx(rr.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":kG(o.value)?"":void 0,...i,ref:l,onClick:Ft(i.onClick,x=>{x.currentTarget.focus(),u.current!=="mouse"&&p(x)}),onPointerDown:Ft(i.onPointerDown,x=>{u.current=x.pointerType;const v=x.target;v.hasPointerCapture(x.pointerId)&&v.releasePointerCapture(x.pointerId),x.button===0&&x.ctrlKey===!1&&x.pointerType==="mouse"&&(p(x),x.preventDefault())}),onKeyDown:Ft(i.onKeyDown,x=>{const v=d.current!=="";!(x.ctrlKey||x.altKey||x.metaKey)&&x.key.length===1&&h(x.key),!(v&&x.key===" ")&&Cve.includes(x.key)&&(p(),x.preventDefault())})})})});lG.displayName=aG;var cG="SelectValue",uG=N.forwardRef((n,e)=>{const{__scopeSelect:t,className:r,style:i,children:s,placeholder:o="",...a}=n,l=Id(cG,t),{onValueNodeHasChildrenChange:c}=l,u=s!==void 0,d=Gn(e,l.onValueNodeChange);return wi(()=>{c(u)},[c,u]),w.jsx(rr.span,{...a,ref:d,style:{pointerEvents:"none"},children:kG(l.value)?w.jsx(w.Fragment,{children:o}):s})});uG.displayName=cG;var Ive="SelectIcon",dG=N.forwardRef((n,e)=>{const{__scopeSelect:t,children:r,...i}=n;return w.jsx(rr.span,{"aria-hidden":!0,...i,ref:e,children:r||"▼"})});dG.displayName=Ive;var Rve="SelectPortal",hG=n=>w.jsx(S_,{asChild:!0,...n});hG.displayName=Rve;var ff="SelectContent",fG=N.forwardRef((n,e)=>{const t=Id(ff,n.__scopeSelect),[r,i]=N.useState();if(wi(()=>{i(new DocumentFragment)},[]),!t.open){const s=r;return s?cg.createPortal(w.jsx(pG,{scope:n.__scopeSelect,children:w.jsx(h2.Slot,{scope:n.__scopeSelect,children:w.jsx("div",{children:n.children})})}),s):null}return w.jsx(mG,{...n,ref:e})});fG.displayName=ff;var Ua=10,[pG,Rd]=Ng(ff),Pve="SelectContentImpl",Dve=nf("SelectContent.RemoveScroll"),mG=N.forwardRef((n,e)=>{const{__scopeSelect:t,position:r="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:s,onPointerDownOutside:o,side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:f,sticky:p,hideWhenDetached:x,avoidCollisions:v,...y}=n,b=Id(ff,t),[S,_]=N.useState(null),[T,M]=N.useState(null),k=Gn(e,Oe=>_(Oe)),[P,z]=N.useState(null),[I,L]=N.useState(null),W=f2(t),[q,$]=N.useState(!1),ne=N.useRef(!1);N.useEffect(()=>{if(S)return gI(S)},[S]),oI();const Y=N.useCallback(Oe=>{const[nt,...rt]=W().map(ae=>ae.ref.current),[ut]=rt.slice(-1),Qe=document.activeElement;for(const ae of Oe)if(ae===Qe||(ae==null||ae.scrollIntoView({block:"nearest"}),ae===nt&&T&&(T.scrollTop=0),ae===ut&&T&&(T.scrollTop=T.scrollHeight),ae==null||ae.focus(),document.activeElement!==Qe))return},[W,T]),we=N.useCallback(()=>Y([P,S]),[Y,P,S]);N.useEffect(()=>{q&&we()},[q,we]);const{onOpenChange:H,triggerPointerDownPosRef:X}=b;N.useEffect(()=>{if(S){let Oe={x:0,y:0};const nt=ut=>{var Qe,ae;Oe={x:Math.abs(Math.round(ut.pageX)-(((Qe=X.current)==null?void 0:Qe.x)??0)),y:Math.abs(Math.round(ut.pageY)-(((ae=X.current)==null?void 0:ae.y)??0))}},rt=ut=>{Oe.x<=10&&Oe.y<=10?ut.preventDefault():S.contains(ut.target)||H(!1),document.removeEventListener("pointermove",nt),X.current=null};return X.current!==null&&(document.addEventListener("pointermove",nt),document.addEventListener("pointerup",rt,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",nt),document.removeEventListener("pointerup",rt,{capture:!0})}}},[S,H,X]),N.useEffect(()=>{const Oe=()=>H(!1);return window.addEventListener("blur",Oe),window.addEventListener("resize",Oe),()=>{window.removeEventListener("blur",Oe),window.removeEventListener("resize",Oe)}},[H]);const[oe,ve]=RG(Oe=>{const nt=W().filter(Qe=>!Qe.disabled),rt=nt.find(Qe=>Qe.ref.current===document.activeElement),ut=PG(nt,Oe,rt);ut&&setTimeout(()=>ut.ref.current.focus())}),Te=N.useCallback((Oe,nt,rt)=>{const ut=!ne.current&&!rt;(b.value!==void 0&&b.value===nt||ut)&&(z(Oe),ut&&(ne.current=!0))},[b.value]),Xe=N.useCallback(()=>S==null?void 0:S.focus(),[S]),_e=N.useCallback((Oe,nt,rt)=>{const ut=!ne.current&&!rt;(b.value!==void 0&&b.value===nt||ut)&&L(Oe)},[b.value]),Ue=r==="popper"?YA:gG,Fe=Ue===YA?{side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:f,sticky:p,hideWhenDetached:x,avoidCollisions:v}:{};return w.jsx(pG,{scope:t,content:S,viewport:T,onViewportChange:M,itemRefCallback:Te,selectedItem:P,onItemLeave:Xe,itemTextRefCallback:_e,focusSelectedItem:we,selectedItemText:I,position:r,isPositioned:q,searchRef:oe,children:w.jsx(C_,{as:Dve,allowPinchZoom:!0,children:w.jsx(y_,{asChild:!0,trapped:b.open,onMountAutoFocus:Oe=>{Oe.preventDefault()},onUnmountAutoFocus:Ft(i,Oe=>{var nt;(nt=b.trigger)==null||nt.focus({preventScroll:!0}),Oe.preventDefault()}),children:w.jsx(g_,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:Oe=>Oe.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:w.jsx(Ue,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:Oe=>Oe.preventDefault(),...y,...Fe,onPlaced:()=>$(!0),ref:k,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:Ft(y.onKeyDown,Oe=>{const nt=Oe.ctrlKey||Oe.altKey||Oe.metaKey;if(Oe.key==="Tab"&&Oe.preventDefault(),!nt&&Oe.key.length===1&&ve(Oe.key),["ArrowUp","ArrowDown","Home","End"].includes(Oe.key)){let ut=W().filter(Qe=>!Qe.disabled).map(Qe=>Qe.ref.current);if(["ArrowUp","End"].includes(Oe.key)&&(ut=ut.slice().reverse()),["ArrowUp","ArrowDown"].includes(Oe.key)){const Qe=Oe.target,ae=ut.indexOf(Qe);ut=ut.slice(ae+1)}setTimeout(()=>Y(ut)),Oe.preventDefault()}})})})})})})});mG.displayName=Pve;var Lve="SelectItemAlignedPosition",gG=N.forwardRef((n,e)=>{const{__scopeSelect:t,onPlaced:r,...i}=n,s=Id(ff,t),o=Rd(ff,t),[a,l]=N.useState(null),[c,u]=N.useState(null),d=Gn(e,k=>u(k)),h=f2(t),f=N.useRef(!1),p=N.useRef(!0),{viewport:x,selectedItem:v,selectedItemText:y,focusSelectedItem:b}=o,S=N.useCallback(()=>{if(s.trigger&&s.valueNode&&a&&c&&x&&v&&y){const k=s.trigger.getBoundingClientRect(),P=c.getBoundingClientRect(),z=s.valueNode.getBoundingClientRect(),I=y.getBoundingClientRect();if(s.dir!=="rtl"){const Qe=I.left-P.left,ae=z.left-Qe,ze=k.left-ae,Re=k.width+ze,Je=Math.max(Re,P.width),Ge=window.innerWidth-Ua,Et=vS(ae,[Ua,Math.max(Ua,Ge-Je)]);a.style.minWidth=Re+"px",a.style.left=Et+"px"}else{const Qe=P.right-I.right,ae=window.innerWidth-z.right-Qe,ze=window.innerWidth-k.right-ae,Re=k.width+ze,Je=Math.max(Re,P.width),Ge=window.innerWidth-Ua,Et=vS(ae,[Ua,Math.max(Ua,Ge-Je)]);a.style.minWidth=Re+"px",a.style.right=Et+"px"}const L=h(),W=window.innerHeight-Ua*2,q=x.scrollHeight,$=window.getComputedStyle(c),ne=parseInt($.borderTopWidth,10),Y=parseInt($.paddingTop,10),we=parseInt($.borderBottomWidth,10),H=parseInt($.paddingBottom,10),X=ne+Y+q+H+we,oe=Math.min(v.offsetHeight*5,X),ve=window.getComputedStyle(x),Te=parseInt(ve.paddingTop,10),Xe=parseInt(ve.paddingBottom,10),_e=k.top+k.height/2-Ua,Ue=W-_e,Fe=v.offsetHeight/2,Oe=v.offsetTop+Fe,nt=ne+Y+Oe,rt=X-nt;if(nt<=_e){const Qe=L.length>0&&v===L[L.length-1].ref.current;a.style.bottom="0px";const ae=c.clientHeight-x.offsetTop-x.offsetHeight,ze=Math.max(Ue,Fe+(Qe?Xe:0)+ae+we),Re=nt+ze;a.style.height=Re+"px"}else{const Qe=L.length>0&&v===L[0].ref.current;a.style.top="0px";const ze=Math.max(_e,ne+x.offsetTop+(Qe?Te:0)+Fe)+rt;a.style.height=ze+"px",x.scrollTop=nt-_e+x.offsetTop}a.style.margin=`${Ua}px 0`,a.style.minHeight=oe+"px",a.style.maxHeight=W+"px",r==null||r(),requestAnimationFrame(()=>f.current=!0)}},[h,s.trigger,s.valueNode,a,c,x,v,y,s.dir,r]);wi(()=>S(),[S]);const[_,T]=N.useState();wi(()=>{c&&T(window.getComputedStyle(c).zIndex)},[c]);const M=N.useCallback(k=>{k&&p.current===!0&&(S(),b==null||b(),p.current=!1)},[S,b]);return w.jsx(Fve,{scope:t,contentWrapper:a,shouldExpandOnScrollRef:f,onScrollButtonChange:M,children:w.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:_},children:w.jsx(rr.div,{...i,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});gG.displayName=Lve;var Ove="SelectPopperPosition",YA=N.forwardRef((n,e)=>{const{__scopeSelect:t,align:r="start",collisionPadding:i=Ua,...s}=n,o=p2(t);return w.jsx(Ej,{...o,...s,ref:e,align:r,collisionPadding:i,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});YA.displayName=Ove;var[Fve,UR]=Ng(ff,{}),ZA="SelectViewport",yG=N.forwardRef((n,e)=>{const{__scopeSelect:t,nonce:r,...i}=n,s=Rd(ZA,t),o=UR(ZA,t),a=Gn(e,s.onViewportChange),l=N.useRef(0);return w.jsxs(w.Fragment,{children:[w.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),w.jsx(h2.Slot,{scope:t,children:w.jsx(rr.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:Ft(i.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=o;if(h!=null&&h.current&&d){const f=Math.abs(l.current-u.scrollTop);if(f>0){const p=window.innerHeight-Ua*2,x=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),y=Math.max(x,v);if(y<p){const b=y+f,S=Math.min(p,b),_=b-S;d.style.height=S+"px",d.style.bottom==="0px"&&(u.scrollTop=_>0?_:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});yG.displayName=ZA;var vG="SelectGroup",[zve,Uve]=Ng(vG),Bve=N.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n,i=Ja();return w.jsx(zve,{scope:t,id:i,children:w.jsx(rr.div,{role:"group","aria-labelledby":i,...r,ref:e})})});Bve.displayName=vG;var xG="SelectLabel",wG=N.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n,i=Uve(xG,t);return w.jsx(rr.div,{id:i.id,...r,ref:e})});wG.displayName=xG;var CS="SelectItem",[$ve,bG]=Ng(CS),SG=N.forwardRef((n,e)=>{const{__scopeSelect:t,value:r,disabled:i=!1,textValue:s,...o}=n,a=Id(CS,t),l=Rd(CS,t),c=a.value===r,[u,d]=N.useState(s??""),[h,f]=N.useState(!1),p=Gn(e,b=>{var S;return(S=l.itemRefCallback)==null?void 0:S.call(l,b,r,i)}),x=Ja(),v=N.useRef("touch"),y=()=>{i||(a.onValueChange(r),a.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return w.jsx($ve,{scope:t,value:r,disabled:i,textId:x,isSelected:c,onItemTextChange:N.useCallback(b=>{d(S=>S||((b==null?void 0:b.textContent)??"").trim())},[]),children:w.jsx(h2.ItemSlot,{scope:t,value:r,disabled:i,textValue:u,children:w.jsx(rr.div,{role:"option","aria-labelledby":x,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...o,ref:p,onFocus:Ft(o.onFocus,()=>f(!0)),onBlur:Ft(o.onBlur,()=>f(!1)),onClick:Ft(o.onClick,()=>{v.current!=="mouse"&&y()}),onPointerUp:Ft(o.onPointerUp,()=>{v.current==="mouse"&&y()}),onPointerDown:Ft(o.onPointerDown,b=>{v.current=b.pointerType}),onPointerMove:Ft(o.onPointerMove,b=>{var S;v.current=b.pointerType,i?(S=l.onItemLeave)==null||S.call(l):v.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ft(o.onPointerLeave,b=>{var S;b.currentTarget===document.activeElement&&((S=l.onItemLeave)==null||S.call(l))}),onKeyDown:Ft(o.onKeyDown,b=>{var _;((_=l.searchRef)==null?void 0:_.current)!==""&&b.key===" "||(Tve.includes(b.key)&&y(),b.key===" "&&b.preventDefault())})})})})});SG.displayName=CS;var Gy="SelectItemText",_G=N.forwardRef((n,e)=>{const{__scopeSelect:t,className:r,style:i,...s}=n,o=Id(Gy,t),a=Rd(Gy,t),l=bG(Gy,t),c=kve(Gy,t),[u,d]=N.useState(null),h=Gn(e,y=>d(y),l.onItemTextChange,y=>{var b;return(b=a.itemTextRefCallback)==null?void 0:b.call(a,y,l.value,l.disabled)}),f=u==null?void 0:u.textContent,p=N.useMemo(()=>w.jsx("option",{value:l.value,disabled:l.disabled,children:f},l.value),[l.disabled,l.value,f]),{onNativeOptionAdd:x,onNativeOptionRemove:v}=c;return wi(()=>(x(p),()=>v(p)),[x,v,p]),w.jsxs(w.Fragment,{children:[w.jsx(rr.span,{id:l.textId,...s,ref:h}),l.isSelected&&o.valueNode&&!o.valueNodeHasChildren?cg.createPortal(s.children,o.valueNode):null]})});_G.displayName=Gy;var EG="SelectItemIndicator",CG=N.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n;return bG(EG,t).isSelected?w.jsx(rr.span,{"aria-hidden":!0,...r,ref:e}):null});CG.displayName=EG;var QA="SelectScrollUpButton",TG=N.forwardRef((n,e)=>{const t=Rd(QA,n.__scopeSelect),r=UR(QA,n.__scopeSelect),[i,s]=N.useState(!1),o=Gn(e,r.onScrollButtonChange);return wi(()=>{if(t.viewport&&t.isPositioned){let a=function(){const c=l.scrollTop>0;s(c)};const l=t.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[t.viewport,t.isPositioned]),i?w.jsx(AG,{...n,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=t;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});TG.displayName=QA;var JA="SelectScrollDownButton",MG=N.forwardRef((n,e)=>{const t=Rd(JA,n.__scopeSelect),r=UR(JA,n.__scopeSelect),[i,s]=N.useState(!1),o=Gn(e,r.onScrollButtonChange);return wi(()=>{if(t.viewport&&t.isPositioned){let a=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;s(u)};const l=t.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[t.viewport,t.isPositioned]),i?w.jsx(AG,{...n,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=t;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});MG.displayName=JA;var AG=N.forwardRef((n,e)=>{const{__scopeSelect:t,onAutoScroll:r,...i}=n,s=Rd("SelectScrollButton",t),o=N.useRef(null),a=f2(t),l=N.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return N.useEffect(()=>()=>l(),[l]),wi(()=>{var u;const c=a().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[a]),w.jsx(rr.div,{"aria-hidden":!0,...i,ref:e,style:{flexShrink:0,...i.style},onPointerDown:Ft(i.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:Ft(i.onPointerMove,()=>{var c;(c=s.onItemLeave)==null||c.call(s),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:Ft(i.onPointerLeave,()=>{l()})})}),jve="SelectSeparator",NG=N.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n;return w.jsx(rr.div,{"aria-hidden":!0,...r,ref:e})});NG.displayName=jve;var eN="SelectArrow",Vve=N.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n,i=p2(t),s=Id(eN,t),o=Rd(eN,t);return s.open&&o.position==="popper"?w.jsx(Cj,{...i,...r,ref:e}):null});Vve.displayName=eN;function kG(n){return n===""||n===void 0}var IG=N.forwardRef((n,e)=>{const{value:t,...r}=n,i=N.useRef(null),s=Gn(e,i),o=G5(t);return N.useEffect(()=>{const a=i.current,l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==t&&u){const d=new Event("change",{bubbles:!0});u.call(a,t),a.dispatchEvent(d)}},[o,t]),w.jsx(sG,{asChild:!0,children:w.jsx("select",{...r,ref:s,defaultValue:t})})});IG.displayName="BubbleSelect";function RG(n){const e=_o(n),t=N.useRef(""),r=N.useRef(0),i=N.useCallback(o=>{const a=t.current+o;e(a),function l(c){t.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(a)},[e]),s=N.useCallback(()=>{t.current="",window.clearTimeout(r.current)},[]);return N.useEffect(()=>()=>window.clearTimeout(r.current),[]),[t,i,s]}function PG(n,e,t){const i=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,s=t?n.indexOf(t):-1;let o=Wve(n,Math.max(s,0));i.length===1&&(o=o.filter(c=>c!==t));const l=o.find(c=>c.textValue.toLowerCase().startsWith(i.toLowerCase()));return l!==t?l:void 0}function Wve(n,e){return n.map((t,r)=>n[(e+r)%n.length])}var Hve=oG,DG=lG,Gve=uG,qve=dG,Xve=hG,LG=fG,Kve=yG,OG=wG,FG=SG,Yve=_G,Zve=CG,zG=TG,UG=MG,BG=NG;const Ju=Hve,ed=Gve,Rc=N.forwardRef(({className:n,children:e,...t},r)=>w.jsxs(DG,{ref:r,className:wn("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-zinc-200 bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-white placeholder:text-zinc-500 focus:outline-none focus:ring-1 focus:ring-zinc-950 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 dark:border-zinc-800 dark:ring-offset-zinc-950 dark:placeholder:text-zinc-400 dark:focus:ring-zinc-300",n),...t,children:[e,w.jsx(qve,{asChild:!0,children:w.jsx(D$,{className:"h-4 w-4 opacity-50"})})]}));Rc.displayName=DG.displayName;const $G=N.forwardRef(({className:n,...e},t)=>w.jsx(zG,{ref:t,className:wn("flex cursor-default items-center justify-center py-1",n),...e,children:w.jsx(Iee,{className:"h-4 w-4"})}));$G.displayName=zG.displayName;const jG=N.forwardRef(({className:n,...e},t)=>w.jsx(UG,{ref:t,className:wn("flex cursor-default items-center justify-center py-1",n),...e,children:w.jsx(D$,{className:"h-4 w-4"})}));jG.displayName=UG.displayName;const Pc=N.forwardRef(({className:n,children:e,position:t="popper",...r},i)=>w.jsx(Xve,{children:w.jsxs(LG,{ref:i,className:wn("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-zinc-200 bg-white text-zinc-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:t,...r,children:[w.jsx($G,{}),w.jsx(Kve,{className:wn("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),w.jsx(jG,{})]})}));Pc.displayName=LG.displayName;const Qve=N.forwardRef(({className:n,...e},t)=>w.jsx(OG,{ref:t,className:wn("px-2 py-1.5 text-sm font-semibold",n),...e}));Qve.displayName=OG.displayName;const Ni=N.forwardRef(({className:n,children:e,...t},r)=>w.jsxs(FG,{ref:r,className:wn("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-zinc-100 focus:text-zinc-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-zinc-800 dark:focus:text-zinc-50",n),...t,children:[w.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:w.jsx(Zve,{children:w.jsx(eI,{className:"h-4 w-4"})})}),w.jsx(Yve,{children:e})]}));Ni.displayName=FG.displayName;const Jve=N.forwardRef(({className:n,...e},t)=>w.jsx(BG,{ref:t,className:wn("-mx-1 my-1 h-px bg-zinc-100 dark:bg-zinc-800",n),...e}));Jve.displayName=BG.displayName;const e0e=()=>{const[n,e]=N.useState(""),[t,r]=N.useState("all"),[i,s]=N.useState("grid"),[o,a]=N.useState([]),l=[{id:"1",name:"Дуб классический",category:"wood",description:"Натуральная текстура дуба с выраженной структурой",color:"#D2B48C",properties:{roughness:.8,metalness:0,opacity:1},tags:["натуральный","классический","текстура"],isPremium:!1,downloads:1250,likes:89},{id:"2",name:"Сосна скандинавская",category:"wood",description:"Светлая древесина с минимальной обработкой",color:"#F5DEB3",properties:{roughness:.7,metalness:0,opacity:1},tags:["светлый","скандинавский","минимализм"],isPremium:!1,downloads:980,likes:67},{id:"3",name:"Нержавеющая сталь",category:"metal",description:"Матовая нержавеющая сталь премиум качества",color:"#C0C0C0",properties:{roughness:.2,metalness:1,opacity:1},tags:["металл","современный","прочный"],isPremium:!0,downloads:750,likes:45},{id:"4",name:"Хлопок белоснежный",category:"fabric",description:"Мягкий хлопковый материал для обивки",color:"#F8F8FF",properties:{roughness:.9,metalness:0,opacity:1},tags:["ткань","мягкий","обивка"],isPremium:!1,downloads:620,likes:34},{id:"5",name:"Мрамор каррарский",category:"stone",description:"Элитный белый мрамор с натуральными прожилками",color:"#F5F5DC",properties:{roughness:.1,metalness:0,opacity:1},tags:["камень","роскошь","прожилки"],isPremium:!0,downloads:890,likes:78},{id:"6",name:"Кожа натуральная",category:"leather",description:"Высококачественная натуральная кожа",color:"#8B4513",properties:{roughness:.6,metalness:0,opacity:1},tags:["кожа","натуральный","качество"],isPremium:!0,downloads:540,likes:42},{id:"7",name:"Стекло прозрачное",category:"glass",description:"Кристально чистое прозрачное стекло для современного дизайна",color:"#F0F8FF",properties:{roughness:.05,metalness:0,opacity:.9},tags:["стекло","прозрачный","современный","блеск"],isPremium:!1,downloads:320,likes:28},{id:"8",name:"Керамика белая",category:"ceramic",description:"Классическая белая керамика с матовой поверхностью",color:"#FFFEF7",properties:{roughness:.3,metalness:0,opacity:1},tags:["керамика","белый","матовый","классический"],isPremium:!1,downloads:450,likes:35},{id:"9",name:"Пластик чёрный",category:"plastic",description:"Глянцевый чёрный пластик для современной мебели",color:"#1C1C1C",properties:{roughness:.1,metalness:0,opacity:1},tags:["пластик","чёрный","глянцевый","современный"],isPremium:!1,downloads:280,likes:22}],c=[{value:"all",label:"Все материалы"},{value:"wood",label:"Дерево"},{value:"metal",label:"Металл"},{value:"fabric",label:"Ткань"},{value:"stone",label:"Камень"},{value:"leather",label:"Кожа"},{value:"glass",label:"Стекло"},{value:"ceramic",label:"Керамика"},{value:"plastic",label:"Пластик"}],u=l.filter(f=>{const p=f.name.toLowerCase().includes(n.toLowerCase())||f.description.toLowerCase().includes(n.toLowerCase())||f.tags.some(v=>v.toLowerCase().includes(n.toLowerCase())),x=t==="all"||f.category===t;return p&&x}),d=f=>{a(p=>p.includes(f)?p.filter(x=>x!==f):[...p,f])},h=f=>{console.log("Скачивание материала:",f.name)};return w.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:w.jsxs("div",{className:"container mx-auto px-4 py-8",children:[w.jsxs("div",{className:"mb-8",children:[w.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Библиотека материалов"}),w.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Обширная коллекция высококачественных материалов для ваших проектов"})]}),w.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 mb-8 shadow-sm",children:w.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[w.jsx("div",{className:"flex-1",children:w.jsxs("div",{className:"relative",children:[w.jsx(Fm,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),w.jsx(Jr,{placeholder:"Поиск материалов...",value:n,onChange:f=>e(f.target.value),className:"pl-10"})]})}),w.jsxs("div",{className:"flex gap-4",children:[w.jsxs(Ju,{value:t,onValueChange:r,children:[w.jsx(Rc,{className:"w-48",children:w.jsx(ed,{placeholder:"Категория"})}),w.jsx(Pc,{children:c.map(f=>w.jsx(Ni,{value:f.value,children:f.label},f.value))})]}),w.jsxs(zt,{variant:"outline",children:[w.jsx(L$,{className:"w-4 h-4 mr-2"}),"Фильтры"]}),w.jsxs("div",{className:"flex border rounded-lg",children:[w.jsx(zt,{variant:i==="grid"?"default":"ghost",size:"sm",onClick:()=>s("grid"),className:"rounded-r-none",children:w.jsx(gh,{className:"w-4 h-4"})}),w.jsx(zt,{variant:i==="list"?"default":"ghost",size:"sm",onClick:()=>s("list"),className:"rounded-l-none",children:w.jsx(z$,{className:"w-4 h-4"})})]})]})]})}),w.jsxs("div",{className:"mb-4 text-gray-600 dark:text-gray-300",children:["Найдено материалов: ",u.length]}),w.jsx("div",{className:i==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6":"space-y-4",children:u.map(f=>w.jsx(ti,{className:"group hover:shadow-lg transition-all duration-300",children:i==="grid"?w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"h-48 rounded-t-lg",style:{background:`linear-gradient(135deg, ${f.color}, ${f.color}CC)`}}),f.isPremium&&w.jsx(yo,{className:"absolute top-2 left-2 bg-yellow-500 text-yellow-900",children:"Premium"}),w.jsxs("div",{className:"absolute top-2 right-2 flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[w.jsx(zt,{size:"sm",variant:"secondary",className:"w-8 h-8 p-0",onClick:()=>d(f.id),children:w.jsx(Oee,{className:`w-4 h-4 ${o.includes(f.id)?"fill-red-500 text-red-500":""}`})}),w.jsx(zt,{size:"sm",variant:"secondary",className:"w-8 h-8 p-0",children:w.jsx(ym,{className:"w-4 h-4"})})]})]}),w.jsxs(ns,{className:"pb-2",children:[w.jsx(rs,{className:"text-lg line-clamp-1",children:f.name}),w.jsx(So,{className:"line-clamp-2",children:f.description})]}),w.jsxs($r,{className:"pt-0",children:[w.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:f.tags.slice(0,3).map(p=>w.jsx(yo,{variant:"secondary",className:"text-xs",children:p},p))}),w.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs text-gray-500 dark:text-gray-400 mb-3",children:[w.jsxs("div",{children:["Шерох: ",f.properties.roughness]}),w.jsxs("div",{children:["Металл: ",f.properties.metalness]}),w.jsxs("div",{children:["Прозр: ",f.properties.opacity]})]}),w.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400 mb-3",children:[w.jsxs("span",{children:[f.downloads," скач."]}),w.jsxs("span",{children:[f.likes," ♥"]})]}),w.jsxs(zt,{className:"w-full",onClick:()=>h(f),children:[w.jsx(Zb,{className:"w-4 h-4 mr-2"}),"Скачать"]})]})]}):w.jsx($r,{className:"p-4",children:w.jsxs("div",{className:"flex items-center space-x-4",children:[w.jsx("div",{className:"w-16 h-16 rounded-lg flex-shrink-0",style:{backgroundColor:f.color}}),w.jsxs("div",{className:"flex-1 min-w-0",children:[w.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[w.jsx("h3",{className:"font-semibold truncate",children:f.name}),f.isPremium&&w.jsx(yo,{className:"bg-yellow-500 text-yellow-900",children:"Premium"})]}),w.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-2",children:f.description}),w.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:f.tags.slice(0,3).map(p=>w.jsx(yo,{variant:"secondary",className:"text-xs",children:p},p))})]}),w.jsxs("div",{className:"flex items-center space-x-2",children:[w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"text-sm font-medium",children:f.downloads}),w.jsx("div",{className:"text-xs text-gray-500",children:"скач."})]}),w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"text-sm font-medium",children:f.likes}),w.jsx("div",{className:"text-xs text-gray-500",children:"♥"})]}),w.jsxs(zt,{size:"sm",onClick:()=>h(f),children:[w.jsx(Zb,{className:"w-4 h-4 mr-1"}),"Скачать"]})]})]})})},f.id))}),u.length===0&&w.jsxs("div",{className:"text-center py-16",children:[w.jsx("div",{className:"w-24 h-24 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4",children:w.jsx(Fm,{className:"w-12 h-12 text-gray-400"})}),w.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Материалы не найдены"}),w.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Попробуйте изменить поисковый запрос или выбрать другую категорию"})]})]})})};function t0e(){return xve.useSyncExternalStore(n0e,()=>!0,()=>!1)}function n0e(){return()=>{}}var BR="Avatar",[r0e,zBe]=Qo(BR),[i0e,VG]=r0e(BR),WG=N.forwardRef((n,e)=>{const{__scopeAvatar:t,...r}=n,[i,s]=N.useState("idle");return w.jsx(i0e,{scope:t,imageLoadingStatus:i,onImageLoadingStatusChange:s,children:w.jsx(ls.span,{...r,ref:e})})});WG.displayName=BR;var HG="AvatarImage",GG=N.forwardRef((n,e)=>{const{__scopeAvatar:t,src:r,onLoadingStatusChange:i=()=>{},...s}=n,o=VG(HG,t),a=s0e(r,s),l=_o(c=>{i(c),o.onImageLoadingStatusChange(c)});return wi(()=>{a!=="idle"&&l(a)},[a,l]),a==="loaded"?w.jsx(ls.img,{...s,ref:e,src:r}):null});GG.displayName=HG;var qG="AvatarFallback",XG=N.forwardRef((n,e)=>{const{__scopeAvatar:t,delayMs:r,...i}=n,s=VG(qG,t),[o,a]=N.useState(r===void 0);return N.useEffect(()=>{if(r!==void 0){const l=window.setTimeout(()=>a(!0),r);return()=>window.clearTimeout(l)}},[r]),o&&s.imageLoadingStatus!=="loaded"?w.jsx(ls.span,{...i,ref:e}):null});XG.displayName=qG;function nz(n,e){return n?e?(n.src!==e&&(n.src=e),n.complete&&n.naturalWidth>0?"loaded":"loading"):"error":"idle"}function s0e(n,{referrerPolicy:e,crossOrigin:t}){const r=t0e(),i=N.useRef(null),s=r?(i.current||(i.current=new window.Image),i.current):null,[o,a]=N.useState(()=>nz(s,n));return wi(()=>{a(nz(s,n))},[s,n]),wi(()=>{const l=d=>()=>{a(d)};if(!s)return;const c=l("loaded"),u=l("error");return s.addEventListener("load",c),s.addEventListener("error",u),e&&(s.referrerPolicy=e),typeof t=="string"&&(s.crossOrigin=t),()=>{s.removeEventListener("load",c),s.removeEventListener("error",u)}},[s,t,e]),o}var KG=WG,YG=GG,ZG=XG;const fv=N.forwardRef(({className:n,...e},t)=>w.jsx(KG,{ref:t,className:wn("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",n),...e}));fv.displayName=KG.displayName;const QG=N.forwardRef(({className:n,...e},t)=>w.jsx(YG,{ref:t,className:wn("aspect-square h-full w-full",n),...e}));QG.displayName=YG.displayName;const pv=N.forwardRef(({className:n,...e},t)=>w.jsx(ZG,{ref:t,className:wn("flex h-full w-full items-center justify-center rounded-full bg-zinc-100 dark:bg-zinc-800",n),...e}));pv.displayName=ZG.displayName;const o0e=()=>{const{user:n}=Zl(),[e,t]=N.useState([]),[r,i]=N.useState(""),[s,o]=N.useState(!1),a=N.useRef(null),l=[{id:"1",title:"Подбор материалов",description:"Какие материалы лучше использовать для кухонного стола?",category:"материалы"},{id:"2",title:"Размеры мебели",description:"Какие стандартные размеры для обеденного стола на 6 человек?",category:"размеры"},{id:"3",title:"Стилевые решения",description:"Помоги создать мебель в скандинавском стиле",category:"стиль"},{id:"4",title:"Цветовые сочетания",description:"Какие цвета сочетаются с темным дубом?",category:"цвет"}],c={id:"welcome",type:"assistant",content:`Привет, ${n==null?void 0:n.name}! Я РУВ - ваш AI помощник по дизайну мебели. Я помогу вам с выбором материалов, размеров, стилей и цветовых решений. Чем могу помочь?`,timestamp:new Date,suggestions:l.map(p=>p.description)};N.useEffect(()=>{e.length===0&&t([c])},[]),N.useEffect(()=>{var p;(p=a.current)==null||p.scrollIntoView({behavior:"smooth"})},[e]);const u=async()=>{if(!r.trim()||s)return;const p={id:crypto.randomUUID(),type:"user",content:r,timestamp:new Date};t(x=>[...x,p]),i(""),o(!0),setTimeout(()=>{const x=d(r),v={id:crypto.randomUUID(),type:"assistant",content:x.content,timestamp:new Date,suggestions:x.suggestions};t(y=>[...y,v]),o(!1)},1e3+Math.random()*2e3)},d=p=>{const x=p.toLowerCase();return x.includes("материал")||x.includes("дерево")||x.includes("металл")?{content:`Для выбора материалов рекомендую учитывать несколько факторов:

🌳 **Дерево**: Дуб и ясень отлично подходят для столешниц - прочные и красивые. Сосна хороша для каркасов.

🔧 **Металл**: Нержавеющая сталь для современного стиля, чугун для лофта.

💡 **Совет**: Комбинируйте материалы - например, деревянная столешница с металлическими ножками создает интересный контраст.`,suggestions:["Расскажи про свойства дуба","Какие виды металла лучше для ножек стола?","Как сочетать дерево и металл?"]}:x.includes("размер")||x.includes("стол")||x.includes("стул")?{content:`Вот стандартные размеры мебели:

📏 **Обеденный стол**:
• На 4 человека: 120x80 см
• На 6 человек: 160x90 см
• На 8 человек: 200x100 см
• Высота: 72-75 см

🪑 **Стулья**:
• Высота сиденья: 42-45 см
• Ширина: 40-50 см
• Глубина: 40-45 см

💡 **Важно**: Оставляйте 60 см свободного пространства вокруг стола для комфортного перемещения.`,suggestions:["Какие размеры для барной стойки?","Стандарты для офисной мебели","Размеры детской мебели"]}:x.includes("стиль")||x.includes("скандинавский")||x.includes("минимализм")?{content:`Скандинавский стиль - отличный выбор! Вот основные принципы:

🎨 **Цвета**: Белый, светло-серый, бежевый как основа. Акценты - приглушенные пастельные тона.

🌳 **Материалы**: Светлые породы дерева (сосна, береза, дуб беленый), натуральные ткани.

✨ **Формы**: Простые, чистые линии, функциональность превыше всего.

💡 **Особенности**: Минимум декора, максимум функциональности, уют через текстуру и свет.`,suggestions:["Создай дизайн стула в скандинавском стиле","Какие текстуры использовать?","Примеры скандинавской мебели"]}:{content:`Интересный вопрос! Я готов помочь с любыми аспектами дизайна мебели:

• 🎨 Выбор цветов и материалов
• 📐 Расчет размеров и пропорций
• 🏠 Стилевые решения
• 🔧 Технические аспекты
• 💡 Креативные идеи

Уточните, пожалуйста, что именно вас интересует?`,suggestions:["Помоги выбрать материал для стола","Какие размеры нужны для дивана?","Создай дизайн в современном стиле"]}},h=p=>{i(p)},f=p=>{navigator.clipboard.writeText(p)};return w.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:w.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[w.jsxs("div",{className:"text-center mb-8",children:[w.jsx("div",{className:"flex justify-center mb-4",children:w.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl flex items-center justify-center",children:w.jsx(Qk,{className:"w-8 h-8 text-white"})})}),w.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"AI Помощник РУВ"}),w.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Умный помощник для создания идеальной мебели"})]}),e.length<=1&&w.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:l.map(p=>w.jsxs(ti,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>h(p.description),children:[w.jsx(ns,{className:"pb-3",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx(rs,{className:"text-lg",children:p.title}),w.jsx(yo,{variant:"secondary",children:p.category})]})}),w.jsx($r,{children:w.jsx(So,{children:p.description})})]},p.id))}),w.jsxs(ti,{className:"min-h-[500px] flex flex-col",children:[w.jsx(ns,{className:"border-b",children:w.jsxs("div",{className:"flex items-center space-x-3",children:[w.jsx(fv,{children:w.jsx(pv,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white",children:"РУВ"})}),w.jsxs("div",{children:[w.jsx(rs,{className:"text-lg",children:"РУВ AI Помощник"}),w.jsx(So,{children:"Онлайн • Готов помочь с дизайном"})]})]})}),w.jsxs($r,{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.map(p=>w.jsx("div",{className:`flex ${p.type==="user"?"justify-end":"justify-start"}`,children:w.jsxs("div",{className:`flex space-x-3 max-w-[80%] ${p.type==="user"?"flex-row-reverse":"flex-row"}`,children:[w.jsx(fv,{className:"w-8 h-8",children:w.jsx(pv,{className:p.type==="user"?"bg-blue-500 text-white":"bg-gradient-to-br from-purple-500 to-pink-500 text-white",children:p.type==="user"?w.jsx(nI,{className:"w-4 h-4"}):"РУВ"})}),w.jsxs("div",{className:`space-y-2 ${p.type==="user"?"text-right":"text-left"}`,children:[w.jsxs("div",{className:`inline-block px-4 py-3 rounded-2xl ${p.type==="user"?"bg-blue-500 text-white":"bg-white dark:bg-gray-800 border"}`,children:[w.jsx("div",{className:"whitespace-pre-wrap",children:p.content}),p.type==="assistant"&&w.jsxs("div",{className:"flex space-x-2 mt-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[w.jsxs(zt,{size:"sm",variant:"ghost",onClick:()=>f(p.content),className:"h-6 px-2 text-xs",children:[w.jsx(AM,{className:"w-3 h-3 mr-1"}),"Копировать"]}),w.jsxs(zt,{size:"sm",variant:"ghost",className:"h-6 px-2 text-xs",children:[w.jsx(kM,{className:"w-3 h-3 mr-1"}),"Поделиться"]})]})]}),p.suggestions&&w.jsx("div",{className:"space-y-1",children:p.suggestions.map((x,v)=>w.jsxs(zt,{variant:"outline",size:"sm",onClick:()=>h(x),className:"block text-left text-xs h-auto py-2 px-3 whitespace-normal",children:[w.jsx(Uee,{className:"w-3 h-3 mr-1 inline flex-shrink-0"}),x]},v))}),w.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:p.timestamp.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})})]})]})},p.id)),s&&w.jsx("div",{className:"flex justify-start",children:w.jsxs("div",{className:"flex space-x-3",children:[w.jsx(fv,{className:"w-8 h-8",children:w.jsx(pv,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white",children:"РУВ"})}),w.jsx("div",{className:"bg-white dark:bg-gray-800 border rounded-2xl px-4 py-3",children:w.jsxs("div",{className:"flex space-x-1",children:[w.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),w.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),w.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})}),w.jsx("div",{ref:a})]}),w.jsxs("div",{className:"border-t p-4",children:[w.jsxs("div",{className:"flex space-x-2",children:[w.jsx(Jr,{value:r,onChange:p=>i(p.target.value),placeholder:"Задайте вопрос о дизайне мебели...",onKeyPress:p=>p.key==="Enter"&&u(),disabled:s,className:"flex-1"}),w.jsx(zt,{onClick:u,disabled:!r.trim()||s,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",children:w.jsx(Kee,{className:"w-4 h-4"})})]}),w.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 text-center",children:"РУВ может допускать ошибки. Проверяйте важную информацию."})]})]})]})})};var $R="Progress",jR=100,[a0e,UBe]=Qo($R),[l0e,c0e]=a0e($R),JG=N.forwardRef((n,e)=>{const{__scopeProgress:t,value:r=null,max:i,getValueLabel:s=u0e,...o}=n;(i||i===0)&&!rz(i)&&console.error(d0e(`${i}`,"Progress"));const a=rz(i)?i:jR;r!==null&&!iz(r,a)&&console.error(h0e(`${r}`,"Progress"));const l=iz(r,a)?r:null,c=TS(l)?s(l,a):void 0;return w.jsx(l0e,{scope:t,value:l,max:a,children:w.jsx(ls.div,{"aria-valuemax":a,"aria-valuemin":0,"aria-valuenow":TS(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":n8(l,a),"data-value":l??void 0,"data-max":a,...o,ref:e})})});JG.displayName=$R;var e8="ProgressIndicator",t8=N.forwardRef((n,e)=>{const{__scopeProgress:t,...r}=n,i=c0e(e8,t);return w.jsx(ls.div,{"data-state":n8(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...r,ref:e})});t8.displayName=e8;function u0e(n,e){return`${Math.round(n/e*100)}%`}function n8(n,e){return n==null?"indeterminate":n===e?"complete":"loading"}function TS(n){return typeof n=="number"}function rz(n){return TS(n)&&!isNaN(n)&&n>0}function iz(n,e){return TS(n)&&!isNaN(n)&&n<=e&&n>=0}function d0e(n,e){return`Invalid prop \`max\` of value \`${n}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${jR}\`.`}function h0e(n,e){return`Invalid prop \`value\` of value \`${n}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${jR} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var r8=JG,f0e=t8;const xb=N.forwardRef(({className:n,value:e,...t},r)=>w.jsx(r8,{ref:r,className:wn("relative h-2 w-full overflow-hidden rounded-full bg-zinc-900/20 dark:bg-zinc-50/20",n),...t,children:w.jsx(f0e,{className:"h-full w-full flex-1 bg-zinc-900 transition-all dark:bg-zinc-50",style:{transform:`translateX(-${100-(e||0)}%)`}})}));xb.displayName=r8.displayName;const p0e=()=>{const{user:n,updateSubscription:e}=Zl(),t=Zc(),[r,i]=N.useState(!1),[s,o]=N.useState(!1);if(!n)return t("/auth"),null;const a=y=>new Date(y).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}),l=y=>y===-1?"Безлимит":`${(y/1024).toFixed(1)} ГБ`,c=()=>n.usage.storageLimit===-1?0:Math.round(n.usage.storageUsed/n.usage.storageLimit*100),u=()=>n.usage.aiRequestsLimit===-1||n.usage.aiRequestsLimit===0?0:Math.round(n.usage.aiRequestsUsed/n.usage.aiRequestsLimit*100),d=y=>{switch(y){case"free":return 0;case"basic":return 9.99;case"pro":return 19.99;case"enterprise":return 49.99;default:return 0}},h=y=>{switch(y){case"active":return"default";case"trial":return"secondary";case"expired":return"destructive";case"inactive":return"outline";default:return"outline"}},f=async()=>{i(!0);try{await new Promise(y=>setTimeout(y,1500)),e({plan:"free",status:"inactive",startDate:new Date().toISOString(),endDate:new Date(Date.now()+7*24*60*60*1e3).toISOString()}),o(!1)}catch(y){console.error("Ошибка при отмене подписки:",y)}finally{i(!1)}},p=()=>{if(n.subscription.status!=="trial"||!n.subscription.trialEndsAt)return!1;const y=new Date(n.subscription.trialEndsAt),b=new Date;return Math.ceil((y.getTime()-b.getTime())/(1e3*60*60*24))<=2},x=()=>{if(!n.subscription.trialEndsAt)return 0;const y=new Date(n.subscription.trialEndsAt),b=new Date;return Math.max(0,Math.ceil((y.getTime()-b.getTime())/(1e3*60*60*24)))},v=[{id:"1",date:"2024-01-15",amount:d(n.subscription.plan),plan:n.subscription.plan,status:"paid",invoice:"INV-2024-001"},{id:"2",date:"2023-12-15",amount:d(n.subscription.plan),plan:n.subscription.plan,status:"paid",invoice:"INV-2023-012"}];return w.jsx("div",{className:"min-h-screen bg-gray-50",children:w.jsx("div",{className:"container mx-auto px-4 py-8",children:w.jsxs("div",{className:"max-w-4xl mx-auto",children:[w.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Управление подпиской"}),p()&&w.jsx(ti,{className:"mb-6 border-yellow-200 bg-yellow-50",children:w.jsx($r,{className:"p-4",children:w.jsxs("div",{className:"flex items-center",children:[w.jsx(Eee,{className:"h-5 w-5 text-yellow-600 mr-2"}),w.jsxs("div",{children:[w.jsxs("p",{className:"text-yellow-800 font-medium",children:["Ваш пробный период заканчивается через ",x()," дн."]}),w.jsx("p",{className:"text-yellow-700 text-sm",children:"Выберите план для продолжения использования всех функций"})]}),w.jsx(zt,{variant:"outline",className:"ml-auto border-yellow-300 text-yellow-700 hover:bg-yellow-100",onClick:()=>t("/pricing"),children:"Выбрать план"})]})})}),w.jsxs(ti,{className:"mb-6",children:[w.jsxs(ns,{children:[w.jsxs(rs,{className:"flex items-center justify-between",children:[w.jsx("span",{children:"Текущая подписка"}),w.jsx(yo,{variant:h(n.subscription.status),children:n.subscription.status==="active"?"Активна":n.subscription.status==="trial"?"Пробный период":n.subscription.status==="expired"?"Истекла":"Неактивна"})]}),w.jsx(So,{children:"Управляйте своей подпиской и биллингом"})]}),w.jsx($r,{children:w.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[w.jsxs("div",{children:[w.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["План: ",n.subscription.plan.toUpperCase()]}),w.jsxs("p",{className:"text-gray-600 mb-4",children:["$",d(n.subscription.plan),"/месяц"]}),w.jsxs("div",{className:"space-y-2 text-sm",children:[w.jsxs("div",{className:"flex justify-between",children:[w.jsx("span",{className:"text-gray-500",children:"Начало подписки:"}),w.jsx("span",{children:a(n.subscription.startDate)})]}),w.jsxs("div",{className:"flex justify-between",children:[w.jsx("span",{className:"text-gray-500",children:"Следующий платеж:"}),w.jsx("span",{children:a(n.subscription.endDate)})]}),n.subscription.trialEndsAt&&w.jsxs("div",{className:"flex justify-between",children:[w.jsx("span",{className:"text-gray-500",children:"Конец пробного периода:"}),w.jsx("span",{children:a(n.subscription.trialEndsAt)})]})]})]}),w.jsxs("div",{className:"space-y-4",children:[w.jsxs(zt,{className:"w-full",onClick:()=>t("/pricing"),variant:"outline",children:[w.jsx(Mee,{className:"mr-2 h-4 w-4"}),"Изменить план"]}),n.subscription.plan!=="free"&&n.subscription.status==="active"&&w.jsxs(ex,{open:s,onOpenChange:o,children:[w.jsx(tx,{asChild:!0,children:w.jsx(zt,{variant:"outline",className:"w-full",children:"Отменить подписку"})}),w.jsxs(yg,{children:[w.jsxs(vg,{children:[w.jsx(xg,{children:"Отмена подписки"}),w.jsx(wg,{children:"Вы уверены, что хотите отменить подписку? Вы потеряете доступ к премиум функциям."})]}),w.jsxs(nx,{children:[w.jsx(zt,{variant:"outline",onClick:()=>o(!1),children:"Отмена"}),w.jsx(zt,{variant:"destructive",onClick:f,disabled:r,children:r?"Отменяем...":"Подтвердить отмену"})]})]})]})]})]})})]}),w.jsxs(ti,{className:"mb-6",children:[w.jsxs(ns,{children:[w.jsx(rs,{children:"Статистика использования"}),w.jsx(So,{children:"Отслеживайте использование ресурсов вашего плана"})]}),w.jsx($r,{children:w.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[w.jsxs("div",{children:[w.jsxs("div",{className:"flex justify-between items-center mb-2",children:[w.jsx("span",{className:"text-sm font-medium",children:"Проекты"}),w.jsxs("span",{className:"text-sm text-gray-500",children:[n.projects.count,"/",n.projects.limit===-1?"∞":n.projects.limit]})]}),w.jsx(xb,{value:n.projects.limit===-1?0:n.projects.count/n.projects.limit*100,className:"h-2"})]}),w.jsxs("div",{children:[w.jsxs("div",{className:"flex justify-between items-center mb-2",children:[w.jsx("span",{className:"text-sm font-medium",children:"Хранилище"}),w.jsxs("span",{className:"text-sm text-gray-500",children:[l(n.usage.storageUsed),"/",l(n.usage.storageLimit)]})]}),w.jsx(xb,{value:c(),className:"h-2"})]}),w.jsxs("div",{children:[w.jsxs("div",{className:"flex justify-between items-center mb-2",children:[w.jsx("span",{className:"text-sm font-medium",children:"AI запросы"}),w.jsxs("span",{className:"text-sm text-gray-500",children:[n.usage.aiRequestsUsed,"/",n.usage.aiRequestsLimit===-1?"∞":n.usage.aiRequestsLimit]})]}),w.jsx(xb,{value:u(),className:"h-2"})]})]})})]}),w.jsxs(ti,{className:"mb-6",children:[w.jsx(ns,{children:w.jsxs(rs,{className:"flex items-center",children:[w.jsx(p_,{className:"mr-2 h-5 w-5"}),"Способ оплаты"]})}),w.jsx($r,{children:w.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[w.jsxs("div",{className:"flex items-center",children:[w.jsx("div",{className:"w-12 h-8 bg-gradient-to-r from-blue-600 to-purple-600 rounded flex items-center justify-center mr-3",children:w.jsx("span",{className:"text-white text-xs font-bold",children:"VISA"})}),w.jsxs("div",{children:[w.jsx("p",{className:"font-medium",children:"**** **** **** 4242"}),w.jsx("p",{className:"text-sm text-gray-500",children:"Истекает 12/27"})]})]}),w.jsx(zt,{variant:"outline",size:"sm",children:"Изменить"})]})})]}),w.jsxs(ti,{children:[w.jsxs(ns,{children:[w.jsx(rs,{children:"История платежей"}),w.jsx(So,{children:"Просмотрите историю ваших платежей и загрузите счета"})]}),w.jsx($r,{children:w.jsx("div",{className:"space-y-4",children:v.map(y=>w.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[w.jsxs("div",{className:"flex items-center",children:[w.jsx(Jk,{className:"h-5 w-5 text-green-500 mr-3"}),w.jsxs("div",{children:[w.jsxs("p",{className:"font-medium",children:["$",y.amount," - ",y.plan.toUpperCase()]}),w.jsx("p",{className:"text-sm text-gray-500",children:a(y.date)})]})]}),w.jsxs("div",{className:"flex items-center space-x-2",children:[w.jsx(yo,{variant:"outline",children:"Оплачено"}),w.jsxs(zt,{variant:"outline",size:"sm",children:[w.jsx(Zb,{className:"h-4 w-4 mr-1"}),"Счет"]})]})]},y.id))})})]})]})})})},m0e=()=>{const n={totalUsers:1247,activeSubscriptions:892,totalMaterials:456,totalFurniture:234,monthlyRevenue:23450,newUsersThisMonth:156},e=({title:t,value:r,description:i,icon:s,trend:o})=>w.jsxs(ti,{children:[w.jsxs(ns,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[w.jsx(rs,{className:"text-sm font-medium",children:t}),s]}),w.jsxs($r,{children:[w.jsx("div",{className:"text-2xl font-bold",children:r}),w.jsxs("p",{className:"text-xs text-muted-foreground",children:[o&&w.jsx("span",{className:"text-green-600",children:o})," ",i]})]})]});return w.jsxs("div",{className:"flex-1 space-y-4 p-8 pt-6",children:[w.jsx("div",{className:"flex items-center justify-between space-y-2",children:w.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Панель администратора"})}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[w.jsx(e,{title:"Всего пользователей",value:n.totalUsers.toLocaleString(),description:"с прошлого месяца",icon:w.jsx(rI,{className:"h-4 w-4 text-muted-foreground"}),trend:"+12%"}),w.jsx(e,{title:"Активные подписки",value:n.activeSubscriptions.toLocaleString(),description:"пользователей с подпиской",icon:w.jsx(p_,{className:"h-4 w-4 text-muted-foreground"}),trend:"+8%"}),w.jsx(e,{title:"Материалы",value:n.totalMaterials.toLocaleString(),description:"доступных материалов",icon:w.jsx(F$,{className:"h-4 w-4 text-muted-foreground"})}),w.jsx(e,{title:"Мебель",value:n.totalFurniture.toLocaleString(),description:"3D модели мебели",icon:w.jsx(tI,{className:"h-4 w-4 text-muted-foreground"})}),w.jsx(e,{title:"Месячный доход",value:`$${n.monthlyRevenue.toLocaleString()}`,description:"в этом месяце",icon:w.jsx(Jee,{className:"h-4 w-4 text-muted-foreground"}),trend:"+15%"}),w.jsx(e,{title:"Новые пользователи",value:n.newUsersThisMonth.toLocaleString(),description:"за этот месяц",icon:w.jsx(_ee,{className:"h-4 w-4 text-muted-foreground"}),trend:"+23%"})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-7",children:[w.jsxs(ti,{className:"col-span-4",children:[w.jsx(ns,{children:w.jsx(rs,{children:"Обзор доходов"})}),w.jsx($r,{className:"pl-2",children:w.jsx("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:"График доходов (интеграция с charts)"})})]}),w.jsxs(ti,{className:"col-span-3",children:[w.jsxs(ns,{children:[w.jsx(rs,{children:"Последние активности"}),w.jsx(So,{children:"Недавние действия пользователей"})]}),w.jsx($r,{children:w.jsxs("div",{className:"space-y-4",children:[w.jsx("div",{className:"flex items-center",children:w.jsxs("div",{className:"ml-4 space-y-1",children:[w.jsx("p",{className:"text-sm font-medium leading-none",children:"Новый пользователь зарегистрировался"}),w.jsx("p",{className:"text-sm text-muted-foreground",children:"2 минуты назад"})]})}),w.jsx("div",{className:"flex items-center",children:w.jsxs("div",{className:"ml-4 space-y-1",children:[w.jsx("p",{className:"text-sm font-medium leading-none",children:"Обновлена подписка на Pro"}),w.jsx("p",{className:"text-sm text-muted-foreground",children:"5 минут назад"})]})}),w.jsx("div",{className:"flex items-center",children:w.jsxs("div",{className:"ml-4 space-y-1",children:[w.jsx("p",{className:"text-sm font-medium leading-none",children:"Добавлен новый материал"}),w.jsx("p",{className:"text-sm text-muted-foreground",children:"10 минут назад"})]})})]})})]})]})]})},g0e=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function Ym(n,e,t){const r=y0e(n),{webkitRelativePath:i}=n,s=typeof e=="string"?e:typeof i=="string"&&i.length>0?i:`./${n.name}`;return typeof r.path!="string"&&sz(r,"path",s),sz(r,"relativePath",s),r}function y0e(n){const{name:e}=n;if(e&&e.lastIndexOf(".")!==-1&&!n.type){const r=e.split(".").pop().toLowerCase(),i=g0e.get(r);i&&Object.defineProperty(n,"type",{value:i,writable:!1,configurable:!1,enumerable:!0})}return n}function sz(n,e,t){Object.defineProperty(n,e,{value:t,writable:!1,configurable:!1,enumerable:!0})}const v0e=[".DS_Store","Thumbs.db"];function x0e(n){return Ef(this,void 0,void 0,function*(){return MS(n)&&w0e(n.dataTransfer)?E0e(n.dataTransfer,n.type):b0e(n)?S0e(n):Array.isArray(n)&&n.every(e=>"getFile"in e&&typeof e.getFile=="function")?_0e(n):[]})}function w0e(n){return MS(n)}function b0e(n){return MS(n)&&MS(n.target)}function MS(n){return typeof n=="object"&&n!==null}function S0e(n){return tN(n.target.files).map(e=>Ym(e))}function _0e(n){return Ef(this,void 0,void 0,function*(){return(yield Promise.all(n.map(t=>t.getFile()))).map(t=>Ym(t))})}function E0e(n,e){return Ef(this,void 0,void 0,function*(){if(n.items){const t=tN(n.items).filter(i=>i.kind==="file");if(e!=="drop")return t;const r=yield Promise.all(t.map(C0e));return oz(i8(r))}return oz(tN(n.files).map(t=>Ym(t)))})}function oz(n){return n.filter(e=>v0e.indexOf(e.name)===-1)}function tN(n){if(n===null)return[];const e=[];for(let t=0;t<n.length;t++){const r=n[t];e.push(r)}return e}function C0e(n){if(typeof n.webkitGetAsEntry!="function")return az(n);const e=n.webkitGetAsEntry();return e&&e.isDirectory?s8(e):az(n,e)}function i8(n){return n.reduce((e,t)=>[...e,...Array.isArray(t)?i8(t):[t]],[])}function az(n,e){return Ef(this,void 0,void 0,function*(){var t;if(globalThis.isSecureContext&&typeof n.getAsFileSystemHandle=="function"){const s=yield n.getAsFileSystemHandle();if(s===null)throw new Error(`${n} is not a File`);if(s!==void 0){const o=yield s.getFile();return o.handle=s,Ym(o)}}const r=n.getAsFile();if(!r)throw new Error(`${n} is not a File`);return Ym(r,(t=e==null?void 0:e.fullPath)!==null&&t!==void 0?t:void 0)})}function T0e(n){return Ef(this,void 0,void 0,function*(){return n.isDirectory?s8(n):M0e(n)})}function s8(n){const e=n.createReader();return new Promise((t,r)=>{const i=[];function s(){e.readEntries(o=>Ef(this,void 0,void 0,function*(){if(o.length){const a=Promise.all(o.map(T0e));i.push(a),s()}else try{const a=yield Promise.all(i);t(a)}catch(a){r(a)}}),o=>{r(o)})}s()})}function M0e(n){return Ef(this,void 0,void 0,function*(){return new Promise((e,t)=>{n.file(r=>{const i=Ym(r,n.fullPath);e(i)},r=>{t(r)})})})}var sT=function(n,e){if(n&&e){var t=Array.isArray(e)?e:e.split(",");if(t.length===0)return!0;var r=n.name||"",i=(n.type||"").toLowerCase(),s=i.replace(/\/.*$/,"");return t.some(function(o){var a=o.trim().toLowerCase();return a.charAt(0)==="."?r.toLowerCase().endsWith(a):a.endsWith("/*")?s===a.replace(/\/.*$/,""):i===a})}return!0};function lz(n){return k0e(n)||N0e(n)||a8(n)||A0e()}function A0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N0e(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function k0e(n){if(Array.isArray(n))return nN(n)}function cz(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function uz(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?cz(Object(t),!0).forEach(function(r){o8(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):cz(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function o8(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function C0(n,e){return P0e(n)||R0e(n,e)||a8(n,e)||I0e()}function I0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a8(n,e){if(n){if(typeof n=="string")return nN(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nN(n,e)}}function nN(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function R0e(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r=[],i=!0,s=!1,o,a;try{for(t=t.call(n);!(i=(o=t.next()).done)&&(r.push(o.value),!(e&&r.length===e));i=!0);}catch(l){s=!0,a=l}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw a}}return r}}function P0e(n){if(Array.isArray(n))return n}var D0e=typeof sT=="function"?sT:sT.default,L0e="file-invalid-type",O0e="file-too-large",F0e="file-too-small",z0e="too-many-files",U0e=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=e.split(","),r=t.length>1?"one of ".concat(t.join(", ")):t[0];return{code:L0e,message:"File type must be ".concat(r)}},dz=function(e){return{code:O0e,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},hz=function(e){return{code:F0e,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},B0e={code:z0e,message:"Too many files"};function l8(n,e){var t=n.type==="application/x-moz-file"||D0e(n,e);return[t,t?null:U0e(e)]}function c8(n,e,t){if(xh(n.size))if(xh(e)&&xh(t)){if(n.size>t)return[!1,dz(t)];if(n.size<e)return[!1,hz(e)]}else{if(xh(e)&&n.size<e)return[!1,hz(e)];if(xh(t)&&n.size>t)return[!1,dz(t)]}return[!0,null]}function xh(n){return n!=null}function $0e(n){var e=n.files,t=n.accept,r=n.minSize,i=n.maxSize,s=n.multiple,o=n.maxFiles,a=n.validator;return!s&&e.length>1||s&&o>=1&&e.length>o?!1:e.every(function(l){var c=l8(l,t),u=C0(c,1),d=u[0],h=c8(l,r,i),f=C0(h,1),p=f[0],x=a?a(l):null;return d&&p&&!x})}function AS(n){return typeof n.isPropagationStopped=="function"?n.isPropagationStopped():typeof n.cancelBubble<"u"?n.cancelBubble:!1}function z1(n){return n.dataTransfer?Array.prototype.some.call(n.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!n.target&&!!n.target.files}function fz(n){n.preventDefault()}function j0e(n){return n.indexOf("MSIE")!==-1||n.indexOf("Trident/")!==-1}function V0e(n){return n.indexOf("Edge/")!==-1}function W0e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return j0e(n)||V0e(n)}function wl(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return e.some(function(a){return!AS(r)&&a&&a.apply(void 0,[r].concat(s)),AS(r)})}}function H0e(){return"showOpenFilePicker"in window}function G0e(n){if(xh(n)){var e=Object.entries(n).filter(function(t){var r=C0(t,2),i=r[0],s=r[1],o=!0;return u8(i)||(console.warn('Skipped "'.concat(i,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),o=!1),(!Array.isArray(s)||!s.every(d8))&&(console.warn('Skipped "'.concat(i,'" because an invalid file extension was provided.')),o=!1),o}).reduce(function(t,r){var i=C0(r,2),s=i[0],o=i[1];return uz(uz({},t),{},o8({},s,o))},{});return[{description:"Files",accept:e}]}return n}function q0e(n){if(xh(n))return Object.entries(n).reduce(function(e,t){var r=C0(t,2),i=r[0],s=r[1];return[].concat(lz(e),[i],lz(s))},[]).filter(function(e){return u8(e)||d8(e)}).join(",")}function X0e(n){return n instanceof DOMException&&(n.name==="AbortError"||n.code===n.ABORT_ERR)}function K0e(n){return n instanceof DOMException&&(n.name==="SecurityError"||n.code===n.SECURITY_ERR)}function u8(n){return n==="audio/*"||n==="video/*"||n==="image/*"||n==="text/*"||n==="application/*"||/\w+\/[-+.\w]+/g.test(n)}function d8(n){return/^.*\.[\w]+$/.test(n)}var Y0e=["children"],Z0e=["open"],Q0e=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],J0e=["refKey","onChange","onClick"];function exe(n){return rxe(n)||nxe(n)||h8(n)||txe()}function txe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nxe(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function rxe(n){if(Array.isArray(n))return rN(n)}function oT(n,e){return oxe(n)||sxe(n,e)||h8(n,e)||ixe()}function ixe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h8(n,e){if(n){if(typeof n=="string")return rN(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return rN(n,e)}}function rN(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function sxe(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r=[],i=!0,s=!1,o,a;try{for(t=t.call(n);!(i=(o=t.next()).done)&&(r.push(o.value),!(e&&r.length===e));i=!0);}catch(l){s=!0,a=l}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw a}}return r}}function oxe(n){if(Array.isArray(n))return n}function pz(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function Yr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?pz(Object(t),!0).forEach(function(r){iN(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):pz(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function iN(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function NS(n,e){if(n==null)return{};var t=axe(n,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function axe(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}var VR=N.forwardRef(function(n,e){var t=n.children,r=NS(n,Y0e),i=kS(r),s=i.open,o=NS(i,Z0e);return N.useImperativeHandle(e,function(){return{open:s}},[s]),Sr.createElement(N.Fragment,null,t(Yr(Yr({},o),{},{open:s})))});VR.displayName="Dropzone";var f8={disabled:!1,getFilesFromEvent:x0e,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};VR.defaultProps=f8;VR.propTypes={children:Ar.func,accept:Ar.objectOf(Ar.arrayOf(Ar.string)),multiple:Ar.bool,preventDropOnDocument:Ar.bool,noClick:Ar.bool,noKeyboard:Ar.bool,noDrag:Ar.bool,noDragEventsBubbling:Ar.bool,minSize:Ar.number,maxSize:Ar.number,maxFiles:Ar.number,disabled:Ar.bool,getFilesFromEvent:Ar.func,onFileDialogCancel:Ar.func,onFileDialogOpen:Ar.func,useFsAccessApi:Ar.bool,autoFocus:Ar.bool,onDragEnter:Ar.func,onDragLeave:Ar.func,onDragOver:Ar.func,onDrop:Ar.func,onDropAccepted:Ar.func,onDropRejected:Ar.func,onError:Ar.func,validator:Ar.func};var sN={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function kS(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=Yr(Yr({},f8),n),t=e.accept,r=e.disabled,i=e.getFilesFromEvent,s=e.maxSize,o=e.minSize,a=e.multiple,l=e.maxFiles,c=e.onDragEnter,u=e.onDragLeave,d=e.onDragOver,h=e.onDrop,f=e.onDropAccepted,p=e.onDropRejected,x=e.onFileDialogCancel,v=e.onFileDialogOpen,y=e.useFsAccessApi,b=e.autoFocus,S=e.preventDropOnDocument,_=e.noClick,T=e.noKeyboard,M=e.noDrag,k=e.noDragEventsBubbling,P=e.onError,z=e.validator,I=N.useMemo(function(){return q0e(t)},[t]),L=N.useMemo(function(){return G0e(t)},[t]),W=N.useMemo(function(){return typeof v=="function"?v:mz},[v]),q=N.useMemo(function(){return typeof x=="function"?x:mz},[x]),$=N.useRef(null),ne=N.useRef(null),Y=N.useReducer(lxe,sN),we=oT(Y,2),H=we[0],X=we[1],oe=H.isFocused,ve=H.isFileDialogActive,Te=N.useRef(typeof window<"u"&&window.isSecureContext&&y&&H0e()),Xe=function(){!Te.current&&ve&&setTimeout(function(){if(ne.current){var Ee=ne.current.files;Ee.length||(X({type:"closeDialog"}),q())}},300)};N.useEffect(function(){return window.addEventListener("focus",Xe,!1),function(){window.removeEventListener("focus",Xe,!1)}},[ne,ve,q,Te]);var _e=N.useRef([]),Ue=function(Ee){$.current&&$.current.contains(Ee.target)||(Ee.preventDefault(),_e.current=[])};N.useEffect(function(){return S&&(document.addEventListener("dragover",fz,!1),document.addEventListener("drop",Ue,!1)),function(){S&&(document.removeEventListener("dragover",fz),document.removeEventListener("drop",Ue))}},[$,S]),N.useEffect(function(){return!r&&b&&$.current&&$.current.focus(),function(){}},[$,b,r]);var Fe=N.useCallback(function(ee){P?P(ee):console.error(ee)},[P]),Oe=N.useCallback(function(ee){ee.preventDefault(),ee.persist(),G(ee),_e.current=[].concat(exe(_e.current),[ee.target]),z1(ee)&&Promise.resolve(i(ee)).then(function(Ee){if(!(AS(ee)&&!k)){var Me=Ee.length,Ae=Me>0&&$0e({files:Ee,accept:I,minSize:o,maxSize:s,multiple:a,maxFiles:l,validator:z}),Be=Me>0&&!Ae;X({isDragAccept:Ae,isDragReject:Be,isDragActive:!0,type:"setDraggedFiles"}),c&&c(ee)}}).catch(function(Ee){return Fe(Ee)})},[i,c,Fe,k,I,o,s,a,l,z]),nt=N.useCallback(function(ee){ee.preventDefault(),ee.persist(),G(ee);var Ee=z1(ee);if(Ee&&ee.dataTransfer)try{ee.dataTransfer.dropEffect="copy"}catch{}return Ee&&d&&d(ee),!1},[d,k]),rt=N.useCallback(function(ee){ee.preventDefault(),ee.persist(),G(ee);var Ee=_e.current.filter(function(Ae){return $.current&&$.current.contains(Ae)}),Me=Ee.indexOf(ee.target);Me!==-1&&Ee.splice(Me,1),_e.current=Ee,!(Ee.length>0)&&(X({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),z1(ee)&&u&&u(ee))},[$,u,k]),ut=N.useCallback(function(ee,Ee){var Me=[],Ae=[];ee.forEach(function(Be){var dt=l8(Be,I),We=oT(dt,2),Kt=We[0],cn=We[1],jt=c8(Be,o,s),wt=oT(jt,2),Mt=wt[0],ye=wt[1],He=z?z(Be):null;if(Kt&&Mt&&!He)Me.push(Be);else{var st=[cn,ye];He&&(st=st.concat(He)),Ae.push({file:Be,errors:st.filter(function(_t){return _t})})}}),(!a&&Me.length>1||a&&l>=1&&Me.length>l)&&(Me.forEach(function(Be){Ae.push({file:Be,errors:[B0e]})}),Me.splice(0)),X({acceptedFiles:Me,fileRejections:Ae,isDragReject:Ae.length>0,type:"setFiles"}),h&&h(Me,Ae,Ee),Ae.length>0&&p&&p(Ae,Ee),Me.length>0&&f&&f(Me,Ee)},[X,a,I,o,s,l,h,f,p,z]),Qe=N.useCallback(function(ee){ee.preventDefault(),ee.persist(),G(ee),_e.current=[],z1(ee)&&Promise.resolve(i(ee)).then(function(Ee){AS(ee)&&!k||ut(Ee,ee)}).catch(function(Ee){return Fe(Ee)}),X({type:"reset"})},[i,ut,Fe,k]),ae=N.useCallback(function(){if(Te.current){X({type:"openDialog"}),W();var ee={multiple:a,types:L};window.showOpenFilePicker(ee).then(function(Ee){return i(Ee)}).then(function(Ee){ut(Ee,null),X({type:"closeDialog"})}).catch(function(Ee){X0e(Ee)?(q(Ee),X({type:"closeDialog"})):K0e(Ee)?(Te.current=!1,ne.current?(ne.current.value=null,ne.current.click()):Fe(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):Fe(Ee)});return}ne.current&&(X({type:"openDialog"}),W(),ne.current.value=null,ne.current.click())},[X,W,q,y,ut,Fe,L,a]),ze=N.useCallback(function(ee){!$.current||!$.current.isEqualNode(ee.target)||(ee.key===" "||ee.key==="Enter"||ee.keyCode===32||ee.keyCode===13)&&(ee.preventDefault(),ae())},[$,ae]),Re=N.useCallback(function(){X({type:"focus"})},[]),Je=N.useCallback(function(){X({type:"blur"})},[]),Ge=N.useCallback(function(){_||(W0e()?setTimeout(ae,0):ae())},[_,ae]),Et=function(Ee){return r?null:Ee},pt=function(Ee){return T?null:Et(Ee)},Q=function(Ee){return M?null:Et(Ee)},G=function(Ee){k&&Ee.stopPropagation()},ke=N.useMemo(function(){return function(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ee=ee.refKey,Me=Ee===void 0?"ref":Ee,Ae=ee.role,Be=ee.onKeyDown,dt=ee.onFocus,We=ee.onBlur,Kt=ee.onClick,cn=ee.onDragEnter,jt=ee.onDragOver,wt=ee.onDragLeave,Mt=ee.onDrop,ye=NS(ee,Q0e);return Yr(Yr(iN({onKeyDown:pt(wl(Be,ze)),onFocus:pt(wl(dt,Re)),onBlur:pt(wl(We,Je)),onClick:Et(wl(Kt,Ge)),onDragEnter:Q(wl(cn,Oe)),onDragOver:Q(wl(jt,nt)),onDragLeave:Q(wl(wt,rt)),onDrop:Q(wl(Mt,Qe)),role:typeof Ae=="string"&&Ae!==""?Ae:"presentation"},Me,$),!r&&!T?{tabIndex:0}:{}),ye)}},[$,ze,Re,Je,Ge,Oe,nt,rt,Qe,T,M,r]),J=N.useCallback(function(ee){ee.stopPropagation()},[]),he=N.useMemo(function(){return function(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ee=ee.refKey,Me=Ee===void 0?"ref":Ee,Ae=ee.onChange,Be=ee.onClick,dt=NS(ee,J0e),We=iN({accept:I,multiple:a,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:Et(wl(Ae,Qe)),onClick:Et(wl(Be,J)),tabIndex:-1},Me,ne);return Yr(Yr({},We),dt)}},[ne,t,a,Qe,r]);return Yr(Yr({},H),{},{isFocused:oe&&!r,getRootProps:ke,getInputProps:he,rootRef:$,inputRef:ne,open:Et(ae)})}function lxe(n,e){switch(e.type){case"focus":return Yr(Yr({},n),{},{isFocused:!0});case"blur":return Yr(Yr({},n),{},{isFocused:!1});case"openDialog":return Yr(Yr({},sN),{},{isFileDialogActive:!0});case"closeDialog":return Yr(Yr({},n),{},{isFileDialogActive:!1});case"setDraggedFiles":return Yr(Yr({},n),{},{isDragActive:e.isDragActive,isDragAccept:e.isDragAccept,isDragReject:e.isDragReject});case"setFiles":return Yr(Yr({},n),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections,isDragReject:e.isDragReject});case"reset":return Yr({},sN);default:return n}}function mz(){}const cxe=()=>{const[n,e]=N.useState([{id:"1",name:"Дуб натуральный",category:"wood",description:"Натуральная текстура дуба высокого качества",imageUrl:"/images/materials/oak-texture.jpg",properties:{roughness:.8,metalness:0,normalScale:1},tags:["натуральный","дерево","классический"],isActive:!0,createdAt:"2024-01-15"},{id:"2",name:"Мрамор каррарский",category:"stone",description:"Белый мрамор с характерными прожилками",imageUrl:"/images/materials/marble-texture.jpg",properties:{roughness:.1,metalness:0,normalScale:.5},tags:["мрамор","премиум","белый"],isActive:!0,createdAt:"2024-01-10"}]),[t,r]=N.useState(""),[i,s]=N.useState("all"),[o,a]=N.useState(!1),[l,c]=N.useState(null),[u,d]=N.useState({name:"",category:"",description:"",imageFile:null,properties:{roughness:.5,metalness:0,normalScale:1},tags:""}),h=[{value:"all",label:"Все категории"},{value:"wood",label:"Дерево"},{value:"stone",label:"Камень"},{value:"metal",label:"Металл"},{value:"fabric",label:"Ткань"},{value:"plastic",label:"Пластик"}],f=n.filter(_=>{const T=_.name.toLowerCase().includes(t.toLowerCase())||_.description.toLowerCase().includes(t.toLowerCase()),M=i==="all"||_.category===i;return T&&M}),{getRootProps:p,getInputProps:x,isDragActive:v}=kS({accept:{"image/*":[".jpeg",".jpg",".png",".webp"]},onDrop:_=>{_.length>0&&d(T=>({...T,imageFile:_[0]}))}}),y=()=>{if(!u.name||!u.category||!u.imageFile)return;const _={id:crypto.randomUUID(),name:u.name,category:u.category,description:u.description,imageUrl:URL.createObjectURL(u.imageFile),properties:u.properties,tags:u.tags.split(",").map(T=>T.trim()).filter(Boolean),isActive:!0,createdAt:new Date().toISOString().split("T")[0]};e(T=>[...T,_]),d({name:"",category:"",description:"",imageFile:null,properties:{roughness:.5,metalness:0,normalScale:1},tags:""}),a(!1)},b=_=>{e(T=>T.filter(M=>M.id!==_))},S=_=>{e(T=>T.map(M=>M.id===_?{...M,isActive:!M.isActive}:M))};return w.jsxs("div",{className:"flex-1 space-y-4 p-8 pt-6",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Управление материалами"}),w.jsxs(ex,{open:o,onOpenChange:a,children:[w.jsx(tx,{asChild:!0,children:w.jsxs(zt,{children:[w.jsx(Om,{className:"mr-2 h-4 w-4"}),"Добавить материал"]})}),w.jsxs(yg,{className:"sm:max-w-[600px]",children:[w.jsxs(vg,{children:[w.jsx(xg,{children:"Добавить новый материал"}),w.jsx(wg,{children:"Создайте новый материал для библиотеки"})]}),w.jsxs("div",{className:"grid gap-4 py-4",children:[w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{htmlFor:"name",className:"text-right",children:"Название"}),w.jsx(Jr,{id:"name",value:u.name,onChange:_=>d(T=>({...T,name:_.target.value})),className:"col-span-3"})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{htmlFor:"category",className:"text-right",children:"Категория"}),w.jsxs(Ju,{onValueChange:_=>d(T=>({...T,category:_})),children:[w.jsx(Rc,{className:"col-span-3",children:w.jsx(ed,{placeholder:"Выберите категорию"})}),w.jsxs(Pc,{children:[w.jsx(Ni,{value:"wood",children:"Дерево"}),w.jsx(Ni,{value:"stone",children:"Камень"}),w.jsx(Ni,{value:"metal",children:"Металл"}),w.jsx(Ni,{value:"fabric",children:"Ткань"}),w.jsx(Ni,{value:"plastic",children:"Пластик"})]})]})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{htmlFor:"description",className:"text-right",children:"Описание"}),w.jsx(k_,{id:"description",value:u.description,onChange:_=>d(T=>({...T,description:_.target.value})),className:"col-span-3"})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{className:"text-right",children:"Изображение"}),w.jsxs("div",{...p(),className:"col-span-3 border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer hover:border-gray-400",children:[w.jsx("input",{...x()}),u.imageFile?w.jsxs("div",{children:[w.jsx(Jb,{className:"mx-auto h-8 w-8 text-gray-400"}),w.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Выбран: ",u.imageFile.name]})]}):w.jsxs("div",{children:[w.jsx(Jb,{className:"mx-auto h-8 w-8 text-gray-400"}),w.jsx("p",{className:"mt-2 text-sm text-gray-600",children:v?"Отпустите файлы здесь":"Перетащите изображение или нажмите для выбора"})]})]})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{htmlFor:"tags",className:"text-right",children:"Теги"}),w.jsx(Jr,{id:"tags",value:u.tags,onChange:_=>d(T=>({...T,tags:_.target.value})),placeholder:"тег1, тег2, тег3",className:"col-span-3"})]})]}),w.jsx(nx,{children:w.jsx(zt,{type:"submit",onClick:y,children:"Создать материал"})})]})]})]}),w.jsxs("div",{className:"flex items-center space-x-2",children:[w.jsxs("div",{className:"relative flex-1 max-w-sm",children:[w.jsx(Fm,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),w.jsx(Jr,{placeholder:"Поиск материалов...",value:t,onChange:_=>r(_.target.value),className:"pl-8"})]}),w.jsxs(Ju,{value:i,onValueChange:s,children:[w.jsx(Rc,{className:"w-[200px]",children:w.jsx(ed,{})}),w.jsx(Pc,{children:h.map(_=>w.jsx(Ni,{value:_.value,children:_.label},_.value))})]})]}),w.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:f.map(_=>{var T;return w.jsxs(ti,{className:"overflow-hidden",children:[w.jsxs("div",{className:"aspect-square relative",children:[w.jsx("img",{src:_.imageUrl,alt:_.name,className:"w-full h-full object-cover",onError:M=>{M.target.src="/images/placeholders/material-placeholder.webp"}}),w.jsx("div",{className:"absolute top-2 right-2",children:w.jsx(yo,{variant:_.isActive?"default":"secondary",children:_.isActive?"Активен":"Неактивен"})})]}),w.jsxs(ns,{className:"p-4",children:[w.jsx(rs,{className:"text-lg",children:_.name}),w.jsx(So,{className:"text-sm",children:_.description})]}),w.jsxs($r,{className:"p-4 pt-0",children:[w.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:_.tags.map((M,k)=>w.jsx(yo,{variant:"outline",className:"text-xs",children:M},k))}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("span",{className:"text-sm text-muted-foreground",children:(T=h.find(M=>M.value===_.category))==null?void 0:T.label}),w.jsxs("div",{className:"flex gap-1",children:[w.jsx(zt,{variant:"outline",size:"sm",onClick:()=>S(_.id),children:_.isActive?"Деактивировать":"Активировать"}),w.jsx(zt,{variant:"outline",size:"sm",onClick:()=>c(_),children:w.jsx(Qb,{className:"h-4 w-4"})}),w.jsx(zt,{variant:"outline",size:"sm",onClick:()=>b(_.id),children:w.jsx(zv,{className:"h-4 w-4"})})]})]})]})]},_.id)})}),f.length===0&&w.jsx("div",{className:"text-center py-12",children:w.jsx("p",{className:"text-muted-foreground",children:"Материалы не найдены"})})]})},uxe=()=>{const[n,e]=N.useState([{id:"1",name:"Современный диван",category:"seating",description:"Элегантный трехместный диван в современном стиле",imageUrl:"/images/furniture/modern-sofa.jpeg",modelUrl:"/models/sofa.glb",dimensions:{width:220,height:85,depth:95},materials:["fabric","wood"],tags:["современный","диван","гостиная"],price:1299.99,isActive:!0,createdAt:"2024-01-15"},{id:"2",name:"Обеденный стол",category:"tables",description:"Круглый обеденный стол из массива дуба",imageUrl:"/images/furniture/dining-table.jpg",modelUrl:"/models/table.glb",dimensions:{width:120,height:75,depth:120},materials:["wood"],tags:["стол","дуб","обеденная"],price:899.99,isActive:!0,createdAt:"2024-01-10"}]),[t,r]=N.useState(""),[i,s]=N.useState("all"),[o,a]=N.useState(!1),[l,c]=N.useState({name:"",category:"",description:"",imageFile:null,modelFile:null,dimensions:{width:0,height:0,depth:0},materials:"",tags:"",price:0}),u=[{value:"all",label:"Все категории"},{value:"seating",label:"Мягкая мебель"},{value:"tables",label:"Столы"},{value:"storage",label:"Системы хранения"},{value:"lighting",label:"Освещение"},{value:"decoration",label:"Декор"}],d=n.filter(T=>{const M=T.name.toLowerCase().includes(t.toLowerCase())||T.description.toLowerCase().includes(t.toLowerCase()),k=i==="all"||T.category===i;return M&&k}),{getRootProps:h,getInputProps:f,isDragActive:p}=kS({accept:{"image/*":[".jpeg",".jpg",".png",".webp"]},onDrop:T=>{T.length>0&&c(M=>({...M,imageFile:T[0]}))}}),{getRootProps:x,getInputProps:v,isDragActive:y}=kS({accept:{"model/gltf-binary":[".glb"],"model/gltf+json":[".gltf"],"application/octet-stream":[".obj"]},onDrop:T=>{T.length>0&&c(M=>({...M,modelFile:T[0]}))}}),b=()=>{if(!l.name||!l.category||!l.imageFile||!l.modelFile)return;const T={id:crypto.randomUUID(),name:l.name,category:l.category,description:l.description,imageUrl:URL.createObjectURL(l.imageFile),modelUrl:URL.createObjectURL(l.modelFile),dimensions:l.dimensions,materials:l.materials.split(",").map(M=>M.trim()).filter(Boolean),tags:l.tags.split(",").map(M=>M.trim()).filter(Boolean),price:l.price||void 0,isActive:!0,createdAt:new Date().toISOString().split("T")[0]};e(M=>[...M,T]),c({name:"",category:"",description:"",imageFile:null,modelFile:null,dimensions:{width:0,height:0,depth:0},materials:"",tags:"",price:0}),a(!1)},S=T=>{e(M=>M.filter(k=>k.id!==T))},_=T=>{e(M=>M.map(k=>k.id===T?{...k,isActive:!k.isActive}:k))};return w.jsxs("div",{className:"flex-1 space-y-4 p-8 pt-6",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Управление мебелью"}),w.jsxs(ex,{open:o,onOpenChange:a,children:[w.jsx(tx,{asChild:!0,children:w.jsxs(zt,{children:[w.jsx(Om,{className:"mr-2 h-4 w-4"}),"Добавить мебель"]})}),w.jsxs(yg,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[w.jsxs(vg,{children:[w.jsx(xg,{children:"Добавить новую мебель"}),w.jsx(wg,{children:"Создайте новый предмет мебели для каталога"})]}),w.jsxs("div",{className:"grid gap-4 py-4",children:[w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{htmlFor:"name",className:"text-right",children:"Название"}),w.jsx(Jr,{id:"name",value:l.name,onChange:T=>c(M=>({...M,name:T.target.value})),className:"col-span-3"})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{htmlFor:"category",className:"text-right",children:"Категория"}),w.jsxs(Ju,{onValueChange:T=>c(M=>({...M,category:T})),children:[w.jsx(Rc,{className:"col-span-3",children:w.jsx(ed,{placeholder:"Выберите категорию"})}),w.jsxs(Pc,{children:[w.jsx(Ni,{value:"seating",children:"Мягкая мебель"}),w.jsx(Ni,{value:"tables",children:"Столы"}),w.jsx(Ni,{value:"storage",children:"Системы хранения"}),w.jsx(Ni,{value:"lighting",children:"Освещение"}),w.jsx(Ni,{value:"decoration",children:"Декор"})]})]})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{htmlFor:"description",className:"text-right",children:"Описание"}),w.jsx(k_,{id:"description",value:l.description,onChange:T=>c(M=>({...M,description:T.target.value})),className:"col-span-3"})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{className:"text-right",children:"Изображение"}),w.jsxs("div",{...h(),className:"col-span-3 border-2 border-dashed border-gray-300 rounded-lg p-4 text-center cursor-pointer hover:border-gray-400",children:[w.jsx("input",{...f()}),l.imageFile?w.jsxs("div",{children:[w.jsx(Jb,{className:"mx-auto h-6 w-6 text-gray-400"}),w.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Выбрано: ",l.imageFile.name]})]}):w.jsxs("div",{children:[w.jsx(Jb,{className:"mx-auto h-6 w-6 text-gray-400"}),w.jsx("p",{className:"mt-2 text-sm text-gray-600",children:p?"Отпустите изображение здесь":"Перетащите изображение или нажмите"})]})]})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{className:"text-right",children:"3D модель"}),w.jsxs("div",{...x(),className:"col-span-3 border-2 border-dashed border-blue-300 rounded-lg p-4 text-center cursor-pointer hover:border-blue-400",children:[w.jsx("input",{...v()}),l.modelFile?w.jsxs("div",{children:[w.jsx(lL,{className:"mx-auto h-6 w-6 text-blue-400"}),w.jsxs("p",{className:"mt-2 text-sm text-blue-600",children:["Выбрана: ",l.modelFile.name]})]}):w.jsxs("div",{children:[w.jsx(lL,{className:"mx-auto h-6 w-6 text-blue-400"}),w.jsx("p",{className:"mt-2 text-sm text-blue-600",children:y?"Отпустите 3D модель здесь":"Перетащите .glb/.gltf/.obj файл"})]})]})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{className:"text-right",children:"Размеры (см)"}),w.jsxs("div",{className:"col-span-3 grid grid-cols-3 gap-2",children:[w.jsxs("div",{children:[w.jsx(tr,{htmlFor:"width",className:"text-xs",children:"Ширина"}),w.jsx(Jr,{id:"width",type:"number",value:l.dimensions.width||"",onChange:T=>c(M=>({...M,dimensions:{...M.dimensions,width:Number(T.target.value)}}))})]}),w.jsxs("div",{children:[w.jsx(tr,{htmlFor:"height",className:"text-xs",children:"Высота"}),w.jsx(Jr,{id:"height",type:"number",value:l.dimensions.height||"",onChange:T=>c(M=>({...M,dimensions:{...M.dimensions,height:Number(T.target.value)}}))})]}),w.jsxs("div",{children:[w.jsx(tr,{htmlFor:"depth",className:"text-xs",children:"Глубина"}),w.jsx(Jr,{id:"depth",type:"number",value:l.dimensions.depth||"",onChange:T=>c(M=>({...M,dimensions:{...M.dimensions,depth:Number(T.target.value)}}))})]})]})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{htmlFor:"materials",className:"text-right",children:"Материалы"}),w.jsx(Jr,{id:"materials",value:l.materials,onChange:T=>c(M=>({...M,materials:T.target.value})),placeholder:"дерево, металл, ткань",className:"col-span-3"})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{htmlFor:"price",className:"text-right",children:"Цена ($)"}),w.jsx(Jr,{id:"price",type:"number",value:l.price||"",onChange:T=>c(M=>({...M,price:Number(T.target.value)})),className:"col-span-3"})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{htmlFor:"tags",className:"text-right",children:"Теги"}),w.jsx(Jr,{id:"tags",value:l.tags,onChange:T=>c(M=>({...M,tags:T.target.value})),placeholder:"тег1, тег2, тег3",className:"col-span-3"})]})]}),w.jsx(nx,{children:w.jsx(zt,{type:"submit",onClick:b,children:"Создать мебель"})})]})]})]}),w.jsxs("div",{className:"flex items-center space-x-2",children:[w.jsxs("div",{className:"relative flex-1 max-w-sm",children:[w.jsx(Fm,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),w.jsx(Jr,{placeholder:"Поиск мебели...",value:t,onChange:T=>r(T.target.value),className:"pl-8"})]}),w.jsxs(Ju,{value:i,onValueChange:s,children:[w.jsx(Rc,{className:"w-[200px]",children:w.jsx(ed,{})}),w.jsx(Pc,{children:u.map(T=>w.jsx(Ni,{value:T.value,children:T.label},T.value))})]})]}),w.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:d.map(T=>{var M;return w.jsxs(ti,{className:"overflow-hidden",children:[w.jsxs("div",{className:"aspect-square relative",children:[w.jsx("img",{src:T.imageUrl,alt:T.name,className:"w-full h-full object-cover",onError:k=>{k.target.src="/images/placeholders/furniture-placeholder.jpg"}}),w.jsx("div",{className:"absolute top-2 right-2",children:w.jsx(yo,{variant:T.isActive?"default":"secondary",children:T.isActive?"Активна":"Неактивна"})})]}),w.jsxs(ns,{className:"p-4",children:[w.jsx(rs,{className:"text-lg",children:T.name}),w.jsx(So,{className:"text-sm",children:T.description})]}),w.jsx($r,{className:"p-4 pt-0",children:w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{children:[w.jsxs("p",{className:"text-sm text-muted-foreground",children:["Размеры: ",T.dimensions.width,"×",T.dimensions.height,"×",T.dimensions.depth," см"]}),T.price&&w.jsxs("p",{className:"text-sm font-semibold text-green-600",children:["$",T.price]})]}),w.jsx("div",{className:"flex flex-wrap gap-1",children:T.tags.map((k,P)=>w.jsx(yo,{variant:"outline",className:"text-xs",children:k},P))}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("span",{className:"text-sm text-muted-foreground",children:(M=u.find(k=>k.value===T.category))==null?void 0:M.label}),w.jsxs("div",{className:"flex gap-1",children:[w.jsx(zt,{variant:"outline",size:"sm",onClick:()=>_(T.id),children:T.isActive?"Деактивировать":"Активировать"}),w.jsx(zt,{variant:"outline",size:"sm",children:w.jsx(Qb,{className:"h-4 w-4"})}),w.jsx(zt,{variant:"outline",size:"sm",onClick:()=>S(T.id),children:w.jsx(zv,{className:"h-4 w-4"})})]})]})]})})]},T.id)})}),d.length===0&&w.jsx("div",{className:"text-center py-12",children:w.jsx("p",{className:"text-muted-foreground",children:"Мебель не найдена"})})]})},gz=()=>{const[n,e]=N.useState([{id:"demo-user",email:"demo@craftruv.ru",name:"Демо Пользователь",avatar:"",role:"user",createdAt:"2024-01-15T10:30:00Z",subscription:{plan:"pro",status:"active",startDate:"2024-01-15T10:30:00Z",endDate:"2024-02-15T10:30:00Z"},projects:{count:5,limit:-1},usage:{storageUsed:1024,storageLimit:102400,aiRequestsUsed:150,aiRequestsLimit:1e3}},{id:"user-2",email:"ivan@example.com",name:"Иван Петров",avatar:"",role:"user",createdAt:"2024-01-10T15:20:00Z",subscription:{plan:"basic",status:"active",startDate:"2024-01-10T15:20:00Z",endDate:"2024-02-10T15:20:00Z"},projects:{count:3,limit:10},usage:{storageUsed:512,storageLimit:10240,aiRequestsUsed:0,aiRequestsLimit:0}},{id:"user-3",email:"maria@example.com",name:"Мария Сидорова",avatar:"",role:"user",createdAt:"2024-01-05T09:15:00Z",subscription:{plan:"free",status:"trial",startDate:"2024-01-05T09:15:00Z",endDate:"2024-01-12T09:15:00Z",trialEndsAt:"2024-01-12T09:15:00Z"},projects:{count:2,limit:3},usage:{storageUsed:256,storageLimit:1024,aiRequestsUsed:0,aiRequestsLimit:0}}]),[t,r]=N.useState(""),[i,s]=N.useState("all"),[o,a]=N.useState("all"),[l,c]=N.useState(null),u=[{value:"all",label:"Все планы"},{value:"free",label:"Free"},{value:"basic",label:"Basic"},{value:"pro",label:"Pro"},{value:"enterprise",label:"Enterprise"}],d=[{value:"all",label:"Все статусы"},{value:"active",label:"Активная"},{value:"trial",label:"Пробная"},{value:"expired",label:"Истекшая"},{value:"inactive",label:"Неактивная"}],h=n.filter(S=>{const _=S.name.toLowerCase().includes(t.toLowerCase())||S.email.toLowerCase().includes(t.toLowerCase()),T=i==="all"||S.subscription.plan===i,M=o==="all"||S.subscription.status===o;return _&&T&&M}),f=S=>{switch(S){case"active":return"default";case"trial":return"secondary";case"expired":return"destructive";case"inactive":return"outline";default:return"outline"}},p=S=>{switch(S){case"free":return"outline";case"basic":return"secondary";case"pro":return"default";case"enterprise":return"destructive";default:return"outline"}},x=S=>new Date(S).toLocaleDateString("ru-RU"),v=S=>`${(S/1024).toFixed(1)} ГБ`,y=(S,_)=>{e(T=>T.map(M=>{if(M.id===S){const k=new Date().toISOString(),P=new Date(Date.now()+30*24*60*60*1e3).toISOString();let z={count:0,limit:3},I={storageUsed:M.usage.storageUsed,storageLimit:1024,aiRequestsUsed:M.usage.aiRequestsUsed,aiRequestsLimit:0};switch(_){case"basic":z={count:M.projects.count,limit:10},I={...I,storageLimit:10*1024,aiRequestsLimit:0};break;case"pro":z={count:M.projects.count,limit:-1},I={...I,storageLimit:100*1024,aiRequestsLimit:1e3};break;case"enterprise":z={count:M.projects.count,limit:-1},I={...I,storageLimit:-1,aiRequestsLimit:-1};break}return{...M,subscription:{plan:_,status:"active",startDate:k,endDate:P},projects:z,usage:I}}return M}))},b=S=>{e(_=>_.map(T=>{if(T.id===S){const M=T.subscription.status==="active"?"inactive":"active";return{...T,subscription:{...T.subscription,status:M}}}return T}))};return w.jsxs("div",{className:"flex-1 space-y-4 p-8 pt-6",children:[w.jsx("div",{className:"flex items-center justify-between",children:w.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Управление пользователями"})}),w.jsxs("div",{className:"flex items-center space-x-2",children:[w.jsxs("div",{className:"relative flex-1 max-w-sm",children:[w.jsx(Fm,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),w.jsx(Jr,{placeholder:"Поиск пользователей...",value:t,onChange:S=>r(S.target.value),className:"pl-8"})]}),w.jsxs(Ju,{value:i,onValueChange:s,children:[w.jsx(Rc,{className:"w-[150px]",children:w.jsx(ed,{})}),w.jsx(Pc,{children:u.map(S=>w.jsx(Ni,{value:S.value,children:S.label},S.value))})]}),w.jsxs(Ju,{value:o,onValueChange:a,children:[w.jsx(Rc,{className:"w-[150px]",children:w.jsx(ed,{})}),w.jsx(Pc,{children:d.map(S=>w.jsx(Ni,{value:S.value,children:S.label},S.value))})]})]}),w.jsx("div",{className:"grid gap-4",children:h.map(S=>{var _;return w.jsx(ti,{children:w.jsxs($r,{className:"p-6",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center space-x-4",children:[w.jsxs(fv,{children:[w.jsx(QG,{src:S.avatar}),w.jsx(pv,{children:S.name.split(" ").map(T=>T[0]).join("")})]}),w.jsxs("div",{children:[w.jsxs("div",{className:"flex items-center space-x-2",children:[w.jsx("h3",{className:"text-lg font-semibold",children:S.name}),w.jsx(yo,{variant:p(S.subscription.plan),children:S.subscription.plan.toUpperCase()}),w.jsx(yo,{variant:f(S.subscription.status),children:(_=d.find(T=>T.value===S.subscription.status))==null?void 0:_.label})]}),w.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground mt-1",children:[w.jsxs("div",{className:"flex items-center",children:[w.jsx(NM,{className:"mr-1 h-3 w-3"}),S.email]}),w.jsxs("div",{className:"flex items-center",children:[w.jsx(P$,{className:"mr-1 h-3 w-3"}),"Регистрация: ",x(S.createdAt)]}),w.jsxs("div",{className:"flex items-center",children:[w.jsx(tI,{className:"mr-1 h-3 w-3"}),"Проектов: ",S.projects.count,S.projects.limit>0?`/${S.projects.limit}`:""]})]})]})]}),w.jsxs("div",{className:"flex items-center space-x-2",children:[w.jsxs(ex,{children:[w.jsx(tx,{asChild:!0,children:w.jsxs(zt,{variant:"outline",size:"sm",children:[w.jsx(tte,{className:"mr-2 h-4 w-4"}),"Управление"]})}),w.jsxs(yg,{children:[w.jsxs(vg,{children:[w.jsx(xg,{children:"Управление пользователем"}),w.jsxs(wg,{children:["Изменение подписки и статуса пользователя ",S.name]})]}),w.jsxs("div",{className:"grid gap-4 py-4",children:[w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{htmlFor:"plan",className:"text-right",children:"План"}),w.jsxs(Ju,{defaultValue:S.subscription.plan,onValueChange:T=>y(S.id,T),children:[w.jsx(Rc,{className:"col-span-3",children:w.jsx(ed,{})}),w.jsxs(Pc,{children:[w.jsx(Ni,{value:"free",children:"Free"}),w.jsx(Ni,{value:"basic",children:"Basic ($9.99/мес)"}),w.jsx(Ni,{value:"pro",children:"Pro ($19.99/мес)"}),w.jsx(Ni,{value:"enterprise",children:"Enterprise ($49.99/мес)"})]})]})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{className:"text-right",children:"Хранилище"}),w.jsxs("div",{className:"col-span-3 text-sm",children:[v(S.usage.storageUsed)," / ",S.usage.storageLimit===-1?"Безлимит":v(S.usage.storageLimit)]})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(tr,{className:"text-right",children:"AI запросы"}),w.jsxs("div",{className:"col-span-3 text-sm",children:[S.usage.aiRequestsUsed," / ",S.usage.aiRequestsLimit===-1?"Безлимит":S.usage.aiRequestsLimit]})]})]})]})]}),w.jsx(zt,{variant:S.subscription.status==="active"?"destructive":"default",size:"sm",onClick:()=>b(S.id),children:S.subscription.status==="active"?w.jsxs(w.Fragment,{children:[w.jsx(Aee,{className:"mr-2 h-4 w-4"}),"Заблокировать"]}):w.jsxs(w.Fragment,{children:[w.jsx(Jk,{className:"mr-2 h-4 w-4"}),"Активировать"]})})]})]}),w.jsxs("div",{className:"mt-4 grid grid-cols-4 gap-4 text-sm",children:[w.jsxs("div",{children:[w.jsx("span",{className:"text-muted-foreground",children:"Подписка активна до:"}),w.jsx("div",{className:"font-medium",children:x(S.subscription.endDate)})]}),w.jsxs("div",{children:[w.jsx("span",{className:"text-muted-foreground",children:"Использование хранилища:"}),w.jsxs("div",{className:"font-medium",children:[(S.usage.storageUsed/(S.usage.storageLimit===-1?S.usage.storageUsed:S.usage.storageLimit)*100).toFixed(1),"%"]})]}),w.jsxs("div",{children:[w.jsx("span",{className:"text-muted-foreground",children:"AI запросы в месяц:"}),w.jsx("div",{className:"font-medium",children:S.usage.aiRequestsLimit===-1?"Безлимит":`${S.usage.aiRequestsUsed}/${S.usage.aiRequestsLimit}`})]}),w.jsxs("div",{children:[w.jsx("span",{className:"text-muted-foreground",children:"Создано проектов:"}),w.jsx("div",{className:"font-medium",children:S.projects.count})]})]})]})},S.id)})}),h.length===0&&w.jsx("div",{className:"text-center py-12",children:w.jsx("p",{className:"text-muted-foreground",children:"Пользователи не найдены"})})]})},Rp=new Wa,Eu=new c2,Py=new Ze,yz=new ie,U1=new ie,aT=new ie,vz=new vn;class dxe extends Jl{constructor(e,t,r){super(),r.style.touchAction="none";let i=null,s=null;const o=[],a=this;function l(){r.addEventListener("pointermove",f),r.addEventListener("pointerdown",p),r.addEventListener("pointerup",x),r.addEventListener("pointerleave",x)}function c(){r.removeEventListener("pointermove",f),r.removeEventListener("pointerdown",p),r.removeEventListener("pointerup",x),r.removeEventListener("pointerleave",x),r.style.cursor=""}function u(){c()}function d(){return e}function h(){return Eu}function f(y){if(a.enabled!==!1){if(v(y),Eu.setFromCamera(Py,t),i){Eu.ray.intersectPlane(Rp,U1)&&i.position.copy(U1.sub(yz).applyMatrix4(vz)),a.dispatchEvent({type:"drag",object:i});return}if(y.pointerType==="mouse"||y.pointerType==="pen")if(o.length=0,Eu.setFromCamera(Py,t),Eu.intersectObjects(e,a.recursive,o),o.length>0){const b=o[0].object;Rp.setFromNormalAndCoplanarPoint(t.getWorldDirection(Rp.normal),aT.setFromMatrixPosition(b.matrixWorld)),s!==b&&s!==null&&(a.dispatchEvent({type:"hoveroff",object:s}),r.style.cursor="auto",s=null),s!==b&&(a.dispatchEvent({type:"hoveron",object:b}),r.style.cursor="pointer",s=b)}else s!==null&&(a.dispatchEvent({type:"hoveroff",object:s}),r.style.cursor="auto",s=null)}}function p(y){a.enabled!==!1&&(v(y),o.length=0,Eu.setFromCamera(Py,t),Eu.intersectObjects(e,a.recursive,o),o.length>0&&(i=a.transformGroup===!0?e[0]:o[0].object,Rp.setFromNormalAndCoplanarPoint(t.getWorldDirection(Rp.normal),aT.setFromMatrixPosition(i.matrixWorld)),Eu.ray.intersectPlane(Rp,U1)&&(vz.copy(i.parent.matrixWorld).invert(),yz.copy(U1).sub(aT.setFromMatrixPosition(i.matrixWorld))),r.style.cursor="move",a.dispatchEvent({type:"dragstart",object:i})))}function x(){a.enabled!==!1&&(i&&(a.dispatchEvent({type:"dragend",object:i}),i=null),r.style.cursor=s?"pointer":"auto")}function v(y){const b=r.getBoundingClientRect();Py.x=(y.clientX-b.left)/b.width*2-1,Py.y=-(y.clientY-b.top)/b.height*2+1}l(),this.enabled=!0,this.recursive=!0,this.transformGroup=!1,this.activate=l,this.deactivate=c,this.dispose=u,this.getObjects=d,this.getRaycaster=h}}const xz={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class hxe{constructor(e,t,r){const i=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(u){a++,s===!1&&i.onStart!==void 0&&i.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,i.onProgress!==void 0&&i.onProgress(u,o,a),o===a&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(u){i.onError!==void 0&&i.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return d!==-1&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=c.length;d<h;d+=2){const f=c[d],p=c[d+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}}const fxe=new hxe;class WR{constructor(e){this.manager=e!==void 0?e:fxe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(i,s){r.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}WR.DEFAULT_MATERIAL_NAME="__DEFAULT";function oN(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}const wz={};function lT(n){n in wz||(wz[n]=!0,console.warn(n))}class pxe extends WR{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=xz.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=oN("img");function l(){u(),xz.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(d){u(),i&&i(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class mxe{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}}const p8=300,bz=1e3,B1=1001,Sz=1002,gxe=1006,yxe=1008,vxe=1009,xxe=1023,wxe=3e3,cT=3001,uT="",dT="srgb",xs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function m8(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(xs[n&255]+xs[n>>8&255]+xs[n>>16&255]+xs[n>>24&255]+"-"+xs[e&255]+xs[e>>8&255]+"-"+xs[e>>16&15|64]+xs[e>>24&255]+"-"+xs[t&63|128]+xs[t>>8&255]+"-"+xs[t>>16&255]+xs[t>>24&255]+xs[r&255]+xs[r>>8&255]+xs[r>>16&255]+xs[r>>24&255]).toLowerCase()}function bxe(n,e,t){return Math.max(e,Math.min(t,n))}class mv{constructor(e=0,t=0){mv.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(bxe(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*r-o*i+e.x,this.y=s*i+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class m2{constructor(e,t,r,i,s,o,a,l,c){m2.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,o,a,l,c)}set(e,t,r,i,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=i,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=r,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[3],l=r[6],c=r[1],u=r[4],d=r[7],h=r[2],f=r[5],p=r[8],x=i[0],v=i[3],y=i[6],b=i[1],S=i[4],_=i[7],T=i[2],M=i[5],k=i[8];return s[0]=o*x+a*b+l*T,s[3]=o*v+a*S+l*M,s[6]=o*y+a*_+l*k,s[1]=c*x+u*b+d*T,s[4]=c*v+u*S+d*M,s[7]=c*y+u*_+d*k,s[2]=h*x+f*b+p*T,s[5]=h*v+f*S+p*M,s[8]=h*y+f*_+p*k,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-r*s*u+r*a*l+i*s*c-i*o*l}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,h=a*l-u*s,f=c*s-o*l,p=t*d+r*h+i*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/p;return e[0]=d*x,e[1]=(i*c-u*r)*x,e[2]=(a*r-i*o)*x,e[3]=h*x,e[4]=(u*t-i*l)*x,e[5]=(i*s-a*t)*x,e[6]=f*x,e[7]=(r*l-c*t)*x,e[8]=(o*t-r*s)*x,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(r*l,r*c,-r*(l*o+c*a)+o+e,-i*c,i*l,-i*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(hT.makeScale(e,t)),this}rotate(e){return this.premultiply(hT.makeRotation(-e)),this}translate(e,t){return this.premultiply(hT.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const hT=new m2;function fT(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}let Pp;class Sxe{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Pp===void 0&&(Pp=oN("canvas")),Pp.width=e.width,Pp.height=e.height;const r=Pp.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Pp}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=oN("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let o=0;o<s.length;o++)s[o]=fT(s[o]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(fT(t[r]/255)*255):t[r]=fT(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let _xe=0;class Exe{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_xe++}),this.uuid=m8(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?s.push(pT(i[o].image)):s.push(pT(i[o]))}else s=pT(i);r.url=s}return t||(e.images[this.uuid]=r),r}}function pT(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Sxe.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Cxe=0;class td extends mxe{constructor(e=td.DEFAULT_IMAGE,t=td.DEFAULT_MAPPING,r=B1,i=B1,s=gxe,o=yxe,a=xxe,l=vxe,c=td.DEFAULT_ANISOTROPY,u=uT){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Cxe++}),this.uuid=m8(),this.name="",this.source=new Exe(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new mv(0,0),this.repeat=new mv(1,1),this.center=new mv(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new m2,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof u=="string"?this.colorSpace=u:(lT("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===cT?dT:uT),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==p8)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case bz:e.x=e.x-Math.floor(e.x);break;case B1:e.x=e.x<0?0:1;break;case Sz:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case bz:e.y=e.y-Math.floor(e.y);break;case B1:e.y=e.y<0?0:1;break;case Sz:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return lT("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===dT?cT:wxe}set encoding(e){lT("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===cT?dT:uT}}td.DEFAULT_IMAGE=null;td.DEFAULT_MAPPING=p8;td.DEFAULT_ANISOTROPY=1;class Txe extends WR{constructor(e){super(e)}load(e,t,r,i){const s=new td,o=new pxe(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},r,i),s}}const Mxe=[{id:"oak_wood",name:"Дуб",type:"wood",maps:{albedo:"/textures/wood/oak/albedo.jpg",normal:"/textures/wood/oak/normal.jpg",roughness:"/textures/wood/oak/roughness.jpg",metallic:"/textures/wood/oak/metallic.jpg",ao:"/textures/wood/oak/ao.jpg",displacement:"/textures/wood/oak/displacement.jpg"},parameters:{roughness:.7,metalness:0,clearcoat:.3,clearcoatRoughness:.25,transmission:0,ior:1.5,sheen:0,sheenRoughness:0,sheenColor:"#ffffff"}},{id:"brushed_metal",name:"Металл (матовый)",type:"metal",maps:{albedo:"/textures/metal/brushed/albedo.jpg",normal:"/textures/metal/brushed/normal.jpg",roughness:"/textures/metal/brushed/roughness.jpg",metallic:"/textures/metal/brushed/metallic.jpg",ao:"/textures/metal/brushed/ao.jpg"},parameters:{roughness:.3,metalness:1,clearcoat:0,clearcoatRoughness:0,transmission:0,ior:1,sheen:0,sheenRoughness:0,sheenColor:"#ffffff"}},{id:"leather",name:"Кожа",type:"leather",maps:{albedo:"/textures/leather/classic/albedo.jpg",normal:"/textures/leather/classic/normal.jpg",roughness:"/textures/leather/classic/roughness.jpg",metallic:"/textures/leather/classic/metallic.jpg",ao:"/textures/leather/classic/ao.jpg"},parameters:{roughness:.6,metalness:0,clearcoat:.2,clearcoatRoughness:.3,transmission:0,ior:1.5,sheen:.3,sheenRoughness:.2,sheenColor:"#ffffff"}}],Axe=({onMaterialSelect:n})=>{const[e,t]=N.useState(Mxe),[r,i]=N.useState(null),[s,o]=N.useState({}),a=u=>{const d=new Txe,h={map:d.load(u.maps.albedo),normalMap:d.load(u.maps.normal),roughnessMap:d.load(u.maps.roughness),metalnessMap:d.load(u.maps.metallic),aoMap:d.load(u.maps.ao)};return u.maps.displacement&&(h.displacementMap=d.load(u.maps.displacement)),Object.values(h).forEach(p=>{p&&(p.wrapS=p.wrapT=Vm,p.repeat.set(2,2))}),new o2({...h,...u.parameters,...s,envMapIntensity:1})},l=u=>{i(u);const d=a(u);n==null||n(d)},c=(u,d)=>{if(o(h=>({...h,[u]:d})),r){const h=a(r);n==null||n(h)}};return w.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg",children:[w.jsx("h2",{className:"text-xl font-bold mb-4",children:"Материалы"}),w.jsx("div",{className:"grid grid-cols-2 gap-2 mb-4",children:e.map(u=>w.jsx("button",{onClick:()=>l(u),className:`p-2 rounded ${(r==null?void 0:r.id)===u.id?"bg-blue-500 text-white":"bg-white hover:bg-gray-200"}`,children:u.name},u.id))}),r&&w.jsxs("div",{className:"space-y-4",children:[w.jsx("h3",{className:"font-semibold",children:"Настройки материала"}),w.jsxs("div",{className:"space-y-2",children:[w.jsxs("label",{className:"block",children:["Шероховатость",w.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:s.roughness??r.parameters.roughness,onChange:u=>c("roughness",parseFloat(u.target.value)),className:"w-full"})]}),w.jsxs("label",{className:"block",children:["Металличность",w.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:s.metalness??r.parameters.metalness,onChange:u=>c("metalness",parseFloat(u.target.value)),className:"w-full"})]}),w.jsxs("label",{className:"block",children:["Прозрачность",w.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:s.transmission??r.parameters.transmission,onChange:u=>c("transmission",parseFloat(u.target.value)),className:"w-full"})]})]})]})]})},Nxe=({onSave:n,scannedPointCloud:e})=>{const t=N.useRef(null),[r,i]=N.useState(null),[s,o]=N.useState([]),[a,l]=N.useState(["wood","metal","glass","fabric"]),[c,u]=N.useState("wood"),[d,h]=N.useState(null),[f,p]=N.useState(null),[x,v]=N.useState(!1),y=N.useRef(null);N.useRef(null),N.useRef([]),N.useEffect(()=>{if(!t.current)return;const _=new Tg,T=new hi(75,window.innerWidth/window.innerHeight,.1,1e3),M=new cx({antialias:!0});M.setSize(window.innerWidth,window.innerHeight),t.current.appendChild(M.domElement);const k=new bR(16777215,.5);_.add(k);const P=new wR(16777215,.5);P.position.set(5,5,5),_.add(P);const z=new KA(T,M.domElement);T.position.z=5;const I=new mH(10,10);_.add(I),e&&_.add(e);const L=new dxe([],T,M.domElement);L.addEventListener("dragstart",()=>{z.enabled=!1}),L.addEventListener("dragend",()=>{z.enabled=!0});const W=()=>{requestAnimationFrame(W),z.update(),M.render(_,T)};W();const q=()=>{T.aspect=window.innerWidth/window.innerHeight,T.updateProjectionMatrix(),M.setSize(window.innerWidth,window.innerHeight)};return window.addEventListener("resize",q),()=>{var $;window.removeEventListener("resize",q),($=t.current)==null||$.removeChild(M.domElement)}},[e]);const b=_=>{const T={id:Date.now().toString(),type:_,position:new ie(0,0,0),rotation:new Eg(0,0,0),scale:new ie(1,1,1),material:new ec({color:65280})};o([...s,T])},S=_=>{if(p(_),r){const T={...r,material:_};i(T),o(M=>M.map(k=>k.id===r.id?T:k))}};return w.jsxs("div",{className:"flex h-full",children:[w.jsxs("div",{className:"w-64 p-4 bg-gray-100 border-r",children:[w.jsx("h2",{className:"text-xl font-bold mb-4",children:"Мебель"}),w.jsx("div",{className:"space-y-2",children:a.map(_=>w.jsx("button",{onClick:()=>b(_),className:"w-full p-2 bg-white rounded hover:bg-gray-200",children:_.charAt(0).toUpperCase()+_.slice(1)},_))}),w.jsx("div",{className:"mt-8",children:w.jsx(Axe,{onMaterialSelect:S})})]}),w.jsx("div",{className:"flex-1 relative",children:w.jsxs(UH,{camera:{position:[5,5,5],fov:75},shadows:!0,onCreated:({gl:_})=>{_.shadowMap.enabled=!0,_.shadowMap.type=Sm},children:[w.jsx("ambientLight",{intensity:.5}),w.jsx("directionalLight",{position:[10,10,5],intensity:1,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048}),w.jsx(nG,{preset:"studio"}),w.jsx(KA,{ref:y,enabled:!x,makeDefault:!0}),w.jsx("gridHelper",{args:[20,20]}),s.map(_=>w.jsx(FurnitureModel,{furniture:_,isSelected:(r==null?void 0:r.id)===_.id,onSelect:()=>i(_)},_.id))]})})]})};var kxe={};(function(){var n;function e(C){var R=0;return function(){return R<C.length?{done:!1,value:C[R++]}:{done:!0}}}var t=typeof Object.defineProperties=="function"?Object.defineProperty:function(C,R,F){return C==Array.prototype||C==Object.prototype||(C[R]=F.value),C};function r(C){C=[typeof globalThis=="object"&&globalThis,C,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pl=="object"&&Pl];for(var R=0;R<C.length;++R){var F=C[R];if(F&&F.Math==Math)return F}throw Error("Cannot find global object")}var i=r(this);function s(C,R){if(R)e:{var F=i;C=C.split(".");for(var V=0;V<C.length-1;V++){var se=C[V];if(!(se in F))break e;F=F[se]}C=C[C.length-1],V=F[C],R=R(V),R!=V&&R!=null&&t(F,C,{configurable:!0,writable:!0,value:R})}}s("Symbol",function(C){function R(ue){if(this instanceof R)throw new TypeError("Symbol is not a constructor");return new F(V+(ue||"")+"_"+se++,ue)}function F(ue,ce){this.h=ue,t(this,"description",{configurable:!0,writable:!0,value:ce})}if(C)return C;F.prototype.toString=function(){return this.h};var V="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",se=0;return R}),s("Symbol.iterator",function(C){if(C)return C;C=Symbol("Symbol.iterator");for(var R="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),F=0;F<R.length;F++){var V=i[R[F]];typeof V=="function"&&typeof V.prototype[C]!="function"&&t(V.prototype,C,{configurable:!0,writable:!0,value:function(){return o(e(this))}})}return C});function o(C){return C={next:C},C[Symbol.iterator]=function(){return this},C}function a(C){var R=typeof Symbol<"u"&&Symbol.iterator&&C[Symbol.iterator];return R?R.call(C):{next:e(C)}}function l(C){if(!(C instanceof Array)){C=a(C);for(var R,F=[];!(R=C.next()).done;)F.push(R.value);C=F}return C}var c=typeof Object.assign=="function"?Object.assign:function(C,R){for(var F=1;F<arguments.length;F++){var V=arguments[F];if(V)for(var se in V)Object.prototype.hasOwnProperty.call(V,se)&&(C[se]=V[se])}return C};s("Object.assign",function(C){return C||c});var u=typeof Object.create=="function"?Object.create:function(C){function R(){}return R.prototype=C,new R},d;if(typeof Object.setPrototypeOf=="function")d=Object.setPrototypeOf;else{var h;e:{var f={a:!0},p={};try{p.__proto__=f,h=p.a;break e}catch{}h=!1}d=h?function(C,R){if(C.__proto__=R,C.__proto__!==R)throw new TypeError(C+" is not extensible");return C}:null}var x=d;function v(C,R){if(C.prototype=u(R.prototype),C.prototype.constructor=C,x)x(C,R);else for(var F in R)if(F!="prototype")if(Object.defineProperties){var V=Object.getOwnPropertyDescriptor(R,F);V&&Object.defineProperty(C,F,V)}else C[F]=R[F];C.za=R.prototype}function y(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function b(C){if(C.m)throw new TypeError("Generator is already running");C.m=!0}y.prototype.u=function(C){this.i=C};function S(C,R){C.l={ma:R,na:!0},C.h=C.s||C.v}y.prototype.return=function(C){this.l={return:C},this.h=this.v};function _(C,R,F){return C.h=F,{value:R}}function T(C){this.h=new y,this.i=C}function M(C,R){b(C.h);var F=C.h.j;return F?k(C,"return"in F?F.return:function(V){return{value:V,done:!0}},R,C.h.return):(C.h.return(R),P(C))}function k(C,R,F,V){try{var se=R.call(C.h.j,F);if(!(se instanceof Object))throw new TypeError("Iterator result "+se+" is not an object");if(!se.done)return C.h.m=!1,se;var ue=se.value}catch(ce){return C.h.j=null,S(C.h,ce),P(C)}return C.h.j=null,V.call(C.h,ue),P(C)}function P(C){for(;C.h.h;)try{var R=C.i(C.h);if(R)return C.h.m=!1,{value:R.value,done:!1}}catch(F){C.h.i=void 0,S(C.h,F)}if(C.h.m=!1,C.h.l){if(R=C.h.l,C.h.l=null,R.na)throw R.ma;return{value:R.return,done:!0}}return{value:void 0,done:!0}}function z(C){this.next=function(R){return b(C.h),C.h.j?R=k(C,C.h.j.next,R,C.h.u):(C.h.u(R),R=P(C)),R},this.throw=function(R){return b(C.h),C.h.j?R=k(C,C.h.j.throw,R,C.h.u):(S(C.h,R),R=P(C)),R},this.return=function(R){return M(C,R)},this[Symbol.iterator]=function(){return this}}function I(C){function R(V){return C.next(V)}function F(V){return C.throw(V)}return new Promise(function(V,se){function ue(ce){ce.done?V(ce.value):Promise.resolve(ce.value).then(R,F).then(ue,se)}ue(C.next())})}function L(C){return I(new z(new T(C)))}s("Promise",function(C){function R(ce){this.i=0,this.j=void 0,this.h=[],this.u=!1;var Se=this.l();try{ce(Se.resolve,Se.reject)}catch(Pe){Se.reject(Pe)}}function F(){this.h=null}function V(ce){return ce instanceof R?ce:new R(function(Se){Se(ce)})}if(C)return C;F.prototype.i=function(ce){if(this.h==null){this.h=[];var Se=this;this.j(function(){Se.m()})}this.h.push(ce)};var se=i.setTimeout;F.prototype.j=function(ce){se(ce,0)},F.prototype.m=function(){for(;this.h&&this.h.length;){var ce=this.h;this.h=[];for(var Se=0;Se<ce.length;++Se){var Pe=ce[Se];ce[Se]=null;try{Pe()}catch(tt){this.l(tt)}}}this.h=null},F.prototype.l=function(ce){this.j(function(){throw ce})},R.prototype.l=function(){function ce(tt){return function(St){Pe||(Pe=!0,tt.call(Se,St))}}var Se=this,Pe=!1;return{resolve:ce(this.I),reject:ce(this.m)}},R.prototype.I=function(ce){if(ce===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(ce instanceof R)this.L(ce);else{e:switch(typeof ce){case"object":var Se=ce!=null;break e;case"function":Se=!0;break e;default:Se=!1}Se?this.F(ce):this.s(ce)}},R.prototype.F=function(ce){var Se=void 0;try{Se=ce.then}catch(Pe){this.m(Pe);return}typeof Se=="function"?this.M(Se,ce):this.s(ce)},R.prototype.m=function(ce){this.v(2,ce)},R.prototype.s=function(ce){this.v(1,ce)},R.prototype.v=function(ce,Se){if(this.i!=0)throw Error("Cannot settle("+ce+", "+Se+"): Promise already settled in state"+this.i);this.i=ce,this.j=Se,this.i===2&&this.K(),this.H()},R.prototype.K=function(){var ce=this;se(function(){if(ce.D()){var Se=i.console;typeof Se<"u"&&Se.error(ce.j)}},1)},R.prototype.D=function(){if(this.u)return!1;var ce=i.CustomEvent,Se=i.Event,Pe=i.dispatchEvent;return typeof Pe>"u"?!0:(typeof ce=="function"?ce=new ce("unhandledrejection",{cancelable:!0}):typeof Se=="function"?ce=new Se("unhandledrejection",{cancelable:!0}):(ce=i.document.createEvent("CustomEvent"),ce.initCustomEvent("unhandledrejection",!1,!0,ce)),ce.promise=this,ce.reason=this.j,Pe(ce))},R.prototype.H=function(){if(this.h!=null){for(var ce=0;ce<this.h.length;++ce)ue.i(this.h[ce]);this.h=null}};var ue=new F;return R.prototype.L=function(ce){var Se=this.l();ce.T(Se.resolve,Se.reject)},R.prototype.M=function(ce,Se){var Pe=this.l();try{ce.call(Se,Pe.resolve,Pe.reject)}catch(tt){Pe.reject(tt)}},R.prototype.then=function(ce,Se){function Pe(Zt,yt){return typeof Zt=="function"?function(Yt){try{tt(Zt(Yt))}catch(Gt){St(Gt)}}:yt}var tt,St,un=new R(function(Zt,yt){tt=Zt,St=yt});return this.T(Pe(ce,tt),Pe(Se,St)),un},R.prototype.catch=function(ce){return this.then(void 0,ce)},R.prototype.T=function(ce,Se){function Pe(){switch(tt.i){case 1:ce(tt.j);break;case 2:Se(tt.j);break;default:throw Error("Unexpected state: "+tt.i)}}var tt=this;this.h==null?ue.i(Pe):this.h.push(Pe),this.u=!0},R.resolve=V,R.reject=function(ce){return new R(function(Se,Pe){Pe(ce)})},R.race=function(ce){return new R(function(Se,Pe){for(var tt=a(ce),St=tt.next();!St.done;St=tt.next())V(St.value).T(Se,Pe)})},R.all=function(ce){var Se=a(ce),Pe=Se.next();return Pe.done?V([]):new R(function(tt,St){function un(Yt){return function(Gt){Zt[Yt]=Gt,yt--,yt==0&&tt(Zt)}}var Zt=[],yt=0;do Zt.push(void 0),yt++,V(Pe.value).T(un(Zt.length-1),St),Pe=Se.next();while(!Pe.done)})},R});function W(C,R){C instanceof String&&(C+="");var F=0,V=!1,se={next:function(){if(!V&&F<C.length){var ue=F++;return{value:R(ue,C[ue]),done:!1}}return V=!0,{done:!0,value:void 0}}};return se[Symbol.iterator]=function(){return se},se}s("Array.prototype.keys",function(C){return C||function(){return W(this,function(R){return R})}}),s("Array.prototype.fill",function(C){return C||function(R,F,V){var se=this.length||0;for(0>F&&(F=Math.max(0,se+F)),(V==null||V>se)&&(V=se),V=Number(V),0>V&&(V=Math.max(0,se+V)),F=Number(F||0);F<V;F++)this[F]=R;return this}});function q(C){return C||Array.prototype.fill}s("Int8Array.prototype.fill",q),s("Uint8Array.prototype.fill",q),s("Uint8ClampedArray.prototype.fill",q),s("Int16Array.prototype.fill",q),s("Uint16Array.prototype.fill",q),s("Int32Array.prototype.fill",q),s("Uint32Array.prototype.fill",q),s("Float32Array.prototype.fill",q),s("Float64Array.prototype.fill",q),s("Object.is",function(C){return C||function(R,F){return R===F?R!==0||1/R===1/F:R!==R&&F!==F}}),s("Array.prototype.includes",function(C){return C||function(R,F){var V=this;V instanceof String&&(V=String(V));var se=V.length;for(F=F||0,0>F&&(F=Math.max(F+se,0));F<se;F++){var ue=V[F];if(ue===R||Object.is(ue,R))return!0}return!1}}),s("String.prototype.includes",function(C){return C||function(R,F){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(R instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(R,F||0)!==-1}});var $=this||self;function ne(C,R){C=C.split(".");var F=$;C[0]in F||typeof F.execScript>"u"||F.execScript("var "+C[0]);for(var V;C.length&&(V=C.shift());)C.length||R===void 0?F[V]&&F[V]!==Object.prototype[V]?F=F[V]:F=F[V]={}:F[V]=R}function Y(C){var R;e:{if((R=$.navigator)&&(R=R.userAgent))break e;R=""}return R.indexOf(C)!=-1}var we=Array.prototype.map?function(C,R){return Array.prototype.map.call(C,R,void 0)}:function(C,R){for(var F=C.length,V=Array(F),se=typeof C=="string"?C.split(""):C,ue=0;ue<F;ue++)ue in se&&(V[ue]=R.call(void 0,se[ue],ue,C));return V},H={},X=null;function oe(C){var R=C.length,F=3*R/4;F%3?F=Math.floor(F):"=.".indexOf(C[R-1])!=-1&&(F="=.".indexOf(C[R-2])!=-1?F-2:F-1);var V=new Uint8Array(F),se=0;return ve(C,function(ue){V[se++]=ue}),se!==F?V.subarray(0,se):V}function ve(C,R){function F(Pe){for(;V<C.length;){var tt=C.charAt(V++),St=X[tt];if(St!=null)return St;if(!/^[\s\xa0]*$/.test(tt))throw Error("Unknown base64 encoding at char: "+tt)}return Pe}Te();for(var V=0;;){var se=F(-1),ue=F(0),ce=F(64),Se=F(64);if(Se===64&&se===-1)break;R(se<<2|ue>>4),ce!=64&&(R(ue<<4&240|ce>>2),Se!=64&&R(ce<<6&192|Se))}}function Te(){if(!X){X={};for(var C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),R=["+/=","+/","-_=","-_.","-_"],F=0;5>F;F++){var V=C.concat(R[F].split(""));H[F]=V;for(var se=0;se<V.length;se++){var ue=V[se];X[ue]===void 0&&(X[ue]=se)}}}}var Xe=typeof Uint8Array<"u",_e=!(Y("Trident")||Y("MSIE"))&&typeof $.btoa=="function";function Ue(C){if(!_e){var R;R===void 0&&(R=0),Te(),R=H[R];for(var F=Array(Math.floor(C.length/3)),V=R[64]||"",se=0,ue=0;se<C.length-2;se+=3){var ce=C[se],Se=C[se+1],Pe=C[se+2],tt=R[ce>>2];ce=R[(ce&3)<<4|Se>>4],Se=R[(Se&15)<<2|Pe>>6],Pe=R[Pe&63],F[ue++]=tt+ce+Se+Pe}switch(tt=0,Pe=V,C.length-se){case 2:tt=C[se+1],Pe=R[(tt&15)<<2]||V;case 1:C=C[se],F[ue]=R[C>>2]+R[(C&3)<<4|tt>>4]+Pe+V}return F.join("")}for(R="";10240<C.length;)R+=String.fromCharCode.apply(null,C.subarray(0,10240)),C=C.subarray(10240);return R+=String.fromCharCode.apply(null,C),btoa(R)}var Fe=RegExp("[-_.]","g");function Oe(C){switch(C){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function nt(C){if(!_e)return oe(C);Fe.test(C)&&(C=C.replace(Fe,Oe)),C=atob(C);for(var R=new Uint8Array(C.length),F=0;F<C.length;F++)R[F]=C.charCodeAt(F);return R}var rt;function ut(){return rt||(rt=new Uint8Array(0))}var Qe={},ae=typeof Uint8Array.prototype.slice=="function",ze=0,Re=0;function Je(C){var R=0>C;C=Math.abs(C);var F=C>>>0;C=Math.floor((C-F)/4294967296),R&&(F=a(Et(F,C)),R=F.next().value,C=F.next().value,F=R),ze=F>>>0,Re=C>>>0}var Ge=typeof BigInt=="function";function Et(C,R){return R=~R,C?C=~C+1:R+=1,[C,R]}function pt(C,R){this.i=C>>>0,this.h=R>>>0}function Q(C){if(!C)return G||(G=new pt(0,0));if(!/^-?\d+$/.test(C))return null;if(16>C.length)Je(Number(C));else if(Ge)C=BigInt(C),ze=Number(C&BigInt(4294967295))>>>0,Re=Number(C>>BigInt(32)&BigInt(4294967295));else{var R=+(C[0]==="-");Re=ze=0;for(var F=C.length,V=R,se=(F-R)%6+R;se<=F;V=se,se+=6)V=Number(C.slice(V,se)),Re*=1e6,ze=1e6*ze+V,4294967296<=ze&&(Re+=ze/4294967296|0,ze%=4294967296);R&&(R=a(Et(ze,Re)),C=R.next().value,R=R.next().value,ze=C,Re=R)}return new pt(ze,Re)}var G;function ke(C,R){return Error("Invalid wire type: "+C+" (at position "+R+")")}function J(){return Error("Failed to read varint, encoding is invalid.")}function he(C,R){return Error("Tried to read past the end of the data "+R+" > "+C)}function ee(){throw Error("Invalid UTF8")}function Ee(C,R){return R=String.fromCharCode.apply(null,R),C==null?R:C+R}var Me=void 0,Ae,Be=typeof TextDecoder<"u",dt,We=typeof TextEncoder<"u",Kt;function cn(C){if(C!==Qe)throw Error("illegal external caller")}function jt(C,R){if(cn(R),this.V=C,C!=null&&C.length===0)throw Error("ByteString should be constructed with non-empty values")}function wt(){return Kt||(Kt=new jt(null,Qe))}function Mt(C){cn(Qe);var R=C.V;return R=R==null||Xe&&R!=null&&R instanceof Uint8Array?R:typeof R=="string"?nt(R):null,R==null?R:C.V=R}function ye(C){if(typeof C=="string")return{buffer:nt(C),C:!1};if(Array.isArray(C))return{buffer:new Uint8Array(C),C:!1};if(C.constructor===Uint8Array)return{buffer:C,C:!1};if(C.constructor===ArrayBuffer)return{buffer:new Uint8Array(C),C:!1};if(C.constructor===jt)return{buffer:Mt(C)||ut(),C:!0};if(C instanceof Uint8Array)return{buffer:new Uint8Array(C.buffer,C.byteOffset,C.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function He(C,R){this.i=null,this.m=!1,this.h=this.j=this.l=0,st(this,C,R)}function st(C,R,F){F=F===void 0?{}:F,C.S=F.S===void 0?!1:F.S,R&&(R=ye(R),C.i=R.buffer,C.m=R.C,C.l=0,C.j=C.i.length,C.h=C.l)}He.prototype.reset=function(){this.h=this.l};function _t(C,R){if(C.h=R,R>C.j)throw he(C.j,R)}function Ye(C){var R=C.i,F=C.h,V=R[F++],se=V&127;if(V&128&&(V=R[F++],se|=(V&127)<<7,V&128&&(V=R[F++],se|=(V&127)<<14,V&128&&(V=R[F++],se|=(V&127)<<21,V&128&&(V=R[F++],se|=V<<28,V&128&&R[F++]&128&&R[F++]&128&&R[F++]&128&&R[F++]&128&&R[F++]&128)))))throw J();return _t(C,F),se}function fe(C,R){if(0>R)throw Error("Tried to read a negative byte length: "+R);var F=C.h,V=F+R;if(V>C.j)throw he(R,C.j-F);return C.h=V,F}var ot=[];function ht(){this.h=[]}ht.prototype.length=function(){return this.h.length},ht.prototype.end=function(){var C=this.h;return this.h=[],C};function Bt(C,R,F){for(;0<F||127<R;)C.h.push(R&127|128),R=(R>>>7|F<<25)>>>0,F>>>=7;C.h.push(R)}function Pt(C,R){for(;127<R;)C.h.push(R&127|128),R>>>=7;C.h.push(R)}function xn(C,R){if(ot.length){var F=ot.pop();st(F,C,R),C=F}else C=new He(C,R);this.h=C,this.j=this.h.h,this.i=this.l=-1,this.setOptions(R)}xn.prototype.setOptions=function(C){C=C===void 0?{}:C,this.ca=C.ca===void 0?!1:C.ca},xn.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function Dn(C){var R=C.h;if(R.h==R.j)return!1;C.j=C.h.h;var F=Ye(C.h)>>>0;if(R=F>>>3,F&=7,!(0<=F&&5>=F))throw ke(F,C.j);if(1>R)throw Error("Invalid field number: "+R+" (at position "+C.j+")");return C.l=R,C.i=F,!0}function ir(C){switch(C.i){case 0:if(C.i!=0)ir(C);else e:{C=C.h;for(var R=C.h,F=R+10,V=C.i;R<F;)if(!(V[R++]&128)){_t(C,R);break e}throw J()}break;case 1:C=C.h,_t(C,C.h+8);break;case 2:C.i!=2?ir(C):(R=Ye(C.h)>>>0,C=C.h,_t(C,C.h+R));break;case 5:C=C.h,_t(C,C.h+4);break;case 3:R=C.l;do{if(!Dn(C))throw Error("Unmatched start-group tag: stream EOF");if(C.i==4){if(C.l!=R)throw Error("Unmatched end-group tag");break}ir(C)}while(!0);break;default:throw ke(C.i,C.j)}}var wr=[];function Wn(){this.j=[],this.i=0,this.h=new ht}function kr(C,R){R.length!==0&&(C.j.push(R),C.i+=R.length)}function cs(C,R){if(R=R.R){kr(C,C.h.end());for(var F=0;F<R.length;F++)kr(C,Mt(R[F])||ut())}}var bi=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function Is(C,R){return bi?C[bi]|=R:C.A!==void 0?C.A|=R:(Object.defineProperties(C,{A:{value:R,configurable:!0,writable:!0,enumerable:!1}}),R)}function Rs(C,R){bi?C[bi]&&(C[bi]&=~R):C.A!==void 0&&(C.A&=~R)}function Xn(C){var R;return bi?R=C[bi]:R=C.A,R??0}function ln(C,R){bi?C[bi]=R:C.A!==void 0?C.A=R:Object.defineProperties(C,{A:{value:R,configurable:!0,writable:!0,enumerable:!1}})}function Ra(C){return Is(C,1),C}function tu(C,R){ln(R,(C|0)&-51)}function j(C,R){ln(R,(C|18)&-41)}var Z={};function xe(C){return C!==null&&typeof C=="object"&&!Array.isArray(C)&&C.constructor===Object}var B,re=[];ln(re,23),B=Object.freeze(re);function le(C){if(Xn(C.o)&2)throw Error("Cannot mutate an immutable Message")}function me(C){var R=C.length;(R=R?C[R-1]:void 0)&&xe(R)?R.g=1:(R={},C.push((R.g=1,R)))}function pe(C){var R=C.i+C.G;return C.B||(C.B=C.o[R]={})}function Ie(C,R){return R===-1?null:R>=C.i?C.B?C.B[R]:void 0:C.o[R+C.G]}function Le(C,R,F,V){le(C),$e(C,R,F,V)}function $e(C,R,F,V){C.j&&(C.j=void 0),R>=C.i||V?pe(C)[R]=F:(C.o[R+C.G]=F,(C=C.B)&&R in C&&delete C[R])}function je(C,R,F,V){var se=Ie(C,R);Array.isArray(se)||(se=B);var ue=Xn(se);if(ue&1||Ra(se),V)ue&2||Is(se,2),F&1||Object.freeze(se);else{V=!(F&2);var ce=ue&2;F&1||!ce?V&&ue&16&&!ce&&Rs(se,16):(se=Ra(Array.prototype.slice.call(se)),$e(C,R,se))}return se}function Dt(C,R){var F=Ie(C,R),V=F==null?F:typeof F=="number"||F==="NaN"||F==="Infinity"||F==="-Infinity"?Number(F):void 0;return V!=null&&V!==F&&$e(C,R,V),V}function et(C,R,F,V,se){C.h||(C.h={});var ue=C.h[F],ce=je(C,F,3,se);if(!ue){var Se=ce;ue=[];var Pe=!!(Xn(C.o)&16);ce=!!(Xn(Se)&2);var tt=Se;!se&&ce&&(Se=Array.prototype.slice.call(Se));for(var St=ce,un=0;un<Se.length;un++){var Zt=Se[un],yt=R,Yt=!1;if(Yt=Yt===void 0?!1:Yt,Zt=Array.isArray(Zt)?new yt(Zt):Yt?new yt:void 0,Zt!==void 0){yt=Zt.o;var Gt=Yt=Xn(yt);ce&&(Gt|=2),Pe&&(Gt|=16),Gt!=Yt&&ln(yt,Gt),yt=Gt,St=St||!!(2&yt),ue.push(Zt)}}return C.h[F]=ue,Pe=Xn(Se),R=Pe|33,R=St?R&-9:R|8,Pe!=R&&(St=Se,Object.isFrozen(St)&&(St=Array.prototype.slice.call(St)),ln(St,R),Se=St),tt!==Se&&$e(C,F,Se),(se||V&&ce)&&Is(ue,2),V&&Object.freeze(ue),ue}return se||(se=Object.isFrozen(ue),V&&!se?Object.freeze(ue):!V&&se&&(ue=Array.prototype.slice.call(ue),C.h[F]=ue)),ue}function it(C,R,F){var V=!!(Xn(C.o)&2);if(R=et(C,R,F,V,V),C=je(C,F,3,V),!(V||Xn(C)&8)){for(V=0;V<R.length;V++){if(F=R[V],Xn(F.o)&2){var se=Nn(F,!1);se.j=F}else se=F;F!==se&&(R[V]=se,C[V]=se.o)}Is(C,8)}return R}function At(C,R,F){if(F!=null&&typeof F!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof F+": "+F);Le(C,R,F)}function en(C,R,F,V,se){le(C);var ue=et(C,F,R,!1,!1);return F=V??new F,C=je(C,R,2,!1),se!=null?(ue.splice(se,0,F),C.splice(se,0,F.o)):(ue.push(F),C.push(F.o)),F.C()&&Rs(C,8),F}function tn(C,R){return C??R}function on(C,R,F){return F=F===void 0?0:F,tn(Dt(C,R),F)}var It;function bt(C){switch(typeof C){case"number":return isFinite(C)?C:String(C);case"object":if(C)if(Array.isArray(C)){if(Xn(C)&128)return C=Array.prototype.slice.call(C),me(C),C}else{if(Xe&&C!=null&&C instanceof Uint8Array)return Ue(C);if(C instanceof jt){var R=C.V;return R==null?"":typeof R=="string"?R:C.V=Ue(R)}}}return C}function Cn(C,R,F,V){if(C!=null){if(Array.isArray(C))C=an(C,R,F,V!==void 0);else if(xe(C)){var se={},ue;for(ue in C)se[ue]=Cn(C[ue],R,F,V);C=se}else C=R(C,V);return C}}function an(C,R,F,V){var se=Xn(C);V=V?!!(se&16):void 0,C=Array.prototype.slice.call(C);for(var ue=0;ue<C.length;ue++)C[ue]=Cn(C[ue],R,F,V);return F(se,C),C}function fn(C){return C.ja===Z?C.toJSON():bt(C)}function ur(C,R){C&128&&me(R)}function zr(C,R,F){if(F=F===void 0?j:F,C!=null){if(Xe&&C instanceof Uint8Array)return C.length?new jt(new Uint8Array(C),Qe):wt();if(Array.isArray(C)){var V=Xn(C);return V&2?C:R&&!(V&32)&&(V&16||V===0)?(ln(C,V|2),C):(C=an(C,zr,V&4?j:F,!0),R=Xn(C),R&4&&R&2&&Object.freeze(C),C)}return C.ja===Z?Hn(C):C}}function Tr(C,R,F,V,se,ue,ce){if(C=C.h&&C.h[F]){if(V=Xn(C),V&2?V=C:(ue=we(C,Hn),j(V,ue),Object.freeze(ue),V=ue),le(R),ce=V==null?B:Ra([]),V!=null){for(ue=!!V.length,C=0;C<V.length;C++){var Se=V[C];ue=ue&&!(Xn(Se.o)&2),ce[C]=Se.o}ue=(ue?8:0)|1,C=Xn(ce),(C&ue)!==ue&&(Object.isFrozen(ce)&&(ce=Array.prototype.slice.call(ce)),ln(ce,C|ue)),R.h||(R.h={}),R.h[F]=V}else R.h&&(R.h[F]=void 0);$e(R,F,ce,se)}else Le(R,F,zr(V,ue,ce),se)}function Hn(C){return Xn(C.o)&2||(C=Nn(C,!0),Is(C.o,2)),C}function Nn(C,R){var F=C.o,V=[];Is(V,16);var se=C.constructor.h;if(se&&V.push(se),se=C.B,se){V.length=F.length,V.fill(void 0,V.length,F.length);var ue={};V[V.length-1]=ue}Xn(F)&128&&me(V),R=R||C.C()?j:tu,ue=C.constructor,It=V,V=new ue(V),It=void 0,C.R&&(V.R=C.R.slice()),ue=!!(Xn(F)&16);for(var ce=se?F.length-1:F.length,Se=0;Se<ce;Se++)Tr(C,V,Se-C.G,F[Se],!1,ue,R);if(se)for(var Pe in se)Tr(C,V,+Pe,se[Pe],!0,ue,R);return V}function $n(C,R,F){C==null&&(C=It),It=void 0;var V=this.constructor.i||0,se=0<V,ue=this.constructor.h,ce=!1;if(C==null){C=ue?[ue]:[];var Se=48,Pe=!0;se&&(V=0,Se|=128),ln(C,Se)}else{if(!Array.isArray(C)||ue&&ue!==C[0])throw Error();var tt=Se=Is(C,0);if((Pe=(16&tt)!==0)&&((ce=(32&tt)!==0)||(tt|=32)),se){if(128&tt)V=0;else if(0<C.length){var St=C[C.length-1];if(xe(St)&&"g"in St){V=0,tt|=128,delete St.g;var un=!0,Zt;for(Zt in St){un=!1;break}un&&C.pop()}}}else if(128&tt)throw Error();Se!==tt&&ln(C,tt)}this.G=(ue?0:-1)-V,this.h=void 0,this.o=C;e:{if(ue=this.o.length,V=ue-1,ue&&(ue=this.o[V],xe(ue))){this.B=ue,this.i=V-this.G;break e}R!==void 0&&-1<R?(this.i=Math.max(R,V+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!se&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(F){R=Pe&&!ce&&!0,se=this.i;var yt;for(Pe=0;Pe<F.length;Pe++)ce=F[Pe],ce<se?(ce+=this.G,(V=C[ce])?bn(V,R):C[ce]=B):(yt||(yt=pe(this)),(V=yt[ce])?bn(V,R):yt[ce]=B)}}$n.prototype.toJSON=function(){return an(this.o,fn,ur)},$n.prototype.C=function(){return!!(Xn(this.o)&2)};function bn(C,R){if(Array.isArray(C)){var F=Xn(C),V=1;!R||F&2||(V|=16),(F&V)!==V&&ln(C,F|V)}}$n.prototype.ja=Z,$n.prototype.toString=function(){return this.o.toString()};function Un(C,R,F){if(F){var V={},se;for(se in F){var ue=F[se],ce=ue.ra;ce||(V.J=ue.xa||ue.oa.W,ue.ia?(V.aa=Cx(ue.ia),ce=function(Se){return function(Pe,tt,St){return Se.J(Pe,tt,St,Se.aa)}}(V)):ue.ka?(V.Z=Tx(ue.da.P,ue.ka),ce=function(Se){return function(Pe,tt,St){return Se.J(Pe,tt,St,Se.Z)}}(V)):ce=V.J,ue.ra=ce),ce(R,C,ue.da),V={J:V.J,aa:V.aa,Z:V.Z}}}cs(R,C)}var dr=Symbol();function Ps(C,R,F){return C[dr]||(C[dr]=function(V,se){return R(V,se,F)})}function Vi(C){var R=C[dr];if(!R){var F=ai(C);R=function(V,se){return Bf(V,se,F)},C[dr]=R}return R}function na(C){var R=C.ia;if(R)return Vi(R);if(R=C.wa)return Ps(C.da.P,R,C.ka)}function Uf(C){var R=na(C),F=C.da,V=C.oa.U;return R?function(se,ue){return V(se,ue,F,R)}:function(se,ue){return V(se,ue,F)}}function Od(C,R){var F=C[R];return typeof F=="function"&&F.length===0&&(F=F(),C[R]=F),Array.isArray(F)&&(ru in F||ic in F||0<F.length&&typeof F[0]=="function")?F:void 0}function nu(C,R,F,V,se,ue){R.P=C[0];var ce=1;if(C.length>ce&&typeof C[ce]!="number"){var Se=C[ce++];F(R,Se)}for(;ce<C.length;){F=C[ce++];for(var Pe=ce+1;Pe<C.length&&typeof C[Pe]!="number";)Pe++;switch(Se=C[ce++],Pe-=ce,Pe){case 0:V(R,F,Se);break;case 1:(Pe=Od(C,ce))?(ce++,se(R,F,Se,Pe)):V(R,F,Se,C[ce++]);break;case 2:Pe=ce++,Pe=Od(C,Pe),se(R,F,Se,Pe,C[ce++]);break;case 3:ue(R,F,Se,C[ce++],C[ce++],C[ce++]);break;case 4:ue(R,F,Se,C[ce++],C[ce++],C[ce++],C[ce++]);break;default:throw Error("unexpected number of binary field arguments: "+Pe)}}return R}var rc=Symbol();function Cx(C){var R=C[rc];if(!R){var F=Kn(C);R=function(V,se){return Ax(V,se,F)},C[rc]=R}return R}function Tx(C,R){var F=C[rc];return F||(F=function(V,se){return Un(V,se,R)},C[rc]=F),F}var ic=Symbol();function Fg(C,R){C.push(R)}function Fd(C,R,F){C.push(R,F.W)}function R2(C,R,F,V){var se=Cx(V),ue=Kn(V).P,ce=F.W;C.push(R,function(Se,Pe,tt){return ce(Se,Pe,tt,ue,se)})}function zg(C,R,F,V,se,ue){var ce=Tx(V,ue),Se=F.W;C.push(R,function(Pe,tt,St){return Se(Pe,tt,St,V,ce)})}function Kn(C){var R=C[ic];return R||(R=nu(C,C[ic]=[],Fg,Fd,R2,zg),ru in C&&ic in C&&(C.length=0),R)}var ru=Symbol();function Ug(C,R){C[0]=R}function Mx(C,R,F,V){var se=F.U;C[R]=V?function(ue,ce,Se){return se(ue,ce,Se,V)}:se}function P2(C,R,F,V,se){var ue=F.U,ce=Vi(V),Se=ai(V).P;C[R]=function(Pe,tt,St){return ue(Pe,tt,St,Se,ce,se)}}function D2(C,R,F,V,se,ue,ce){var Se=F.U,Pe=Ps(V,se,ue);C[R]=function(tt,St,un){return Se(tt,St,un,V,Pe,ce)}}function ai(C){var R=C[ru];return R||(R=nu(C,C[ru]={},Ug,Mx,P2,D2),ru in C&&ic in C&&(C.length=0),R)}function Bf(C,R,F){for(;Dn(R)&&R.i!=4;){var V=R.l,se=F[V];if(!se){var ue=F[0];ue&&(ue=ue[V])&&(se=F[V]=Uf(ue))}if(!se||!se(R,C,V)){se=R,V=C,ue=se.j,ir(se);var ce=se;if(!ce.ca){if(se=ce.h.h-ue,ce.h.h=ue,ce=ce.h,se==0)se=wt();else{if(ue=fe(ce,se),ce.S&&ce.m)se=ce.i.subarray(ue,ue+se);else{ce=ce.i;var Se=ue;se=ue+se,se=Se===se?ut():ae?ce.slice(Se,se):new Uint8Array(ce.subarray(Se,se))}se=se.length==0?wt():new jt(se,Qe)}(ue=V.R)?ue.push(se):V.R=[se]}}}return C}function Ax(C,R,F){for(var V=F.length,se=V%2==1,ue=se?1:0;ue<V;ue+=2)(0,F[ue+1])(R,C,F[ue]);Un(C,R,se?F[0]:void 0)}function sc(C,R){return{U:C,W:R}}var Mo=sc(function(C,R,F){if(C.i!==5)return!1;C=C.h;var V=C.i,se=C.h,ue=V[se],ce=V[se+1],Se=V[se+2];return V=V[se+3],_t(C,C.h+4),ce=(ue<<0|ce<<8|Se<<16|V<<24)>>>0,C=2*(ce>>31)+1,ue=ce>>>23&255,ce&=8388607,Le(R,F,ue==255?ce?NaN:1/0*C:ue==0?C*Math.pow(2,-149)*ce:C*Math.pow(2,ue-150)*(ce+Math.pow(2,23))),!0},function(C,R,F){if(R=Dt(R,F),R!=null){Pt(C.h,8*F+5),C=C.h;var V=+R;V===0?0<1/V?ze=Re=0:(Re=0,ze=2147483648):isNaN(V)?(Re=0,ze=2147483647):(V=(F=0>V?-2147483648:0)?-V:V,34028234663852886e22<V?(Re=0,ze=(F|2139095040)>>>0):11754943508222875e-54>V?(V=Math.round(V/Math.pow(2,-149)),Re=0,ze=(F|V)>>>0):(R=Math.floor(Math.log(V)/Math.LN2),V*=Math.pow(2,-R),V=Math.round(8388608*V),16777216<=V&&++R,Re=0,ze=(F|R+127<<23|V&8388607)>>>0)),F=ze,C.h.push(F>>>0&255),C.h.push(F>>>8&255),C.h.push(F>>>16&255),C.h.push(F>>>24&255)}}),$f=sc(function(C,R,F){if(C.i!==0)return!1;var V=C.h,se=0,ue=C=0,ce=V.i,Se=V.h;do{var Pe=ce[Se++];se|=(Pe&127)<<ue,ue+=7}while(32>ue&&Pe&128);for(32<ue&&(C|=(Pe&127)>>4),ue=3;32>ue&&Pe&128;ue+=7)Pe=ce[Se++],C|=(Pe&127)<<ue;if(_t(V,Se),128>Pe)V=se>>>0,Pe=C>>>0,(C=Pe&2147483648)&&(V=~V+1>>>0,Pe=~Pe>>>0,V==0&&(Pe=Pe+1>>>0)),V=4294967296*Pe+(V>>>0);else throw J();return Le(R,F,C?-V:V),!0},function(C,R,F){R=Ie(R,F),R!=null&&(typeof R=="string"&&Q(R),R!=null&&(Pt(C.h,8*F),typeof R=="number"?(C=C.h,Je(R),Bt(C,ze,Re)):(F=Q(R),Bt(C.h,F.i,F.h))))}),ra=sc(function(C,R,F){return C.i!==0?!1:(Le(R,F,Ye(C.h)),!0)},function(C,R,F){if(R=Ie(R,F),R!=null&&R!=null)if(Pt(C.h,8*F),C=C.h,F=R,0<=F)Pt(C,F);else{for(R=0;9>R;R++)C.h.push(F&127|128),F>>=7;C.h.push(1)}}),Nx=sc(function(C,R,F){if(C.i!==2)return!1;var V=Ye(C.h)>>>0;C=C.h;var se=fe(C,V);if(C=C.i,Be){var ue=C,ce;(ce=Ae)||(ce=Ae=new TextDecoder("utf-8",{fatal:!0})),C=se+V,ue=se===0&&C===ue.length?ue:ue.subarray(se,C);try{var Se=ce.decode(ue)}catch(un){if(Me===void 0){try{ce.decode(new Uint8Array([128]))}catch{}try{ce.decode(new Uint8Array([97])),Me=!0}catch{Me=!1}}throw!Me&&(Ae=void 0),un}}else{Se=se,V=Se+V,se=[];for(var Pe=null,tt,St;Se<V;)tt=C[Se++],128>tt?se.push(tt):224>tt?Se>=V?ee():(St=C[Se++],194>tt||(St&192)!==128?(Se--,ee()):se.push((tt&31)<<6|St&63)):240>tt?Se>=V-1?ee():(St=C[Se++],(St&192)!==128||tt===224&&160>St||tt===237&&160<=St||((ue=C[Se++])&192)!==128?(Se--,ee()):se.push((tt&15)<<12|(St&63)<<6|ue&63)):244>=tt?Se>=V-2?ee():(St=C[Se++],(St&192)!==128||(tt<<28)+(St-144)>>30||((ue=C[Se++])&192)!==128||((ce=C[Se++])&192)!==128?(Se--,ee()):(tt=(tt&7)<<18|(St&63)<<12|(ue&63)<<6|ce&63,tt-=65536,se.push((tt>>10&1023)+55296,(tt&1023)+56320))):ee(),8192<=se.length&&(Pe=Ee(Pe,se),se.length=0);Se=Ee(Pe,se)}return Le(R,F,Se),!0},function(C,R,F){if(R=Ie(R,F),R!=null){var V=!1;if(V=V===void 0?!1:V,We){if(V&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(R))throw Error("Found an unpaired surrogate");R=(dt||(dt=new TextEncoder)).encode(R)}else{for(var se=0,ue=new Uint8Array(3*R.length),ce=0;ce<R.length;ce++){var Se=R.charCodeAt(ce);if(128>Se)ue[se++]=Se;else{if(2048>Se)ue[se++]=Se>>6|192;else{if(55296<=Se&&57343>=Se){if(56319>=Se&&ce<R.length){var Pe=R.charCodeAt(++ce);if(56320<=Pe&&57343>=Pe){Se=1024*(Se-55296)+Pe-56320+65536,ue[se++]=Se>>18|240,ue[se++]=Se>>12&63|128,ue[se++]=Se>>6&63|128,ue[se++]=Se&63|128;continue}else ce--}if(V)throw Error("Found an unpaired surrogate");Se=65533}ue[se++]=Se>>12|224,ue[se++]=Se>>6&63|128}ue[se++]=Se&63|128}}R=se===ue.length?ue:ue.subarray(0,se)}Pt(C.h,8*F+2),Pt(C.h,R.length),kr(C,C.h.end()),kr(C,R)}}),kx=sc(function(C,R,F,V,se){if(C.i!==2)return!1;R=en(R,F,V),F=C.h.j,V=Ye(C.h)>>>0;var ue=C.h.h+V,ce=ue-F;if(0>=ce&&(C.h.j=ue,se(R,C,void 0,void 0,void 0),ce=ue-C.h.h),ce)throw Error("Message parsing ended unexpectedly. Expected to read "+(V+" bytes, instead read "+(V-ce)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return C.h.h=ue,C.h.j=F,!0},function(C,R,F,V,se){if(R=it(R,V,F),R!=null)for(V=0;V<R.length;V++){var ue=C;Pt(ue.h,8*F+2);var ce=ue.h.end();kr(ue,ce),ce.push(ue.i),ue=ce,se(R[V],C),ce=C;var Se=ue.pop();for(Se=ce.i+ce.h.length()-Se;127<Se;)ue.push(Se&127|128),Se>>>=7,ce.i++;ue.push(Se),ce.i++}});function so(C){return function(R,F){e:{if(wr.length){var V=wr.pop();V.setOptions(F),st(V.h,R,F),R=V}else R=new xn(R,F);try{var se=ai(C),ue=Bf(new se.P,R,se);break e}finally{se=R.h,se.i=null,se.m=!1,se.l=0,se.j=0,se.h=0,se.S=!1,R.l=-1,R.i=-1,100>wr.length&&wr.push(R)}ue=void 0}return ue}}function Ao(C){return function(){var R=new Wn;Ax(this,R,Kn(C)),kr(R,R.h.end());for(var F=new Uint8Array(R.i),V=R.j,se=V.length,ue=0,ce=0;ce<se;ce++){var Se=V[ce];F.set(Se,ue),ue+=Se.length}return R.j=[F],F}}function Pa(C){$n.call(this,C)}v(Pa,$n);var jf=[Pa,1,ra,2,Mo,3,Nx,4,Nx];Pa.prototype.l=Ao(jf);function Vf(C){$n.call(this,C,-1,L2)}v(Vf,$n),Vf.prototype.addClassification=function(C,R){return en(this,1,Pa,C,R),this};var L2=[1],ia=so([Vf,1,kx,jf]);function zd(C){$n.call(this,C)}v(zd,$n);var Ud=[zd,1,Mo,2,Mo,3,Mo,4,Mo,5,Mo];zd.prototype.l=Ao(Ud);function Ix(C){$n.call(this,C,-1,No)}v(Ix,$n);var No=[1],Wf=so([Ix,1,kx,Ud]);function oc(C){$n.call(this,C)}v(oc,$n);var ac=[oc,1,Mo,2,Mo,3,Mo,4,Mo,5,Mo,6,$f],Bg=so(ac);oc.prototype.l=Ao(ac);function Hf(C,R,F){if(F=C.createShader(F===0?C.VERTEX_SHADER:C.FRAGMENT_SHADER),C.shaderSource(F,R),C.compileShader(F),!C.getShaderParameter(F,C.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+C.getShaderInfoLog(F));return F}function Rx(C){return it(C,Pa,1).map(function(R){var F=Ie(R,1);return{index:F??0,qa:on(R,2),label:Ie(R,3)!=null?tn(Ie(R,3),""):void 0,displayName:Ie(R,4)!=null?tn(Ie(R,4),""):void 0}})}function $g(C){return{x:on(C,1),y:on(C,2),z:on(C,3),visibility:Dt(C,4)!=null?on(C,4):void 0}}function Bd(C){return it(Wf(C),zd,1).map($g)}function fl(C,R){this.i=C,this.h=R,this.m=0}function Ds(C,R,F){return sa(C,R),typeof C.h.canvas.transferToImageBitmap=="function"?Promise.resolve(C.h.canvas.transferToImageBitmap()):F?Promise.resolve(C.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(C.h.canvas):(C.j===void 0&&(C.j=document.createElement("canvas")),new Promise(function(V){C.j.height=C.h.canvas.height,C.j.width=C.h.canvas.width,C.j.getContext("2d",{}).drawImage(C.h.canvas,0,0,C.h.canvas.width,C.h.canvas.height),V(C.j)}))}function sa(C,R){var F=C.h;if(C.s===void 0){var V=Hf(F,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),se=Hf(F,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),ue=F.createProgram();if(F.attachShader(ue,V),F.attachShader(ue,se),F.linkProgram(ue),!F.getProgramParameter(ue,F.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+F.getProgramInfoLog(ue));V=C.s=ue,F.useProgram(V),se=F.getUniformLocation(V,"sampler0"),C.l={O:F.getAttribLocation(V,"aVertex"),N:F.getAttribLocation(V,"aTex"),ya:se},C.v=F.createBuffer(),F.bindBuffer(F.ARRAY_BUFFER,C.v),F.enableVertexAttribArray(C.l.O),F.vertexAttribPointer(C.l.O,2,F.FLOAT,!1,0,0),F.bufferData(F.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),F.STATIC_DRAW),F.bindBuffer(F.ARRAY_BUFFER,null),C.u=F.createBuffer(),F.bindBuffer(F.ARRAY_BUFFER,C.u),F.enableVertexAttribArray(C.l.N),F.vertexAttribPointer(C.l.N,2,F.FLOAT,!1,0,0),F.bufferData(F.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),F.STATIC_DRAW),F.bindBuffer(F.ARRAY_BUFFER,null),F.uniform1i(se,0)}V=C.l,F.useProgram(C.s),F.canvas.width=R.width,F.canvas.height=R.height,F.viewport(0,0,R.width,R.height),F.activeTexture(F.TEXTURE0),C.i.bindTexture2d(R.glName),F.enableVertexAttribArray(V.O),F.bindBuffer(F.ARRAY_BUFFER,C.v),F.vertexAttribPointer(V.O,2,F.FLOAT,!1,0,0),F.enableVertexAttribArray(V.N),F.bindBuffer(F.ARRAY_BUFFER,C.u),F.vertexAttribPointer(V.N,2,F.FLOAT,!1,0,0),F.bindFramebuffer(F.DRAW_FRAMEBUFFER?F.DRAW_FRAMEBUFFER:F.FRAMEBUFFER,null),F.clearColor(0,0,0,0),F.clear(F.COLOR_BUFFER_BIT),F.colorMask(!0,!0,!0,!0),F.drawArrays(F.TRIANGLE_FAN,0,4),F.disableVertexAttribArray(V.O),F.disableVertexAttribArray(V.N),F.bindBuffer(F.ARRAY_BUFFER,null),C.i.bindTexture2d(0)}function pl(C){this.h=C}var jg=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Px(C,R){return R+C}function oa(C,R){window[C]=R}function ml(C){var R=document.createElement("script");return R.setAttribute("src",C),R.setAttribute("crossorigin","anonymous"),new Promise(function(F){R.addEventListener("load",function(){F()},!1),R.addEventListener("error",function(){F()},!1),document.body.appendChild(R)})}function Gf(){return L(function(C){switch(C.h){case 1:return C.s=2,_(C,WebAssembly.instantiate(jg),4);case 4:C.h=3,C.s=0;break;case 2:return C.s=0,C.l=null,C.return(!1);case 3:return C.return(!0)}})}function qf(C){if(this.h=C,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=C&&C.locateFile||Px,typeof window=="object")var R=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")R=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=R,C.options){R=a(Object.keys(C.options));for(var F=R.next();!F.done;F=R.next()){F=F.value;var V=C.options[F].default;V!==void 0&&(this.l[F]=typeof V=="function"?V():V)}}}n=qf.prototype,n.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function Xf(C){var R,F,V,se,ue,ce,Se,Pe,tt,St,un;return L(function(Zt){switch(Zt.h){case 1:return C.ga?(R=C.h.files===void 0?[]:typeof C.h.files=="function"?C.h.files(C.l):C.h.files,_(Zt,Gf(),2)):Zt.return();case 2:if(F=Zt.i,typeof window=="object")return oa("createMediapipeSolutionsWasm",{locateFile:C.locateFile}),oa("createMediapipeSolutionsPackedAssets",{locateFile:C.locateFile}),ce=R.filter(function(yt){return yt.data!==void 0}),Se=R.filter(function(yt){return yt.data===void 0}),Pe=Promise.all(ce.map(function(yt){var Yt=iu(C,yt.url);if(yt.path!==void 0){var Gt=yt.path;Yt=Yt.then(function(hr){return C.overrideFile(Gt,hr),Promise.resolve(hr)})}return Yt})),tt=Promise.all(Se.map(function(yt){return yt.simd===void 0||yt.simd&&F||!yt.simd&&!F?ml(C.locateFile(yt.url,C.ha)):Promise.resolve()})).then(function(){var yt,Yt,Gt;return L(function(hr){if(hr.h==1)return yt=window.createMediapipeSolutionsWasm,Yt=window.createMediapipeSolutionsPackedAssets,Gt=C,_(hr,yt(Yt),2);Gt.i=hr.i,hr.h=0})}),St=function(){return L(function(yt){return C.h.graph&&C.h.graph.url?yt=_(yt,iu(C,C.h.graph.url),0):(yt.h=0,yt=void 0),yt})}(),_(Zt,Promise.all([tt,Pe,St]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return V=R.filter(function(yt){return yt.simd===void 0||yt.simd&&F||!yt.simd&&!F}).map(function(yt){return C.locateFile(yt.url,C.ha)}),importScripts.apply(null,l(V)),se=C,_(Zt,createMediapipeSolutionsWasm(Module),6);case 6:se.i=Zt.i,C.m=new OffscreenCanvas(1,1),C.i.canvas=C.m,ue=C.i.GL.createContext(C.m,{antialias:!1,alpha:!1,va:typeof WebGL2RenderingContext<"u"?2:1}),C.i.GL.makeContextCurrent(ue),Zt.h=4;break;case 7:if(C.m=document.createElement("canvas"),un=C.m.getContext("webgl2",{}),!un&&(un=C.m.getContext("webgl",{}),!un))return alert("Failed to create WebGL canvas context when passing video frame."),Zt.return();C.K=un,C.i.canvas=C.m,C.i.createContext(C.m,!0,!0,{});case 4:C.j=new C.i.SolutionWasm,C.ga=!1,Zt.h=0}})}function Dx(C){var R,F,V,se,ue,ce,Se,Pe;return L(function(tt){if(tt.h==1){if(C.h.graph&&C.h.graph.url&&C.fa===C.h.graph.url)return tt.return();if(C.u=!0,!C.h.graph||!C.h.graph.url){tt.h=2;return}return C.fa=C.h.graph.url,_(tt,iu(C,C.h.graph.url),3)}for(tt.h!=2&&(R=tt.i,C.j.loadGraph(R)),F=a(Object.keys(C.D)),V=F.next();!V.done;V=F.next())se=V.value,C.j.overrideFile(se,C.D[se]);if(C.D={},C.h.listeners)for(ue=a(C.h.listeners),ce=ue.next();!ce.done;ce=ue.next())Se=ce.value,Fx(C,Se);Pe=C.l,C.l={},C.setOptions(Pe),tt.h=0})}n.reset=function(){var C=this;return L(function(R){C.j&&(C.j.reset(),C.s={},C.v={}),R.h=0})},n.setOptions=function(C,R){var F=this;if(R=R||this.h.options){for(var V=[],se=[],ue={},ce=a(Object.keys(C)),Se=ce.next();!Se.done;ue={X:ue.X,Y:ue.Y},Se=ce.next())if(Se=Se.value,!(Se in this.l&&this.l[Se]===C[Se])){this.l[Se]=C[Se];var Pe=R[Se];Pe!==void 0&&(Pe.onChange&&(ue.X=Pe.onChange,ue.Y=C[Se],V.push(function(tt){return function(){var St;return L(function(un){if(un.h==1)return _(un,tt.X(tt.Y),2);St=un.i,St===!0&&(F.u=!0),un.h=0})}}(ue))),Pe.graphOptionXref&&(Se=Object.assign({},{calculatorName:"",calculatorIndex:0},Pe.graphOptionXref,{valueNumber:Pe.type===1?C[Se]:0,valueBoolean:Pe.type===0?C[Se]:!1,valueString:Pe.type===2?C[Se]:""}),se.push(Se)))}(V.length!==0||se.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(se),this.F=(this.F===void 0?[]:this.F).concat(V))}};function Lx(C){var R,F,V,se,ue,ce,Se;return L(function(Pe){switch(Pe.h){case 1:if(!C.u)return Pe.return();if(!C.F){Pe.h=2;break}R=a(C.F),F=R.next();case 3:if(F.done){Pe.h=5;break}return V=F.value,_(Pe,V(),4);case 4:F=R.next(),Pe.h=3;break;case 5:C.F=void 0;case 2:if(C.H){for(se=new C.i.GraphOptionChangeRequestList,ue=a(C.H),ce=ue.next();!ce.done;ce=ue.next())Se=ce.value,se.push_back(Se);C.j.changeOptions(se),se.delete(),C.H=void 0}C.u=!1,Pe.h=0}})}n.initialize=function(){var C=this;return L(function(R){return R.h==1?_(R,Xf(C),2):R.h!=3?_(R,Dx(C),3):_(R,Lx(C),0)})};function iu(C,R){var F,V;return L(function(se){return R in C.L?se.return(C.L[R]):(F=C.locateFile(R,""),V=fetch(F).then(function(ue){return ue.arrayBuffer()}),C.L[R]=V,se.return(V))})}n.overrideFile=function(C,R){this.j?this.j.overrideFile(C,R):this.D[C]=R},n.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},n.send=function(C,R){var F=this,V,se,ue,ce,Se,Pe,tt,St,un;return L(function(Zt){switch(Zt.h){case 1:return F.h.inputs?(V=1e3*(R??performance.now()),_(Zt,F.I,2)):Zt.return();case 2:return _(Zt,F.initialize(),3);case 3:for(se=new F.i.PacketDataList,ue=a(Object.keys(C)),ce=ue.next();!ce.done;ce=ue.next())if(Se=ce.value,Pe=F.h.inputs[Se]){e:{var yt=C[Se];switch(Pe.type){case"video":var Yt=F.s[Pe.stream];if(Yt||(Yt=new fl(F.i,F.K),F.s[Pe.stream]=Yt),Yt.m===0&&(Yt.m=Yt.i.createTexture()),typeof HTMLVideoElement<"u"&&yt instanceof HTMLVideoElement)var Gt=yt.videoWidth,hr=yt.videoHeight;else typeof HTMLImageElement<"u"&&yt instanceof HTMLImageElement?(Gt=yt.naturalWidth,hr=yt.naturalHeight):(Gt=yt.width,hr=yt.height);hr={glName:Yt.m,width:Gt,height:hr},Gt=Yt.h,Gt.canvas.width=hr.width,Gt.canvas.height=hr.height,Gt.activeTexture(Gt.TEXTURE0),Yt.i.bindTexture2d(Yt.m),Gt.texImage2D(Gt.TEXTURE_2D,0,Gt.RGBA,Gt.RGBA,Gt.UNSIGNED_BYTE,yt),Yt.i.bindTexture2d(0),Yt=hr;break e;case"detections":for(Yt=F.s[Pe.stream],Yt||(Yt=new pl(F.i),F.s[Pe.stream]=Yt),Yt.data||(Yt.data=new Yt.h.DetectionListData),Yt.data.reset(yt.length),hr=0;hr<yt.length;++hr){Gt=yt[hr];var jn=Yt.data,Si=jn.setBoundingBox,Ls=hr,Wi=Gt.la,Yn=new oc;if(At(Yn,1,Wi.sa),At(Yn,2,Wi.ta),At(Yn,3,Wi.height),At(Yn,4,Wi.width),At(Yn,5,Wi.rotation),Le(Yn,6,Wi.pa),Wi=Yn.l(),Si.call(jn,Ls,Wi),Gt.ea)for(jn=0;jn<Gt.ea.length;++jn){Yn=Gt.ea[jn],Si=Yt.data,Ls=Si.addNormalizedLandmark,Wi=hr,Yn=Object.assign({},Yn,{visibility:Yn.visibility?Yn.visibility:0});var _i=new zd;At(_i,1,Yn.x),At(_i,2,Yn.y),At(_i,3,Yn.z),Yn.visibility&&At(_i,4,Yn.visibility),Yn=_i.l(),Ls.call(Si,Wi,Yn)}if(Gt.ba)for(jn=0;jn<Gt.ba.length;++jn)Si=Yt.data,Ls=Si.addClassification,Wi=hr,Yn=Gt.ba[jn],_i=new Pa,At(_i,2,Yn.qa),Yn.index&&Le(_i,1,Yn.index),Yn.label&&Le(_i,3,Yn.label),Yn.displayName&&Le(_i,4,Yn.displayName),Yn=_i.l(),Ls.call(Si,Wi,Yn)}Yt=Yt.data;break e;default:Yt={}}}switch(tt=Yt,St=Pe.stream,Pe.type){case"video":se.pushTexture2d(Object.assign({},tt,{stream:St,timestamp:V}));break;case"detections":un=tt,un.stream=St,un.timestamp=V,se.pushDetectionList(un);break;default:throw Error("Unknown input config type: '"+Pe.type+"'")}}return F.j.send(se),_(Zt,F.I,4);case 4:se.delete(),Zt.h=0}})};function Kf(C,R,F){var V,se,ue,ce,Se,Pe,tt,St,un,Zt,yt,Yt,Gt,hr;return L(function(jn){switch(jn.h){case 1:if(!F)return jn.return(R);for(V={},se=0,ue=a(Object.keys(F)),ce=ue.next();!ce.done;ce=ue.next())Se=ce.value,Pe=F[Se],typeof Pe!="string"&&Pe.type==="texture"&&R[Pe.stream]!==void 0&&++se;1<se&&(C.M=!1),tt=a(Object.keys(F)),ce=tt.next();case 2:if(ce.done){jn.h=4;break}if(St=ce.value,un=F[St],typeof un=="string")return Gt=V,hr=St,_(jn,Ox(C,St,R[un]),14);if(Zt=R[un.stream],un.type==="detection_list"){if(Zt){for(var Si=Zt.getRectList(),Ls=Zt.getLandmarksList(),Wi=Zt.getClassificationsList(),Yn=[],_i=0;_i<Si.size();++_i){var oo=Bg(Si.get(_i)),su=on(oo,1),Wg=on(oo,2),$d=on(oo,3),Zf=on(oo,4),zx=on(oo,5,0),jd=void 0;jd=jd===void 0?0:jd,oo={la:{sa:su,ta:Wg,height:$d,width:Zf,rotation:zx,pa:tn(Ie(oo,6),jd)},ea:Bd(Ls.get(_i)),ba:Rx(ia(Wi.get(_i)))},Yn.push(oo)}Si=Yn}else Si=[];V[St]=Si,jn.h=7;break}if(un.type==="proto_list"){if(Zt){for(Si=Array(Zt.size()),Ls=0;Ls<Zt.size();Ls++)Si[Ls]=Zt.get(Ls);Zt.delete()}else Si=[];V[St]=Si,jn.h=7;break}if(Zt===void 0){jn.h=3;break}if(un.type==="float_list"){V[St]=Zt,jn.h=7;break}if(un.type==="proto"){V[St]=Zt,jn.h=7;break}if(un.type!=="texture")throw Error("Unknown output config type: '"+un.type+"'");return yt=C.v[St],yt||(yt=new fl(C.i,C.K),C.v[St]=yt),_(jn,Ds(yt,Zt,C.M),13);case 13:Yt=jn.i,V[St]=Yt;case 7:un.transform&&V[St]&&(V[St]=un.transform(V[St])),jn.h=3;break;case 14:Gt[hr]=jn.i;case 3:ce=tt.next(),jn.h=2;break;case 4:return jn.return(V)}})}function Ox(C,R,F){var V;return L(function(se){return typeof F=="number"||F instanceof Uint8Array||F instanceof C.i.Uint8BlobList?se.return(F):F instanceof C.i.Texture2dDataOut?(V=C.v[R],V||(V=new fl(C.i,C.K),C.v[R]=V),se.return(Ds(V,F,C.M))):se.return(void 0)})}function Fx(C,R){for(var F=R.name||"$",V=[].concat(l(R.wants)),se=new C.i.StringList,ue=a(R.wants),ce=ue.next();!ce.done;ce=ue.next())se.push_back(ce.value);ue=C.i.PacketListener.implement({onResults:function(Se){for(var Pe={},tt=0;tt<R.wants.length;++tt)Pe[V[tt]]=Se.get(tt);var St=C.listeners[F];St&&(C.I=Kf(C,Pe,R.outs).then(function(un){un=St(un);for(var Zt=0;Zt<R.wants.length;++Zt){var yt=Pe[V[Zt]];typeof yt=="object"&&yt.hasOwnProperty&&yt.hasOwnProperty("delete")&&yt.delete()}un&&(C.I=un)}))}}),C.j.attachMultiListener(se,ue),se.delete()}n.onResults=function(C,R){this.listeners[R||"$"]=C},ne("Solution",qf),ne("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"});function Vg(C){switch(C===void 0&&(C=0),C){case 1:return"pose_landmark_full.tflite";case 2:return"pose_landmark_heavy.tflite";default:return"pose_landmark_lite.tflite"}}function Yf(C){var R=this;C=C||{},this.h=new qf({locateFile:C.locateFile,files:function(F){return[{url:"pose_solution_packed_assets_loader.js"},{simd:!1,url:"pose_solution_wasm_bin.js"},{simd:!0,url:"pose_solution_simd_wasm_bin.js"},{data:!0,url:Vg(F.modelComplexity)}]},graph:{url:"pose_web.binarypb"},listeners:[{wants:["pose_landmarks","world_landmarks","segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:Bd},poseWorldLandmarks:{type:"proto",stream:"world_landmarks",transform:Bd},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(F){var V,se,ue;return L(function(ce){return ce.h==1?(V=Vg(F),se="third_party/mediapipe/modules/pose_landmark/"+V,_(ce,iu(R.h,V),2)):(ue=ce.i,R.h.overrideFile(se,ue),ce.return(!0))})}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}}}})}n=Yf.prototype,n.reset=function(){this.h.reset()},n.close=function(){return this.h.close(),Promise.resolve()},n.onResults=function(C){this.h.onResults(C)},n.initialize=function(){var C=this;return L(function(R){return _(R,C.h.initialize(),0)})},n.send=function(C,R){var F=this;return L(function(V){return _(V,F.h.send(C,R),0)})},n.setOptions=function(C){this.h.setOptions(C)},ne("Pose",Yf),ne("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),ne("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),ne("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),ne("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),ne("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),ne("VERSION","0.5.1675469404")}).call(Pl);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ixe=1e-7,Rxe=1e-4;class Pxe{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class g8{refCount(e){return uo("refCount")}incRef(e){return uo("incRef")}timerAvailable(){return!0}time(e){return uo("time")}read(e){return uo("read")}readSync(e){return uo("readSync")}readToGPU(e,t){return uo("readToGPU")}numDataIds(){return uo("numDataIds")}disposeData(e,t){return uo("disposeData")}write(e,t,r){return uo("write")}move(e,t,r,i,s){return uo("move")}createTensorFromGPUData(e,t,r){return uo("createTensorFromGPUData")}memory(){return uo("memory")}floatPrecision(){return uo("floatPrecision")}epsilon(){return this.floatPrecision()===32?Ixe:Rxe}dispose(){return uo("dispose")}}function uo(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dy(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function Dxe(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function te(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function Jo(n,e,t=""){te(Zs(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function kg(n){te(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function gt(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function _z(n){return n.length===0}function Lxe(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==null&&e[t]!==null&&n[t]!==e[t])return!1;return!0}function Zs(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function T0(n){return n%1===0}function wb(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function Oxe(n,e){let t=1,r=-1;for(let s=0;s<n.length;++s)if(n[s]>=0)t*=n[s];else if(n[s]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(n[s]<0)throw Error(`Shapes can not be < 0. Found ${n[s]} at dim ${s}`);if(r===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const i=n.slice();return i[r]=e/t,i}function ka(n,e){const t=e.length;return n=n==null?e.map((r,i)=>i):[].concat(n),te(n.every(r=>r>=-t&&r<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),te(n.every(r=>T0(r)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(r=>r<0?t+r:r)}function Fxe(n,e){const t=[],r=[],i=e!=null&&Array.isArray(e)&&e.length===0,s=e==null||i?null:ka(e,n).sort();let o=0;for(let a=0;a<n.length;++a){if(s!=null){if(s[o]===a&&n[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${n[a]}' is not 1`);(s[o]==null||s[o]>a)&&n[a]===1&&(t.push(n[a]),r.push(a)),s[o]<=a&&o++}n[a]!==1&&(t.push(n[a]),r.push(a))}return{newShape:t,keptDims:r}}function yd(n,e){return zi(n,e)}function zi(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function zxe(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function Uxe(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function Bxe(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function aN(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function $xe(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function g2(n){return typeof n=="string"||n instanceof String}function jxe(n){return typeof n=="boolean"}function Vxe(n){return typeof n=="number"}function vx(n){return Array.isArray(n)?vx(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":Vxe(n)?"float32":g2(n)?"string":jxe(n)?"bool":"float32"}function lN(n){return!!(n&&n.constructor&&n.call&&n.apply)}function os(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let r=e-3;r>=0;--r)t[r]=t[r+1]*n[r+1];return t}function y8(n,e,t,r=!1){const i=new Array;if(e.length===1){const s=e[0]*(r?2:1);for(let o=0;o<s;o++)i[o]=t[n+o]}else{const s=e[0],o=e.slice(1),a=o.reduce((l,c)=>l*c)*(r?2:1);for(let l=0;l<s;l++)i[l]=y8(n+l*a,o,t,r)}return i}function cN(n,e,t=!1){if(n.length===0)return e[0];const r=n.reduce((i,s)=>i*s)*(t?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return y8(0,n,e,t)}function mT(n,e){if(Array.isArray(n))return n;if(e==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(e==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${e}`)}function v8(n,e){const t=Hc(n,e);for(let r=0;r<t.length;r++)t[r]=1;return t}function Hc(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function ea(n){n.forEach(e=>{te(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function uN(n,e,t){if(e===0)return 0;if(e===1)return n[0];let r=n[n.length-1];for(let i=0;i<n.length-1;++i)r+=t[i]*n[i];return r}function HR(n,e,t){if(e===0)return[];if(e===1)return[n];const r=new Array(e);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(n/t[i]),n-=r[i]*t[i];return r[r.length-1]=n,r}function pf(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ez="tfjsflags";class Wxe{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Hxe,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(rn().getBool("IS_TEST")||rn().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){const i=this.urlFlags[e];rn().getBool("IS_TEST")||rn().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${i}.`),this.set(e,i)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(pf(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);Ez in e&&e[Ez].split(",").forEach(r=>{const[i,s]=r.split(":");this.urlFlags[i]=qxe(i,s)})}}function Hxe(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...r)=>(Gxe(e,r[0],r[1]),r.join("="))),e}function Gxe(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function qxe(n,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":`${+t}`===t?+t:e}function rn(){return x8}let x8=null;function Xxe(n){x8=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let gT;function w8(){if(gT==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");gT=n}return gT}function Kxe(){const n=w8();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function GR(n,e){const t=Kxe();if(t.has(n))return t.get(n);{const r=e();return t.set(n,r),t.get(n)}}const b8="Abs",S8="Acos",_8="Acosh",qR="Add",E8="AddN",C8="All",T8="Any",M8="ArgMax",A8="ArgMin",N8="Asin",k8="Asinh",I8="Atan",R8="Atanh",P8="Atan2",D8="AvgPool",Yxe="AvgPoolGrad",L8="AvgPool3D",Zxe="AvgPool3DGrad",O8="BatchMatMul",F8="BatchToSpaceND",z8="Bincount",Qxe="BitwiseAnd",U8="BroadcastArgs",XR="Cast",B8="Ceil",$8="ClipByValue",j8="Complex",V8="ComplexAbs",W8="Concat",H8="Conv2D",G8="Conv2DBackpropFilter",q8="Conv2DBackpropInput",X8="Conv3D",Jxe="Conv3DBackpropFilterV2",K8="Conv3DBackpropInputV2",Y8="Cos",Z8="Cosh",Q8="Cumprod",J8="Cumsum",e9="CropAndResize",t9="DenseBincount",n9="DepthToSpace",r9="DepthwiseConv2dNative",i9="DepthwiseConv2dNativeBackpropFilter",s9="DepthwiseConv2dNativeBackpropInput",o9="Diag",a9="Dilation2D",ewe="Dilation2DBackpropInput",twe="Dilation2DBackpropFilter",l9="Draw",c9="RealDiv",u9="Einsum",d9="Elu",nwe="EluGrad",h9="Erf",f9="Equal",p9="Exp",m9="ExpandDims",g9="Expm1",y9="FFT",v9="Fill",x9="FlipLeftRight",w9="Floor",b9="FloorDiv",S9="FusedBatchNorm",_9="GatherV2",E9="GatherNd",C9="Greater",T9="GreaterEqual",KR="Identity",M9="IFFT",A9="Imag",N9="IsFinite",k9="IsInf",I9="IsNan",R9="LeakyRelu",P9="Less",D9="LessEqual",L9="LinSpace",O9="Log",F9="Log1p",z9="LogicalAnd",U9="LogicalNot",B9="LogicalOr",$9="LRN",rwe="LRNGrad",j9="Max",V9="Maximum",W9="MaxPool",iwe="MaxPoolGrad",H9="MaxPool3D",swe="MaxPool3DGrad",G9="MaxPoolWithArgmax",q9="Mean",X9="Min",K9="Minimum",Y9="MirrorPad",Z9="Mod",Q9="Multinomial",J9="Multiply",e7="Neg",t7="NotEqual",n7="NonMaxSuppressionV3",owe="NonMaxSuppressionV4",r7="NonMaxSuppressionV5",i7="OnesLike",s7="OneHot",o7="Pack",a7="PadV2",l7="Pow",c7="Prelu",u7="Prod",awe="RaggedGather",lwe="RaggedRange",cwe="RaggedTensorToTensor",d7="Range",h7="Real",f7="Reciprocal",p7="Relu",m7="Reshape",g7="ResizeNearestNeighbor",uwe="ResizeNearestNeighborGrad",y7="ResizeBilinear",dwe="ResizeBilinearGrad",v7="Relu6",x7="Reverse",w7="Round",b7="Rsqrt",S7="ScatterNd",_7="TensorScatterUpdate",E7="SearchSorted",C7="Select",T7="Selu",M7="Slice",A7="Sin",N7="Sinh",k7="Sign",I7="Sigmoid",R7="Softplus",P7="Sqrt",D7="Sum",L7="SpaceToBatchND",O7="SplitV",F7="Softmax",hwe="SparseFillEmptyRows",fwe="SparseReshape",z7="SparseSegmentMean",U7="SparseSegmentSum",B7="SparseToDense",$7="SquaredDifference",pwe="Square",mwe="StaticRegexReplace",j7="StridedSlice",V7="StringNGrams",gwe="StringSplit",ywe="StringToHashBucketFast",W7="Sub",H7="Tan",G7="Tanh",YR="Tile",q7="TopK",X7="Transform",bb="Transpose",vwe="Unique",K7="Unpack",Y7="UnsortedSegmentSum",Z7="ZerosLike",Q7="Step",dN="FromPixels",J7="RotateWithOffset",hN="_FusedMatMul",fN="FusedConv2D",pN="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $p(...n){rn().getBool("IS_TEST")||rn().getBool("PROD")||console.warn(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IS=GR("kernelRegistry",()=>new Map),xwe=GR("gradRegistry",()=>new Map);function RS(n,e){const t=eq(n,e);return IS.get(t)}function Cz(n){return xwe.get(n)}function Tz(n){const e=IS.entries(),t=[];for(;;){const{done:r,value:i}=e.next();if(r)break;const[s,o]=i,[a]=s.split("_");a===n&&t.push(o)}return t}function wwe(n){const{kernelName:e,backendName:t}=n,r=eq(e,t);IS.has(r)&&$p(`The kernel '${e}' for backend '${t}' is already registered`),IS.set(r,n)}function eq(n,e){return`${e}_${n}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tq(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var nq=Lr,xa=null;try{xa=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Lr(n,e,t){this.low=n|0,this.high=e|0,this.unsigned=!!t}Lr.prototype.__isLong__;Object.defineProperty(Lr.prototype,"__isLong__",{value:!0});function To(n){return(n&&n.__isLong__)===!0}Lr.isLong=To;var Mz={},Az={};function Rf(n,e){var t,r,i;return e?(n>>>=0,(i=0<=n&&n<256)&&(r=Az[n],r)?r:(t=Or(n,(n|0)<0?-1:0,!0),i&&(Az[n]=t),t)):(n|=0,(i=-128<=n&&n<128)&&(r=Mz[n],r)?r:(t=Or(n,n<0?-1:0,!1),i&&(Mz[n]=t),t))}Lr.fromInt=Rf;function wa(n,e){if(isNaN(n))return e?Dh:ba;if(e){if(n<0)return Dh;if(n>=rq)return oq}else{if(n<=-9223372036854776e3)return vo;if(n+1>=Swe)return sq}return n<0?wa(-n,e).neg():Or(n%Zm|0,n/Zm|0,e)}Lr.fromNumber=wa;function Or(n,e,t){return new Lr(n,e,t)}Lr.fromBits=Or;var PS=Math.pow;function ZR(n,e,t){if(n.length===0)throw Error("empty string");if(n==="NaN"||n==="Infinity"||n==="+Infinity"||n==="-Infinity")return ba;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var r;if((r=n.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return ZR(n.substring(1),e,t).neg();for(var i=wa(PS(t,8)),s=ba,o=0;o<n.length;o+=8){var a=Math.min(8,n.length-o),l=parseInt(n.substring(o,o+a),t);if(a<8){var c=wa(PS(t,a));s=s.mul(c).add(wa(l))}else s=s.mul(i),s=s.add(wa(l))}return s.unsigned=e,s}Lr.fromString=ZR;function ul(n,e){return typeof n=="number"?wa(n,e):typeof n=="string"?ZR(n,e):Or(n.low,n.high,typeof e=="boolean"?e:n.unsigned)}Lr.fromValue=ul;var Nz=65536,bwe=1<<24,Zm=Nz*Nz,rq=Zm*Zm,Swe=rq/2,kz=Rf(bwe),ba=Rf(0);Lr.ZERO=ba;var Dh=Rf(0,!0);Lr.UZERO=Dh;var um=Rf(1);Lr.ONE=um;var iq=Rf(1,!0);Lr.UONE=iq;var mN=Rf(-1);Lr.NEG_ONE=mN;var sq=Or(-1,2147483647,!1);Lr.MAX_VALUE=sq;var oq=Or(-1,-1,!0);Lr.MAX_UNSIGNED_VALUE=oq;var vo=Or(0,-2147483648,!1);Lr.MIN_VALUE=vo;var Tt=Lr.prototype;Tt.toInt=function(){return this.unsigned?this.low>>>0:this.low};Tt.toNumber=function(){return this.unsigned?(this.high>>>0)*Zm+(this.low>>>0):this.high*Zm+(this.low>>>0)};Tt.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(vo)){var t=wa(e),r=this.div(t),i=r.mul(t).sub(this);return r.toString(e)+i.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=wa(PS(e,6),this.unsigned),o=this,a="";;){var l=o.div(s),c=o.sub(l.mul(s)).toInt()>>>0,u=c.toString(e);if(o=l,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};Tt.getHighBits=function(){return this.high};Tt.getHighBitsUnsigned=function(){return this.high>>>0};Tt.getLowBits=function(){return this.low};Tt.getLowBitsUnsigned=function(){return this.low>>>0};Tt.getNumBitsAbs=function(){if(this.isNegative())return this.eq(vo)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};Tt.isZero=function(){return this.high===0&&this.low===0};Tt.eqz=Tt.isZero;Tt.isNegative=function(){return!this.unsigned&&this.high<0};Tt.isPositive=function(){return this.unsigned||this.high>=0};Tt.isOdd=function(){return(this.low&1)===1};Tt.isEven=function(){return(this.low&1)===0};Tt.equals=function(e){return To(e)||(e=ul(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};Tt.eq=Tt.equals;Tt.notEquals=function(e){return!this.eq(e)};Tt.neq=Tt.notEquals;Tt.ne=Tt.notEquals;Tt.lessThan=function(e){return this.comp(e)<0};Tt.lt=Tt.lessThan;Tt.lessThanOrEqual=function(e){return this.comp(e)<=0};Tt.lte=Tt.lessThanOrEqual;Tt.le=Tt.lessThanOrEqual;Tt.greaterThan=function(e){return this.comp(e)>0};Tt.gt=Tt.greaterThan;Tt.greaterThanOrEqual=function(e){return this.comp(e)>=0};Tt.gte=Tt.greaterThanOrEqual;Tt.ge=Tt.greaterThanOrEqual;Tt.compare=function(e){if(To(e)||(e=ul(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Tt.comp=Tt.compare;Tt.negate=function(){return!this.unsigned&&this.eq(vo)?vo:this.not().add(um)};Tt.neg=Tt.negate;Tt.add=function(e){To(e)||(e=ul(e));var t=this.high>>>16,r=this.high&65535,i=this.low>>>16,s=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,d=0,h=0,f=0;return f+=s+c,h+=f>>>16,f&=65535,h+=i+l,d+=h>>>16,h&=65535,d+=r+a,u+=d>>>16,d&=65535,u+=t+o,u&=65535,Or(h<<16|f,u<<16|d,this.unsigned)};Tt.subtract=function(e){return To(e)||(e=ul(e)),this.add(e.neg())};Tt.sub=Tt.subtract;Tt.multiply=function(e){if(this.isZero())return ba;if(To(e)||(e=ul(e)),xa){var t=xa.mul(this.low,this.high,e.low,e.high);return Or(t,xa.get_high(),this.unsigned)}if(e.isZero())return ba;if(this.eq(vo))return e.isOdd()?vo:ba;if(e.eq(vo))return this.isOdd()?vo:ba;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(kz)&&e.lt(kz))return wa(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,i=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,d=0,h=0,f=0,p=0;return p+=o*u,f+=p>>>16,p&=65535,f+=s*u,h+=f>>>16,f&=65535,f+=o*c,h+=f>>>16,f&=65535,h+=i*u,d+=h>>>16,h&=65535,h+=s*c,d+=h>>>16,h&=65535,h+=o*l,d+=h>>>16,h&=65535,d+=r*u+i*c+s*l+o*a,d&=65535,Or(f<<16|p,d<<16|h,this.unsigned)};Tt.mul=Tt.multiply;Tt.divide=function(e){if(To(e)||(e=ul(e)),e.isZero())throw Error("division by zero");if(xa){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?xa.div_u:xa.div_s)(this.low,this.high,e.low,e.high);return Or(t,xa.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Dh:ba;var r,i,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Dh;if(e.gt(this.shru(1)))return iq;s=Dh}else{if(this.eq(vo)){if(e.eq(um)||e.eq(mN))return vo;if(e.eq(vo))return um;var o=this.shr(1);return r=o.div(e).shl(1),r.eq(ba)?e.isNegative()?um:mN:(i=this.sub(e.mul(r)),s=r.add(i.div(e)),s)}else if(e.eq(vo))return this.unsigned?Dh:ba;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=ba}for(i=this;i.gte(e);){r=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:PS(2,a-48),c=wa(r),u=c.mul(e);u.isNegative()||u.gt(i);)r-=l,c=wa(r,this.unsigned),u=c.mul(e);c.isZero()&&(c=um),s=s.add(c),i=i.sub(u)}return s};Tt.div=Tt.divide;Tt.modulo=function(e){if(To(e)||(e=ul(e)),xa){var t=(this.unsigned?xa.rem_u:xa.rem_s)(this.low,this.high,e.low,e.high);return Or(t,xa.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Tt.mod=Tt.modulo;Tt.rem=Tt.modulo;Tt.not=function(){return Or(~this.low,~this.high,this.unsigned)};Tt.and=function(e){return To(e)||(e=ul(e)),Or(this.low&e.low,this.high&e.high,this.unsigned)};Tt.or=function(e){return To(e)||(e=ul(e)),Or(this.low|e.low,this.high|e.high,this.unsigned)};Tt.xor=function(e){return To(e)||(e=ul(e)),Or(this.low^e.low,this.high^e.high,this.unsigned)};Tt.shiftLeft=function(e){return To(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Or(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Or(0,this.low<<e-32,this.unsigned)};Tt.shl=Tt.shiftLeft;Tt.shiftRight=function(e){return To(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Or(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Or(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Tt.shr=Tt.shiftRight;Tt.shiftRightUnsigned=function(e){if(To(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var r=this.low;return Or(r>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?Or(t,0,this.unsigned):Or(t>>>e-32,0,this.unsigned)};Tt.shru=Tt.shiftRightUnsigned;Tt.shr_u=Tt.shiftRightUnsigned;Tt.toSigned=function(){return this.unsigned?Or(this.low,this.high,!1):this};Tt.toUnsigned=function(){return this.unsigned?this:Or(this.low,this.high,!0)};Tt.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Tt.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Tt.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Lr.fromBytes=function(e,t,r){return r?Lr.fromBytesLE(e,t):Lr.fromBytesBE(e,t)};Lr.fromBytesLE=function(e,t){return new Lr(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Lr.fromBytesBE=function(e,t){return new Lr(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};const aq=B0(nq),_we=J4({__proto__:null,default:aq},[nq]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wh=aq||_we;function y2(n){return wh.fromString(n,!0,16)}const lq=y2("c3a5c85c97cb3127"),ph=y2("b492b66fbe98f273"),Es=y2("9ae16a3b2f90404f");function gN(n){return n.xor(n.shru(47))}function cq(n,e,t){const r=n.slice(e,e+t);return wh.fromBytes(Array.from(r),!0,!0)}function Nr(n,e){return cq(n,e,8)}function Iz(n,e){return cq(n,e,4)}function Li(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function nd(n,e,t=y2("9ddfea08eb382d69")){let r=n.xor(e).mul(t);r=r.xor(r.shru(47));let i=e.xor(r).mul(t);return i=i.xor(i.shru(47)),i=i.mul(t),i}function Ewe(n,e,t,r,i,s){i=i.add(n),s=Li(s.add(i).add(r),21);const o=i;return i=i.add(e),i=i.add(t),s=s.add(Li(i,44)),[i.add(r),s.add(o)]}function $1(n,e,t,r){return Ewe(Nr(n,e),Nr(n,e+8),Nr(n,e+16),Nr(n,e+24),t,r)}function Cwe(n,e=n.length){if(e>=8){const t=Es.add(e*2),r=Nr(n,0).add(Es),i=Nr(n,e-8),s=Li(i,37).mul(t).add(r),o=Li(r,25).add(i).mul(t);return nd(s,o,t)}if(e>=4){const t=Es.add(e*2),r=Iz(n,0);return nd(r.shl(3).add(e),Iz(n,e-4),t)}if(e>0){const t=n[0],r=n[e>>1],i=n[e-1],s=t+(r<<8),o=e+(i<<2);return gN(Es.mul(s).xor(lq.mul(o))).mul(Es)}return Es}function Twe(n,e=n.length){const t=Es.add(e*2),r=Nr(n,0).mul(ph),i=Nr(n,8),s=Nr(n,e-8).mul(t),o=Nr(n,e-16).mul(Es);return nd(Li(r.add(i),43).add(Li(s,30)).add(o),r.add(Li(i.add(Es),18)).add(s),t)}function Mwe(n,e=n.length){const t=Es.add(e*2),r=Nr(n,0).mul(Es),i=Nr(n,8),s=Nr(n,e-8).mul(t),o=Nr(n,e-16).mul(Es),a=Li(r.add(i),43).add(Li(s,30)).add(o),l=nd(a,r.add(Li(i.add(Es),18)).add(s),t),c=Nr(n,16).mul(t),u=Nr(n,24),d=a.add(Nr(n,e-32)).mul(t),h=l.add(Nr(n,e-24)).mul(t);return nd(Li(c.add(u),43).add(Li(d,30)).add(h),c.add(Li(u.add(r),18)).add(d),t)}function Awe(n,e=n.length){const t=wh.fromNumber(81,!0);if(e<=32)return e<=16?Cwe(n,e):Twe(n,e);if(e<=64)return Mwe(n,e);let r=t,i=t.mul(ph).add(113),s=gN(i.mul(Es).add(113)).mul(Es),o=[wh.UZERO,wh.UZERO],a=[wh.UZERO,wh.UZERO];r=r.mul(Es).add(Nr(n,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do r=Li(r.add(i).add(o[0]).add(Nr(n,l+8)),37).mul(ph),i=Li(i.add(o[1]).add(Nr(n,l+48)),42).mul(ph),r=r.xor(a[1]),i=i.add(o[0]).add(Nr(n,l+40)),s=Li(s.add(a[0]),33).mul(ph),o=$1(n,l,o[1].mul(ph),r.add(a[0])),a=$1(n,l+32,s.add(a[1]),i.add(Nr(n,l+16))),[s,r]=[r,s],l+=64;while(l!==c);const d=ph.add(s.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),r=Li(r.add(i).add(o[0]).add(Nr(n,l+8)),37).mul(d),i=Li(i.add(o[1]).add(Nr(n,l+48)),42).mul(d),r=r.xor(a[1].mul(9)),i=i.add(o[0].mul(9).add(Nr(n,l+40))),s=Li(s.add(a[0]),33).mul(d),o=$1(n,l,o[1].mul(d),r.add(a[0])),a=$1(n,l+32,s.add(a[1]),i.add(Nr(n,l+16))),[s,r]=[r,s],nd(nd(o[0],a[0],d).add(gN(i).mul(lq)).add(s),nd(o[1],a[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nwe(n,e){return e==="string"?qh(n):v2([n],e)}function kwe(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function v2(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=mf(n)),rn().getBool("DEBUG")&&zxe(n,e),kwe(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let r=0;r<t.length;++r)Math.round(n[r])!==0&&(t[r]=1);return t}else throw new Error(`Unknown data type ${e}`)}function DS(){return rn().platform.now()}function qh(n,e="utf-8"){return e=e||"utf-8",rn().platform.encode(n,e)}function Qm(n,e="utf-8"){return e=e||"utf-8",rn().platform.decode(n,e)}function Aa(n){return rn().platform.isTypedArray!=null?rn().platform.isTypedArray(n):tq(n)}function mf(n,e=[],t=!1){if(e==null&&(e=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||pf(n)||n==null||Aa(n)&&t)e.push(n);else if(Array.isArray(n)||Aa(n))for(let r=0;r<n.length;++r)mf(n[r],e,t);else{let r=-1;for(const i of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(i)&&(r=Math.max(r,Number(i)));for(let i=0;i<=r;i++)mf(n[i],e,t)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Iwe{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new Pwe)}profileKernel(e,t,r){let i;const s=()=>{i=r()};let o;const a=DS();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(s);else{s();for(const c of i)c.dataSync();o=Promise.resolve({kernelMs:DS()-a})}if(rn().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<i.length;c++){const u=i[c];u.data().then(d=>{Rwe(d,u.dtype,e)})}return{kernelName:e,outputs:i,inputs:t,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:r,timeMs:i,inputs:s,extraInfo:o}=e;r.forEach(a=>{Promise.all([a.data(),i,o]).then(l=>{this.logger.logKernelProfile(t,a,l[0],l[1],s,l[2])})})}}function Rwe(n,e,t){if(e!=="float32")return!1;for(let r=0;r<n.length;r++){const i=n[r];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${t}'`),!0}return!1}class Pwe{logKernelProfile(e,t,r,i,s,o){const a=typeof i=="number"?wb(`${i}ms`,9):i.error,l=wb(e,25),c=t.rank,u=t.size,d=wb(t.shape.toString(),14);let h="";for(const f in s){const p=s[f];if(p!=null){const x=p.shape||t.shape,v=x.length;h+=`${f}: ${v}D ${v>0?x:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${d}	%c${u}	%c${h}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dwe(n,e,t){const r={},i={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<n.length;l++){const c=n[l],u=c.inputs;for(const d in u){const h=u[d];let f=!1;for(let p=0;p<e.length;p++)if(r[h.id]){c.outputs.forEach(x=>r[x.id]=!0),f=!0,i[c.id]=!0;break}if(f)break}}const s={};s[t.id]=!0;const o={};for(let l=n.length-1;l>=0;l--){const c=n[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(s[c.outputs[d].id]){for(const h in u)s[u[h].id]=!0,o[c.id]=!0;break}}const a=[];for(let l=0;l<n.length;l++){const c=n[l];if(i[c.id]&&o[c.id]){const u={};for(const h in c.inputs){const f=c.inputs[h];r[f.id]&&(u[h]=f)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,a.push(d)}}return a}function Lwe(n,e,t,r){for(let i=e.length-1;i>=0;i--){const s=e[i],o=[];if(s.outputs.forEach(l=>{const c=n[l.id];c!=null?o.push(c):o.push(null)}),s.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);const a=s.gradient(o);for(const l in s.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=t(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=s.inputs[l];if(!Zs(c.shape,u.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(n[u.id]==null)n[u.id]=c;else{const d=n[u.id];n[u.id]=r(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rz=20,Ly=3,yT=7;function Owe(n,e,t,r){const i=os(e),s=Fwe(n,e,t,i),o=e.length,a=Sb(n,e,t,i,s),l=["Tensor"];return r&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function Fwe(n,e,t,r){const i=gt(e),s=r[r.length-1],o=new Array(s).fill(0),a=e.length,l=t==="complex64"?Xy(n):n;if(a>1)for(let c=0;c<i/s;c++){const u=c*s;for(let d=0;d<s;d++)o[d]=Math.max(o[d],qy(l[u+d],0,t).length)}return o}function qy(n,e,t){let r;return Array.isArray(n)?r=`${parseFloat(n[0].toFixed(yT))} + ${parseFloat(n[1].toFixed(yT))}j`:g2(n)?r=`'${n}'`:t==="bool"?r=uq(n):r=parseFloat(n.toFixed(yT)).toString(),wb(r,e)}function uq(n){return n===0?"false":"true"}function Sb(n,e,t,r,i,s=!0){const o=t==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(t==="complex64"){const x=Xy(n);return[qy(x[0],0,t)]}return t==="bool"?[uq(n[0])]:[n[0].toString()]}if(l===1){if(a>Rz){const v=Ly*o;let y=Array.from(n.slice(0,v)),b=Array.from(n.slice((a-Ly)*o,a*o));return t==="complex64"&&(y=Xy(y),b=Xy(b)),["["+y.map((S,_)=>qy(S,i[_],t)).join(", ")+", ..., "+b.map((S,_)=>qy(S,i[a-Ly+_],t)).join(", ")+"]"]}return["["+(t==="complex64"?Xy(n):Array.from(n)).map((v,y)=>qy(v,i[y],t)).join(", ")+"]"]}const c=e.slice(1),u=r.slice(1),d=r[0]*o,h=[];if(a>Rz){for(let x=0;x<Ly;x++){const v=x*d,y=v+d;h.push(...Sb(n.slice(v,y),c,t,u,i,!1))}h.push("...");for(let x=a-Ly;x<a;x++){const v=x*d,y=v+d;h.push(...Sb(n.slice(v,y),c,t,u,i,x===a-1))}}else for(let x=0;x<a;x++){const v=x*d,y=v+d;h.push(...Sb(n.slice(v,y),c,t,u,i,x===a-1))}const f=l===2?",":"";h[0]="["+(a>0?h[0]+f:"");for(let x=1;x<h.length-1;x++)h[x]=" "+h[x]+f;let p=`,
`;for(let x=2;x<l;x++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(s?"":p),h}function Xy(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jm{constructor(e,t,r){if(this.dtype=t,this.shape=e.slice(),this.size=gt(e),r!=null){const i=r.length;te(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||zi(t,this.size),this.strides=os(e)}set(e,...t){t.length===0&&(t=[0]),te(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const r=this.locToIndex(t);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const i of e){if(i<0||i>=this.shape[t]){const s=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(s)}t++}let r=e[e.length-1];for(let i=0;i<e.length-1;++i)r+=this.strides[i]*e[i];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Ga().makeTensor(this.values,this.shape,this.dtype)}}let Ga=null,jp=null;function zwe(n){Ga=n}function Uwe(n){jp=n}class ei{constructor(e,t,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=gt(e),this.strides=os(e),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return jp.buffer(this.shape,this.dtype,e)}bufferSync(){return jp.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return cN(this.shape,e,this.dtype==="complex64")}arraySync(){return cN(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Ga().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(r=>Qm(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Ga().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Ga().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>Qm(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Ga().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Ga().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return jp.print(this,e)}clone(){return this.throwIfDisposed(),jp.clone(this)}toString(e=!1){const t=this.dataSync();return Owe(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),jp.cast(this,e)}variable(e=!0,t,r){return this.throwIfDisposed(),Ga().makeVariable(this,e,t,r)}}Object.defineProperty(ei,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function dq(){return GR("Tensor",()=>ei)}dq();class LS extends ei{constructor(e,t,r,i){super(e.shape,e.dtype,e.dataId,i),this.trainable=t,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Zs(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Ga().disposeTensor(this),this.dataId=e.dataId,Ga().incRef(this,null)}dispose(){Ga().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(LS,Symbol.hasInstance,{value:n=>n instanceof ei&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Pz;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(Pz||(Pz={}));var yN;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(yN||(yN={}));var vN;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(vN||(vN={}));var xN;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(xN||(xN={}));var wN;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(wN||(wN={}));const Bwe={float32:xN,int32:yN,bool:vN,complex64:wN};function vd(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return Bwe[n][e]}function $we(n){return vd(n,"int32")}function hq(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function fq(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oi(n,e){if(n.dtype===e.dtype)return[n,e];const t=vd(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function jwe(n,e){te(n.dtype===e.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${e.dtype}) input must match`)}function pq(n){const e=[];return mq(n,e,new Set),e}function mq(n,e,t){if(n==null)return;if(n instanceof ei){e.push(n);return}if(!Vwe(n))return;const r=n;for(const i in r){const s=r[i];t.has(s)||(t.add(s),mq(s,e,t))}}function Vwe(n){return Array.isArray(n)||typeof n=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vT(n){return n.kernelName!=null}class Dz{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class eg{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Dz}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,r=1){return e in this.registryFactory?($p(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:r}=this.initializeBackend(e);if(!(r?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Iwe(this.backendInstance),!0}setupRegisteredKernels(){Tz(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Tz(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=t.factory();if(r&&!(r instanceof g8)&&typeof r.then=="function"){const i=++this.pendingBackendInitId,s=r.then(o=>i<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(i<this.pendingBackendInitId||(this.pendingBackendInit=null,$p(`Initialization of backend ${e} failed`),$p(o.stack||o.message)),!1));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return $p(`Initialization of backend ${e} failed`),$p(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t],{success:i,asyncInit:s}=this.initializeBackend(r);if(s||i)return{name:r,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const r=this.state.tensorInfo.get(t),i=r.backend,s=this.readSync(t),o=i.refCount(t);i.disposeData(t,!0),r.backend=e,e.move(t,s,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let r=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let i;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(i),()=>(i=t(),i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i))}scopedRun(e,t,r){e();try{const i=r();return t(),i}catch(i){throw t(),i}}nextTensorId(){return eg.nextTensorId++}nextVariableId(){return eg.nextVariableId++}clone(e){const t=be.runKernel(KR,{x:e}),r={x:e},i=o=>({x:()=>{const a="float32",l={x:o},c={dtype:a};return be.runKernel(XR,l,c)}}),s=[];return this.addTapeNode(this.state.activeScope.name,r,[t],i,s,{}),t}runKernel(e,t,r){if(this.backendName==null&&this.backend,!(RS(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,r){const i=this.backend.numDataIds();let s=0;r.forEach(l=>{s+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=i-t-s-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let t,r=[];const i=this.isTapeOn(),s=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=vT(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(vT(e)){const{kernelName:p,inputs:x,attrs:v}=e;this.backendName==null&&this.backend;const y=RS(p,this.backendName);te(y!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const b=this.backend.numDataIds();l=y.kernelFunc({inputs:x,attrs:v,backend:this.backend});const S=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,b,S);const _=S.map(T=>T.rank!=null?T:this.makeTensorFromTensorInfo(T));if(i){const T=this.getTensorsForGradient(p,x,_);r=this.saveTensorsForBackwardMode(T)}return _}}else{const{forwardFunc:p}=e,x=v=>{i&&(r=v.map(y=>this.keep(this.clone(y))))};a=()=>{const v=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,x));const y=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,v,y),y}}const{inputs:u,attrs:d}=e,h=vT(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),t=f.outputs)}),i&&this.addTapeNode(c,u,t,h,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:t.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,t,r){const i=Cz(e);if(i!=null){const s=i.inputsToSave||[],o=i.outputsToSave||[];let a;i.saveAllInputs?(te(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(t).map(c=>t[c])):a=s.map(c=>t[c]);const l=r.filter((c,u)=>o[u]);return a.concat(l)}return[]}makeTensor(e,t,r,i){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;let s=e;r==="string"&&g2(e[0])&&(s=e.map(l=>qh(l)));const o=i.write(s,t,r),a=new ei(t,r,o,this.nextTensorId());if(this.trackTensor(a,i),r==="string"){const l=this.state.tensorInfo.get(o),c=$xe(s);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,t,r,i){r=r||"float32";const s={dataId:e,shape:t,dtype:r};return this.makeTensorFromTensorInfo(s,i)}makeTensorFromTensorInfo(e,t){const{dataId:r,shape:i,dtype:s}=e,o=new ei(i,s,r,this.nextTensorId());return this.trackTensor(o,t),o}makeVariable(e,t=!0,r,i){r=r||this.nextVariableId().toString(),i!=null&&i!==e.dtype&&(e=e.cast(i));const s=new LS(e,t,r,this.nextTensorId());if(this.state.registeredVariables[s.name]!=null)throw new Error(`Variable with name ${s.name} was already registered`);return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*aN(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof LS||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*aN(e.dtype);this.state.numBytes-=r}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(i=>i.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,r,i,s,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:r,saved:s},l=Cz(e);l!=null&&(i=l.gradFunc),i!=null&&(a.gradient=c=>(c=c.map((u,d)=>{if(u==null){const h=r[d],f=Hc(h.size,h.dtype);return this.makeTensor(f,h.shape,h.dtype)}return u}),i(c.length>1?c:c[0],s,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=pq(e),r=new Set(t.map(s=>s.id));for(let s=0;s<this.state.activeScope.track.length;s++){const o=this.state.activeScope.track[s];!o.kept&&!r.has(o.id)&&o.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(s=>{!s.kept&&s.scopeId===i.id&&this.track(s)})}gradients(e,t,r,i=!1){if(te(t.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const s=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));te(s instanceof ei,()=>"The result y returned by f() must be a tensor.");const o=Dwe(this.state.activeTape,t,s);if(!i&&o.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[s.id]=r??Wwe(s.shape),Lwe(a,o,c=>this.tidy(c),Hwe);const l=t.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:s,grads:l}})}customGrad(e){return te(lN(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{te(t.every(a=>a instanceof ei),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const i={};t.forEach((a,l)=>{i[l]=a});const s=(a,l)=>(r=e(...t,l),te(r.value instanceof ei,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),te(lN(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(a,l)=>{const c=r.gradFunc(a,l),u=Array.isArray(c)?c:[c];te(u.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),te(u.every(h=>h instanceof ei),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((h,f)=>{d[f]=()=>h}),d};return this.runKernelFunc({forwardFunc:s,backwardsFunc:o,inputs:i})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=DS(),r=await this.backend.time(e);return r.wallMs=DS()-t,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Dz;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}eg.nextTensorId=0;eg.nextVariableId=0;function Wwe(n){const e=v8(gt(n),"float32");return be.makeTensor(e,n,"float32")}function gq(){const n=w8();if(n._tfengine==null){const e=new Wxe(n);n._tfengine=new eg(e)}return Xxe(n._tfengine.ENV),zwe(()=>n._tfengine),n._tfengine}const be=gq();function Hwe(n,e){const t={a:n,b:e};return be.runKernel(qR,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gwe(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qs=rn();Qs.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Qs.registerFlag("IS_BROWSER",()=>Gwe());Qs.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Qs.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Qs.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Qs.registerFlag("PROD",()=>!1);Qs.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Qs.getBool("DEBUG"));Qs.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Qs.registerFlag("IS_TEST",()=>!1);Qs.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Qs.getBool("DEBUG"));Qs.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Qs.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Qs.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pd(n,e){let t=n;if(Aa(n))return e==="string"?[]:[n.length];if(hq(n)){const i=n.channels||"RGBA";return[n.height,n.width*i.length]}else if(fq(n))return[n.buffer.size/(e==null?4:aN(e))];if(!Array.isArray(n))return[];const r=[];for(;Array.isArray(t)||Aa(t)&&e!=="string";)r.push(t.length),t=t[0];return Array.isArray(n)&&rn().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&yq(n,r,[]),r}function yq(n,e,t){if(t=t||[],!Array.isArray(n)&&!Aa(n)){te(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}te(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),te(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const r=e.slice(1);for(let i=0;i<n.length;++i)yq(n[i],r,t.concat(i))}function Lz(n,e,t,r){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${r}' must be ${n} tensor, but got ${e} tensor`)}}function K(n,e,t,r="numeric"){if(n instanceof dq())return Lz(r,n.dtype,e,t),n;let i=vx(n);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),Lz(r,i,e,t),n==null||!Aa(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const s=Pd(n,i);!Aa(n)&&!Array.isArray(n)&&(n=[n]);const a=i!=="string"?v2(n,i):mf(n,[],!0);return be.makeTensor(a,s,i)}function OS(n,e,t,r="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((s,o)=>K(s,`${e}[${o}]`,t,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vq="__op";function ge(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const r=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+vq;const i=(...s)=>{be.startScope(t);try{const o=r(...s);return pf(o)&&console.error("Cannot return a Promise inside of tidy."),be.endScope(o),o}catch(o){throw be.endScope(null),o}};return Object.defineProperty(i,"name",{value:t,configurable:!0}),i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qwe(n,e){const t=K(n,"real","complex"),r=K(e,"imag","complex");Jo(t.shape,r.shape,`real and imag shapes, ${t.shape} and ${r.shape}, must match in call to tf.complex().`);const i={real:t,imag:r};return be.runKernel(j8,i)}const xd=ge({complex_:qwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dd(n,e,t,r){if(r==null)r=vx(n);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(fq(n)||hq(n)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return be.backend.createTensorFromGPUData(n,e||t,r)}if(!Aa(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){ea(e);const i=gt(e),s=gt(t);te(i===s,()=>`Based on the provided shape, [${e}], the tensor should have ${i} values but has ${s}`);for(let o=0;o<t.length;++o){const a=t[o],l=o===t.length-1?a!==gt(e.slice(o)):!0;te(t[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!Aa(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=r!=="string"?v2(n,r):mf(n,[],!0),be.makeTensor(n,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $l(n,e,t){const r=Pd(n,t);return Dd(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gf={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class dl{static join(e){return new dl(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>Aa(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let r=0;r<e.length;r++){const i=e[r];r!==e.length-1&&i.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const s=t+i.byteLength;this.shards.push({buffer:i,start:t,end:s}),t=s}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const i=t-e,s=new ArrayBuffer(i),o=new Uint8Array(s);let a=0;for(let l=r;l<this.shards.length;l++){const c=this.shards[l],d=e+a-c.start,h=a,p=Math.min(t,c.end)-c.start,x=new Uint8Array(c.buffer,d,p-d);if(o.set(x,h),a+=x.length,t<c.end)break}return s}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(i){return e<i.start?-1:e>=i.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=Xwe(this.shards,t);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function Xwe(n,e){let t=0,r=n.length;for(;t<=r;){const i=Math.floor((r-t)/2)+t,s=e(n[i]);if(s===0)return i;s<0?r=i:t=i+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cm(){return be}function yn(n,e){return be.tidy(n,e)}function fr(n){pq(n).forEach(t=>t.dispose())}function Rl(n){return be.keep(n)}function M0(){return be.backendName}function Kwe(n,e,t=1){return be.registerBackend(n,e,t)}function tg(){return be.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wd=4;async function Ywe(n,e){const t=[],r=[],i=Array.isArray(n)?n.map(o=>o.name):Object.keys(n);for(let o=0;o<i.length;++o){const a=i[o],l=Array.isArray(n)?n[o].tensor:n[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async d=>{const h=await l.bytes(),f=h.reduce((v,y)=>v+y.length,0)+wd*h.length,p=new Uint8Array(f);let x=0;for(let v=0;v<h.length;v++){const y=h[v],b=new Uint8Array(new Uint32Array([y.length]).buffer);p.set(b,x),x+=wd,p.set(y,x),x+=y.length}d(p)});r.push(u)}else r.push(l.data());e!=null&&(c.group=e),t.push(c)}const s=await Promise.all(r);return{data:Jwe(s),specs:t}}function xq(n,e){const t=new dl(n),r={};let i=0;for(const s of e){const o=Zwe(s,(a,l)=>t.slice(i+a,i+l));r[s.name]=wq(s,t.slice(i,i+o)),i+=o}return r}function Zwe(n,e){const t=gt(n.shape);let r;if("quantization"in n){const i=n.quantization;r=gf[i.dtype]}else if(n.dtype==="string"){let i=0;for(let s=0;s<t;s++)i+=wd+new Uint32Array(e(i,i+wd))[0];return i}else r=gf[n.dtype];return t*r}async function Qwe(n,e){const t=gt(n.shape);let r;if("quantization"in n){const i=n.quantization;r=gf[i.dtype]}else if(n.dtype==="string"){let i=0;for(let s=0;s<t;s++)i+=wd+new Uint32Array(await e(i,i+wd))[0];return i}else r=gf[n.dtype];return t*r}function wq(n,e){const t=n.name,r=n.dtype,i=n.shape,s=gt(i);let o,a=0;if("quantization"in n){const l=n.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${n.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${n.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${n.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=gf[l.dtype],u=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(r==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){o=new Float32Array(u.length);for(let d=0;d<u.length;d++){const h=u[d];o[d]=h*l.scale+l.min}}else if(l.dtype==="float16")o=o1e()(u);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(r==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);o=new Int32Array(u.length);for(let d=0;d<u.length;d++){const h=u[d];o[d]=Math.round(h*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${t}': ${r}`);a+=s*c}else if(r==="string"){const l=gt(n.shape);o=[];for(let c=0;c<l;c++){const u=new Uint32Array(e.slice(a,a+wd))[0];a+=wd;const d=new Uint8Array(e.slice(a,a+u));o.push(d),a+=u}}else{const l=gf[r];if(r==="float32")o=new Float32Array(e);else if(r==="int32")o=new Int32Array(e);else if(r==="bool")o=new Uint8Array(e);else if(r==="complex64"){o=new Float32Array(e);const c=new Float32Array(o.length/2),u=new Float32Array(o.length/2);for(let p=0;p<c.length;p++)c[p]=o[p*2],u[p]=o[p*2+1];const d=$l(c,i,"float32"),h=$l(u,i,"float32"),f=xd(d,h);return d.dispose(),h.dispose(),f}else throw new Error(`Unsupported dtype in weight '${t}': ${r}`);a+=s*l}return $l(o,i,r)}async function Oz(n,e,t){let r=new Uint8Array(e);for(;r.byteLength<t;){const{done:i,value:s}=await n.read();if(i&&s==null){const a=t-r.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const o=new Uint8Array(r.length+s.byteLength);o.set(r,0),o.set(new Uint8Array(s),r.length),r=o}return r.buffer}async function bq(n,e){const t={},r=n.getReader();let i=new ArrayBuffer(0);for(const s of e){const o=await Qwe(s,async(c,u)=>(i=await Oz(r,i,u),i.slice(c,u)));i=await Oz(r,i,o);const a=i.slice(0,o);i=i.slice(o);const l=wq(s,a);if(t[s.name]=l,M0()==="webgpu"){const c=tg();"uploadToGPU"in c&&gt(l.shape)>=rn().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(l.dataId)}}return t}function Jwe(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(s=>{if(e+=s.byteLength,t.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});const r=new Uint8Array(e);let i=0;return t.forEach(s=>{r.set(new Uint8Array(s.buffer),i),i+=s.byteLength}),r.buffer}const QR=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Fz(n){return QR?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function e1e(n){if(QR)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let r=0,i=e.length;r<i;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function t1e(n){if(QR){const r=Buffer.from(n,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t.set([e.charCodeAt(r)],r);return t.buffer}function n1e(n){return dl.join(n)}function zz(n){const e="/";for(n=n.trim();n.endsWith(e);)n=n.slice(0,n.length-1);const t=n.split(e);return t[t.length-1]}function Sq(n,e){const t={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:e};return n.signature!=null&&(t.signature=n.signature),n.userDefinedMetadata!=null&&(t.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(t.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(t.initializerSignature=n.initializerSignature),n.trainingConfig!=null&&(t.trainingConfig=n.trainingConfig),t}function _q(n,e,t){const r={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(r.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=t}return n.signature!=null&&(r.signature=n.signature),n.userDefinedMetadata!=null&&(r.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(r.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(r.initializerSignature=n.initializerSignature),r}async function JR(n,e){let t,r;return n.weightsManifest!=null&&([t,r]=await e(n.weightsManifest)),_q(n,t,r)}function xx(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:Fz(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:Fz(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new dl(n.weightData).byteLength}}function bN(n){const e=[];for(const t of n)e.push(...t.weights);return e}function r1e(){const n=t=>{let r=t<<13,i=0;for(;!(r&8388608);)i-=8388608,r<<=1;return r&=-8388609,i+=947912704,r|i},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=n(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function i1e(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let e=1;e<31;e++)n[e]=e<<23;for(let e=33;e<63;e++)n[e]=2147483648+(e-32<<23);return n}function s1e(){const n=new Uint32Array(64);for(let e=0;e<64;e++)n[e]=1024;return n[0]=n[32]=0,n}function o1e(){const n=r1e(),e=i1e(),t=s1e();return r=>{const i=new ArrayBuffer(4*r.length),s=new Uint32Array(i);for(let o=0;o<r.length;o++){const a=r[o],l=n[t[a>>10]+(a&1023)]+e[a>>10];s[o]=l}return new Float32Array(i)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wr{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Wr.instance==null&&(Wr.instance=new Wr),Wr.instance}static registerSaveRouter(e){Wr.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Wr.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Wr.getHandlers(e,"save")}static getLoadHandlers(e,t){return Wr.getHandlers(e,"load",t)}static getHandlers(e,t,r){const i=[];return(t==="load"?Wr.getInstance().loadRouters:Wr.getInstance().saveRouters).forEach(o=>{const a=o(e,r);a!==null&&i.push(a)}),i}}const a1e=n=>Wr.registerSaveRouter(n),l1e=n=>Wr.registerLoadRouter(n),c1e=n=>Wr.getSaveHandlers(n),u1e=(n,e)=>Wr.getLoadHandlers(n,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SN="tensorflowjs",_N=1,Lh="models_store",zu="model_info_store";function Eq(){if(!rn().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function EN(n){const e=n.result;e.createObjectStore(Lh,{keyPath:"modelPath"}),e.createObjectStore(zu,{keyPath:"modelPath"})}class yf{constructor(e){if(this.indexedDB=Eq(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((r,i)=>{const s=this.indexedDB.open(SN,_N);s.onupgradeneeded=()=>EN(s),s.onsuccess=()=>{const o=s.result;if(t==null){const a=o.transaction(Lh,"readonly"),c=a.objectStore(Lh).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),i(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(c.result.modelArtifacts)},c.onerror=u=>(o.close(),i(c.error)),a.oncomplete=()=>o.close()}else{t.weightData=dl.join(t.weightData);const a=xx(t),l=o.transaction(zu,"readwrite");let c=l.objectStore(zu),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return i(h)}let d;u.onsuccess=()=>{d=o.transaction(Lh,"readwrite");const h=d.objectStore(Lh);let f;try{f=h.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:a})}catch(p){return i(p)}f.onsuccess=()=>r({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(zu);const x=c.delete(this.modelPath);x.onsuccess=()=>(o.close(),i(f.error)),x.onerror=v=>(o.close(),i(f.error))}},u.onerror=h=>(o.close(),i(u.error)),l.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},s.onerror=o=>i(s.error)})}}yf.URL_SCHEME="indexeddb://";const Cq=n=>rn().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(yf.URL_SCHEME)?d1e(n.slice(yf.URL_SCHEME.length)):null;Wr.registerSaveRouter(Cq);Wr.registerLoadRouter(Cq);function d1e(n){return new yf(n)}function h1e(n){return n.startsWith(yf.URL_SCHEME)?n.slice(yf.URL_SCHEME.length):n}class f1e{constructor(){this.indexedDB=Eq()}async listModels(){return new Promise((e,t)=>{const r=this.indexedDB.open(SN,_N);r.onupgradeneeded=()=>EN(r),r.onsuccess=()=>{const i=r.result,s=i.transaction(zu,"readonly"),a=s.objectStore(zu).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(i.close(),t(a.error)),s.oncomplete=()=>i.close()},r.onerror=i=>t(r.error)})}async removeModel(e){return e=h1e(e),new Promise((t,r)=>{const i=this.indexedDB.open(SN,_N);i.onupgradeneeded=()=>EN(i),i.onsuccess=()=>{const s=i.result,o=s.transaction(zu,"readwrite"),a=o.objectStore(zu),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return s.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),d=()=>{c=s.transaction(Lh,"readwrite");const f=c.objectStore(Lh).delete(e);f.onsuccess=()=>t(l.result.modelArtifactsInfo),f.onerror=p=>r(l.error)};u.onsuccess=d,u.onerror=h=>(d(),s.close(),r(l.error))}},l.onerror=u=>(s.close(),r(l.error)),o.oncomplete=()=>{c==null?s.close():c.oncomplete=()=>s.close()}},i.onerror=s=>r(i.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cc="/",Vp="tensorflowjs_models",Tq="info",p1e="model_topology",m1e="weight_specs",g1e="weight_data",y1e="model_metadata";function Mq(n){return{info:[Vp,n,Tq].join(Cc),topology:[Vp,n,p1e].join(Cc),weightSpecs:[Vp,n,m1e].join(Cc),weightData:[Vp,n,g1e].join(Cc),modelMetadata:[Vp,n,y1e].join(Cc)}}function Aq(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function v1e(n){const e=n.split(Cc);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(Cc)}function x1e(n){return n.startsWith(vf.URL_SCHEME)?n.slice(vf.URL_SCHEME.length):n}class vf{constructor(e){if(!rn().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Mq(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),i=xx(e),s=dl.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,e1e(s));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:i}}catch{throw Aq(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=r;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(i==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=i;const s=this.LS.getItem(this.keys.modelMetadata);if(s!=null){const a=JSON.parse(s);t.format=a.format,t.generatedBy=a.generatedBy,t.convertedBy=a.convertedBy,a.signature!=null&&(t.signature=a.signature),a.userDefinedMetadata!=null&&(t.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(t.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(t.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(t.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=t1e(o),t}}vf.URL_SCHEME="localstorage://";const Nq=n=>rn().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(vf.URL_SCHEME)?w1e(n.slice(vf.URL_SCHEME.length)):null;Wr.registerSaveRouter(Nq);Wr.registerLoadRouter(Nq);function w1e(n){return new vf(n)}class b1e{constructor(){te(rn().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),te(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=Vp+Cc,r=Cc+Tq;for(let i=0;i<this.LS.length;++i){const s=this.LS.key(i);if(s.startsWith(t)&&s.endsWith(r)){const o=v1e(s);e[o]=JSON.parse(this.LS.getItem(s))}}return e}async removeModel(e){e=x1e(e);const t=Mq(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(t.info));return Aq(t),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tm="://";class Ss{constructor(){this.managers={}}static getInstance(){return Ss.instance==null&&(Ss.instance=new Ss),Ss.instance}static registerManager(e,t){te(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Tm)&&(e=e.slice(0,e.indexOf(Tm))),te(e.length>0,()=>"scheme must not be an empty string.");const r=Ss.getInstance();te(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=t}static getManager(e){const t=Ss.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(Ss.getInstance().managers)}}function _b(n){if(n.indexOf(Tm)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Ss.getSchemes().join(",")}`);return{scheme:n.split(Tm)[0],path:n.split(Tm)[1]}}async function kq(n,e,t=!1){te(n!==e,()=>`Old path and new path are the same: '${n}'`);const r=Wr.getLoadHandlers(n);te(r.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),te(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${n}.`);const i=r[0],s=Wr.getSaveHandlers(e);te(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),te(s.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const o=s[0],a=_b(n).scheme,l=_b(n).path,c=a===_b(n).scheme,u=await i.load();t&&c&&await Ss.getManager(a).removeModel(l);const d=await o.save(u);return t&&!c&&await Ss.getManager(a).removeModel(l),d.modelArtifactsInfo}async function S1e(){const n=Ss.getSchemes(),e={};for(const t of n){const r=await Ss.getManager(t).listModels();for(const i in r){const s=t+Tm+i;e[s]=r[i]}}return e}async function _1e(n){const e=_b(n);return Ss.getManager(e.scheme).removeModel(e.path)}async function E1e(n,e){return kq(n,e,!1)}async function C1e(n,e){return kq(n,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T1e{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!rn().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const i=this.functionRefs[r.data.index];i(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return tq(e)}}if(rn().get("IS_BROWSER")){rn().setPlatform("browser",new T1e);try{Ss.registerManager(vf.URL_SCHEME,new b1e)}catch{}try{Ss.registerManager(yf.URL_SCHEME,new f1e)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M1e={importFetch:()=>require("node-fetch")};let xT;class A1e{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return rn().global.fetch!=null?rn().global.fetch(e,t):(xT==null&&(xT=M1e.importFetch()),xT(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}rn().get("IS_NODE")&&!rn().get("IS_BROWSER")&&rn().setPlatform("node",new A1e);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fr(n,e="float32",t){return e=e||"float32",ea(n),new Jm(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N1e(n,e){const t=K(n,"x","cast");if(!Uxe(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:t},i={dtype:e};return be.runKernel(XR,r,i)}const Cr=ge({cast_:N1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k1e(n){const t={x:K(n,"x","clone","string_or_numeric")};return be.runKernel(KR,t)}const rd=ge({clone_:k1e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iq(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gq();const I1e={buffer:Fr,cast:Cr,clone:rd,print:Iq};Uwe(I1e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R1e(n,e){let t=K(n,"a","add"),r=K(e,"b","add");[t,r]=oi(t,r);const i={a:t,b:r};return be.runKernel(qR,i)}const Xt=ge({add_:R1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P1e(n,e){let t=K(n,"a","floorDiv"),r=K(e,"b","floorDiv");[t,r]=oi(t,r);const i={a:t,b:r};return be.runKernel(b9,i)}const Rq=ge({floorDiv_:P1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D1e(n,e){let t=K(n,"a","div"),r=K(e,"b","div");if([t,r]=oi(t,r),t.dtype==="int32"&&r.dtype==="int32")return Rq(t,r);const i={a:t,b:r},s={};return be.runKernel(c9,i,s)}const On=ge({div_:D1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L1e(n,e){let t=K(n,"a","mul"),r=K(e,"b","mul");[t,r]=oi(t,r);const i={a:t,b:r};return be.runKernel(J9,i)}const lt=ge({mul_:L1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O1e(n){const e=K(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return be.runKernel(V8,t)}else{const t={x:e};return be.runKernel(b8,t)}}const Lo=ge({abs_:O1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1e(n){const t={x:K(n,"x","acos")};return be.runKernel(S8,t)}const z1e=ge({acos_:F1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U1e(n){const t={x:K(n,"x","acosh")};return be.runKernel(_8,t)}const B1e=ge({acosh_:U1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $1e(n){te(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),te(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const e=n.map((i,s)=>K(i,`tensors${s}`,"addN")),t=e[0];e.forEach(i=>{if(i.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(i=>{if(!Zs(i.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return be.runKernel(E8,r)}const j1e=ge({addN_:$1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V1e(n,e=null,t=!1){const i={x:K(n,"x","all","bool")},s={axis:e,keepDims:t};return be.runKernel(C8,i,s)}const W1e=ge({all_:V1e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H1e(n,e=null,t=!1){const i={x:K(n,"x","any","bool")},s={axis:e,keepDims:t};return be.runKernel(T8,i,s)}const G1e=ge({any_:H1e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q1e(n,e=0){const r={x:K(n,"x","argMax")},i={axis:e};return be.runKernel(M8,r,i)}const Pq=ge({argMax_:q1e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X1e(n,e=0){const r={x:K(n,"x","argMin")},i={axis:e};return be.runKernel(A8,r,i)}const K1e=ge({argMin_:X1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y1e(n){const t={x:K(n,"x","asin")};return be.runKernel(N8,t)}const Z1e=ge({asin_:Y1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q1e(n){const t={x:K(n,"x","asinh")};return be.runKernel(k8,t)}const J1e=ge({asinh_:Q1e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ebe(n){const t={x:K(n,"x","atan")};return be.runKernel(I8,t)}const tbe=ge({atan_:ebe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nbe(n,e){let t=K(n,"a","atan2"),r=K(e,"b","atan2");[t,r]=oi(t,r);const i={a:t,b:r};return be.runKernel(P8,i)}const rbe=ge({atan2_:nbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ibe(n){const t={x:K(n,"x","atanh")};return be.runKernel(R8,t)}const sbe=ge({atanh_:ibe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e3(n,e,t,r,i="NHWC",s){const o=n[3],a=[...e,o],l=Rg(i);return Ia(n,a,t,s,r,null,null,l)}function Ig(n,e,t,r,i,s,o="channelsLast"){const[a,l]=A0(e);let c;if(o==="channelsLast")c=[a,l,n[3],n[3]];else if(o==="channelsFirst")c=[a,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${o}`);return Ia(n,c,t,r,i,s,!1,o)}function x2(n,e,t,r,i,s,o="NDHWC"){const[a,l,c]=CN(e);let u,d;if(o==="NDHWC")d="channelsLast",u=[a,l,c,n[4],n[4]];else if(o==="NCDHW")d="channelsFirst",u=[a,l,c,n[1],n[1]];else throw new Error(`Unknown dataFormat ${o}`);return w2(n,u,t,r,i,!1,d,s)}function Ia(n,e,t,r,i,s,o=!1,a="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,d]=n;else if(a==="channelsFirst")[l,d,c,u]=n;else throw new Error(`Unknown dataFormat ${a}`);const[h,f,,p]=e,[x,v]=A0(t),[y,b]=A0(r),S=Mm(h,y),_=Mm(f,b),{padInfo:T,outHeight:M,outWidth:k}=lbe(i,c,u,x,v,S,_,s,a),P=o?p*d:p;let z;return a==="channelsFirst"?z=[l,P,M,k]:a==="channelsLast"&&(z=[l,M,k,P]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:d,outHeight:M,outWidth:k,outChannels:P,padInfo:T,strideHeight:x,strideWidth:v,filterHeight:h,filterWidth:f,effectiveFilterHeight:S,effectiveFilterWidth:_,dilationHeight:y,dilationWidth:b,inShape:n,outShape:z,filterShape:e}}function w2(n,e,t,r,i,s=!1,o="channelsLast",a){let[l,c,u,d,h]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,d,h]=n;else if(o==="channelsFirst")[l,h,c,u,d]=n;else throw new Error(`Unknown dataFormat ${o}`);const[f,p,x,,v]=e,[y,b,S]=CN(t),[_,T,M]=CN(r),k=Mm(f,_),P=Mm(p,T),z=Mm(x,M),{padInfo:I,outDepth:L,outHeight:W,outWidth:q}=cbe(i,c,u,d,y,b,S,k,P,z,a),$=s?v*h:v;let ne;return o==="channelsFirst"?ne=[l,$,L,W,q]:o==="channelsLast"&&(ne=[l,L,W,q,$]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:u,inWidth:d,inChannels:h,outDepth:L,outHeight:W,outWidth:q,outChannels:$,padInfo:I,strideDepth:y,strideHeight:b,strideWidth:S,filterDepth:f,filterHeight:p,filterWidth:x,effectiveFilterDepth:k,effectiveFilterHeight:P,effectiveFilterWidth:z,dilationDepth:_,dilationHeight:T,dilationWidth:M,inShape:n,outShape:ne,filterShape:e}}function obe(n,e,t,r,i){r==null&&(r=Dq(n,e,t));const s=n[0],o=n[1],a=N0((s-e+2*r)/t+1,i),l=N0((o-e+2*r)/t+1,i);return[a,l]}function abe(n,e,t,r,i,s){i==null&&(i=Dq(n,e[0],r[0]));const o=[0,0,0,t];for(let a=0;a<3;a++)n[a]+2*i>=e[a]&&(o[a]=N0((n[a]-e[a]+2*i)/r[a]+1,s));return o}function Dq(n,e,t,r=1){const i=Mm(e,r);return Math.floor((n[0]*(t-1)-t+i)/2)}function A0(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function CN(n){return typeof n=="number"?[n,n,n]:n}function Mm(n,e){return e<=1?n:n+(n-1)*(e-1)}function lbe(n,e,t,r,i,s,o,a,l){let c,u,d;if(typeof n=="number"){c={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const f=obe([e,t],s,r,n,a);u=f[0],d=f[1]}else if(n==="same"){u=Math.ceil(e/r),d=Math.ceil(t/i);const h=Math.max(0,(u-1)*r+s-e),f=Math.max(0,(d-1)*i+o-t),p=Math.floor(h/2),x=h-p,v=Math.floor(f/2),y=f-v;c={top:p,bottom:x,left:v,right:y,type:"SAME"}}else if(n==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-s+1)/r),d=Math.ceil((t-o+1)/i);else if(typeof n=="object"){const h=l==="channelsLast"?n[1][0]:n[2][0],f=l==="channelsLast"?n[1][1]:n[2][1],p=l==="channelsLast"?n[2][0]:n[3][0],x=l==="channelsLast"?n[2][1]:n[3][1];c={top:h,bottom:f,left:p,right:x,type:h===0&&f===0&&p===0&&x===0?"VALID":"EXPLICIT"},u=N0((e-s+h+f)/r+1,a),d=N0((t-o+p+x)/i+1,a)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:c,outHeight:u,outWidth:d}}function cbe(n,e,t,r,i,s,o,a,l,c,u){let d,h,f,p;if(n==="valid"&&(n=0),typeof n=="number"){d={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const v=abe([e,t,r,1],[a,l,c],1,[i,s,o],n,u);h=v[0],f=v[1],p=v[2]}else if(n==="same"){h=Math.ceil(e/i),f=Math.ceil(t/s),p=Math.ceil(r/o);const x=(h-1)*i+a-e,v=(f-1)*s+l-t,y=(p-1)*o+c-r,b=Math.floor(x/2),S=x-b,_=Math.floor(v/2),T=v-_,M=Math.floor(y/2),k=y-M;d={top:_,bottom:T,left:M,right:k,front:b,back:S,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:d,outDepth:h,outHeight:f,outWidth:p}}function N0(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function FS(n){const[e,t,r]=A0(n);return e===1&&t===1&&r===1}function nc(n,e){return FS(n)||FS(e)}function ng(n){return A0(n).every(e=>e>0)}function Rg(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function hl(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")te(T0(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(i=>{te(T0(i),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${i}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ube(n,e){const r={x:K(n,"x","reshape","string_or_numeric")},i={shape:e};return be.runKernel(m7,r,i)}const Ke=ge({reshape_:ube});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dbe(n,e,t,r,i){const s=K(n,"x","avgPool","float32"),o=1;te(nc(t,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`);let a=s,l=!1;s.rank===3&&(l=!0,a=Ke(s,[1,s.shape[0],s.shape[1],s.shape[2]])),te(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),hl("avgPool",r,i);const c={x:a},u={filterSize:e,strides:t,pad:r,dimRoundingMode:i};let d=be.runKernel(D8,c,u);return d=Cr(d,s.dtype),l?Ke(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Lq=ge({avgPool_:dbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hbe(n,e,t,r,i,s="NDHWC"){const o=K(n,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=Ke(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),te(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),te(s==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),te(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${t}'`),hl("avgPool3d",r,i);const c={x:a},u={filterSize:e,strides:t,pad:r,dimRoundingMode:i,dataFormat:s};let d=be.runKernel(L8,c,u);return d=Cr(d,a.dtype),l?Ke(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const fbe=ge({avgPool3d_:hbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pbe(n,e=0){te(n.length>=1,()=>"Pass at least one tensor to concat");const t=OS(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(s=>{if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${s.dtype}. `)}),t.length===1)return rd(t[0]);const r=t,i={axis:e};return be.runKernel(W8,r,i)}const Ui=ge({concat_:pbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mbe(n,e,t=!1,r=!1){let i=K(n,"a","matMul"),s=K(e,"b","matMul");[i,s]=oi(i,s);const o={a:i,b:s},a={transposeA:t,transposeB:r};return be.runKernel(O8,o,a)}const yr=ge({matMul_:mbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gbe(n){const t={x:K(n,"x","sigmoid","float32")};return be.runKernel(I7,t)}const Dc=ge({sigmoid_:gbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ybe(n,e,t){const r=K(n,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const i={x:r},s={begin:e,size:t};return be.runKernel(M7,i,s)}const Rn=ge({slice_:ybe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vbe(n){const t={x:K(n,"x","tanh","float32")};return be.runKernel(G7,t)}const TN=ge({tanh_:vbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xbe(n,e,t,r,i,s){const o=K(n,"forgetBias","basicLSTMCell"),a=K(e,"lstmKernel","basicLSTMCell"),l=K(t,"lstmBias","basicLSTMCell"),c=K(r,"data","basicLSTMCell"),u=K(i,"c","basicLSTMCell"),d=K(s,"h","basicLSTMCell"),h=Ui([c,d],1),f=yr(h,a),p=Xt(f,l),x=p.shape[0],v=p.shape[1]/4,y=[x,v],b=Rn(p,[0,0],y),S=Rn(p,[0,v],y),_=Rn(p,[0,v*2],y),T=Rn(p,[0,v*3],y),M=Xt(lt(Dc(b),TN(S)),lt(u,Dc(Xt(o,_)))),k=lt(TN(M),Dc(T));return[M,k]}const wbe=ge({basicLSTMCell_:xbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bbe(n,e,t){const r=K(n,"x","batchToSpaceND"),i=e.reduce((a,l)=>a*l);te(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),te(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),te(r.shape[0]%i===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${i}`);const s={x:r},o={blockShape:e,crops:t};return be.runKernel(F8,s,o)}const Oq=ge({batchToSpaceND_:bbe});function Sbe(n){let e;return n.rank===0||n.rank===1?e=Ke(n,[1,1,1,n.size]):n.rank===2?e=Ke(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=Ke(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _be(n,e,t,r,i,s){s==null&&(s=.001);const o=K(n,"x","batchNorm"),a=K(e,"mean","batchNorm"),l=K(t,"variance","batchNorm");let c;i!=null&&(c=K(i,"scale","batchNorm"));let u;r!=null&&(u=K(r,"offset","batchNorm")),te(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),te(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),te(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:Sbe(o),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:s},p=be.runKernel(S9,h,f);return Ke(p,o.shape)}const b2=ge({batchNorm_:_be});function Ebe(n,e,t,r,i,s){const o=K(n,"x","batchNorm"),a=K(e,"mean","batchNorm"),l=K(t,"variance","batchNorm");let c;i!=null&&(c=K(i,"scale","batchNorm"));let u;return r!=null&&(u=K(r,"offset","batchNorm")),te(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),te(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),te(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&te(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&te(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),b2(o,a,l,u,c,s)}const Cbe=ge({batchNorm2d_:Ebe});function Tbe(n,e,t,r,i,s){const o=K(n,"x","batchNorm"),a=K(e,"mean","batchNorm"),l=K(t,"variance","batchNorm");let c;i!=null&&(c=K(i,"scale","batchNorm"));let u;return r!=null&&(u=K(r,"offset","batchNorm")),te(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),te(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),te(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&te(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&te(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),b2(o,a,l,u,c,s)}const Mbe=ge({batchNorm3d_:Tbe});function Abe(n,e,t,r,i,s){const o=K(n,"x","batchNorm"),a=K(e,"mean","batchNorm"),l=K(t,"variance","batchNorm");let c;i!=null&&(c=K(i,"scale","batchNorm"));let u;return r!=null&&(u=K(r,"offset","batchNorm")),te(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),te(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),te(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&te(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&te(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),b2(o,a,l,u,c,s)}const Nbe=ge({batchNorm4d_:Abe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kbe(n,e,t){const r=K(n,"x","bincount"),i=K(e,"weights","bincount");te(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),te(t>=0,()=>`size must be non-negative, but got ${t}.`),te(i.size===r.size||i.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`);const s={x:r,weights:i},o={size:t};return be.runKernel(z8,s,o)}const Fq=ge({bincount_:kbe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ibe(n,e){const t=K(n,"x","bitwiseAnd"),r=K(e,"y","bitwiseAnd");if(!Zs(t.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${t.shape}, y: ${r.shape}`);if(t.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${t.dtype} and type of y: ${r.dtype}`);const i={a:t,b:r};return be.runKernel(Qxe,i)}const Rbe=ge({bitwiseAnd_:Ibe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pbe(n,e){const t=K(n,"s0","broadcastArgs","int32"),r=K(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${t.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const i={s0:t,s1:r};return be.runKernel(U8,i)}const Dbe=ge({broadcastArgs_:Pbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lbe(n,e){let t=K(n,"broadcastTo","x");const r=t.shape;if(ea(e),e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const c=t.shape.slice();for(;c.length<e.length;)c.unshift(1);t=Ke(t,c)}const i=t.shape,s=Array.from(e);for(let c=e.length-1;c>=0;c--)if(i[c]===e[c])s[c]=1;else if(t.shape[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(s.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return rd(t);const a={x:t},l={reps:s};return be.runKernel(YR,a,l)}const gv=ge({broadcastTo_:Lbe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Obe(n){const t={x:K(n,"x","ceil","float32")};return be.runKernel(B8,t)}const Fbe=ge({ceil_:Obe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wx(n,e,t){ea(n),t=t||vx(e);const r={shape:n,value:e,dtype:t};return be.runKernel(v9,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zbe(n,e,t){const r=K(n,"x","clipByValue");if(te(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return wx(r.shape,e,r.dtype);const i={x:r},s={clipValueMin:e,clipValueMax:t};return be.runKernel($8,i,s)}const zq=ge({clipByValue_:zbe});function Ube(n){return Ui(n,0)}const Bbe=ge({concat1d_:Ube});function $be(n,e){return Ui(n,e)}const jbe=ge({concat2d_:$be});function Vbe(n,e){return Ui(n,e)}const Wbe=ge({concat3d_:Vbe});function Hbe(n,e){return Ui(n,e)}const Gbe=ge({concat4d_:Hbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qbe(n,e,t,r,i="NHWC",s=[1,1],o){const a=K(n,"x","conv2d","float32"),l=K(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=Ke(a,[1,a.shape[0],a.shape[1],a.shape[2]])),te(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),te(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),hl("conv2d",r,o);const d=i==="NHWC"?c.shape[3]:c.shape[1];te(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),te(nc(t,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${s}'`),te(ng(s),()=>"Error in conv2D: Dilated rates should be larger than 0."),te(ng(t),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:c,filter:l},f={strides:t,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o},p=be.runKernel(H8,h,f);return u?Ke(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const S2=ge({conv2d_:qbe});function Xbe(n,e,t,r,i="NWC",s=1,o){const a=K(n,"x","conv1d"),l=K(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=Ke(a,[1,a.shape[0],a.shape[1]])),te(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),te(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),hl("conv1d",r,o),te(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),te(nc(t,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${s}'`),te(ng(s),()=>"Error in conv1D: Dilated rates should be larger than 0."),te(ng(t),()=>"Error in conv1D: Stride should be larger than 0."),te(i==="NWC",()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);const d=Ke(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=Ke(c,[c.shape[0],1,c.shape[1],c.shape[2]]),v=S2(h,d,[1,t],r,"NHWC",[1,s],o);return u?Ke(v,[v.shape[2],v.shape[3]]):Ke(v,[v.shape[0],v.shape[2],v.shape[3]])}const Kbe=ge({conv1d_:Xbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ybe(n,e,t,r,i,s="NHWC",o){te(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let a=n,l=e,c=!1;e.rank===3&&(c=!0,l=Ke(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,n[0],n[1],n[2]]),te(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),te(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),te(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const u=s==="NHWC"?a[3]:a[1],d=s==="NHWC"?l.shape[3]:l.shape[1];te(u===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${t.shape[2]}.`),te(d===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${t.shape[3]}.`),hl("conv2dDerInput",i,o);const h={dy:l,filter:t},f={strides:r,pad:i,dataFormat:s,dimRoundingMode:o,inputShape:a},p=be.runKernel(q8,h,f);return c?Ke(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Uq=ge({conv2DBackpropInput_:Ybe});function Zbe(n,e,t,r,i,s){const o=K(n,"x","conv2dTranspose"),a=K(e,"filter","conv2dTranspose");return Uq(t,o,a,r,i,"NHWC",s)}const Qbe=ge({conv2dTranspose_:Zbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jbe(n,e,t,r,i="NDHWC",s=[1,1,1]){const o=K(n,"x","conv3d"),a=K(e,"filter","conv3d");let l=o,c=!1;o.rank===4&&(c=!0,l=Ke(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),te(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),te(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),te(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),te(nc(t,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${s}'`),te(i==="NDHWC",()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`),te(ng(s),()=>"Error in conv3D: Dilated rates should be larger than 0."),te(ng(t),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:a},d={strides:t,pad:r,dataFormat:i,dilations:s},h=be.runKernel(X8,u,d);return c?Ke(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const eSe=ge({conv3d_:Jbe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tSe(n,e,t,r,i){te(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let s=n,o=e,a=!1;e.rank===4&&(a=!0,o=Ke(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),s=[1,n[0],n[1],n[2],n[3]]);const l=s[4],c=o.shape[4];te(s.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),te(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),te(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),te(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),te(c===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${t.shape[4]}.`);const u={dy:o,filter:t},d={pad:i,strides:r,inputShape:s},h=be.runKernel(K8,u,d);return a?Ke(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const nSe=ge({conv3DBackpropInput_:tSe});function rSe(n,e,t,r,i){const s=K(n,"x","conv3dTranspose"),o=K(e,"filter","conv3dTranspose");return nSe(t,s,o,r,i)}const iSe=ge({conv3dTranspose_:rSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sSe(n){const t={x:K(n,"x","cos","float32")};return be.runKernel(Y8,t)}const oSe=ge({cos_:sSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aSe(n){const t={x:K(n,"x","cosh","float32")};return be.runKernel(Z8,t)}const lSe=ge({cosh_:aSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cSe(n,e=0,t=!1,r=!1){const s={x:K(n,"x","cumprod")},o={axis:e,exclusive:t,reverse:r};return be.runKernel(Q8,s,o)}const uSe=ge({cumprod_:cSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dSe(n,e=0,t=!1,r=!1){const s={x:K(n,"x","cumsum")},o={axis:e,exclusive:t,reverse:r};return be.runKernel(J8,s,o)}const hSe=ge({cumsum_:dSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fSe(n,e,t,r=!1){const i=K(n,"x","denseBincount"),s=K(e,"weights","denseBincount");te(i.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),te(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),te(t>=0,()=>`size must be non-negative, but got ${t}.`),te(s.size===i.size||s.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${s.shape}.`);const o={x:i,weights:s},a={size:t,binaryOutput:r};return be.runKernel(t9,o,a)}const pSe=ge({denseBincount_:fSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mSe(n,e,t="NHWC"){const r=K(n,"x","depthToSpace","float32"),i=t==="NHWC"?r.shape[1]:r.shape[2],s=t==="NHWC"?r.shape[2]:r.shape[3],o=t==="NHWC"?r.shape[3]:r.shape[1];te(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),te(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e}  for depthToSpace with input shape
    ${r.shape}`),te(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e} for depthToSpace with input shape
        ${r.shape}`),te(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`);const a={x:r},l={blockSize:e,dataFormat:t};return be.runKernel(n9,a,l)}const gSe=ge({depthToSpace_:mSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ySe(n,e,t,r,i="NHWC",s=[1,1],o){const a=K(n,"x","depthwiseConv2d","float32"),l=K(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=Ke(a,[1,a.shape[0],a.shape[1],a.shape[2]])),te(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),te(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=i==="NHWC"?c.shape[3]:c.shape[1];te(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),hl("depthwiseConv2d",r,o);const h={x:c,filter:l},f={strides:t,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o},p=be.runKernel(r9,h,f);return u?Ke(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const t3=ge({depthwiseConv2d_:ySe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vSe(n){const t={x:K(n,"x","diag")};return be.runKernel(o9,t)}const xSe=ge({diag_:vSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wSe(n,e,t,r,i=[1,1],s="NHWC"){const o=K(n,"x","dilation2d"),a=K(e,"filter","dilation2d");te(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),te(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),te(s==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let l=o,c=!1;o.rank===3&&(l=Ke(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),te(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const u={x:l,filter:a},d={strides:t,pad:r,dilations:i},h=be.runKernel(a9,u,d);return c?Ke(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const bSe=ge({dilation2d_:wSe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zS(n,e){const t=n.length,r=[];for(let i=0;i<t;i++){const s=t-1-i,o=n[s]||1;(e[e.length-1-i]||1)>1&&o===1&&r.unshift(s)}return r}function SSe(n,e){const t=[];for(let r=0;r<e.length;r++){const i=n[n.length-r-1],s=e.length-r-1,o=e[s];(i==null||i===1&&o>1)&&t.unshift(s)}return t}function _r(n,e){const t=Math.max(n.length,e.length),r=new Array(t);for(let i=0;i<t;i++){let s=n[n.length-i-1];s==null&&(s=1);let o=e[e.length-i-1];if(o==null&&(o=1),s===1)r[t-i-1]=o;else if(o===1)r[t-i-1]=s;else if(s!==o){const a=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(a)}else r[t-i-1]=s}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Se(n,e){let t=K(n,"a","equal","string_or_numeric"),r=K(e,"b","equal","string_or_numeric");[t,r]=oi(t,r),_r(t.shape,r.shape);const i={a:t,b:r};return be.runKernel(f9,i)}const Bq=ge({equal_:_Se});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ESe(n,e,t){const r=K(e,"a","where"),i=K(t,"b","where"),s=K(n,"condition","where","bool"),o=_r(_r(s.shape,r.shape),i.shape),a=gv(s,o),l=gv(r,o),c=gv(i,o),u={condition:a,t:l,e:c};return be.runKernel(C7,u)}const id=ge({where_:ESe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CSe(n){const t={x:K(n,"x","zerosLike")};return be.runKernel(Z7,t)}const qo=ge({zerosLike_:CSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TSe(n,e){let t=K(n,"a","div"),r=K(e,"b","div");[t,r]=oi(t,r);const i=On(t,r),s=qo(i),o=Bq(r,s);return id(o,s,i)}const MSe=ge({divNoNan_:TSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ASe(n,e){const t=K(n,"t1","dot"),r=K(e,"t2","dot");te((t.rank===1||t.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${r.rank}.`);const i=t.rank===1?t.size:t.shape[1],s=r.rank===1?r.size:r.shape[0];if(te(i===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${s}.`),t.rank===1&&r.rank===1){const o=Ke(t,[1,-1]),a=Ke(r,[-1,1]),l=yr(o,a);return Ke(l,[])}else if(t.rank===1&&r.rank===2){const o=Ke(t,[1,-1]),a=Ke(r,[r.shape[0],r.shape[1]]),l=yr(o,a);return Ke(l,[l.size])}else if(t.rank===2&&r.rank===1){const o=Ke(r,[-1,1]),a=yr(t,o);return Ke(a,[a.size])}else{const o=Ke(r,[r.shape[0],r.shape[1]]);return yr(t,o)}}const NSe=ge({dot_:ASe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kSe(n,...e){const t=e.map((i,s)=>K(i,`tensors${s}`,"einsum")),r={equation:n};return be.runKernel(u9,t,r)}const Wp=ge({einsum_:kSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ISe(n){const t={x:K(n,"x","elu","float32")};return be.runKernel(d9,t)}const $q=ge({elu_:ISe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RSe(n,e){const t=K(n,"x","ensureShape","string_or_numeric");if(!Lxe(t.shape,e))throw new Error(`EnsureShape: Shape of tensor ${t.shape} is not compatible with expected shape ${e}`);return n}const PSe=ge({ensureShape_:RSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DSe(n){let e=K(n,"x","erf");te(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Cr(e,"float32"));const t={x:e};return be.runKernel(h9,t)}const LSe=ge({erf_:DSe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jq(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function OSe(n,e,t){const r=n.length+e.length,i=[];let s=0,o=0;for(let a=0;a<r;a++)t.indexOf(a)===-1?i.push(n[s++]):i.push(e[o++]);return i}function _2(n,e){const t=[],r=n.length;for(let s=0;s<r;s++)e.indexOf(s)===-1&&t.push(n[s]);const i=e.map(s=>n[s]);return[t,i]}function bx(n,e){const t=e.map(r=>1);return OSe(n,t,e)}function n3(n,e,t){te(jq(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function Sx(n,e){if(jq(n,e))return null;const t=[];for(let r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);return n.forEach(r=>t.push(r)),t}function Vq(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function _x(n,e){const t=[];for(let r=e-n;r<e;++r)t.push(r);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FSe(n,e=null,t=!1){const i={x:K(n,"x","max")},s={reductionIndices:e,keepDims:t};return be.runKernel(j9,i,s)}const Am=ge({max_:FSe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zSe(n,e=null,t=!1){const i={x:K(n,"x","min")},s={axis:e,keepDims:t};return be.runKernel(X9,i,s)}const MN=ge({min_:zSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function USe(n,e){let t=K(n,"base","pow"),r=K(e,"exp","pow");[t,r]=oi(t,r);const i={a:t,b:r};return be.runKernel(l7,i)}const k0=ge({pow_:USe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zn(n,e){if((Aa(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Aa(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Dd(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BSe(n){const t={x:K(n,"x","sqrt","float32")};return be.runKernel(P7,t)}const Gc=ge({sqrt_:BSe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Se(n){const e=K(n,"x","square"),t={};return be.runKernel("Square",{x:e},t)}const Ea=ge({square_:$Se});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jSe(n,e=null,t=!1){let r=K(n,"x","sum");r.dtype==="bool"&&(r=Cr(r,"int32"));const i={x:r},s={axis:e,keepDims:t};return be.runKernel(D7,i,s)}const Pr=ge({sum_:jSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VSe(n,e="euclidean",t=null,r=!1){n=K(n,"x","norm");const i=Wq(n,e,t);let s=i.shape;if(r){const o=ka(t,n.shape);s=bx(i.shape,o)}return Ke(i,s)}function Wq(n,e,t=null){if(n.rank===0)return Lo(n);if(n.rank!==1&&t===null)return Wq(Ke(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return Pr(Lo(n),t);if(e===1/0)return Am(Lo(n),t);if(e===-1/0)return MN(Lo(n),t);if(e==="euclidean"||e===2)return Gc(Pr(k0(Lo(n),zn(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return Am(Pr(Lo(n),t[0]),t[1]-1);if(e===1/0)return Am(Pr(Lo(n),t[1]),t[0]);if(e===-1/0)return MN(Pr(Lo(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return Gc(Pr(Ea(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const E2=ge({norm_:VSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WSe(n,e=null,t=!1){return E2(n,"euclidean",e,t)}const HSe=ge({euclideanNorm_:WSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GSe(n){const t={x:K(n,"x","exp")};return be.runKernel(p9,t)}const qc=ge({exp_:GSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qSe(n,e=0){const t=K(n,"x","expandDims","string_or_numeric");te(e<=t.rank,()=>"Axis must be <= rank of the tensor");const r={input:t},i={dim:e};return be.runKernel(m9,r,i)}const Fo=ge({expandDims_:qSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XSe(n){const t={x:K(n,"x","expm1")};return be.runKernel(g9,t)}const KSe=ge({expm1_:XSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YSe(n,e){const t=K(n,"x","tile","string_or_numeric");te(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const r={x:t},i={reps:e};return be.runKernel(YR,r,i)}const yv=ge({tile_:YSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZSe(n,e,t,r="float32"){e==null&&(e=n);const i=Fr([n,e],r),s=n<=e?n:e;for(let a=0;a<s;++a)i.set(1,a,a);const o=Ke(i.toTensor(),[n,e]);if(t==null)return o;if(t.length===1)return yv(Fo(o,0),[t[0],1,1]);if(t.length===2)return yv(Fo(Fo(o,0),0),[t[0],t[1],1,1]);if(t.length===3)return yv(Fo(Fo(Fo(o,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const Hq=ge({eye_:ZSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QSe(n){const t={x:K(n,"x","floor","float32")};return be.runKernel(w9,t)}const Gq=ge({floor_:QSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JSe(n,e,t=0,r=0){const i=K(n,"x","gather"),s=K(e,"indices","gather","int32"),o={x:i,indices:s},a={axis:t,batchDims:r};return be.runKernel(_9,o,a)}const qq=ge({gather_:JSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e_e(n,e){let t=K(n,"a","greater","string_or_numeric"),r=K(e,"b","greater","string_or_numeric");[t,r]=oi(t,r),_r(t.shape,r.shape);const i={a:t,b:r};return be.runKernel(C9,i)}const C2=ge({greater_:e_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t_e(n,e){let t=K(n,"a","greaterEqual","string_or_numeric"),r=K(e,"b","greaterEqual","string_or_numeric");[t,r]=oi(t,r),_r(t.shape,r.shape);const i={a:t,b:r};return be.runKernel(T9,i)}const Xq=ge({greaterEqual_:t_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n_e(n){const t={input:K(n,"input","imag")};return be.runKernel(A9,t)}const T2=ge({imag_:n_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r_e(n){const t={x:K(n,"x","isFinite")};return be.runKernel(N9,t)}const i_e=ge({isFinite_:r_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s_e(n){const t={x:K(n,"x","isInf")};return be.runKernel(k9,t)}const o_e=ge({isInf_:s_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a_e(n){const t={x:K(n,"x","isNaN")};return be.runKernel(I9,t)}const l_e=ge({isNaN_:a_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c_e(n,e=.2){const r={x:K(n,"x","leakyRelu")},i={alpha:e};return be.runKernel(R9,r,i)}const Kq=ge({leakyRelu_:c_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u_e(n,e){let t=K(n,"a","less","string_or_numeric"),r=K(e,"b","less","string_or_numeric");[t,r]=oi(t,r),_r(t.shape,r.shape);const i={a:t,b:r};return be.runKernel(P9,i)}const AN=ge({less_:u_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_e(n,e){let t=K(n,"a","lessEqual","string_or_numeric"),r=K(e,"b","lessEqual","string_or_numeric");[t,r]=oi(t,r),_r(t.shape,r.shape);const i={a:t,b:r};return be.runKernel(D9,i)}const r3=ge({lessEqual_:d_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h_e(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");const r={start:n,stop:e,num:t};return be.runKernel(L9,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f_e(n,e=5,t=1,r=1,i=.5){const s=K(n,"x","localResponseNormalization");te(s.rank===4||s.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${s.rank}.`),te(T0(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=s,a=!1;s.rank===3&&(a=!0,o=Ke(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const l={x:o},c={depthRadius:e,bias:t,alpha:r,beta:i},u=be.runKernel($9,l,c);return a?Ke(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const p_e=ge({localResponseNormalization_:f_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m_e(n){const t={x:K(n,"x","log","float32")};return be.runKernel(O9,t)}const I0=ge({log_:m_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g_e(n){const t={x:K(n,"x","log1p")};return be.runKernel(F9,t)}const Yq=ge({log1p_:g_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y_e(n,e){te(lN(n),()=>"The f passed in variableGrads(f) must be a function"),te(e==null||Array.isArray(e)&&e.every(c=>c instanceof LS),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const c in be.registeredVariables)e.push(be.registeredVariables[c])}const r=t?e.filter(c=>!c.trainable):null,i=e.length;e=e.filter(c=>c.trainable),te(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);const s=!0,{value:o,grads:a}=be.gradients(n,e,null,s);te(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),te(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),r!=null&&r.forEach(c=>l[c.name]=null),{value:o,grads:l}}function Xc(n){return be.customGrad(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v_e(n){const t={x:K(n,"x","neg")};return be.runKernel(e7,t)}const jl=ge({neg_:v_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x_e(n){const t={x:K(n,"x","softplus")};return be.runKernel(R7,t)}const Zq=ge({softplus_:x_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w_e(n){const e=K(n,"x","logSigmoid");return Xc(r=>({value:jl(Zq(jl(r))),gradFunc:o=>lt(o,Dc(jl(r)))}))(e)}const b_e=ge({logSigmoid_:w_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S_e(n,e){let t=K(n,"a","sub"),r=K(e,"b","sub");[t,r]=oi(t,r);const i={a:t,b:r};return be.runKernel(W7,i)}const Sn=ge({sub_:S_e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function __e(n,e=-1){const t=K(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Xc((i,s)=>{const a=Am(i,e,!0),l=Sn(i,a),c=Sn(Cr(l,"float32"),I0(Pr(qc(l),e,!0)));return s([c]),{value:c,gradFunc:(d,h)=>{const[f]=h,p=!0,x=qc(f);return Sn(d,lt(Pr(d,e,p),x))}}})(t)}const E_e=ge({logSoftmax_:__e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C_e(n,e=null,t=!1){const r=K(n,"x","logSumExp"),i=ka(e,r.shape),s=Am(r,i,!0),o=Sn(r,s),a=qc(o),l=Pr(a,i),c=I0(l),u=Xt(Ke(s,c.shape),c);if(t){const d=bx(u.shape,i);return Ke(u,d)}return u}const Qq=ge({logSumExp_:C_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T_e(n,e){const t=K(n,"a","logicalAnd","bool"),r=K(e,"b","logicalAnd","bool");_r(t.shape,r.shape);const i={a:t,b:r};return be.runKernel(z9,i)}const US=ge({logicalAnd_:T_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M_e(n){const t={x:K(n,"x","logicalNot","bool")};return be.runKernel(U9,t)}const Jq=ge({logicalNot_:M_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A_e(n,e){const t=K(n,"a","logicalOr","bool"),r=K(e,"b","logicalOr","bool");_r(t.shape,r.shape);const i={a:t,b:r};return be.runKernel(B9,i)}const eX=ge({logicalOr_:A_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N_e(n,e){const t=K(n,"a","logicalXor","bool"),r=K(e,"b","logicalXor","bool");return _r(t.shape,r.shape),US(eX(n,e),Jq(US(n,e)))}const k_e=ge({logicalXor_:N_e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j1=2147483648;function I_e(n,e,t="left"){const r=K(n,"sortedSequence","searchSorted"),i=K(e,"values","searchSorted"),s=r.shape[r.shape.length-1],o=i.shape[i.shape.length-1],a=Ke(r,[-1,s]),l=Ke(i,[-1,o]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(gt(l.shape)>=j1)throw new Error(`values tensor size must less than ${j1}`);if(a.shape[1]>=j1)throw new Error(`trailing dim_size must less than ${j1} for int32 output type, was ${a.shape[1]}`);const c={sortedSequence:a,values:l},u={side:t};return be.runKernel(E7,c,u)}const i3=ge({searchSorted_:I_e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R_e(n,e){return i3(n,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P_e(n,e,t,r,i){const s=K(n,"x","maxPool"),o=1;let a=s,l=!1;s.rank===3&&(l=!0,a=Ke(s,[1,s.shape[0],s.shape[1],s.shape[2]])),te(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),te(nc(t,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),hl("maxPool",r,i);const c={x:a},u={filterSize:e,strides:t,pad:r,dimRoundingMode:i},d=be.runKernel(W9,c,u);return l?Ke(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const tX=ge({maxPool_:P_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D_e(n,e=[1,1,1],t,r,i,s="NDHWC"){const o=K(n,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=Ke(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),te(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),te(s==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),hl("maxPool3d",r,i);const c={x:a},u={filterSize:e,strides:t,pad:r,dimRoundingMode:i,dataFormat:s},d=be.runKernel(H9,c,u);return l?Ke(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const L_e=ge({maxPool3d_:D_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O_e(n,e,t,r,i=!1){const o={x:K(n,"x","maxPoolWithArgmax")},a={filterSize:e,strides:t,pad:r,includeBatchInIndex:i},l=be.runKernel(G9,o,a);return{result:l[0],indexes:l[1]}}const F_e=ge({maxPoolWithArgmax_:O_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z_e(n,e){let t=K(n,"a","maximum"),r=K(e,"b","maximum");[t,r]=oi(t,r),t.dtype==="bool"&&(t=Cr(t,"int32"),r=Cr(r,"int32")),_r(t.shape,r.shape);const i={a:t,b:r};return be.runKernel(V9,i)}const nX=ge({maximum_:z_e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U_e(n,e=null,t=!1){const i={x:K(n,"x","mean")},s={axis:e,keepDims:t};return be.runKernel(q9,i,s)}const BS=ge({mean_:U_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bd(n,e="float32"){if(ea(n),e==="complex64"){const r=bd(n,"float32"),i=bd(n,"float32");return xd(r,i)}const t=Hc(gt(n),e);return be.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oh(n,e="float32"){if(ea(n),e==="complex64"){const r=Oh(n,"float32"),i=bd(n,"float32");return xd(r,i)}const t=v8(gt(n),e);return be.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B_e(n,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError(`${t} is not a valid third argument to meshgrid`);if(n===void 0)return[];let r=K(n,"x","meshgrid",n instanceof ei?n.dtype:"float32");if(e===void 0)return[r];let i=K(e,"y","meshgrid",e instanceof ei?e.dtype:"float32");const s=gt(r.shape),o=gt(i.shape);return t==="xy"?(r=Ke(r,[1,-1]),i=Ke(i,[-1,1]),[yr(Oh([o,1],r.dtype),r),yr(i,Oh([1,s],i.dtype))]):(r=Ke(r,[-1,1]),i=Ke(i,[1,-1]),[yr(r,Oh([1,o],r.dtype)),yr(Oh([s,1],i.dtype),i)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $_e(n,e){let t=K(n,"a","minimum"),r=K(e,"b","minimum");[t,r]=oi(t,r),t.dtype==="bool"&&(t=Cr(t,"int32"),r=Cr(r,"int32")),_r(t.shape,r.shape);const i={a:t,b:r};return be.runKernel(K9,i)}const R0=ge({minimum_:$_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j_e(n,e,t){te(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const r=K(n,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");te(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const i=t==="reflect"?1:0;for(let a=0;a<r.rank;a++)te(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),te(e[a][0]>=0&&e[a][0]<=r.shape[a]-i&&e[a][1]>=0&&e[a][1]<=r.shape[a]-i,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-i} or less than 0 for input of shape ${r.shape}`);const s={paddings:e,mode:t},o={x:r};return be.runKernel(Y9,o,s)}const rX=ge({mirrorPad_:j_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V_e(n,e){let t=K(n,"a","mod"),r=K(e,"b","mod");[t,r]=oi(t,r);const i={a:t,b:r};return be.runKernel(Z9,i)}const W_e=ge({mod_:V_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H_e(n,e=null,t=!1){n=K(n,"x","moments");const r=ka(e,n.shape),i=BS(n,r,t);let s=i.shape;t||(s=bx(i.shape,r));const o=Ea(Sn(Cr(n,"float32"),Ke(i,s))),a=BS(o,r,t);return{mean:i,variance:a}}const G_e=ge({moments_:H_e});function q_e(n,e,t,r){const i=K(e,"data","multiRNNCell"),s=OS(t,"c","multiRNNCell"),o=OS(r,"h","multiRNNCell");let a=i;const l=[];for(let d=0;d<n.length;d++){const h=n[d](a,s[d],o[d]);l.push(h[0]),l.push(h[1]),a=h[1]}const c=[],u=[];for(let d=0;d<l.length;d+=2)c.push(l[d]),u.push(l[d+1]);return[c,u]}const X_e=ge({multiRNNCell_:q_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K_e(n,e,t,r=!1){const i=K(n,"logits","multinomial"),s=i.size,o=i.rank;if(s<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${s}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);t=t||Math.random();const l={logits:o===1?Ke(i,[1,-1]):i},c={numSamples:e,seed:t,normalized:r},u=be.runKernel(Q9,l,c);return o===1?Ke(u,[u.size]):u}const Y_e=ge({multinomial_:K_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z_e(n,e){let t=K(n,"a","notEqual","string_or_numeric"),r=K(e,"b","notEqual","string_or_numeric");[t,r]=oi(t,r),_r(t.shape,r.shape);const i={a:t,b:r};return be.runKernel(t7,i)}const iX=ge({notEqual_:Z_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q_e(n,e,t=1,r=0,i="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:K(n,"indices","oneHot","int32")},a={dtype:i,depth:e,onValue:t,offValue:r};return be.runKernel(s7,o,a)}const J_e=ge({oneHot_:Q_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e2e(n){const t={x:K(n,"x","onesLike")};return be.runKernel(i7,t)}const t2e=ge({onesLike_:e2e});function n2e(n,e){const t=K(n,"v1","outerProduct"),r=K(e,"v2","outerProduct");te(t.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${t.rank} and ${r.rank}.`);const i=Ke(t,[-1,1]),s=Ke(r,[1,-1]);return yr(i,s)}const r2e=ge({outerProduct_:n2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i2e(n,e,t=0){const r=K(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:e,constantValue:t},s={x:r};return be.runKernel(a7,s,i)}const Sd=ge({pad_:i2e});function s2e(n,e,t=0){return te(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Sd(n,[e],t)}const o2e=ge({pad1d_:s2e});function a2e(n,e,t=0){return te(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Sd(n,e,t)}const l2e=ge({pad2d_:a2e});function c2e(n,e,t=0){return te(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Sd(n,e,t)}const u2e=ge({pad3d_:c2e});function d2e(n,e,t=0){return te(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Sd(n,e,t)}const h2e=ge({pad4d_:d2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f2e(n,e,t){const r=K(n,"x","spaceToBatchND");te(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),te(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),te(r.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+t[l-1][0]+t[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const i={x:r},s={blockShape:e,paddings:t};return be.runKernel(L7,i,s)}const sX=ge({spaceToBatchND_:f2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p2e(n,e,t,r,i,s,o){i==null&&(i=[1,1]),s==null&&(s=1),r===0&&(r="valid");const a=K(n,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=Ke(a,[1,a.shape[0],a.shape[1],a.shape[2]])),te(nc(s,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${i}'`);const u=Ig(l.shape,e,s,i,r),d=[u.dilationHeight,u.dilationWidth];let h;r==="same"?h=g2e([u.filterHeight,u.filterWidth],d):h=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[p,x]=m2e([u.inHeight,u.inWidth],d,h),v=f?r:"valid",y=f?l:sX(l,d,p),S=(t==="avg"?()=>Lq(y,e,s,v,o):()=>tX(y,e,s,v,o))(),_=f?S:Oq(S,d,x);return c?Ke(_,[_.shape[1],_.shape[2],_.shape[3]]):_}function m2e(n,e,t){const r=t.map(u=>u[0]),i=t.map(u=>u[1]),s=n.concat(r,i),o=e.map((u,d)=>(u-s[d]%u)%u),a=i.map((u,d)=>u+o[d]),l=e.map((u,d)=>[r[d],a[d]]),c=e.map((u,d)=>[0,o[d]]);return[l,c]}function g2e(n,e){const r=n.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),i=r.map(o=>Math.floor(o/2)),s=r.map((o,a)=>o-i[a]);return r.map((o,a)=>[i[a],s[a]])}const y2e=ge({pool_:p2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v2e(n,e){const t=K(n,"x","prelu"),r=K(e,"alpha","prelu"),i={x:t,alpha:r};return be.runKernel(c7,i)}const oX=ge({prelu_:v2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x2e(n,e=null,t=!1){let r=K(n,"x","prod");r.dtype==="bool"&&(r=Cr(r,"int32"));const i={x:r},s={axis:e,keepDims:t};return be.runKernel(u7,i,s)}const w2e=ge({prod_:x2e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b2e(n,e,t,r){const i=n.map((u,d)=>K(u,`tensors${d}`,"raggedGather","int32")),s=K(e,"paramsDenseValues","raggedGather"),o=K(t,"indices","raggedGather","int32"),a={paramsNestedSplits:i,paramsDenseValues:s,indices:o},l={outputRaggedRank:r},c=be.runKernel(awe,a,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const S2e=ge({raggedGather_:b2e});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _2e(n,e,t){const r=K(n,"starts","raggedRange"),i=K(e,"limits","raggedRange",r.dtype),s=K(t,"deltas","raggedRange",r.dtype),o={starts:r,limits:i,deltas:s},a=be.runKernel(lwe,o);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const E2e=ge({raggedRange_:_2e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C2e(n,e,t,r,i){const s=K(n,"shape","raggedTensorToTensor","int32"),o=K(e,"values","raggedTensorToTensor"),a=K(t,"defaultValue","raggedTensorToTensor",o.dtype),l=r.map((d,h)=>K(d,`tensors${h}`,"raggedTensorToTensor","int32")),c={shape:s,values:o,defaultValue:a,rowPartitionTensors:l},u={rowPartitionTypes:i};return be.runKernel(cwe,c,u)}const T2e=ge({raggedTensorToTensor_:C2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2e(n,e,t){ea(n);const r=gt(n);let i=null;if(t==null||t==="float32")i=new Float32Array(r);else if(t==="int32")i=new Int32Array(r);else if(t==="bool")i=new Uint8Array(r);else throw new Error(`Unknown data type ${t}`);for(let s=0;s<r;s++)i[s]=e();return be.makeTensor(i,n,t)}const A2e=ge({rand_:M2e});var s3={exports:{}};s3.exports;(function(n){(function(e,t,r){function i(l){var c=this,u=a();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function s(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var u=new i(l),d=c&&c.state,h=u.next;return h.int32=function(){return u.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&s(d,u),h.state=function(){return s(u,{})}),h}function a(){var l=4022871197,c=function(u){u=String(u);for(var d=0;d<u.length;d++){l+=u.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return c}t&&t.exports?t.exports=o:this.alea=o})(Pl,n)})(s3);var N2e=s3.exports,o3={exports:{}};o3.exports;(function(n){(function(e,t,r){function i(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function s(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var c=new i(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&s(u,c),d.state=function(){return s(c,{})}),d}t&&t.exports?t.exports=o:this.xor128=o})(Pl,n)})(o3);var k2e=o3.exports,a3={exports:{}};a3.exports;(function(n){(function(e,t,r){function i(a){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function s(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var c=new i(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&s(u,c),d.state=function(){return s(c,{})}),d}t&&t.exports?t.exports=o:this.xorwow=o})(Pl,n)})(a3);var I2e=a3.exports,l3={exports:{}};l3.exports;(function(n){(function(e,t,r){function i(a){var l=this;l.next=function(){var u=l.x,d=l.i,h,f;return h=u[d],h^=h>>>7,f=h^h<<24,h=u[d+1&7],f^=h^h>>>10,h=u[d+3&7],f^=h^h>>>3,h=u[d+4&7],f^=h^h<<7,h=u[d+7&7],h=h^h<<13,f^=h^h<<9,u[d]=f,l.i=d+1&7,f};function c(u,d){var h,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[h&7]=f[h&7]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],u.x=f,u.i=0,h=256;h>0;--h)u.next()}c(l,a)}function s(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var c=new i(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.x&&s(u,c),d.state=function(){return s(c,{})}),d}t&&t.exports?t.exports=o:this.xorshift7=o})(Pl,n)})(l3);var R2e=l3.exports,c3={exports:{}};c3.exports;(function(n){(function(e,t,r){function i(a){var l=this;l.next=function(){var u=l.w,d=l.X,h=l.i,f,p;return l.w=u=u+1640531527|0,p=d[h+34&127],f=d[h=h+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=d[h]=p^f,l.i=h,p+(u^u>>>16)|0};function c(u,d){var h,f,p,x,v,y=[],b=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,b=Math.max(b,d.length)),p=0,x=-32;x<b;++x)d&&(f^=d.charCodeAt((x+32)%d.length)),x===0&&(v=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,x>=0&&(v=v+1640531527|0,h=y[x&127]^=f+v,p=h==0?p+1:0);for(p>=128&&(y[(d&&d.length||0)&127]=-1),p=127,x=4*128;x>0;--x)f=y[p+34&127],h=y[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,y[p]=f^h;u.w=v,u.X=y,u.i=p}c(l,a)}function s(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var c=new i(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.X&&s(u,c),d.state=function(){return s(c,{})}),d}t&&t.exports?t.exports=o:this.xor4096=o})(Pl,n)})(c3);var P2e=c3.exports,u3={exports:{}};u3.exports;(function(n){(function(e,t,r){function i(a){var l=this,c="";l.next=function(){var d=l.b,h=l.c,f=l.d,p=l.a;return d=d<<25^d>>>7^h,h=h-f|0,f=f<<24^f>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-f|0,l.d=f<<16^h>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function s(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var c=new i(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&s(u,c),d.state=function(){return s(c,{})}),d}t&&t.exports?t.exports=o:this.tychei=o})(Pl,n)})(u3);var D2e=u3.exports,aX={exports:{}};const L2e={},O2e=Object.freeze(Object.defineProperty({__proto__:null,default:L2e},Symbol.toStringTag,{value:"Module"})),F2e=oY(O2e);(function(n){(function(e,t,r){var i=256,s=6,o=52,a="random",l=r.pow(i,s),c=r.pow(2,o),u=c*2,d=i-1,h;function f(_,T,M){var k=[];T=T==!0?{entropy:!0}:T||{};var P=y(v(T.entropy?[_,S(t)]:_??b(),3),k),z=new p(k),I=function(){for(var L=z.g(s),W=l,q=0;L<c;)L=(L+q)*i,W*=i,q=z.g(1);for(;L>=u;)L/=2,W/=2,q>>>=1;return(L+q)/W};return I.int32=function(){return z.g(4)|0},I.quick=function(){return z.g(4)/4294967296},I.double=I,y(S(z.S),t),(T.pass||M||function(L,W,q,$){return $&&($.S&&x($,z),L.state=function(){return x(z,{})}),q?(r[a]=L,W):L})(I,P,"global"in T?T.global:this==r,T.state)}function p(_){var T,M=_.length,k=this,P=0,z=k.i=k.j=0,I=k.S=[];for(M||(_=[M++]);P<i;)I[P]=P++;for(P=0;P<i;P++)I[P]=I[z=d&z+_[P%M]+(T=I[P])],I[z]=T;(k.g=function(L){for(var W,q=0,$=k.i,ne=k.j,Y=k.S;L--;)W=Y[$=d&$+1],q=q*i+Y[d&(Y[$]=Y[ne=d&ne+W])+(Y[ne]=W)];return k.i=$,k.j=ne,q})(i)}function x(_,T){return T.i=_.i,T.j=_.j,T.S=_.S.slice(),T}function v(_,T){var M=[],k=typeof _,P;if(T&&k=="object")for(P in _)try{M.push(v(_[P],T-1))}catch{}return M.length?M:k=="string"?_:_+"\0"}function y(_,T){for(var M=_+"",k,P=0;P<M.length;)T[d&P]=d&(k^=T[d&P]*19)+M.charCodeAt(P++);return S(T)}function b(){try{var _;return h&&(_=h.randomBytes)?_=_(i):(_=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(_)),S(_)}catch{var T=e.navigator,M=T&&T.plugins;return[+new Date,e,M,e.screen,S(t)]}}function S(_){return String.fromCharCode.apply(0,_)}if(y(r.random(),t),n.exports){n.exports=f;try{h=F2e}catch{}}else r["seed"+a]=f})(typeof self<"u"?self:Pl,[],Math)})(aX);var z2e=aX.exports,U2e=N2e,B2e=k2e,$2e=I2e,j2e=R2e,V2e=P2e,W2e=D2e,Pf=z2e;Pf.alea=U2e;Pf.xor128=B2e;Pf.xorwow=$2e;Pf.xorshift7=j2e;Pf.xor4096=V2e;Pf.tychei=W2e;var d3=Pf;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h3{constructor(e,t,r,i,s){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=s||Math.random();this.random=d3.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const i=this.nextVal;return this.nextVal=NaN,i}let e,t,r=!1;for(;!r;){let i,s,o;do i=2*this.random()-1,s=2*this.random()-1,o=i*i+s*s;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*i*a,t=this.mean+this.stdDev*s*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class H2e{constructor(e,t,r,i){this.alpha=e,this.beta=1/t,this.dtype=r;const s=i||Math.random();this.randu=d3.alea(s.toString()),this.randn=new h3(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,r,i,s,o;for(;;){do i=this.randn.nextValue(),o=1+this.c*i;while(o<=0);if(o*=o*o,e=i*i,t=1-.331*e*e,r=.5*e+this.d*(1-o+Math.log(o)),s=this.randu(),s<t||Math.log(s)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class G2e{constructor(e=0,t=1,r,i){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=d3.alea(i)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q2e(n,e,t=1,r="float32",i){if(ea(n),t==null&&(t=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const s=new H2e(e,t,r,i),o=Fr(n,r);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}const X2e=ge({randomGamma_:q2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K2e(n,e=0,t=1,r,i){if(ea(n),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const s=new h3(e,t,r,!1,i),o=Fr(n,r);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}const lX=ge({randomNormal_:K2e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y2e(n,e,t){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return lX(n,0,1,e,t)}const Z2e=ge({randomStandardNormal_:Y2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q2e(n,e=0,t=1,r="float32",i){ea(n);const s=Fr(n,r),o=new G2e(e,t,null,i);for(let a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}const f3=ge({randomUniform_:Q2e});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J2e(n,e,t,r){return f3(n,e,t,"int32",r)}const eEe=ge({randomUniformInt_:J2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P0(n,e,t=1,r="float32"){if(t===0)throw new Error("Cannot have a step of zero");const i={start:n,stop:e,step:t,dtype:r};return be.runKernel(d7,{},i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tEe(n){const t={input:K(n,"input","real")};return be.runKernel(h7,t)}const D0=ge({real_:tEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nEe(n){const t={x:K(n,"x","reciprocal")};return be.runKernel(f7,t)}const rEe=ge({reciprocal_:nEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iEe(n){const t={x:K(n,"x","relu")};return be.runKernel(p7,t)}const M2=ge({relu_:iEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sEe(n){const t={x:K(n,"x","relu6")};return be.runKernel(v7,t)}const cX=ge({relu6_:sEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oEe(n,e){const r={x:K(n,"x","reverse")},i={dims:e};return be.runKernel(x7,r,i)}const xf=ge({reverse_:oEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aEe(n){const e=K(n,"x","reverse");return te(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),xf(e,0)}const lEe=ge({reverse1d_:aEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cEe(n,e){const t=K(n,"x","reverse");return te(t.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${t.rank}.`),xf(t,e)}const uEe=ge({reverse2d_:cEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dEe(n,e){const t=K(n,"x","reverse");return te(t.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${t.rank}.`),xf(t,e)}const hEe=ge({reverse3d_:dEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fEe(n,e){const t=K(n,"x","reverse");return te(t.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${t.rank}.`),xf(t,e)}const pEe=ge({reverse4d_:fEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mEe(n){const t={x:K(n,"x","round")};return be.runKernel(w7,t)}const uX=ge({round_:mEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gEe(n){const t={x:K(n,"x","rsqrt","float32")};return be.runKernel(b7,t)}const yEe=ge({rsqrt_:gEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vEe(n){const t={x:K(n,"x","selu")};return be.runKernel(T7,t)}const xEe=ge({selu_:vEe});function wEe(n,e,t,r,i,s=[1,1],o="NHWC"){const a=K(n,"x","separableConv2d"),l=K(e,"depthwiseFilter","separableConv2d"),c=K(t,"pointwiseFilter","separableConv2d");let u=a,d=!1;if(a.rank===3&&(d=!0,u=Ke(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");te(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),te(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),te(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),te(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),te(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const h=l.shape[2],f=l.shape[3];te(c.shape[2]===h*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*f}, but got ${c.shape[2]}.`);const p=t3(u,l,r,i,o,s),v=S2(p,c,1,"valid",o);return d?Ke(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const bEe=ge({separableConv2d_:wEe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function SEe(n,e){const t=K(n,"x","setdiff1d"),r=K(e,"y","setdiff1d");te(t.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${t.dtype}) and y (${r.dtype}).`),te(t.rank===1,()=>`x should be 1D tensor, but got x (${t.shape}).`),te(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const i=await t.data(),s=await r.data(),o=new Set(s);let a=0;for(let u=0;u<i.length;u++)o.has(i[u])||a++;const l=new Jm([a],t.dtype),c=new Jm([a],"int32");for(let u=0,d=0;u<i.length;u++)o.has(i[u])||(l.values[d]=i[u],c.values[d]=u,d++);return[l.toTensor(),c.toTensor()]}const _Ee=SEe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EEe(n){const t={x:K(n,"x","sign")};return be.runKernel(k7,t)}const CEe=ge({sign_:EEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TEe(n){const t={x:K(n,"x","sin","float32")};return be.runKernel(A7,t)}const MEe=ge({sin_:TEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AEe(n){const t={x:K(n,"x","sinh")};return be.runKernel(N7,t)}const NEe=ge({sinh_:AEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kEe(n,e,t){const r=K(n,"x","slice1d");return te(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Rn(r,[e],[t])}const IEe=ge({slice1d_:kEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function REe(n,e,t){const r=K(n,"x","slice2d");return te(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Rn(r,e,t)}const PEe=ge({slice2d_:REe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DEe(n,e,t){const r=K(n,"x","slice3d");return te(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Rn(r,e,t)}const LEe=ge({slice3d_:DEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OEe(n,e,t){const r=K(n,"x","slice4d");return te(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Rn(r,e,t)}const FEe=ge({slice4d_:OEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zEe(n,e=-1){const t=K(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const r={logits:t},i={dim:e};return be.runKernel(F7,r,i)}const UEe=ge({softmax_:zEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BEe(n){te(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return be.runKernel(y9,e)}const p3=ge({fft_:BEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ee(n){te(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return be.runKernel(M9,e)}const $S=ge({ifft_:$Ee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jEe(n){const e=n.shape[n.shape.length-1],t=n.size/e;let r;if(e<=2){const i=Ke(n,[t,e]);r=$S(i)}else{const i=[t,2*(e-1)],s=Ke(D0(n),[t,e]),o=Ke(T2(n),[t,e]),a=xf(Rn(s,[0,1],[t,e-2]),1),l=lt(xf(Rn(o,[0,1],[t,e-2]),1),zn(-1)),c=Ui([s,a],1),u=Ui([o,l],1),d=Ke(xd(c,u),[i[0],i[1]]);r=$S(d)}if(r=D0(r),n.rank===3&&n.shape[0]!==0){const i=r,s=n.shape[0];r=Ke(r,[s,r.shape[0]/s,r.shape[1]]),i.dispose()}return r}const dX=ge({irfft_:jEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VEe(n,e,t=0){const i={x:K(n,"x","split")},s={numOrSizeSplits:e,axis:t};return be.runKernel(O7,i,s)}const L0=ge({split_:VEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WEe(n,e){te(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const r=n.size/t;let i;if(e!=null&&e<t){const p=n.shape.map(v=>0),x=n.shape.map(v=>v);x[n.shape.length-1]=e,i=Rn(n,p,x),t=e}else if(e!=null&&e>t){const p=n.shape.map(x=>x);p[n.shape.length-1]=e-t,i=Ui([n,bd(p)],n.shape.length-1),t=e}else i=n;const s=qo(i),o=Ke(xd(i,s),[r,t]),a=p3(o),l=Math.floor(t/2)+1,c=D0(a),u=T2(a),d=L0(c,[l,t-l],c.shape.length-1),h=L0(u,[l,t-l],u.shape.length-1),f=i.shape.slice();return f[i.shape.length-1]=l,Ke(xd(d[0],h[0]),f)}const m3=ge({rfft_:WEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HEe(n,e){let t=K(n,"a","squaredDifference"),r=K(e,"b","squaredDifference");[t,r]=oi(t,r),_r(t.shape,r.shape);const i={a:t,b:r},s={};return be.runKernel($7,i,s)}const hX=ge({squaredDifference_:HEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GEe(n,e){const t=K(n,"x","squeeze","string_or_numeric");return Ke(t,Fxe(t.shape,e).newShape)}const mr=ge({squeeze_:GEe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qEe(n,e=0){const t=OS(n,"tensors","stack","string_or_numeric");te(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&te(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const r=t,i={axis:e};return be.runKernel(o7,r,i)}const Kc=ge({stack_:qEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XEe(n,e=0){const r={x:K(n,"x","step")},i={alpha:e};return be.runKernel(Q7,r,i)}const fX=ge({step_:XEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KEe(n,e,t,r,i=0,s=0,o=0,a=0,l=0){const u={x:K(n,"x","stridedSlice","string_or_numeric")},d={begin:e,end:t,strides:r,beginMask:i,endMask:s,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return be.runKernel(j7,u,d)}const YEe=ge({stridedSlice_:KEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZEe(n){const t={x:K(n,"x","tan","float32")};return be.runKernel(H7,t)}const QEe=ge({tan_:ZEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function is(n,e){kg(n);const t=Pd(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Dd(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ca(n,e,t){if(kg(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Pd(n,t);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Dd(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pX(n,e,t){if(kg(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Pd(n,t);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Dd(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JEe(n,e,t){if(kg(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Pd(n,t);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Dd(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eCe(n,e,t){if(kg(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Pd(n,t);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Dd(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tCe(n,e,t){if(kg(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Pd(n,t);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,Dd(n,e,r,t)}function nCe(n,e,t){const r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${r}, and batchDim: ${i}.`;if(t.rank<i)throw new Error(s+` update.rank < ${i}. `);if(n.length<r+(t.rank-i))throw new Error(s+` Output shape length < ${r+(t.rank-i)}`);if(t.rank!==i+n.length-r)throw new Error(s+` update.rank != ${i+n.length-r}`);for(let o=0;o<i;++o)if(t.shape[o]!==e.shape[o])throw new Error(s+` updates.shape[${o}] (${t.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<t.rank-i;++o)if(t.shape[o+i]!==n[o+r])throw new Error(s+` updates.shape[${o+i}] (${t.shape[o+i]}) != shape[${o+i}] (${n[o+i]})`)}function mX(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}nCe(t,e,n)}function g3(n,e,t){const r=e.shape.length,i=r>1?e.shape[r-1]:1,s=t.length;let o=1;for(let d=i;d<s;++d)o*=t[d];const a=i<1?1:i,l=gt(e.shape)/a,c=[...os(t.slice(0,i)),1],u=gt(t);return{sliceRank:i,numUpdates:l,sliceSize:o,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rCe(n,e,t){const r=K(n,"tensor","tensorScatterupdate"),i=K(e,"indices","tensorScatterupdate","int32"),s=K(t,"updates","tensorScatterupdate");if(mX(s,i,r.shape),r.dtype!==s.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${s.dtype}.`);const o={tensor:r,indices:i,updates:s},a={};return be.runKernel(_7,o,a)}const iCe=ge({tensorScatterUpdate_:rCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sCe(n,e=1,t=!0){const r=K(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${e}`);const s={x:r},o={k:e,sorted:t},[a,l]=be.runKernel(q7,s,o);return{values:a,indices:l}}const oCe=ge({topk_:sCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aCe(n,e=0,t=1,r,i){if(ea(n),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const s=new h3(e,t,r,!0,i),o=Fr(n,r);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}const lCe=ge({truncatedNormal_:aCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cCe(n,e=0){const t=K(n,"x","unique","string_or_numeric");te(t.rank>0,()=>"The input tensor must be at least 1D");const r={x:t},i={axis:e},[s,o]=be.runKernel(vwe,r,i);return{values:s,indices:o}}const uCe=ge({unique_:cCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dCe(n,e,t){const r=K(n,"x","unsortedSegmentSum"),i=K(e,"segmentIds","unsortedSegmentSum","int32");te(T0(t),()=>"numSegments must be of dtype int");const s={x:r,segmentIds:i},o={numSegments:t};return be.runKernel(Y7,s,o)}const hCe=ge({unsortedSegmentSum_:dCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fCe(n,e=0){const t=K(n,"x","unstack","string_or_numeric");te(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const r={value:t},i={axis:e};return be.runKernel(K7,r,i)}const Df=ge({unstack_:fCe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pCe(n,e){return i3(n,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mCe(n,e=!0,t,r){return be.makeVariable(n,e,t,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gCe(n,e){const t=[];for(let s=0;s<e.length;s++)e[s]&&t.push(s);const r=Fr(n,"int32"),i=Fr([t.length,n.length],"int32");for(let s=0;s<t.length;s++){const o=r.indexToLoc(t[s]),a=s*n.length;i.values.set(o,a)}return i.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function yCe(n){const e=K(n,"condition","whereAsync","bool"),t=await e.data(),r=gCe(e.shape,t);return n!==e&&e.dispose(),r}const gX=yCe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function vCe(n,e,t){const r=K(n,"tensor","boolMask"),i=K(e,"mask","boolMask","bool"),s=t??0,o=i.rank,a=r.shape;te(o>0,()=>"mask cannot be scalar"),Jo(a.slice(s,s+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let x=s;x<s+o;x++)l*=a[x];const c=a.slice(0,s).concat([l],a.slice(s+o)),u=Ke(r,c),d=Ke(i,[-1]),h=await gX(d),f=mr(h,[1]),p=qq(u,f,s);return n!==r&&r.dispose(),e!==i&&i.dispose(),f.dispose(),u.dispose(),d.dispose(),h.dispose(),p}const xCe=vCe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wCe(n,e,t){const r=K(n,"x","transpose");if(e==null&&(e=r.shape.map((o,a)=>a).reverse()),te(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(o=>{te(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const i={x:r},s={perm:e};return r.dtype==="complex64"?yn(()=>{let o=D0(r),a=T2(r);return o=be.runKernel(bb,{x:o},s),a=be.runKernel(bb,{x:a},s),t&&(a=jl(a)),xd(o,a)}):be.runKernel(bb,i,s)}const NN=ge({transpose_:wCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bCe(n,e,t,r,i=!0){const s=K(n,"v","movingAverage"),o=K(e,"x","movingAverage"),a=K(t,"decay","movingAverage");jwe(s,o),te(Zs(s.shape,o.shape),()=>"Shape mismatch in v and x");const l=zn(1),c=Sn(l,a);let u=lt(Sn(o,s),c);if(i){te(r!=null,()=>"When using zeroDebias: true, step is required.");const d=K(r,"step","movingAverage");u=On(u,Sn(l,k0(a,d)))}return Xt(s,u)}const SCe=ge({movingAverage_:bCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ce(n,e,t){ea(t);const r=K(n,"indices","scatterND","int32"),i=K(e,"updates","scatterND");mX(i,r,t);const s={indices:r,updates:i},o={shape:t};return be.runKernel(S7,s,o)}const ECe=ge({scatterND_:_Ce});function CCe(n,e,t,r){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const i=n.rank>0?n.shape[0]:1,s=n.rank>1?n.shape[1]:1;if(t.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${t.length}, should be: ${s}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===i))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${i}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TCe(n,e,t,r=0){ea(t);const i=K(n,"sparseIndices","sparseToDense","int32"),s=K(e,"sparseValues","sparseToDense","string_or_numeric"),o=K(r,"defaultValue","sparseToDense",s.dtype);CCe(i,s,t,o);const a={sparseIndices:i,sparseValues:s,defaultValue:o},l={outputShape:t};return be.runKernel(B7,a,l)}const MCe=ge({sparseToDense_:TCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ACe(n,e){const t=K(e,"indices","gatherND","int32"),i={params:K(n,"x","gatherND","string_or_numeric"),indices:t};return be.runKernel(E9,i)}const NCe=ge({gatherND_:ACe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kCe(n,e){if(e==null)return n.shape.slice();if(Zs(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let r=0;r<n.shape.length;r++)e[r]==null&&n.shape[r]!=null?t.push(n.shape[r]):t.push(e[r]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ICe(n,e,t,r){const i=K(n,"x","dropout");if(te(i.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),te(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof ei?i.clone():i;const s=kCe(i,t),o=1-e,a=On(Gq(Xt(f3(s,0,1,"float32",r),o)),o);return lt(i,a)}const RCe=ge({dropout_:ICe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yX(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function y3(n,e,t){const r=1-n%2,i=new Float32Array(n);for(let s=0;s<n;++s){const o=2*Math.PI*s/(n+r-1);i[s]=e-t*Math.cos(o)}return is(i,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function PCe(n,e,t=1){const r=K(n,"predictions","inTopK"),i=K(e,"targets","inTopK");te(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),te(r.rank-1===i.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`),Jo(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const s=r.shape[r.shape.length-1];te(t>0&&t<=s,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${s}), but got ${t}`);const o=await r.data(),a=await i.data(),[l,c]=[o.length/s,s],u=yd("bool",l);for(let d=0;d<l;d++){const h=d*c,f=o.subarray(h,h+c),p=[];for(let x=0;x<f.length;x++)p.push({value:f[x],index:x});p.sort((x,v)=>v.value-x.value),u[d]=0;for(let x=0;x<t;x++)if(p[x].index===a[d]){u[d]=1;break}}return n!==r&&r.dispose(),e!==i&&i.dispose(),$l(u,i.shape,"bool")}const DCe=PCe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LCe(n,e,t,r,i,s="NHWC",o){let a=n;n.rank===3&&(a=Ke(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=Ke(e,[1,e.shape[0],e.shape[1],e.shape[2]])),te(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),te(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),te(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const c=s==="NHWC"?a.shape[3]:a.shape[1],u=s==="NHWC"?l.shape[3]:l.shape[1];te(c===t[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${t[2]}.`),te(u===t[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${t[3]}).`),hl("conv2dDerFilter",i,o);const d={x:a,dy:l},h={strides:r,pad:i,dataFormat:s,dimRoundingMode:o,filterShape:t};return be.runKernel(G8,d,h)}const OCe=ge({conv2DBackpropFilter_:LCe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v3(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return lt(n,fX(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function x3(n,e){let t=e;const r=SSe(n.shape,e.shape);return r.length>0&&(t=Pr(t,r)),Ke(t,n.shape)}function w3(n,e,t,r){if(e==="linear")return n;if(e==="relu")return M2(n);if(e==="elu")return $q(n);if(e==="relu6")return cX(n);if(e==="prelu")return oX(n,t);if(e==="leakyrelu")return Kq(n,r);if(e==="sigmoid")return Dc(n);throw new Error(`Unknown fused activation ${e}.`)}const b3=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FCe({x:n,filter:e,strides:t,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",b3(be.state.gradientDepth,l)===!1){te(i==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let M=S2(n,e,t,r,i,s,o);return a!=null&&(M=Xt(M,a)),w3(M,l,c,u)}const d=K(n,"x","conv2d","float32"),h=K(e,"filter","conv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=Ke(d,[1,d.shape[0],d.shape[1],d.shape[2]])),te(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),te(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),hl("fused conv2d",r,o);const x=i==="NHWC"?f.shape[3]:f.shape[1];te(h.shape[2]===x,()=>`Error in conv2d: depth of input (${x}) must match input depth for filter ${h.shape[2]}.`),te(nc(t,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${s}'`);const v=Ia(f.shape,h.shape,t,s,r,o);let y;a!=null&&(y=K(a,"bias","fused conv2d"),[y]=oi(y,d),i==="NHWC"?_r(v.outShape,y.shape):(te(y.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`),te(y.shape.length===0||y.shape[0]===v.outChannels||y.shape[0]===1,()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let b;if(c!=null){const M=c.shape;if(te(M.length<=1||M.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${M.length}.`),M.length===1)te(M[0]===1||M[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${M}) is not compatible with the number of output channels (${v.outChannels}).`);else if(M.length===3)try{_r(M,v.outShape)}catch{const P=`Error in fused conv2d: PReLU activation weights (${M}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(P)}b=K(c,"prelu weights","fused conv2d")}const S=(M,k)=>{te(i==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);const[P,z,I,L]=k,W=v3(M,I,l);te(FS(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const q=Uq(z.shape,W,P,t,r),$=OCe(z,W,P.shape,t,r),ne=[q,$];if(L!=null){const Y=x3(L,W);ne.push(Y)}return ne},_={x:f,filter:h,bias:y,preluActivationWeights:b},T={strides:t,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?Xc((k,P,z)=>{let I=be.runKernel(fN,_,T);return z([P,k,I]),p&&(I=Ke(I,[I.shape[1],I.shape[2],I.shape[3]])),{value:I,gradFunc:S}})(f,h):Xc((k,P,z,I)=>{let L=be.runKernel(fN,_,T);return I([P,k,L,z]),p&&(L=Ke(L,[L.shape[1],L.shape[2],L.shape[3]])),{value:L,gradFunc:S}})(f,h,y)}const zCe=ge({fusedConv2d_:FCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UCe(n,e,t,r,i,s=[1,1],o){let a=n;n.rank===3&&(a=Ke(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=Ke(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:r,pad:i,dimRoundingMode:o,dilations:s,filterShape:t};return be.runKernel(i9,c,u)}const BCe=ge({depthwiseConv2dNativeBackpropFilter_:UCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ce(n,e,t,r,i,s=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=Ke(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:t},u={strides:r,pad:i,dimRoundingMode:o,dilations:s,inputShape:n},d=be.runKernel(s9,c,u);return l?Ke(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const jCe=ge({depthwiseConv2dNativeBackpropInput_:$Ce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VCe({x:n,filter:e,strides:t,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(b3(be.state.gradientDepth,l)===!1){let T=t3(n,e,t,r,i,s,o);return a!=null&&(T=Xt(T,a)),w3(T,l,c,u)}const d=K(n,"x","depthwiseConv2d","float32"),h=K(e,"filter","depthwiseConv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=Ke(d,[1,d.shape[0],d.shape[1],d.shape[2]])),te(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),te(h.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),te(f.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),s==null&&(s=[1,1]),te(nc(t,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${t} and dilations '${s}'`),hl("fused depthwiseConv2d",r,o);const x=Ia(f.shape,h.shape,t,s,r,o,!0);let v;a!=null&&(v=K(a,"bias","fused conv2d"),[v]=oi(v,d),_r(x.outShape,v.shape));let y;c!=null&&(y=K(c,"prelu weights","fused depthwiseConv2d"));const b=(T,M)=>{te(FS(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);const[k,P,z,I]=M,L=v3(T,z,l),W=jCe(P.shape,L,k,t,r,s,o),q=BCe(P,L,k.shape,t,r,s,o);if(I!=null){const $=x3(v,L);return[W,q,$]}return[W,q]},S={x:f,filter:h,bias:v,preluActivationWeights:y},_={strides:t,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?Xc((M,k,P)=>{let z=be.runKernel(pN,S,_);return P([k,M,z]),p&&(z=Ke(z,[z.shape[1],z.shape[2],z.shape[3]])),{value:z,gradFunc:b}})(f,h):Xc((M,k,P,z)=>{let I=be.runKernel(pN,S,_);return z([k,M,I,P]),p&&(I=Ke(I,[I.shape[1],I.shape[2],I.shape[3]])),{value:I,gradFunc:b}})(f,h,v)}const WCe=ge({fusedDepthwiseConv2d_:VCe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HCe({a:n,b:e,transposeA:t=!1,transposeB:r=!1,bias:i,activation:s="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(b3(be.state.gradientDepth,s)===!1){let L=yr(n,e,t,r);return i!=null&&(L=Xt(L,i)),w3(L,s,o,a)}let l=K(n,"a","fused matMul"),c=K(e,"b","fused matMul");[l,c]=oi(l,c);const u=t?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?c.shape[c.rank-1]:c.shape[c.rank-2],h=t?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),x=c.shape.slice(0,-2),v=gt(p),y=gt(x);te(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${t} and transposeB=${r} must match.`);const S=_r(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([h,f]),_=t?Ke(l,[v,u,h]):Ke(l,[v,h,u]),T=r?Ke(c,[y,f,d]):Ke(c,[y,d,f]);let M;i!=null&&(M=K(i,"bias","fused matMul"),[M]=oi(M,l),_r(S,M.shape));let k;o!=null&&(k=K(o,"prelu weights","fused matMul"));const P=(L,W)=>{const[q,$,ne,Y]=W,we=v3(Ke(L,ne.shape),ne,s);let H,X;if(!t&&!r?(H=yr(we,$,!1,!0),X=yr(q,we,!0,!1)):!t&&r?(H=yr(we,$,!1,!1),X=yr(we,q,!0,!1)):t&&!r?(H=yr($,we,!1,!0),X=yr(q,we,!1,!1)):(H=yr($,we,!0,!0),X=yr(we,q,!0,!0)),i!=null){const oe=x3(Y,we);return[H,X,oe]}else return[H,X]},z={a:_,b:T,bias:M,preluActivationWeights:k},I={transposeA:t,transposeB:r,activation:s,leakyreluAlpha:a};return i==null?Xc((W,q,$)=>{const ne=be.runKernel(hN,z,I);return $([W,q,ne]),{value:Ke(ne,S),gradFunc:P}})(_,T):Xc((W,q,$,ne)=>{const Y=be.runKernel(hN,z,I);return ne([W,q,Y,$]),{value:Ke(Y,S),gradFunc:P}})(_,T,M)}const GCe=ge({fusedMatMul_:HCe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qCe=Object.freeze(Object.defineProperty({__proto__:null,conv2d:zCe,depthwiseConv2d:WCe,matMul:GCe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XCe(n){return y3(n,.54,.46)}const KCe=ge({hammingWindow_:XCe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YCe(n){return y3(n,.5,.5)}const vX=ge({hannWindow_:YCe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZCe(n,e,t,r=!1,i=0){let s=0;const o=[];for(;s+e<=n.size;)o.push(Rn(n,s,e)),s+=t;if(r)for(;s<n.size;){const a=s+e-n.size,l=Ui([Rn(n,s,e-a),wx([a],i)]);o.push(l),s+=t}return o.length===0?Ca([],[0,e]):Ke(Ui(o),[o.length,e])}const xX=ge({frame_:ZCe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QCe(n,e,t,r,i=vX){r==null&&(r=yX(e));const s=xX(n,e,t),o=lt(s,i(e));return m3(o,r)}const JCe=ge({stft_:QCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eTe(n,e,t,r,i="bilinear",s=0){const o=K(n,"image","cropAndResize"),a=K(e,"boxes","cropAndResize","float32"),l=K(t,"boxInd","cropAndResize","int32"),c=a.shape[0];te(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),te(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),te(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),te(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),te(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),te(i==="bilinear"||i==="nearest",()=>`method must be bilinear or nearest, but was ${i}`);const u={image:o,boxes:a,boxInd:l},d={method:i,extrapolationValue:s,cropSize:r};return be.runKernel(e9,u,d)}const tTe=ge({cropAndResize_:eTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nTe(n){const e=K(n,"image","flipLeftRight","float32");te(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return be.runKernel(x9,t,{})}const rTe=ge({flipLeftRight_:nTe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iTe(n){const e=K(n,"image","grayscaleToRGB"),t=e.rank-1,r=e.shape[t];te(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),te(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const i=new Array(e.rank);return i.fill(1,0,t),i[t]=3,yv(e,i)}const sTe=ge({grayscaleToRGB_:iTe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oTe(n){const e=K(n,"image","RGBToGrayscale"),t=e.rank-1,r=e.shape[t];te(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),te(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const i=e.dtype,s=Cr(e,"float32"),o=is([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Wp("ij,j->i",s,o);break;case 3:a=Wp("ijk,k->ij",s,o);break;case 4:a=Wp("ijkl,l->ijk",s,o);break;case 5:a=Wp("ijklm,m->ijkl",s,o);break;case 6:a=Wp("ijklmn,n->ijklm",s,o);break;default:throw new Error("Not a valid tensor rank.")}return a=Fo(a,-1),Cr(a,i)}const aTe=ge({rgbToGrayscale_:oTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lTe(n,e,t=0,r=.5){const i=K(n,"image","rotateWithOffset","float32");te(i.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);const s={image:i},o={radians:e,fillValue:t,center:r};return be.runKernel(J7,s,o)}const cTe=ge({rotateWithOffset_:lTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pg(n,e,t,r,i,s){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),s==null&&(s=0);const o=n.shape[0];return t=Math.min(t,o),te(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),te(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),te(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),te(e.rank===1,()=>"scores must be a 1D tensor"),te(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),te(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:t,iouThreshold:r,scoreThreshold:i,softNmsSigma:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uTe(n,e,t,r=.5,i=Number.NEGATIVE_INFINITY){const s=K(n,"boxes","nonMaxSuppression","float32"),o=K(e,"scores","nonMaxSuppression","float32"),a=Pg(s,o,t,r,i);t=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;const l={maxOutputSize:t,iouThreshold:r,scoreThreshold:i};return be.runKernel(n7,{boxes:s,scores:o},l)}const dTe=ge({nonMaxSuppression_:uTe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hTe(n,e,t){const r=fTe(n,e,t),i=r<0?-(r+1):r;n.splice(i,0,e)}function fTe(n,e,t){return mTe(n,e,t||pTe)}function pTe(n,e){return n>e?1:n<e?-1:0}function mTe(n,e,t){let r=0,i=n.length,s=0,o=!1;for(;r<i;){s=r+(i-r>>>1);const a=t(e,n[s]);a>0?r=s+1:(i=s,o=!a)}return o?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wX(n,e,t,r,i){return S3(n,e,t,r,i,0)}function gTe(n,e,t,r,i,s){return S3(n,e,t,r,i,0,!1,s,!0)}function bX(n,e,t,r,i,s){return S3(n,e,t,r,i,s,!0)}function S3(n,e,t,r,i,s,o=!1,a=!1,l=!1){const c=[];for(let v=0;v<e.length;v++)e[v]>i&&c.push({score:e[v],boxIndex:v,suppressBeginIndex:0});c.sort(Uz);const u=s>0?-.5/s:0,d=[],h=[];for(;d.length<t&&c.length>0;){const v=c.pop(),{score:y,boxIndex:b,suppressBeginIndex:S}=v;if(y<i)break;let _=!1;for(let T=d.length-1;T>=S;--T){const M=yTe(n,b,d[T]);if(M>=r){_=!0;break}if(v.score=v.score*vTe(r,u,M),v.score<=i)break}v.suppressBeginIndex=d.length,_||(v.score===y?(d.push(b),h.push(v.score)):v.score>i&&hTe(c,v,Uz))}const f=d.length,p=t-f;a&&p>0&&(d.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const x={selectedIndices:d};return o&&(x.selectedScores=h),l&&(x.validOutputs=f),x}function yTe(n,e,t){const r=n.subarray(e*4,e*4+4),i=n.subarray(t*4,t*4+4),s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),u=Math.min(i[1],i[3]),d=Math.max(i[0],i[2]),h=Math.max(i[1],i[3]),f=(a-s)*(l-o),p=(d-c)*(h-u);if(f<=0||p<=0)return 0;const x=Math.max(s,c),v=Math.max(o,u),y=Math.min(a,d),b=Math.min(l,h),S=Math.max(y-x,0)*Math.max(b-v,0);return S/(f+p-S)}function vTe(n,e,t){const r=Math.exp(e*t*t);return t<=n?r:0}function Uz(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function xTe(n,e,t,r=.5,i=Number.NEGATIVE_INFINITY){const s=K(n,"boxes","nonMaxSuppressionAsync"),o=K(e,"scores","nonMaxSuppressionAsync"),a=Pg(s,o,t,r,i);t=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;const l=await Promise.all([s.data(),o.data()]),c=l[0],u=l[1],{selectedIndices:d}=wX(c,u,t,r,i);return s!==n&&s.dispose(),o!==e&&o.dispose(),is(d,"int32")}const wTe=xTe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bTe(n,e,t,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const o=K(n,"boxes","nonMaxSuppression"),a=K(e,"scores","nonMaxSuppression"),l=Pg(o,a,t,r,i,s);t=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,s=l.softNmsSigma;const c={boxes:o,scores:a},u={maxOutputSize:t,iouThreshold:r,scoreThreshold:i,softNmsSigma:s},d=be.runKernel(r7,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}const STe=ge({nonMaxSuppressionWithScore_:bTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _Te(n,e,t,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const o=K(n,"boxes","nonMaxSuppressionAsync"),a=K(e,"scores","nonMaxSuppressionAsync"),l=Pg(o,a,t,r,i,s);t=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,s=l.softNmsSigma;const c=await Promise.all([o.data(),a.data()]),u=c[0],d=c[1],{selectedIndices:h,selectedScores:f}=bX(u,d,t,r,i,s);return o!==n&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:is(h,"int32"),selectedScores:is(f)}}const ETe=_Te;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CTe(n,e,t,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const o=K(n,"boxes","nonMaxSuppression"),a=K(e,"scores","nonMaxSuppression"),l=Pg(o,a,t,r,i,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h={boxes:o,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:s},p=be.runKernel(owe,h,f);return{selectedIndices:p[0],validOutputs:p[1]}}const TTe=ge({nonMaxSuppressionPadded_:CTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function MTe(n,e,t,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const o=K(n,"boxes","nonMaxSuppressionAsync"),a=K(e,"scores","nonMaxSuppressionAsync"),l=Pg(o,a,t,r,i,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[h,f]=await Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:x}=gTe(h,f,c,u,d,s);return o!==n&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:is(p,"int32"),validOutputs:zn(x,"int32")}}const ATe=MTe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NTe(n,e,t=!1,r=!1){const i=K(n,"images","resizeBilinear");te(i.rank===3||i.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),te(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),te(r===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=i,o=!1;i.rank===3&&(o=!0,s=Ke(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const a={images:s},l={alignCorners:t,halfPixelCenters:r,size:e},c=be.runKernel(y7,a,l);return o?Ke(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const kTe=ge({resizeBilinear_:NTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ITe(n,e,t=!1,r=!1){const i=K(n,"images","resizeNearestNeighbor");te(i.rank===3||i.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),te(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),te(i.dtype==="float32"||i.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),te(r===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=i,o=!1;i.rank===3&&(o=!0,s=Ke(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const a={images:s},l={alignCorners:t,halfPixelCenters:r,size:e},c=be.runKernel(g7,a,l);return o?Ke(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const RTe=ge({resizeNearestNeighbor_:ITe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PTe(n,e="binary",t=!1,r=.5){const i=K(n,"image","threshold"),s=.2989,o=.587,a=.114,l=i.shape[0]*i.shape[1];let c=lt(is([r]),255),u,d,h,f;if(te(i.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),te(i.shape[2]===3||i.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),te(i.dtype==="int32"||i.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),te(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),i.shape[2]===3){[u,d,h]=L0(i,[1,1,1],-1);const v=lt(u,s),y=lt(d,o),b=lt(h,a);f=Xt(Xt(v,y),b)}else f=n;if(e==="otsu"){const v=Fq(Cr(uX(f),"int32"),$l([]),256);c=DTe(v,l)}const p=t?r3(f,c):C2(f,c);return Cr(lt(p,255),"int32")}function DTe(n,e){let t=is([-1]),r=is([0]),i=is([0]),s,o,a,l,c,u;for(let d=0;d<n.size-1;d++){s=Rn(n,0,d+1),o=Rn(n,d+1),c=On(Pr(s),e),u=On(Pr(o),e);const h=Pr(lt(s,P0(0,s.size)));a=On(h,Pr(s));const f=wx(o.shape,s.size),p=Xt(P0(0,o.size),f),x=lt(o,p);l=On(Pr(x),Pr(o));const v=Sn(a,l),y=Sn(a,l),b=lt(c,u);i=lt(lt(b,v),y);const S=C2(i,r);r=id(S,i,r),t=id(S,is([d]),t)}return t}const LTe=ge({threshold_:PTe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OTe(n,e,t="nearest",r="constant",i=0,s){const o=K(n,"image","transform","float32"),a=K(e,"transforms","transform","float32");te(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),te(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),te(s==null||s.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`);const l={image:o,transforms:a},c={interpolation:t,fillMode:r,fillValue:i,outputShape:s};return be.runKernel(X7,l,c)}const FTe=ge({transform_:OTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zTe(n,e,t){const r=K(n,"a","bandPart");te(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const i=r.shape,[s,o]=r.shape.slice(-2);let a,l;typeof e=="number"?(te(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),te(e<=s,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${s}).`),a=K(e<0?s:e,"numLower","bandPart")):(te(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=id(AN(e,0),s,R0(e,s))),typeof t=="number"?(te(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`),te(t<=o,()=>`bandPart(): numUpper (${t}) must not be greater than the number of columns (${o}).`),l=K(t<0?o:t,"numUpper","bandPart")):(te(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=id(AN(t,0),o,R0(t,o)));const c=Ke(P0(0,s,1,"int32"),[-1,1]),u=P0(0,o,1,"int32"),d=Sn(c,u),h=US(r3(d,a),Xq(d,jl(l))),f=bd([s,o],r.dtype);return Ke(Kc(Df(Ke(r,[-1,s,o])).map(p=>id(h,p,f))),i)}const UTe=ge({bandPart_:zTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BTe(n){let e;if(Array.isArray(n)){e=!1,te(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const i=n[0].shape[0];for(let s=1;s<n.length;++s)te(n[s].shape[0]===i,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[s].shape[0]} vs. ${i})`)}else e=!0,n=L0(n,n.shape[0],0).map(i=>mr(i,[0]));te(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],r=n;for(let i=0;i<n.length;++i)t.push(be.tidy(()=>{let s=r[i];if(i>0)for(let o=0;o<i;++o){const a=lt(Pr(lt(t[o],s)),t[o]);s=Sn(s,a)}return On(s,E2(s,"euclidean"))}));return e?Kc(t,0):t}const $Te=ge({gramSchmidt_:BTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jTe(n,e=!1){if(te(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return Bz(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((l,c)=>l*c),r=Df(Ke(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),i=[],s=[];r.forEach(l=>{const[c,u]=Bz(l,e);i.push(c),s.push(u)});const o=Ke(Kc(i,0),n.shape),a=Ke(Kc(s,0),n.shape);return[o,a]}}function Bz(n,e=!1){return be.tidy(()=>{te(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],r=n.shape[1];let i=Hq(t),s=rd(n);const o=Ca([[1]],[1,1]);let a=rd(o);const l=t>=r?r:t;for(let c=0;c<l;++c){const u=s,d=a,h=i;[a,s,i]=be.tidy(()=>{const f=Rn(s,[c,c],[t-c,1]),p=E2(f),x=Rn(s,[c,c],[1,1]),v=id(C2(x,0),Ca([[-1]]),Ca([[1]])),y=Sn(x,lt(v,p)),b=On(f,y);b.shape[0]===1?a=rd(o):a=Ui([o,Rn(b,[1,0],[b.shape[0]-1,b.shape[1]])],0);const S=jl(On(yr(v,y),p)),_=Rn(s,[c,0],[t-c,r]),T=lt(S,a),M=NN(a);if(c===0)s=Sn(_,yr(T,yr(M,_)));else{const z=Sn(_,yr(T,yr(M,_)));s=Ui([Rn(s,[0,0],[c,r]),z],0)}const k=NN(T),P=Rn(i,[0,c],[t,i.shape[1]-c]);if(c===0)i=Sn(P,yr(yr(P,a),k));else{const z=Sn(P,yr(yr(P,a),k));i=Ui([Rn(i,[0,0],[t,c]),z],1)}return[a,s,i]}),fr([u,d,h])}return!e&&t>r&&(i=Rn(i,[0,0],[t,r]),s=Rn(s,[0,0],[r,r])),[i,s]})}const VTe=ge({qr_:jTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Hs;(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Hs||(Hs={}));function WTe(n,e,t=Hs.SUM_BY_NONZERO_WEIGHTS){const r=K(n,"losses","computeWeightedLoss");let i=null;e!=null&&(i=K(e,"weights","computeWeightedLoss"));const s=i==null?r:lt(r,i);if(t===Hs.NONE)return s;if(t===Hs.SUM)return Pr(s);if(t===Hs.MEAN){if(i==null)return BS(s);{const o=r.size/i.size,a=On(Pr(s),Pr(i));return o>1?On(a,zn(o)):a}}if(t===Hs.SUM_BY_NONZERO_WEIGHTS){if(i==null)return On(Pr(s),zn(r.size));{const o=lt(i,Oh(r.shape)),a=Cr(Pr(iX(o,zn(0))),"float32");return On(Pr(s),a)}}throw Error(`Unknown reduction: ${t}`)}const Qc=ge({computeWeightedLoss_:WTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HTe(n,e,t,r=Hs.SUM_BY_NONZERO_WEIGHTS){const i=K(n,"labels","absoluteDifference"),s=K(e,"predictions","absoluteDifference");let o=null;t!=null&&(o=K(t,"weights","absoluteDifference")),Jo(i.shape,s.shape,"Error in absoluteDifference: ");const a=Lo(Sn(i,s));return Qc(a,o,r)}const GTe=ge({absoluteDifference_:HTe});function qTe(n,e,t,r,i=Hs.SUM_BY_NONZERO_WEIGHTS){const s=K(n,"labels","cosineDistance"),o=K(e,"predictions","cosineDistance");let a=null;r!=null&&(a=K(r,"weights","cosineDistance")),Jo(s.shape,o.shape,"Error in cosineDistance: ");const l=zn(1),c=Sn(l,Pr(lt(s,o),t,!0));return Qc(c,a,i)}const XTe=ge({cosineDistance_:qTe});function KTe(n,e,t,r=Hs.SUM_BY_NONZERO_WEIGHTS){let i=K(n,"labels","hingeLoss");const s=K(e,"predictions","hingeLoss");let o=null;t!=null&&(o=K(t,"weights","hingeLoss")),Jo(i.shape,s.shape,"Error in hingeLoss: ");const a=zn(1);i=Sn(lt(zn(2),i),a);const l=M2(Sn(a,lt(i,s)));return Qc(l,o,r)}const YTe=ge({hingeLoss_:KTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZTe(n,e,t,r=1,i=Hs.SUM_BY_NONZERO_WEIGHTS){const s=K(n,"labels","huberLoss"),o=K(e,"predictions","huberLoss");let a=null;t!=null&&(a=K(t,"weights","huberLoss")),Jo(s.shape,o.shape,"Error in huberLoss: ");const l=zn(r),c=Lo(Sn(o,s)),u=R0(c,l),d=Sn(c,u),h=Xt(lt(zn(.5),Ea(u)),lt(l,d));return Qc(h,a,i)}const QTe=ge({huberLoss_:ZTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JTe(n,e,t,r=1e-7,i=Hs.SUM_BY_NONZERO_WEIGHTS){const s=K(n,"labels","logLoss"),o=K(e,"predictions","logLoss");let a=null;t!=null&&(a=K(t,"weights","logLoss")),Jo(s.shape,o.shape,"Error in logLoss: ");const l=zn(1),c=zn(r),u=jl(lt(s,I0(Xt(o,c)))),d=lt(Sn(l,s),I0(Xt(Sn(l,o),c))),h=Sn(u,d);return Qc(h,a,i)}const eMe=ge({logLoss_:JTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tMe(n,e,t,r=Hs.SUM_BY_NONZERO_WEIGHTS){const i=K(n,"labels","meanSquaredError"),s=K(e,"predictions","meanSquaredError");let o=null;t!=null&&(o=K(t,"weights","meanSquaredError")),Jo(i.shape,s.shape,"Error in meanSquaredError: ");const a=hX(i,s);return Qc(a,o,r)}const nMe=ge({meanSquaredError_:tMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rMe(n,e){const t=K(n,"labels","sigmoidCrossEntropyWithLogits"),r=K(e,"logits","sigmoidCrossEntropyWithLogits");Jo(t.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=M2(r),s=lt(r,t),o=Yq(qc(jl(Lo(r))));return Xt(Sn(i,s),o)}function iMe(n,e,t,r=0,i=Hs.SUM_BY_NONZERO_WEIGHTS){let s=K(n,"multiClassLabels","sigmoidCrossEntropy");const o=K(e,"logits","sigmoidCrossEntropy");let a=null;if(t!=null&&(a=K(t,"weights","sigmoidCrossEntropy")),Jo(s.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const c=zn(r),u=zn(1),d=zn(.5);s=Xt(lt(s,Sn(u,c)),lt(d,c))}const l=rMe(s,o);return Qc(l,a,i)}const sMe=ge({sigmoidCrossEntropy_:iMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oMe(n,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${t}`);return Xc((i,s,o)=>{const l=Qq(s,[t],!0),c=Sn(Cr(s,"float32"),l);o([i,c]);const u=jl(lt(c,i));return{value:Pr(u,[t]),gradFunc:(f,p)=>{const[x,v]=p,y=bx(f.shape,[t]);return[lt(Ke(f,y),Sn(Cr(x,"float32"),qc(v))),lt(Ke(f,y),Sn(qc(v),Cr(x,"float32")))]}}})(n,e)}function aMe(n,e,t,r=0,i=Hs.SUM_BY_NONZERO_WEIGHTS){let s=K(n,"onehotLabels","softmaxCrossEntropy");const o=K(e,"logits","softmaxCrossEntropy");let a=null;if(t!=null&&(a=K(t,"weights","softmaxCrossEntropy")),Jo(s.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const c=zn(r),u=zn(1),d=zn(s.shape[1]);s=Xt(lt(s,Sn(u,c)),On(c,d))}const l=oMe(s,o);return Qc(l,a,i)}const lMe=ge({softmaxCrossEntropy_:aMe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cMe(n,e,t,r){const i=K(n,"indices","sparseFillEmptyRows","int32"),s=K(e,"values","sparseFillEmptyRows"),o=K(t,"denseShape","sparseFillEmptyRows","int32"),a=K(r,"defaultValue","sparseFillEmptyRows",s.dtype);if(i.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${i.shape}`);if(s.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${s.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:i,values:s,denseShape:o,defaultValue:a},c=be.runKernel(hwe,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const uMe=ge({sparseFillEmptyRows_:cMe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dMe(n,e,t){const r=K(n,"inputIndices","sparseReshape","int32"),i=K(e,"inputShape","sparseReshape","int32"),s=K(t,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(s.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${s.shape}`);const o={inputIndices:r,inputShape:i,newShape:s},a=be.runKernel(fwe,o);return{outputIndices:a[0],outputShape:a[1]}}const hMe=ge({sparseReshape_:dMe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fMe(n,e,t){const r=K(n,"data","sparseSegmentMean"),i=K(e,"indices","sparseSegmentMean","int32"),s=K(t,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${i.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${s.shape}`);const o={data:r,indices:i,segmentIds:s};return be.runKernel(z7,o)}const pMe=ge({sparseSegmentMean_:fMe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mMe(n,e,t){const r=K(n,"data","sparseSegmentSum"),i=K(e,"indices","sparseSegmentSum","int32"),s=K(t,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${i.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${s.shape}`);const o={data:r,indices:i,segmentIds:s};return be.runKernel(U7,o)}const gMe=ge({sparseSegmentSum_:mMe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yMe(n,e,t,r,i,s,o,a){const l=K(n,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=K(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const u={separator:t,nGramWidths:r,leftPad:i,rightPad:s,padWidth:o,preserveShortSequences:a},d={data:l,dataSplits:c},h=be.runKernel(V7,d,u);return{nGrams:h[0],nGramsSplits:h[1]}}const vMe=ge({stringNGrams_:yMe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xMe(n,e,t=!0){const r=K(n,"input","stringSplit","string"),i=K(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(i.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);const s={skipEmpty:t},o={input:r,delimiter:i},a=be.runKernel(gwe,o,s);return{indices:a[0],values:a[1],shape:a[2]}}const wMe=ge({stringSplit_:xMe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bMe(n,e){const t=K(n,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const i={input:t};return be.runKernel(ywe,i,r)}const SMe=ge({stringToHashBucketFast_:bMe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Me(n,e,t,r=!0){const i=K(n,"input","staticRegexReplace","string"),s={pattern:e,rewrite:t,replaceGlobal:r};return be.runKernel(mwe,{x:i},s)}const EMe=ge({staticRegexReplace_:_Me});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CMe={fft:p3,ifft:$S,rfft:m3,irfft:dX},TMe={hammingWindow:KCe,hannWindow:vX,frame:xX,stft:JCe},Xh={flipLeftRight:rTe,grayscaleToRGB:sTe,resizeNearestNeighbor:RTe,resizeBilinear:kTe,rgbToGrayscale:aTe,rotateWithOffset:cTe,cropAndResize:tTe,nonMaxSuppression:dTe,nonMaxSuppressionAsync:wTe,nonMaxSuppressionWithScore:STe,nonMaxSuppressionWithScoreAsync:ETe,nonMaxSuppressionPadded:TTe,nonMaxSuppressionPaddedAsync:ATe,threshold:LTe,transform:FTe},MMe={bandPart:UTe,gramSchmidt:$Te,qr:VTe},AMe={absoluteDifference:GTe,computeWeightedLoss:Qc,cosineDistance:XTe,hingeLoss:YTe,huberLoss:QTe,logLoss:eMe,meanSquaredError:nMe,sigmoidCrossEntropy:sMe,softmaxCrossEntropy:lMe},NMe={sparseFillEmptyRows:uMe,sparseReshape:hMe,sparseSegmentMean:pMe,sparseSegmentSum:gMe},kMe={stringNGrams:vMe,stringSplit:wMe,stringToHashBucketFast:SMe,staticRegexReplace:EMe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IMe=new Map,RMe=new Map;class PMe{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class bh{constructor(){this.classNameMap={}}static getMap(){return bh.instance==null&&(bh.instance=new bh),bh.instance}static register(e){bh.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function DMe(n,e,t){te(n.className!=null,()=>"Class being registered does not have the static className property defined."),te(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),te(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=n.className);const r=t,i=e+">"+r;return bh.register(n),IMe.set(i,n),RMe.set(n,i),n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lf extends PMe{minimize(e,t=!1,r){const{value:i,grads:s}=this.computeGradients(e,r);if(r!=null){const o=r.map(a=>({name:a.name,tensor:s[a.name]}));this.applyGradients(o)}else this.applyGradients(s);return fr(s),t?i:(i.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return y_e(e,t)}dispose(){this.iterations_!=null&&fr(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:zn(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Lf,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LMe extends Lf{static get className(){return"Adadelta"}constructor(e,t,r=null){super(),this.learningRate=e,this.rho=t,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=be.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const s=be.registeredVariables[r],o=!1;this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accum_grad`,variable:yn(()=>qo(s).variable(o))}),this.accumulatedUpdates[i]==null&&(this.accumulatedUpdates[i]={originalName:`${r}/accum_var`,variable:yn(()=>qo(s).variable(o))});const a=Array.isArray(e)?e[i].tensor:e[r];if(a==null)return;const l=this.accumulatedGrads[i].variable,c=this.accumulatedUpdates[i].variable;yn(()=>{const u=Xt(lt(l,this.rho),lt(Ea(a),1-this.rho)),d=lt(On(Gc(Xt(c,this.epsilon)),Gc(Xt(l,this.epsilon))),a),h=Xt(lt(c,this.rho),lt(Ea(d),1-this.rho));l.assign(u),c.assign(h);const f=Xt(lt(d,-this.learningRate),s);s.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(fr(this.accumulatedGrads.map(e=>e.variable)),fr(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,t).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedUpdates=e.slice(t,t*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OMe extends Lf{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const s=be.registeredVariables[r];this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accumulator`,variable:yn(()=>wx(s.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[i].tensor:e[r];if(o==null)return;const a=this.accumulatedGrads[i].variable;yn(()=>{const l=Xt(a,Ea(o));a.assign(l);const c=Xt(lt(On(o,Gc(Xt(l,be.backend.epsilon()))),-this.learningRate),s);s.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&fr(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FMe extends Lf{static get className(){return"Adam"}constructor(e,t,r,i=null){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],yn(()=>{this.accBeta1=zn(t).variable(),this.accBeta2=zn(r).variable()}),i==null&&(this.epsilon=be.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);yn(()=>{const r=Sn(1,this.accBeta1),i=Sn(1,this.accBeta2);t.forEach((s,o)=>{const a=be.registeredVariables[s],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${s}/m`,variable:yn(()=>qo(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${s}/v`,variable:yn(()=>qo(a).variable(l))});const c=Array.isArray(e)?e[o].tensor:e[s];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,h=Xt(lt(u,this.beta1),lt(c,1-this.beta1)),f=Xt(lt(d,this.beta2),lt(Ea(c),1-this.beta2)),p=On(h,r),x=On(f,i);u.assign(h),d.assign(f);const v=Xt(lt(On(p,Xt(Gc(x),this.epsilon)),-this.learningRate),a);a.assign(v)}),this.accBeta1.assign(lt(this.accBeta1,this.beta1)),this.accBeta2.assign(lt(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&fr(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&fr(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),yn(()=>{this.accBeta1.assign(k0(this.beta1,this.iterations_+1)),this.accBeta2.assign(k0(this.beta2,this.iterations_+1))});const t=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,t).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zMe extends Lf{static get className(){return"Adamax"}constructor(e,t,r,i=null,s=0){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=i,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],yn(()=>{this.iteration=zn(0).variable(),this.accBeta1=zn(t).variable()}),i==null&&(this.epsilon=be.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);yn(()=>{const r=Sn(1,this.accBeta1),i=On(-this.learningRate,Xt(lt(this.iteration,this.decay),1));t.forEach((s,o)=>{const a=be.registeredVariables[s],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${s}/m`,variable:qo(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${s}/v`,variable:qo(a).variable(l)});const c=Array.isArray(e)?e[o].tensor:e[s];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,h=Xt(lt(u,this.beta1),lt(c,1-this.beta1)),f=lt(d,this.beta2),p=Lo(c),x=nX(f,p);u.assign(h),d.assign(x);const v=Xt(lt(On(i,r),On(h,Xt(x,this.epsilon))),a);a.assign(v)}),this.iteration.assign(Xt(this.iteration,1)),this.accBeta1.assign(lt(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&fr(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&fr(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SX extends Lf{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const s=Array.isArray(e)?e[i].tensor:e[r];if(s==null)return;const o=be.registeredVariables[r];yn(()=>{const a=Xt(lt(this.c,s),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Rl(zn(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UMe extends SX{static get className(){return"Momentum"}constructor(e,t,r=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=r,this.accumulations=[],this.m=zn(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const s=be.registeredVariables[r];this.accumulations[i]==null&&(this.accumulations[i]={originalName:`${r}/momentum`,variable:yn(()=>qo(s).variable(!1))});const o=this.accumulations[i].variable,a=Array.isArray(e)?e[i].tensor:e[r];a!=null&&yn(()=>{let l;const c=Xt(lt(this.m,o),a);this.useNesterov?l=Xt(lt(this.c,Xt(a,lt(c,this.m))),s):l=Xt(lt(this.c,c),s),o.assign(c),s.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&fr(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BMe extends Lf{static get className(){return"RMSProp"}constructor(e,t=.9,r=0,i=null,s=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=r,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,i==null&&(this.epsilon=be.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const s=be.registeredVariables[r],o=!1;this.accumulatedMeanSquares[i]==null&&(this.accumulatedMeanSquares[i]={originalName:`${r}/rms`,variable:yn(()=>qo(s).variable(o))}),this.accumulatedMoments[i]==null&&(this.accumulatedMoments[i]={originalName:`${r}/momentum`,variable:yn(()=>qo(s).variable(o))}),this.accumulatedMeanGrads[i]==null&&this.centered&&(this.accumulatedMeanGrads[i]={originalName:`${r}/mg`,variable:yn(()=>qo(s).variable(o))});const a=Array.isArray(e)?e[i].tensor:e[r];if(a==null)return;const l=this.accumulatedMeanSquares[i].variable,c=this.accumulatedMoments[i].variable;yn(()=>{const u=Xt(lt(l,this.decay),lt(Ea(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[i].variable,h=Xt(lt(d,this.decay),lt(a,1-this.decay)),f=On(lt(a,this.learningRate),Gc(Sn(u,Xt(Ea(h),this.epsilon)))),p=Xt(lt(c,this.momentum),f);l.assign(u),d.assign(h),c.assign(p);const x=Sn(s,p);s.assign(x)}else{const d=Xt(lt(l,this.decay),lt(Ea(a),1-this.decay)),h=Xt(lt(c,this.momentum),On(lt(a,this.learningRate),Gc(Xt(d,this.epsilon))));l.assign(d),c.assign(h);const f=Sn(s,h);s.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&fr(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&fr(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&fr(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,t).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedMoments=e.slice(t,t*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Me=[LMe,OMe,FMe,zMe,UMe,BMe,SX];function jMe(){for(const n of $Me)DMe(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VMe="model",WMe=".json",HMe=".weights.bin";function $z(n){return new Promise(e=>setTimeout(e)).then(n)}class wf{constructor(e){if(!rn().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(wf.URL_SCHEME)&&(e=e.slice(wf.URL_SCHEME.length)),(e==null||e.length===0)&&(e=VMe),this.modelJsonFileName=e+WMe,this.weightDataFileName=e+HMe}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=dl.join(e.weightData),r=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const i=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],s=Sq(e,i),o=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await $z(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=r,await $z(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:xx(e)}}}}wf.URL_SCHEME="downloads://";class GMe{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const r=new FileReader;r.onload=i=>{const s=JSON.parse(i.target.result),o=s.modelTopology;if(o==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(s.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const l=JR(s,c=>this.loadWeights(c));e(l)},r.onerror=i=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const t=[],r=[];for(const o of e)t.push(...o.weights),r.push(...o.paths);const i=this.checkManifestAndWeightFiles(e),s=r.map(o=>this.loadWeightsFile(o,i[o]));return Promise.all(s).then(o=>[t,o])}loadWeightsFile(e,t){return new Promise((r,i)=>{const s=new FileReader;s.onload=o=>{const a=o.target.result;r(a)},s.onerror=o=>i(`Failed to weights data from file of path '${e}'.`),s.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],r=this.weightsFiles.map(s=>zz(s.name)),i={};for(const s of e)s.paths.forEach(o=>{const a=zz(o);if(t.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(t.push(a),r.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);i[o]=this.weightsFiles[r.indexOf(a)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return i}}const qMe=n=>rn().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(wf.URL_SCHEME)?XMe(n.slice(wf.URL_SCHEME.length)):null;Wr.registerSaveRouter(qMe);function XMe(n="model"){return new wf(n)}function KMe(n){return new GMe(n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jz(n,e,t,r){o(n),t=t??0,r=r??1,a(t,r);let i=0;const s=l=>(l.then(c=>{const u=t+ ++i/n.length*(r-t);return e(u),c}),l);function o(l){te(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,c){te(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),te(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),te(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(n.map(s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _X(n,e){e==null&&(e={});const t=e.fetchFunc==null?rn().platform.fetch:e.fetchFunc,r=n.map(d=>t(d,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(r):await jz(r,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(a):await jz(a,e.onProgress,.5,1)}function YMe(n,e){var t;const r=e.fetchFunc==null?rn().platform.fetch:e.fetchFunc;let i=0,s;return(t=e.onProgress)===null||t===void 0||t.call(e,0),new ReadableStream({pull:async o=>{for(var a;i<n.length;){s||(s=(await r(n[i],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:c}=await s.read();if(l){i++,s=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,i/n.length);continue}o.enqueue(c);return}o.close()}})}async function ZMe(n,e="",t,r){return EX(o=>_X(o,{requestInit:r}))(n,e,t)}function EX(n){return async(e,t="",r)=>{const i=e.map(()=>!1),s={},o=r!=null?r.map(()=>!1):[],a=[];if(e.forEach((f,p)=>{let x=0;f.weights.forEach(v=>{const y="quantization"in v?v.quantization.dtype:v.dtype,b=gf[y]*gt(v.shape),S=()=>{i[p]=!0,s[p]==null&&(s[p]=[]),s[p].push({manifestEntry:v,groupOffset:x,sizeBytes:b})};r!=null?r.forEach((_,T)=>{_===v.name&&(S(),o[T]=!0)}):S(),a.push(v.name),x+=b})}),!o.every(f=>f)){const f=r.filter((p,x)=>!o[x]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=i.reduce((f,p,x)=>(p&&f.push(x),f),[]),c=[];l.forEach(f=>{e[f].paths.forEach(p=>{const x=t+(t.endsWith("/")?"":"/")+p;c.push(x)})});const u=await n(c),d={};let h=0;return l.forEach(f=>{const p=e[f].paths.length,x=new dl(u.slice(h,h+p));s[f].forEach(y=>{const b=x.slice(y.groupOffset,y.groupOffset+y.sizeBytes),S=xq(b,[y.manifestEntry]);for(const _ in S)d[_]=S[_]}),h+=p}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QMe="application/octet-stream",JMe="application/json";class _3{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(te(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=rn().platform.fetch,te(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&te(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],i=Sq(e,r);if(t.body.append("model.json",new Blob([JSON.stringify(i)],{type:JMe}),"model.json"),e.weightData!=null){const o=dl.join(e.weightData);t.body.append("model.weights.bin",new Blob([o],{type:QMe}),"model.weights.bin")}const s=await this.fetch(this.path,t);if(s.ok)return{modelArtifactsInfo:xx(e),responses:[s]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${s.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const r=t.modelTopology,i=t.weightsManifest;if(r==null&&i==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return JR(e,t=>this.loadWeights(t))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),r=bN(e.weightsManifest),i=()=>YMe(t,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:r,getWeightStream:i})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[r,i]=eAe(t),s=this.weightPathPrefix||r,o=[],a=[];for(const l of e)for(const c of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(c)):o.push(s+c+i);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(e){const t=await this.getWeightUrls(e),r=bN(e),i=await _X(t,this.loadOptions);return[r,i]}}_3.URL_SCHEME_REGEX=/^https?:\/\//;function eAe(n){const e=n.lastIndexOf("/"),t=n.lastIndexOf("?"),r=n.substring(0,e),i=t>e?n.substring(t):"";return[r+"/",i]}function kN(n){return n.match(_3.URL_SCHEME_REGEX)!=null}const CX=(n,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(n)?t=n.every(r=>kN(r)):t=kN(n),t)return E3(n,e)}return null};Wr.registerSaveRouter(CX);Wr.registerLoadRouter(CX);function E3(n,e){return new _3(n,e)}function tAe(n,e){return E3(n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wT{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class TX{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class nAe{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function rAe(n,e,t,r){const i=arguments;return new nAe(MX(...i))}function MX(n,e,t,r){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new wT(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new wT({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new wT({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:r}))}function iAe(n){return new TX(n)}function sAe(n){return new TX(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AX=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:dl,browserFiles:KMe,browserHTTPRequest:tAe,concatenateArrayBuffers:n1e,copyModel:E1e,decodeWeights:xq,decodeWeightsStream:bq,encodeWeights:Ywe,fromMemory:rAe,fromMemorySync:MX,getLoadHandlers:u1e,getModelArtifactsForJSON:JR,getModelArtifactsForJSONSync:_q,getModelArtifactsInfoForJSON:xx,getSaveHandlers:c1e,getWeightSpecs:bN,http:E3,isHTTPScheme:kN,listModels:S1e,loadWeights:ZMe,moveModel:C1e,registerLoadRouter:l1e,registerSaveRouter:a1e,removeModel:_1e,weightsLoaderFactory:EX,withSaveHandler:iAe,withSaveHandlerSync:sAe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ah,Vz=!1;function oAe(n,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let t=!1,r=!1,i=!1,s=!1,o=!1,a=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)s=!0;else if(n.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&n instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);if(RS(dN,be.backendName)!=null){const p={pixels:n},x={numChannels:e};return be.runKernel(dN,p,x)}const[c,u]=i?[n.videoWidth,n.videoHeight]:[n.width,n.height];let d;if(o)d=n.getContext("2d").getImageData(0,0,c,u).data;else if(r||t)d=n.data;else if(s||i||a){if(ah==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")ah=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else ah=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});ah.canvas.width=c,ah.canvas.height=u,ah.drawImage(n,0,0,c,u),d=ah.getImageData(0,0,c,u).data}let h;if(e===4)h=new Int32Array(d);else{const p=c*u;h=new Int32Array(p*e);for(let x=0;x<p;x++)for(let v=0;v<e;++v)h[x*e+v]=d[x*4+v]}return pX(h,[u,c,e],"int32")}function aAe(n){if(n.rank!==2&&n.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const e=n.rank===2?1:n.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(n.dtype!=="float32"&&n.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`)}async function C3(n,e){let t=K(n,"img","toPixels");if(!(n instanceof ei)){const c=t;t=Cr(c,"int32"),c.dispose()}aAe(t);const[r,i]=t.shape.slice(0,2),s=t.rank===2?1:t.shape[2],o=await t.data(),a=t.dtype==="float32"?255:1,l=new Uint8ClampedArray(i*r*4);for(let c=0;c<r*i;++c){const u=[0,0,0,255];for(let h=0;h<s;h++){const f=o[c*s+h];if(t.dtype==="float32"){if(f<0||f>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${f}.`)}else if(t.dtype==="int32"&&(f<0||f>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${f}.`);s===1?(u[0]=f*a,u[1]=f*a,u[2]=f*a):u[h]=f*a}const d=c*4;l[d+0]=Math.round(u[0]),l[d+1]=Math.round(u[1]),l[d+2]=Math.round(u[2]),l[d+3]=Math.round(u[3])}if(e!=null){Vz||RS(l9,be.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),Vz=!0),e.width=i,e.height=r;const c=e.getContext("2d"),u=new ImageData(l,i,r);c.putImageData(u,0,0)}return t!==n&&t.dispose(),l}const NX=ge({fromPixels_:oAe});function lAe(n,e){const t=n.shape.length,r=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${t}`);if(gt(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const i=e.shape,s=i[i.length-1];let o=1;for(let d=0;d<i.length-1;++d)o*=i[d];const a=n.shape,l=i.slice();l.pop();let c=1;for(let d=s;d<t;++d)c*=a[d],l.push(a[d]);const u=[...os(n.shape).map(d=>d/c),1].slice(0,s);return[l,o,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IN=-2,cAe=-1;function uAe(n,e,t){const r=n.shape.length;te(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),te(r===t.length,()=>`Error in slice${r}D: Length of size ${t} must match the rank of the array (${r}).`);for(let i=0;i<r;++i)te(e[i]+t[i]<=n.shape[i],()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${e[i]+t[i]}) would overflow input.shape[${i}] (${n.shape[i]})`)}function dAe(n,e,t){const r=[];for(let i=0;i<n.length;i++)r[i]=Math.ceil((e[i]-n[i])/t[i]);return r}function hAe(n,e,t){let r=t.length;for(let i=0;i<t.length;i++)if(t[i]>1){r=i;break}for(let i=r+1;i<t.length;i++)if(e[i]>0||t[i]!==n[i])return!1;return!0}function fAe(n,e){let t=n.length>0?n[n.length-1]:1;for(let r=0;r<n.length-1;r++)t+=n[r]*e[r];return t}function pAe(n,e,t){let r;const i=n.shape.length;typeof e=="number"?r=[e,...new Array(i-1).fill(0)]:e.length<i?r=e.concat(new Array(i-e.length).fill(0)):r=e.slice(),r.forEach(o=>{te(o!==-1,()=>"slice() does not support negative begin indexing.")});let s;return t==null?s=new Array(i).fill(-1):typeof t=="number"?s=[t,...new Array(i-1).fill(-1)]:t.length<i?s=t.concat(new Array(i-t.length).fill(-1)):s=t,s=s.map((o,a)=>o>=0?o:(te(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),n.shape[a]-r[a])),[r,s]}function mAe(n,e,t,r,i,s,o,a,l){let c;if(r==null?(c=new Array(e.length),c.fill(1)):c=r,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:c.slice(),beginMask:i,endMask:s,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let S=0;S<d.dims;S++)u&&1<<S&a&&d.numAddAxisAfterEllipsis++,1<<S&o&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};gAe(d,h);let f=!0,p=!0,x=!0;const v=[],y=[];for(let S=0;S<n.length;++S){if(h.strides[S]===0)throw Error(`strides[${S}] must be non-zero`);const _=!!(h.shrinkAxisMask&1<<S),T=n[S];if(T===-1){v.push(_?1:-1);continue}const M=[h.beginMask&1<<S,h.endMask&1<<S],k=[h.strides[S]>0?0:-1,h.strides[S]>0?T:T-1];if(_&&h.strides[S]<=0)throw Error("only stride 1 allowed on non-range indexing.");x=x&&h.strides[S]===1;const P=!!(h.beginMask&1<<S&&h.endMask&1<<S);if(h.beginValid&&h.endValid){if(_){const W=h.begin[S]<0?T+h.begin[S]:h.begin[S];if(h.begin[S]=W,h.end[S]=h.begin[S]+1,W<0||W>=T)throw Error(`slice index ${h.begin[S]} of dimension ${S} out of bounds.`)}else h.begin[S]=Wz(h.begin[S],0,h.strides[S],T,M,k),h.end[S]=Wz(h.end[S],1,h.strides[S],T,M,k);const L=h.strides[S]===1&&h.begin[S]===0&&h.end[S]===T;f=f&&L,p=p&&(S===0&&h.strides[S]===1||L)}else f=f&&h.strides[S]===1&&P,p=p&&(S===0&&h.strides[S]===1||P);let z,I=!1;if(h.beginValid&&h.endValid?(z=h.end[S]-h.begin[S],I=!0):_?(z=1,I=!0):P&&T>=0&&(h.strides[S]<0?z=-T:z=T,I=!0),I){let L;z===0||z<0!=h.strides[S]<0?L=0:L=Math.trunc(z/h.strides[S])+(z%h.strides[S]!==0?1:0),v.push(L)}else v.push(-1)}for(let S=0;S<h.finalShapeGatherIndices.length;++S){const _=h.finalShapeGatherIndices[S];_>=0?y.push(v[_]):_===IN&&y.push(1)}return{finalShapeSparse:y.filter((S,_)=>h.finalShapeGatherIndices[_]!==IN),finalShape:y,isIdentity:f,sliceDim0:p,isSimpleSlice:x,begin:h.begin,end:h.end,strides:h.strides}}function gAe(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<n.dims;r++)if(1<<r&n.ellipsisMask){const i=Math.min(e.dims-(n.dims-r)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<i;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=r}else if(1<<r&n.newAxisMask)e.finalShapeGatherIndices.push(IN),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[r]),n.end!=null&&(e.end[t]=n.end[r]),e.strides[t]=n.strides[r],n.beginMask&1<<r&&(e.beginMask|=1<<t),n.endMask&1<<r&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(cAe),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[t]=r,t++}}function Wz(n,e,t,r,i,s){if(i[e])return t>0?s[e]:s[e+1&1];{const o=n<0?r+n:n;return o<s[0]?s[0]:o>s[1]?s[1]:o}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yAe(n,e){const t=n[0].length;n.forEach((i,s)=>{te(i.length===t,()=>`Error in concat${t}D: rank of tensors[${s}] must be the same as the rank of the rest (${t})`)}),te(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const r=n[0];n.forEach((i,s)=>{for(let o=0;o<t;o++)te(o===e||i[o]===r[o],()=>`Error in concat${t}D: Shape of tensors[${s}] (${i}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function O0(n,e){const t=n[0].slice();for(let r=1;r<n.length;r++)t[e]+=n[r][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Cl;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(Cl||(Cl={}));function vAe(n,e,t){let r=new Array;if(t==null&&e==null)return r;if(e==null)for(;r.length<n+t.length;)r.push(-1);else r=e.slice();if(t==null)return r;if(n+t.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${r.length}`);for(let i=1;i<t.length;++i){const s=t[i],o=r[r.length-t.length+i],a=r[o];if(s>=0)if(a>=0){if(a!==s)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${i+n}] = ${s} but shape[${i+n}] = ${a}`)}else r[o]=s}return r}function xAe(n){const e={FIRST_DIM_SIZE:Cl.FIRST_DIM_SIZE,VALUE_ROWIDS:Cl.VALUE_ROWIDS,ROW_LENGTHS:Cl.ROW_LENGTHS,ROW_SPLITS:Cl.ROW_SPLITS,ROW_LIMITS:Cl.ROW_LIMITS,ROW_STARTS:Cl.ROW_STARTS},t=[];for(const r of n)if(r in e)t.push(e[r]);else break;return t}function wAe(n){return n.length===0?0:n[0]===Cl.FIRST_DIM_SIZE?n.length-1:n.length}function bAe(n,e){if(n==null||e==null)return;const t=n.length,r=e.length;if(t>=r)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(t,r-1);++i){const s=n[i],o=e[i+1];if(s>=0&&o>=0&&s!==1&&s!==o)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${i-n.length}] = ${s} but ragged tensor input.flatValues.shape[${i-n.length}] = ${o}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SAe(n,e,t){const r=t*(typeof n=="number"?n:n[0]),i=e*(typeof n=="number"?n:n[1]);return[r,i]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kX(n,e,t,r=!0){let i=[];if(r)i=i.concat(e.slice(0)),i.push(n[0]/t),i=i.concat(n.slice(1));else{i=i.concat(n[0]);const s=e.length;for(let o=0;o<s;++o)i=i.concat([n[o+1]/e[o],e[o]]);i=i.concat(n.slice(s+1))}return i}function IX(n,e,t=!0){const r=[];if(t){r.push(e);for(let i=e+1;i<n;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{const i=[],s=[];for(let o=1;o<n;++o)o>=e*2+1||o%2===1?s.push(o):i.push(o);r.push(...i),r.push(0),r.push(...s)}return r}function RX(n,e,t,r=!0){const i=[];r?i.push(n[0]/t):i.push(n[0]*t);for(let s=1;s<n.length;++s)s<=e.length?r?i.push(e[s-1]*n[s]):i.push(n[s]/e[s-1]):i.push(n[s]);return i}function _Ae(n,e){const t=[0];for(let r=0;r<e;++r)t.push(n[r][0]);return t}function EAe(n,e,t){const r=n.slice(0,1);for(let i=0;i<t;++i)r.push(n[i+1]-e[i][0]-e[i][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CAe=1.7580993408473768,TAe=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MAe=.3275911,AAe=.254829592,NAe=-.284496736,kAe=1.421413741,IAe=-1.453152027,RAe=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hz(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let r=0;r<t.length;r+=2)t[r]=n[r/2],t[r+1]=e[r/2];return t}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bT="->",PAe=/->/g,Gz=",",qz="...";function DAe(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(PAe,"").length)/bT.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${bT}").`);const[r,i]=n.split(bT);te(r.indexOf(qz)===-1,()=>`The ellipsis notation ("${qz}") is not supported yet.`);const s=r.split(Gz),o=s.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<i.length;++h){const f=i[h];if(!s.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let h=0;h<r.length;++h){const f=r[h];a.indexOf(f)===-1&&f!==Gz&&a.push(f)}const l=new Array(s.length);for(let h=0;h<o;++h){if(new Set(s[h].split("")).size!==s[h].length)throw new Error(`Found duplicate axes in input component ${s[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let f=0;f<s[h].length;++f)l[h].push(a.indexOf(s[h][f]))}const c=a.length,u=i.length,d=[];for(let h=u;h<c;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function LAe(n,e){let t=new Array(n);t.fill(-1);for(let i=0;i<e.length;++i)t[e[i]]=i;const r=[];for(let i=0;i<n;++i)t[i]===-1&&r.push(i);return t=t.filter(i=>i!==-1),{permutationIndices:t,expandDims:r}}function OAe(n,e,t){const r=new Array(n);for(let i=0;i<t.length;++i){const s=t[i].shape;for(let o=0;o<e[i].length;++o)r[e[i][o]]===void 0?r[e[i][o]]=s[o]:te(r[e[i][o]]===s[o],()=>`Expected dimension ${r[e[i][o]]} at axis ${o} of input shaped ${JSON.stringify(s)}, but got dimension ${s[o]}`)}}function FAe(n,e){const t=n,r=[];let i=0;n.length===0&&t.push(-1),i=n.length+1;for(let o=0;o<i;++o)r.push([]);const s=[];for(let o=0;o<t.length;++o){const a=t[o],l=UAe(e,a);for(const c of l)s.indexOf(c)===-1&&(r[o].push(c),s.push(c))}return{path:t,steps:r}}function zAe(n){return n.every((e,t)=>e===t)}function UAe(n,e){const t=[];for(let r=0;r<n.length;++r)(n[r].length===0||n[r].indexOf(e)!==-1||e===-1)&&t.push(r);return t}function BAe(n,e,t=0){let r=[];if(typeof e=="number")te(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(n.shape[t]/e);else{const i=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);te(i<=1,()=>"There should be only one negative value in split array.");const s=e.indexOf(-1);if(s!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[s]=n.shape[t]-o}te(n.shape[t]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ae(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function jAe(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function VAe(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WAe(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function HAe(n,e){return`size ${n} must be non-negative, not ${e}`}function GAe(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function qAe(n,e){const t=gt(n),r=gt(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${n} outputShape= ${e}`}function XAe(n,e){const t=gt(n),r=gt(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${r}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xz(){return"segment ids must be >= 0"}function KAe(){return"segment ids are not increasing"}function YAe(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function ZAe(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QAe(n,e,t){const r=[],i=n.length;for(let s=0;s<i;s++)s!==e?r.push(n[s]):r.push(t);return r}function JAe(n,e,t,r){const i=e.shape.length,s=n.shape.length;if(r!==0&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${s}).`);if(t<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${t}).`);for(let d=0;d<r;++d)if(n.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${n.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=n.shape[t],a=[];let l=1,c=1,u=1;for(let d=0;d<r;++d)a.push(n.shape[d]),l*=n.shape[d];for(let d=r;d<t;d++)a.push(n.shape[d]),c*=n.shape[d];for(let d=r;d<i;d++)a.push(e.shape[d]);for(let d=t+1;d<s;d++)a.push(n.shape[d]),u*=n.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:o,outputShape:a}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jS(n){try{return n.map(e=>Qm(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function eNe(n){return n.map(e=>qh(e))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */jMe();/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tNe=rn();tNe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var fo;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(fo||(fo={}));var Kz;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(Kz||(Kz={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nNe={};function PX(n){return nNe[n]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O(n,e,t,r,i){const s=e.inputParams[n];if(s&&s.inputIndexStart!==void 0){const a=s.inputIndexStart,l=s.inputIndexEnd===0?void 0:s.inputIndexEnd===void 0?a+1:s.inputIndexEnd,c=a<0?e.inputNames.length+a:a;if(s.type==="tensor")return Zi(e.inputNames[c],t,r,i);if(s.type==="tensors"){const h=e.inputs.slice(a,l);return e.inputNames.slice(a,l).filter((p,x)=>{var v;return((v=h[x])===null||v===void 0?void 0:v.op)!=="NoOp"}).map(p=>Zi(p,t,r,i))}const u=Zi(e.inputNames[c],t,r,i),d=u.dataSync();return s.type==="number"?d[0]:cN(u.shape,d)}const o=e.attrParams[n];return o&&o.value}function Zi(n,e,t,r){const[i,s]=po(n,t);if(r!=null){const a=r.getHashTableHandleByName(i);if(a!=null)return a}const o=t.currentContextIds.find(a=>!!e[VS(i,a)]);return o!==void 0?e[VS(i,o)][s]:void 0}function Yz(n,e,t){return e[VS(n,t.currentContextId)]}function Sc(n,e){const[t,r,i]=po(n,e);return[VS(t,e&&e.currentContextId),r,i]}function VS(n,e){return e?`${n}-${e}`:n}function po(n,e){if(n==="")return["",0,void 0];const t=e!=null&&e.parseNodeNameCache!=null;if(t){const s=e.parseNodeNameCache.get(n);if(s!=null)return s}const r=n.split(":");let i;if(r.length===1)i=[n,0,void 0];else{const s=r[0],o=r.length===3?r[1]:void 0,a=Number(r[r.length-1]);i=[s,a,o]}return t&&e.parseNodeNameCache.set(n,i),i}function Eb(n,e,t){let r=O("pad",n,e,t);if(r==="explicit"){r=O("explicitPaddings",n,e,t);const i=[[0,0],[0,0],[0,0],[0,0]];for(let s=0;s<4;s++)i[s][0]=r[s*2],i[s][1]=r[s*2+1];return i}return r}function _c(n){return n.kept?n:rd(n)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rNe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],iNe=Object.freeze(Object.defineProperty({__proto__:null,json:rNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sNe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],oNe=Object.freeze(Object.defineProperty({__proto__:null,json:sNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aNe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],lNe=Object.freeze(Object.defineProperty({__proto__:null,json:aNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cNe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],uNe=Object.freeze(Object.defineProperty({__proto__:null,json:cNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dNe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],hNe=Object.freeze(Object.defineProperty({__proto__:null,json:dNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fNe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],pNe=Object.freeze(Object.defineProperty({__proto__:null,json:fNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mNe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],gNe=Object.freeze(Object.defineProperty({__proto__:null,json:mNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yNe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],vNe=Object.freeze(Object.defineProperty({__proto__:null,json:yNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xNe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],wNe=Object.freeze(Object.defineProperty({__proto__:null,json:xNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bNe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],SNe=Object.freeze(Object.defineProperty({__proto__:null,json:bNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ne=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],ENe=Object.freeze(Object.defineProperty({__proto__:null,json:_Ne},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CNe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],TNe=Object.freeze(Object.defineProperty({__proto__:null,json:CNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MNe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],ANe=Object.freeze(Object.defineProperty({__proto__:null,json:MNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NNe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],kNe=Object.freeze(Object.defineProperty({__proto__:null,json:NNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const INe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],RNe=Object.freeze(Object.defineProperty({__proto__:null,json:INe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PNe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],DNe=Object.freeze(Object.defineProperty({__proto__:null,json:PNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LNe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],ONe=Object.freeze(Object.defineProperty({__proto__:null,json:LNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FNe=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],zNe=Object.freeze(Object.defineProperty({__proto__:null,json:FNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UNe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],BNe=Object.freeze(Object.defineProperty({__proto__:null,json:UNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zz{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[iNe,oNe,lNe,uNe,hNe,pNe,gNe,vNe,wNe,SNe,ENe,TNe,ANe,kNe,RNe,DNe,ONe,zNe,BNe],t=[].concat(...e.map(r=>r.json));this.opMappers=t.reduce((r,i)=>(r[i.tfOpName]=i,r),{})}transformGraph(e,t={}){const r=e.node,i=[],s=[],o=[],a=r.reduce((x,v)=>(x[v.name]=this.mapNode(v),v.op.startsWith("Placeholder")?i.push(x[v.name]):v.op==="Const"?s.push(x[v.name]):(v.input==null||v.input.length===0)&&o.push(x[v.name]),x),{});let l=[];const c=[];let u={},d={};t!=null&&(u=this.mapSignatureEntries(t.inputs),d=this.mapSignatureEntries(t.outputs));const h=Object.keys(a);h.forEach(x=>{const v=a[x];v.inputNames.forEach((y,b)=>{const[S,,_]=Sc(y),T=a[S];if(T.outputs!=null){const M=T.outputs.indexOf(_);if(M!==-1){const k=`${S}:${M}`;v.inputNames[b]=k}}v.inputs.push(T),T.children.push(v)})}),Object.keys(d).length===0?h.forEach(x=>{const v=a[x];v.children.length===0&&c.push(v)}):Object.keys(d).forEach(x=>{const[v]=Sc(x),y=a[v];y!=null&&(y.signatureKey=d[x],c.push(y))}),Object.keys(u).length>0?Object.keys(u).forEach(x=>{const[v]=Sc(x),y=a[v];y&&(y.signatureKey=u[x],l.push(y))}):l=i;let f={};e.library!=null&&e.library.function!=null&&(f=e.library.function.reduce((x,v)=>(x[v.signature.name]=this.mapFunction(v),x),{}));const p={nodes:a,inputs:l,outputs:c,weights:s,placeholders:i,signature:t,functions:f};return o.length>0&&(p.initNodes=o),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,r)=>(t[e[r].name]=r,t),{})}mapNode(e){const t=PX(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(i=>i.startsWith("^")?i.slice(1):i),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(r.inputParams=t.inputs.reduce((i,s)=>(i[s.name]={type:s.type,inputIndexStart:s.start,inputIndexEnd:s.end},i),{})),t.attrs!=null&&(r.attrParams=t.attrs.reduce((i,s)=>{const o=s.type;let a;switch(s.type){case"string":a=RN(e.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=RN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"string[]":a=UN(e.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=UN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"number":a=DN(e.attr,s.tfName,s.defaultValue||0),a===void 0&&s.tfDeprecatedName&&(a=DN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"number[]":a=zN(e.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=zN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"bool":a=PN(e.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=PN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"bool[]":a=$N(e.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=$N(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"shape":a=FN(e.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=FN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"shape[]":a=BN(e.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=BN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"dtype":a=LN(e.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=LN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"dtype[]":a=ON(e.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=ON(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"func":a=Qz(e.attr,s.tfName,s.defaultValue),a===void 0&&s.tfDeprecatedName&&(a=Qz(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${s.type} for op: ${e.op}`)}return i[s.name]={value:a,type:o},i},{})),r}mapFunction(e){const t=e.nodeDef,r=[],i=[];let s={};t!=null&&(s=t.reduce((d,h)=>(d[h.name]=this.mapNode(h),h.op==="Const"&&i.push(d[h.name]),d),{}));const o=[],a=[];e.signature.inputArg.forEach(d=>{const[h]=Sc(d.name),f={name:h,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:T3(d.type),type:"dtype"}},children:[]};f.signatureKey=d.name,o.push(f),s[h]=f}),Object.keys(s).forEach(d=>{const h=s[d];h.inputNames.forEach((f,p)=>{const[x,,v]=Sc(f),y=s[x];if(y.outputs!=null){const b=y.outputs.indexOf(v);if(b!==-1){const S=`${x}:${b}`;h.inputNames[p]=S}}h.inputs.push(y),y.children.push(h)})});const c=e.ret;e.signature.outputArg.forEach(d=>{const[h,f]=Sc(c[d.name]),p=s[h];p!=null&&(p.defaultOutput=f,a.push(p))});const u=this.mapArgsToSignature(e);return{nodes:s,inputs:o,outputs:a,weights:i,placeholders:r,signature:u}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,r)=>(t[r.name]=this.mapArgToTensorInfo(r),t),{}),outputs:e.signature.outputArg.reduce((t,r)=>(t[r.name]=this.mapArgToTensorInfo(r,e.ret),t),{})}}mapArgToTensorInfo(e,t){let r=e.name;return t!=null&&(r=t[r]),{name:r,dtype:e.type}}}function $Ne(n){const e=rn().global;if(typeof e.atob<"u")return e.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function DX(n,e){const t=Array.isArray(n)?String.fromCharCode.apply(null,n):$Ne(n);return e?t:t.toLowerCase()}function RN(n,e,t,r=!1){const i=n[e];return i!=null?DX(i.s,r):t}function PN(n,e,t){const r=n[e];return r?r.b:t}function DN(n,e,t){const r=n[e]||{},i=r.i!=null?r.i:r.f!=null?r.f:t;return typeof i=="number"?i:parseInt(i,10)}function T3(n){switch(typeof n=="string"&&(n=fo[n]),n){case fo.DT_FLOAT:case fo.DT_HALF:return"float32";case fo.DT_INT32:case fo.DT_INT64:case fo.DT_INT8:case fo.DT_UINT8:return"int32";case fo.DT_BOOL:return"bool";case fo.DT_DOUBLE:return"float32";case fo.DT_STRING:return"string";case fo.DT_COMPLEX64:case fo.DT_COMPLEX128:return"complex64";default:return null}}function Qz(n,e,t){const r=n[e];return r&&r.func?r.func.name:t}function LN(n,e,t){const r=n[e];return r&&r.type?T3(r.type):t}function ON(n,e,t){const r=n[e];return r&&r.list&&r.list.type?r.list.type.map(i=>T3(i)):t}function LX(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function FN(n,e,t){const r=n[e];return r&&r.shape?LX(r.shape):t}function zN(n,e,t){const r=n[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(i=>typeof i=="number"?i:parseInt(i,10)):t}function UN(n,e,t,r=!1){const i=n[e];return i&&i.list&&i.list.s?i.list.s.map(s=>DX(s,r)):t}function BN(n,e,t){const r=n[e];return r&&r.list&&r.list.shape?r.list.shape.map(i=>LX(i)):t}function $N(n,e,t){const r=n[e];return r&&r.list&&r.list.b?r.list.b:t}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jNe{constructor(e,t,r){this.node=e,this.tensorMap=t,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(i=>this.getInput(i)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((i,s)=>(i[s]=this.getAttr(s),i),{}))}getInput(e){return Zi(e,this.tensorMap,this.context)}getAttr(e,t){const r=this.node.rawAttrs[e];if(r.tensor!=null)return Zi(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return DN(this.node.rawAttrs,e,t);if(r.s!=null)return RN(this.node.rawAttrs,e,t);if(r.b!=null)return PN(this.node.rawAttrs,e,t);if(r.shape!=null)return FN(this.node.rawAttrs,e,t);if(r.type!=null)return LN(this.node.rawAttrs,e,t);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return zN(this.node.rawAttrs,e,t);if(r.list.s!=null)return UN(this.node.rawAttrs,e,t);if(r.list.shape!=null)return BN(this.node.rawAttrs,e,t);if(r.list.b!=null)return $N(this.node.rawAttrs,e,t);if(r.list.type!=null)return ON(this.node.rawAttrs,e,t)}return t}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ji=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:vq,abs:Lo,acos:z1e,acosh:B1e,add:Xt,addN:j1e,all:W1e,any:G1e,argMax:Pq,argMin:K1e,asin:Z1e,asinh:J1e,atan:tbe,atan2:rbe,atanh:sbe,avgPool:Lq,avgPool3d:fbe,basicLSTMCell:wbe,batchNorm:b2,batchNorm2d:Cbe,batchNorm3d:Mbe,batchNorm4d:Nbe,batchToSpaceND:Oq,bincount:Fq,bitwiseAnd:Rbe,booleanMaskAsync:xCe,broadcastArgs:Dbe,broadcastTo:gv,buffer:Fr,cast:Cr,ceil:Fbe,clipByValue:zq,clone:rd,complex:xd,concat:Ui,concat1d:Bbe,concat2d:jbe,concat3d:Wbe,concat4d:Gbe,conv1d:Kbe,conv2d:S2,conv2dTranspose:Qbe,conv3d:eSe,conv3dTranspose:iSe,cos:oSe,cosh:lSe,cosineWindow:y3,cumprod:uSe,cumsum:hSe,denseBincount:pSe,depthToSpace:gSe,depthwiseConv2d:t3,diag:xSe,dilation2d:bSe,div:On,divNoNan:MSe,dot:NSe,dropout:RCe,einsum:Wp,elu:$q,enclosingPowerOfTwo:yX,ensureShape:PSe,equal:Bq,erf:LSe,euclideanNorm:HSe,exp:qc,expandDims:Fo,expm1:KSe,eye:Hq,fft:p3,fill:wx,floor:Gq,floorDiv:Rq,fused:qCe,gather:qq,gatherND:NCe,greater:C2,greaterEqual:Xq,ifft:$S,imag:T2,image:Xh,inTopKAsync:DCe,irfft:dX,isFinite:i_e,isInf:o_e,isNaN:l_e,leakyRelu:Kq,less:AN,lessEqual:r3,linalg:MMe,linspace:h_e,localResponseNormalization:p_e,log:I0,log1p:Yq,logSigmoid:b_e,logSoftmax:E_e,logSumExp:Qq,logicalAnd:US,logicalNot:Jq,logicalOr:eX,logicalXor:k_e,losses:AMe,lowerBound:R_e,matMul:yr,max:Am,maxPool:tX,maxPool3d:L_e,maxPoolWithArgmax:F_e,maximum:nX,mean:BS,meshgrid:B_e,min:MN,minimum:R0,mirrorPad:rX,mod:W_e,moments:G_e,movingAverage:SCe,mul:lt,multiRNNCell:X_e,multinomial:Y_e,neg:jl,norm:E2,notEqual:iX,oneHot:J_e,ones:Oh,onesLike:t2e,op:ge,outerProduct:r2e,pad:Sd,pad1d:o2e,pad2d:l2e,pad3d:u2e,pad4d:h2e,pool:y2e,pow:k0,prelu:oX,print:Iq,prod:w2e,raggedGather:S2e,raggedRange:E2e,raggedTensorToTensor:T2e,rand:A2e,randomGamma:X2e,randomNormal:lX,randomStandardNormal:Z2e,randomUniform:f3,randomUniformInt:eEe,range:P0,real:D0,reciprocal:rEe,relu:M2,relu6:cX,reshape:Ke,reverse:xf,reverse1d:lEe,reverse2d:uEe,reverse3d:hEe,reverse4d:pEe,rfft:m3,round:uX,rsqrt:yEe,scalar:zn,scatterND:ECe,searchSorted:i3,selu:xEe,separableConv2d:bEe,setdiff1dAsync:_Ee,sigmoid:Dc,sign:CEe,signal:TMe,sin:MEe,sinh:NEe,slice:Rn,slice1d:IEe,slice2d:PEe,slice3d:LEe,slice4d:FEe,softmax:UEe,softplus:Zq,spaceToBatchND:sX,sparse:NMe,sparseToDense:MCe,spectral:CMe,split:L0,sqrt:Gc,square:Ea,squaredDifference:hX,squeeze:mr,stack:Kc,step:fX,stridedSlice:YEe,string:kMe,sub:Sn,sum:Pr,tan:QEe,tanh:TN,tensor:$l,tensor1d:is,tensor2d:Ca,tensor3d:pX,tensor4d:JEe,tensor5d:eCe,tensor6d:tCe,tensorScatterUpdate:iCe,tile:yv,topk:oCe,transpose:NN,truncatedNormal:lCe,unique:uCe,unsortedSegmentSum:hCe,unstack:Df,upperBound:pCe,variable:mCe,where:id,whereAsync:gX,zeros:bd,zerosLike:qo},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VNe=(n,e,t,r=Ji)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(O("a",n,e,t),O("b",n,e,t))];case"AddN":return[r.addN(O("tensors",n,e,t))];case"FloorMod":case"Mod":return[r.mod(O("a",n,e,t),O("b",n,e,t))];case"Mul":return[r.mul(O("a",n,e,t),O("b",n,e,t))];case"RealDiv":case"Div":return[r.div(O("a",n,e,t),O("b",n,e,t))];case"DivNoNan":return[r.divNoNan(O("a",n,e,t),O("b",n,e,t))];case"FloorDiv":return[r.floorDiv(O("a",n,e,t),O("b",n,e,t))];case"Sub":return[r.sub(O("a",n,e,t),O("b",n,e,t))];case"Minimum":return[r.minimum(O("a",n,e,t),O("b",n,e,t))];case"Maximum":return[r.maximum(O("a",n,e,t),O("b",n,e,t))];case"Pow":return[r.pow(O("a",n,e,t),O("b",n,e,t))];case"SquaredDifference":return[r.squaredDifference(O("a",n,e,t),O("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WNe=(n,e,t,r=Ji)=>{switch(n.op){case"Abs":case"ComplexAbs":return[r.abs(O("x",n,e,t))];case"Acos":return[r.acos(O("x",n,e,t))];case"Acosh":return[r.acosh(O("x",n,e,t))];case"Asin":return[r.asin(O("x",n,e,t))];case"Asinh":return[r.asinh(O("x",n,e,t))];case"Atan":return[r.atan(O("x",n,e,t))];case"Atan2":return[r.atan2(O("x",n,e,t),O("y",n,e,t))];case"Atanh":return[r.atanh(O("x",n,e,t))];case"Ceil":return[r.ceil(O("x",n,e,t))];case"Complex":return[r.complex(O("real",n,e,t),O("imag",n,e,t))];case"Cos":return[r.cos(O("x",n,e,t))];case"Cosh":return[r.cosh(O("x",n,e,t))];case"Elu":return[r.elu(O("x",n,e,t))];case"Erf":return[r.erf(O("x",n,e,t))];case"Exp":return[r.exp(O("x",n,e,t))];case"Expm1":return[r.expm1(O("x",n,e,t))];case"Floor":return[r.floor(O("x",n,e,t))];case"Log":return[r.log(O("x",n,e,t))];case"Log1p":return[r.log1p(O("x",n,e,t))];case"Imag":return[r.imag(O("x",n,e,t))];case"Neg":return[r.neg(O("x",n,e,t))];case"Reciprocal":return[r.reciprocal(O("x",n,e,t))];case"Real":return[r.real(O("x",n,e,t))];case"Relu":return[r.relu(O("x",n,e,t))];case"Round":return[r.round(O("x",n,e,t))];case"Selu":return[r.selu(O("x",n,e,t))];case"Sigmoid":return[r.sigmoid(O("x",n,e,t))];case"Sin":return[r.sin(O("x",n,e,t))];case"Sign":return[r.sign(O("x",n,e,t))];case"Sinh":return[r.sinh(O("x",n,e,t))];case"Softplus":return[r.softplus(O("x",n,e,t))];case"Sqrt":return[r.sqrt(O("x",n,e,t))];case"Square":return[r.square(O("x",n,e,t))];case"Tanh":return[r.tanh(O("x",n,e,t))];case"Tan":return[r.tan(O("x",n,e,t))];case"ClipByValue":return[r.clipByValue(O("x",n,e,t),O("clipValueMin",n,e,t),O("clipValueMax",n,e,t))];case"Relu6":return[r.relu6(O("x",n,e,t))];case"Rsqrt":return[r.rsqrt(Zi(n.inputNames[0],e,t))];case"LeakyRelu":return[r.leakyRelu(O("x",n,e,t),O("alpha",n,e,t))];case"Prelu":return[r.prelu(O("x",n,e,t),O("alpha",n,e,t))];case"IsNan":return[r.isNaN(Zi(n.inputNames[0],e,t))];case"IsInf":return[r.isInf(Zi(n.inputNames[0],e,t))];case"IsFinite":return[r.isFinite(Zi(n.inputNames[0],e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pa(n,e,t=""){if(!(typeof n=="number"||typeof e=="number")){te(n.length===e.length,()=>t+` Shapes ${n} and ${e} must match`);for(let r=0;r<n.length;r++){const i=n[r],s=e[r];te(i<0||s<0||i===s,()=>t+` Shapes ${n} and ${e} must match`)}}}function Jz(n){return!(typeof n=="number"||n.some(e=>e<0))}function Oy(n,e,t){let r=jN(n,t);const i=!Jz(r);if(i&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(i&&e.forEach(s=>{r=jN(s.shape,r)}),!Jz(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function jN(n,e){if(typeof n=="number")return e;if(typeof e=="number")return n;if(n.length!==e.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${e}`);const t=[];for(let r=0;r<n.length;++r){const i=n[r],s=e[r];if(i>=0&&s>=0&&i!==s)throw new Error(`Incompatible shape during merge: ${n} vs. ${e}`);t[r]=i>=0?i:s}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HNe{constructor(e,t,r,i,s,o,a){this.name=e,this.dtype=t,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=s,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=zn(0),Rl(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),pa(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=t,Rl(t),r.written=!0,this.tensors[e]=r}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((r,i)=>this.write(r,t[i]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let i=0;i<this.size();i++)e.push(i)}if(e.length===0)return $l([],[0].concat(this.elementShape));const r=this.readMany(e);return pa(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Kc(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return $l([],[0].concat(this.elementShape));const t=[];for(let i=0;i<this.size();i++)t.push(i);const r=this.readMany(t);return pa(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),Ui(r,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,Df(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let r=0;const i=e.map(l=>(r+=l,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const s=r===0?0:t.size/r,o=[];yn(()=>{t=Ke(t,[1,r,s]);for(let l=0;l<e.length;++l){const u=[0,l===0?0:i[l-1],0],d=[1,e[l],s];o[l]=Ke(Rn(t,u,d),this.elementShape)}return o});const a=[];for(let l=0;l<e.length;l++)a[l]=l;this.writeMany(a,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bf{get id(){return this.idTensor.id}constructor(e,t,r,i=-1){this.tensors=e,this.elementShape=t,this.elementDtype=r,e!=null&&e.forEach(s=>{if(r!==s.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${s.dtype}`);pa(t,s.shape,"TensorList shape mismatch: "),Rl(s)}),this.idTensor=zn(0),this.maxNumElements=i,Rl(this.idTensor)}copy(){return new bf([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,r=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);pa(e,this.elementShape,"TensorList shape mismatch: ");const i=Oy(this.elementShape,this.tensors,e);return yn(()=>{const s=this.tensors.map(o=>Ke(o,i));return Kc(s,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=Oy(this.elementShape,this.tensors,e),i=this.tensors.pop();return i.kept=!1,pa(i.shape,e,"TensorList shape mismatch: "),Ke(i,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(pa(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Rl(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new bf([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)t.tensors[r]=this.tensors[r];return t}getItem(e,t,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);pa(this.tensors[e].shape,t,"TensorList shape mismatch: ");const i=Oy(this.elementShape,this.tensors,t);return Ke(this.tensors[e],i)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);pa(this.elementShape,t.shape,"TensorList shape mismatch: "),Rl(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,r){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);pa(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const i=Oy(this.elementShape,this.tensors,r);return e.length===0?$l([],[0].concat(i)):yn(()=>{const s=e.map(o=>Ke(this.tensors[o],i));return Kc(s,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);pa(this.elementShape,t,"TensorList shape mismatch: ");const r=Oy(this.elementShape,this.tensors,t);return this.size()===0?$l([],[0].concat(r)):yn(()=>{const i=this.tensors.map(s=>Ke(s,r));return Ui(i,0)})}}function GNe(n,e,t){const r=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==t)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${t}`);const i=n.shape.slice(1);pa(i,e,"TensorList shape mismatch: ");const s=Df(n);return new bf(s,e,r)}function qNe(n,e,t,r){return new bf([],n,e,r)}function XNe(n,e,t,r){if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const i=Math.max(...e);if(r!=null&&r!==-1&&i>=r)throw new Error(`Max index must be < array size (${i}  vs. ${r})`);const s=new bf([],t,n.dtype,r),o=Df(n,0);return e.forEach((a,l)=>{s.setItem(a,o[l])}),s}function KNe(n,e,t){let r=0;const i=e.map(u=>(r+=u,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);const s=n.shape.slice(1),o=jN(s,t),a=r===0?0:n.size/r,l=yn(()=>{const u=[];n=Ke(n,[1,r,a]);for(let d=0;d<e.length;++d){const f=[0,d===0?0:i[d-1],0],p=[1,e[d],a];u[d]=Ke(Rn(n,f,p),o)}return n.dispose(),u}),c=new bf([],t,n.dtype,e.length);for(let u=0;u<l.length;u++)c.setItem(u,l[u]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YNe=async(n,e,t)=>{switch(n.op){case"If":case"StatelessIf":{const r=O("thenBranch",n,e,t),i=O("elseBranch",n,e,t),s=O("cond",n,e,t),o=O("args",n,e,t);return(await s.data())[0]?t.functionMap[r].executeFunctionAsync(o,t.tensorArrayMap,t.tensorListMap):t.functionMap[i].executeFunctionAsync(o,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const r=O("body",n,e,t),i=O("cond",n,e,t),s=O("args",n,e,t),o=await t.functionMap[i].executeFunctionAsync(s,t.tensorArrayMap,t.tensorListMap),a=s.map(u=>u.id);let l=await o[0].data();o.forEach(u=>{!u.kept&&a.indexOf(u.id)===-1&&u.dispose()});let c=s;for(;l[0];){const u=c;c=await t.functionMap[r].executeFunctionAsync(c,t.tensorArrayMap,t.tensorListMap);const d=c.map(f=>f.id);u.forEach(f=>{!f.kept&&a.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()});const h=await t.functionMap[i].executeFunctionAsync(c,t.tensorArrayMap,t.tensorListMap);l=await h[0].data(),h.forEach(f=>{!f.kept&&a.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()})}return c}case"LoopCond":{const r=O("pred",n,e,t);return[_c(r)]}case"Switch":{const r=O("pred",n,e,t);let i=O("data",n,e,t);return i.kept||(i=_c(i)),(await r.data())[0]?[void 0,i]:[i,void 0]}case"Merge":{const r=n.inputNames.find(i=>Zi(i,e,t)!==void 0);if(r){const i=Zi(r,e,t);return[_c(i)]}return}case"Enter":{const r=O("frameName",n,e,t),i=O("tensor",n,e,t);return t.enterFrame(r),[_c(i)]}case"Exit":{const r=O("tensor",n,e,t);return t.exitFrame(),[_c(r)]}case"NextIteration":{const r=O("tensor",n,e,t);return t.nextIteration(),[_c(r)]}case"TensorArrayV3":{const r=O("size",n,e,t),i=O("dtype",n,e,t),s=O("elementShape",n,e,t),o=O("dynamicSize",n,e,t),a=O("clearAfterRead",n,e,t),l=O("identicalElementShapes",n,e,t),c=O("name",n,e,t),u=new HNe(c,i,r,s,l,o,a);return t.addTensorArray(u),[u.idTensor,zn(1)]}case"TensorArrayWriteV3":{const r=O("tensorArrayId",n,e,t),i=O("index",n,e,t),s=O("tensor",n,e,t),o=t.getTensorArray(r.id);return o.write(i,s),[o.idTensor]}case"TensorArrayReadV3":{const r=O("tensorArrayId",n,e,t),i=O("index",n,e,t);return[t.getTensorArray(r.id).read(i)]}case"TensorArrayGatherV3":{const r=O("tensorArrayId",n,e,t),i=O("indices",n,e,t),s=O("dtype",n,e,t);return[t.getTensorArray(r.id).gather(i,s)]}case"TensorArrayScatterV3":{const r=O("tensorArrayId",n,e,t),i=O("indices",n,e,t),s=O("tensor",n,e,t),o=t.getTensorArray(r.id);return o.scatter(i,s),[o.idTensor]}case"TensorArrayConcatV3":{const r=O("tensorArrayId",n,e,t),i=t.getTensorArray(r.id),s=O("dtype",n,e,t);return[i.concat(s)]}case"TensorArraySplitV3":{const r=O("tensorArrayId",n,e,t),i=O("tensor",n,e,t),s=O("lengths",n,e,t),o=t.getTensorArray(r.id);return o.split(s,i),[o.idTensor]}case"TensorArraySizeV3":{const r=O("tensorArrayId",n,e,t),i=t.getTensorArray(r.id);return[zn(i.size(),"int32")]}case"TensorArrayCloseV3":{const r=O("tensorArrayId",n,e,t),i=t.getTensorArray(r.id);return i.clearAndClose(),[i.idTensor]}case"TensorListSetItem":{const r=O("tensorListId",n,e,t),i=O("index",n,e,t),s=O("tensor",n,e,t),o=t.getTensorList(r.id);return o.setItem(i,s),[o.idTensor]}case"TensorListGetItem":{const r=O("tensorListId",n,e,t),i=O("index",n,e,t),s=O("elementShape",n,e,t),o=O("elementDType",n,e,t);return[t.getTensorList(r.id).getItem(i,s,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=O("indices",n,e,t),i=O("tensor",n,e,t),s=O("elementShape",n,e,t),o=O("numElements",n,e,t),a=XNe(i,r,s,o);return t.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=O("elementShape",n,e,t),i=O("elementDType",n,e,t);let s;n.op==="TensorListReserve"?s="numElements":s="maxNumElements";const o=O(s,n,e,t),a=n.op==="TensorListReserve"?-1:o,l=qNe(r,i,o,a);return t.addTensorList(l),[l.idTensor]}case"TensorListGather":{const r=O("tensorListId",n,e,t),i=O("indices",n,e,t),s=O("elementShape",n,e,t),o=O("elementDType",n,e,t);return[t.getTensorList(r.id).gather(i,o,s)]}case"TensorListStack":{const r=O("tensorListId",n,e,t),i=O("elementShape",n,e,t),s=O("elementDType",n,e,t),o=O("numElements",n,e,t);return[t.getTensorList(r.id).stack(i,s,o)]}case"TensorListFromTensor":{const r=O("tensor",n,e,t),i=O("elementShape",n,e,t),s=O("elementDType",n,e,t),o=GNe(r,i,s);return t.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=O("tensorListId",n,e,t),i=t.getTensorList(r.id),s=O("dtype",n,e,t),o=O("elementShape",n,e,t);return[i.concat(s,o)]}case"TensorListPushBack":{const r=O("tensorListId",n,e,t),i=O("tensor",n,e,t),s=t.getTensorList(r.id);return s.pushBack(i),[s.idTensor]}case"TensorListPopBack":{const r=O("tensorListId",n,e,t),i=O("elementShape",n,e,t),s=O("elementDType",n,e,t);return[t.getTensorList(r.id).popBack(i,s)]}case"TensorListSplit":{const r=O("tensor",n,e,t),i=O("elementShape",n,e,t),s=O("lengths",n,e,t),o=KNe(r,s,i);return t.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=O("tensorListId",n,e,t),i=t.getTensorList(r.id);return[zn(i.size(),"int32")]}case"TensorListResize":{const r=O("tensorListId",n,e,t),i=O("size",n,e,t),o=t.getTensorList(r.id).resize(i);return t.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e4(n,e,t){const[r,i]=O("fusedOps",n,e,t),s=r==="biasadd",o=!s,a=i==="prelu",l=r==="fusedbatchnorm",c=O("numArgs",n,e,t);if(s){if(a&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&s&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const u=O("strides",n,e,t),d=Eb(n,e,t),h=O("dataFormat",n,e,t).toUpperCase(),f=O("dilations",n,e,t);let[p,x]=O("args",n,e,t);o&&(x=p,p=void 0);const v=O("leakyreluAlpha",n,e,t);return{stride:u,pad:d,dataFormat:h,dilations:f,biasArg:p,preluArg:x,activationFunc:i,leakyreluAlpha:v}}const ZNe=(n,e,t,r=Ji)=>{switch(n.op){case"Conv1D":{const i=O("stride",n,e,t),s=O("pad",n,e,t),o=O("dataFormat",n,e,t).toUpperCase(),a=O("dilation",n,e,t);return[r.conv1d(O("x",n,e,t),O("filter",n,e,t),i,s,o,a)]}case"Conv2D":{const i=O("strides",n,e,t),s=Eb(n,e,t),o=O("dataFormat",n,e,t).toUpperCase(),a=O("dilations",n,e,t);return[r.conv2d(O("x",n,e,t),O("filter",n,e,t),[i[1],i[2]],s,o,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:i,pad:s,dataFormat:o,dilations:a,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=e4(n,e,t);return[r.fused.conv2d({x:O("x",n,e,t),filter:O("filter",n,e,t),strides:[i[1],i[2]],pad:s,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:i,pad:s,dataFormat:o,dilations:a,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=e4(n,e,t);return[r.fused.depthwiseConv2d({x:O("x",n,e,t),filter:O("filter",n,e,t),strides:[i[1],i[2]],pad:s,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const i=O("outputShape",n,e,t),s=O("strides",n,e,t),o=Eb(n,e,t);return[r.conv2dTranspose(O("x",n,e,t),O("filter",n,e,t),i,[s[1],s[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const i=O("strides",n,e,t),s=Eb(n,e,t),o=O("dilations",n,e,t),a=O("dataFormat",n,e,t).toUpperCase();return[r.depthwiseConv2d(O("input",n,e,t),O("filter",n,e,t),[i[1],i[2]],s,a,[o[1],o[2]])]}case"Conv3D":{const i=O("strides",n,e,t),s=O("pad",n,e,t),o=O("dataFormat",n,e,t).toUpperCase(),a=O("dilations",n,e,t);return[r.conv3d(O("x",n,e,t),O("filter",n,e,t),[i[1],i[2],i[3]],s,o,[a[1],a[2],a[3]])]}case"AvgPool":{const i=O("strides",n,e,t),s=O("pad",n,e,t),o=O("kernelSize",n,e,t);return[r.avgPool(O("x",n,e,t),[o[1],o[2]],[i[1],i[2]],s)]}case"MaxPool":{const i=O("strides",n,e,t),s=O("pad",n,e,t),o=O("kernelSize",n,e,t);return[r.maxPool(O("x",n,e,t),[o[1],o[2]],[i[1],i[2]],s)]}case"MaxPoolWithArgmax":{const i=O("strides",n,e,t),s=O("pad",n,e,t),o=O("kernelSize",n,e,t),a=O("includeBatchInIndex",n,e,t),{result:l,indexes:c}=r.maxPoolWithArgmax(O("x",n,e,t),[o[1],o[2]],[i[1],i[2]],s,a);return[l,c]}case"AvgPool3D":{const i=O("strides",n,e,t),s=O("pad",n,e,t),o=O("kernelSize",n,e,t);return[r.avgPool3d(O("x",n,e,t),[o[1],o[2],o[3]],[i[1],i[2],i[3]],s)]}case"MaxPool3D":{const i=O("strides",n,e,t),s=O("pad",n,e,t),o=O("kernelSize",n,e,t);return[r.maxPool3d(O("x",n,e,t),[o[1],o[2],o[3]],[i[1],i[2],i[3]],s)]}case"Dilation2D":{const i=O("strides",n,e,t),s=O("pad",n,e,t),o=O("dilations",n,e,t),a=i[1],l=i[2],c=o[1],u=o[2];return[r.dilation2d(O("x",n,e,t),O("filter",n,e,t),[a,l],s,[c,u],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QNe=(n,e,t,r=Ji)=>{switch(n.op){case"Fill":{const i=O("shape",n,e,t),s=O("dtype",n,e,t),o=O("value",n,e,t);return[r.fill(i,o,s)]}case"LinSpace":{const i=O("start",n,e,t),s=O("stop",n,e,t),o=O("num",n,e,t);return[r.linspace(i,s,o)]}case"Multinomial":{const i=O("logits",n,e,t),s=O("numSamples",n,e,t),o=O("seed",n,e,t);return[r.multinomial(i,s,o)]}case"OneHot":{const i=O("indices",n,e,t),s=O("depth",n,e,t),o=O("onValue",n,e,t),a=O("offValue",n,e,t),l=O("dtype",n,e,t);return[r.oneHot(i,s,o,a,l)]}case"Ones":return[r.ones(O("shape",n,e,t),O("dtype",n,e,t))];case"OnesLike":return[r.onesLike(O("x",n,e,t))];case"RandomStandardNormal":return[r.randomStandardNormal(O("shape",n,e,t),O("dtype",n,e,t),O("seed",n,e,t))];case"RandomUniform":return[r.randomUniform(O("shape",n,e,t),O("minval",n,e,t),O("maxval",n,e,t),O("dtype",n,e,t))];case"RandomUniformInt":return[r.randomUniformInt(O("shape",n,e,t),O("minval",n,e,t),O("maxval",n,e,t),O("seed",n,e,t))];case"Range":{const i=O("start",n,e,t),s=O("stop",n,e,t),o=O("step",n,e,t);return[r.range(i,s,o,O("dtype",n,e,t))]}case"TruncatedNormal":{const i=O("shape",n,e,t),s=O("mean",n,e,t),o=O("stdDev",n,e,t),a=O("seed",n,e,t);return[r.truncatedNormal(i,s,o,O("dtype",n,e,t),a)]}case"Zeros":return[r.zeros(O("shape",n,e,t),O("dtype",n,e,t))];case"ZerosLike":return[r.zerosLike(O("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ST(n,e,t){const r=O("boxes",n,e,t),i=O("scores",n,e,t),s=O("maxOutputSize",n,e,t),o=O("iouThreshold",n,e,t),a=O("scoreThreshold",n,e,t),l=O("softNmsSigma",n,e,t);return{boxes:r,scores:i,maxOutputSize:s,iouThreshold:o,scoreThreshold:a,softNmsSigma:l}}const JNe=async(n,e,t,r,i=Ji)=>{switch(n.op){case"NonMaxSuppressionV5":{const{boxes:s,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=ST(n,e,t),d=await i.image.nonMaxSuppressionWithScoreAsync(s,o,a,l,c,u);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:s,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c}=ST(n,e,t),u=O("padToMaxOutputSize",n,e,t),d=await i.image.nonMaxSuppressionPaddedAsync(s,o,a,l,c,u);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:s,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c}=ST(n,e,t);return[await i.image.nonMaxSuppressionAsync(s,o,a,l,c)]}case"Where":{const s=i.cast(O("condition",n,e,t),"bool"),o=[await i.whereAsync(s)];return s.dispose(),o}case"ListDiff":return i.setdiff1dAsync(O("x",n,e,t),O("y",n,e,t));default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eke=(n,e,t,r=Ji)=>{switch(n.op){case"LowerBound":{const i=O("sortedSequence",n,e,t),s=O("values",n,e,t);return[r.lowerBound(i,s)]}case"TopKV2":{const i=O("x",n,e,t),s=O("k",n,e,t),o=O("sorted",n,e,t),a=r.topk(i,s,o);return[a.values,a.indices]}case"UpperBound":{const i=O("sortedSequence",n,e,t),s=O("values",n,e,t);return[r.upperBound(i,s)]}case"Unique":{const i=O("x",n,e,t),s=r.unique(i);return[s.values,s.indices]}case"UniqueV2":{const i=O("x",n,e,t),s=O("axis",n,e,t),o=r.unique(i,s);return[o.values,o.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tke=(n,e,t,r=Ji)=>{switch(n.op){case"Const":return e[n.name];case"PlaceholderWithDefault":const i=O("default",n,e,t);return[Zi(n.name,e,t)||i];case"Placeholder":return[Zi(n.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const u=O("x",n,e,t);return[_c(u)]}case"IdentityN":return O("x",n,e,t).map(u=>_c(u));case"Snapshot":const s=O("x",n,e,t);return[_c(s)];case"Shape":return[r.tensor1d(O("x",n,e,t).shape,"int32")];case"ShapeN":return O("x",n,e,t).map(u=>r.tensor1d(u.shape));case"Size":return[r.scalar(O("x",n,e,t).size,"int32")];case"Rank":return[r.scalar(O("x",n,e,t).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=O("x",n,e,t),a=O("data",n,e,t),l=O("message",n,e,t),c=O("summarize",n,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let u=0;u<a.length;u++)console.log(Array.prototype.slice.call(a[u].dataSync()).slice(0,c));return[o];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nke{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=zn(0),this.tensorMap=new Map,Rl(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return zn(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const r=await e.data();return this.tensorMap.forEach(i=>i.dispose()),this.tensorMap.clear(),yn(()=>{const i=Df(t),s=r.length,o=i.length;te(s===o,()=>`The number of elements doesn't match, keys has ${s} elements, the values has ${o} elements.`);for(let a=0;a<s;a++){const l=r[a],c=i[a];Rl(c),this.tensorMap.set(l,c)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const r=await e.data();return yn(()=>{const i=[];for(let s=0;s<r.length;s++){const o=r[s],a=this.findWithDefault(o,t);i.push(a)}return Kc(i)})}findWithDefault(e,t){const r=this.tensorMap.get(e);return r??t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rke=async(n,e,t,r)=>{switch(n.op){case"HashTable":case"HashTableV2":{const i=r.getHashTableHandleByName(n.name);if(i!=null)return[i];{const s=O("keyDType",n,e,t),o=O("valueDType",n,e,t),a=new nke(s,o);return r.addHashTable(n.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const i=O("tableHandle",n,e,t,r),s=O("keys",n,e,t),o=O("values",n,e,t);return[await r.getHashTableById(i.id).import(s,o)]}case"LookupTableFind":case"LookupTableFindV2":{const i=O("tableHandle",n,e,t,r),s=O("keys",n,e,t),o=O("defaultValue",n,e,t);return[await r.getHashTableById(i.id).find(s,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const i=O("tableHandle",n,e,t,r);return[r.getHashTableById(i.id).tensorSize()]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ike=(n,e,t,r=Ji)=>{switch(n.op){case"ResizeBilinear":{const i=O("images",n,e,t),s=O("size",n,e,t),o=O("alignCorners",n,e,t),a=O("halfPixelCenters",n,e,t);return[r.image.resizeBilinear(i,[s[0],s[1]],o,a)]}case"ResizeNearestNeighbor":{const i=O("images",n,e,t),s=O("size",n,e,t),o=O("alignCorners",n,e,t),a=O("halfPixelCenters",n,e,t);return[r.image.resizeNearestNeighbor(i,[s[0],s[1]],o,a)]}case"CropAndResize":{const i=O("image",n,e,t),s=O("boxes",n,e,t),o=O("boxInd",n,e,t),a=O("cropSize",n,e,t),l=O("method",n,e,t),c=O("extrapolationValue",n,e,t);return[r.image.cropAndResize(i,s,o,a,l,c)]}case"ImageProjectiveTransformV3":{const i=O("images",n,e,t),s=O("transforms",n,e,t),o=O("outputShape",n,e,t),a=O("fillValue",n,e,t),l=O("interpolation",n,e,t),c=O("fillMode",n,e,t);return[r.image.transform(i,s,l.toLowerCase(),c.toLowerCase(),a,o)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ske=(n,e,t,r=Ji)=>{switch(n.op){case"Equal":return[r.equal(O("a",n,e,t),O("b",n,e,t))];case"NotEqual":return[r.notEqual(O("a",n,e,t),O("b",n,e,t))];case"Greater":return[r.greater(O("a",n,e,t),O("b",n,e,t))];case"GreaterEqual":return[r.greaterEqual(O("a",n,e,t),O("b",n,e,t))];case"Less":return[r.less(O("a",n,e,t),O("b",n,e,t))];case"LessEqual":return[r.lessEqual(O("a",n,e,t),O("b",n,e,t))];case"LogicalAnd":return[r.logicalAnd(O("a",n,e,t),O("b",n,e,t))];case"LogicalNot":return[r.logicalNot(O("a",n,e,t))];case"LogicalOr":return[r.logicalOr(O("a",n,e,t),O("b",n,e,t))];case"Select":case"SelectV2":return[r.where(O("condition",n,e,t),O("a",n,e,t),O("b",n,e,t))];case"BitwiseAnd":return[r.bitwiseAnd(O("a",n,e,t),O("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oke=(n,e,t,r=Ji)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(O("a",n,e,t),O("b",n,e,t),O("transposeA",n,e,t),O("transposeB",n,e,t))];case"Einsum":return[r.einsum(O("equation",n,e,t),...O("tensors",n,e,t))];case"Transpose":return[r.transpose(O("x",n,e,t),O("perm",n,e,t))];case"_FusedMatMul":const[i,s]=O("fusedOps",n,e,t),o=i==="biasadd",a=s==="prelu",l=O("numArgs",n,e,t),c=O("leakyreluAlpha",n,e,t);if(o){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,d]=O("args",n,e,t);return[r.fused.matMul({a:O("a",n,e,t),b:O("b",n,e,t),transposeA:O("transposeA",n,e,t),transposeB:O("transposeB",n,e,t),bias:u,activation:s,preluActivationWeights:d,leakyreluAlpha:c})];case"MatrixBandPart":return[r.linalg.bandPart(O("a",n,e,t),O("numLower",n,e,t),O("numUpper",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ake=(n,e,t,r=Ji)=>{switch(n.op){case"EuclideanNorm":return[r.euclideanNorm(O("x",n,e,t),O("axis",n,e,t),O("keepDims",n,e,t))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(O("x",n,e,t),O("mean",n,e,t),O("variance",n,e,t),O("offset",n,e,t),O("scale",n,e,t),O("epsilon",n,e,t))];case"FusedBatchNormV3":return[r.batchNorm(O("x",n,e,t),O("mean",n,e,t),O("variance",n,e,t),O("offset",n,e,t),O("scale",n,e,t),O("epsilon",n,e,t))];case"LRN":return[r.localResponseNormalization(O("x",n,e,t),O("radius",n,e,t),O("bias",n,e,t),O("alpha",n,e,t),O("beta",n,e,t))];case"Softmax":return[r.softmax(O("x",n,e,t))];case"LogSoftmax":return[r.logSoftmax(O("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lke=(n,e,t,r=Ji)=>{switch(n.op){case"RaggedGather":{const{outputNestedSplits:i,outputDenseValues:s}=r.raggedGather(O("paramsNestedSplits",n,e,t),O("paramsDenseValues",n,e,t),O("indices",n,e,t),O("outputRaggedRank",n,e,t));return i.concat(s)}case"RaggedRange":{const{rtNestedSplits:i,rtDenseValues:s}=r.raggedRange(O("starts",n,e,t),O("limits",n,e,t),O("splits",n,e,t));return[i,s]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(O("shape",n,e,t),O("values",n,e,t),O("defaultValue",n,e,t),O("rowPartitionTensors",n,e,t),O("rowPartitionTypes",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cke=(n,e,t,r=Ji)=>{switch(n.op){case"Max":{const a=O("axis",n,e,t),l=O("keepDims",n,e,t);return[r.max(O("x",n,e,t),a,l)]}case"Mean":{const a=O("axis",n,e,t),l=O("keepDims",n,e,t);return[r.mean(O("x",n,e,t),a,l)]}case"Min":{const a=O("axis",n,e,t),l=O("keepDims",n,e,t);return[r.min(O("x",n,e,t),a,l)]}case"Sum":{const a=O("axis",n,e,t),l=O("keepDims",n,e,t);return[r.sum(O("x",n,e,t),a,l)]}case"All":{const a=O("axis",n,e,t),l=O("keepDims",n,e,t);return[r.all(O("x",n,e,t),a,l)]}case"Any":{const a=O("axis",n,e,t),l=O("keepDims",n,e,t);return[r.any(O("x",n,e,t),a,l)]}case"ArgMax":{const a=O("axis",n,e,t);return[r.argMax(O("x",n,e,t),a)]}case"ArgMin":{const a=O("axis",n,e,t);return[r.argMin(O("x",n,e,t),a)]}case"Prod":{const a=O("axis",n,e,t),l=O("keepDims",n,e,t);return[r.prod(O("x",n,e,t),a,l)]}case"Cumprod":{const a=O("axis",n,e,t),l=O("exclusive",n,e,t),c=O("reverse",n,e,t);return[r.cumprod(O("x",n,e,t),a,l,c)]}case"Cumsum":{const a=O("axis",n,e,t),l=O("exclusive",n,e,t),c=O("reverse",n,e,t);return[r.cumsum(O("x",n,e,t),a,l,c)]}case"Bincount":const i=O("x",n,e,t),s=O("weights",n,e,t),o=O("size",n,e,t);return[r.bincount(i,s,o)];case"DenseBincount":{const a=O("x",n,e,t),l=O("weights",n,e,t),c=O("size",n,e,t),u=O("binaryOutput",n,e,t);return[r.denseBincount(a,l,c,u)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uke=(n,e,t,r=Ji)=>{switch(n.op){case"ConcatV2":case"Concat":{const i=O("n",n,e,t),s=O("axis",n,e,t);let o=O("tensors",n,e,t);return o=o.slice(0,i),[r.concat(o,s)]}case"Gather":{const i=O("x",n,e,t),s=O("indices",n,e,t);return[r.gather(i,r.cast(s,"int32"),0)]}case"GatherV2":{const i=O("axis",n,e,t),s=O("batchDims",n,e,t),o=O("x",n,e,t),a=O("indices",n,e,t);return[r.gather(o,r.cast(a,"int32"),i,s)]}case"Reverse":{const i=O("dims",n,e,t),s=[];for(let a=0;a<i.length;a++)i[a]&&s.push(a);const o=O("x",n,e,t);return[r.reverse(o,s)]}case"ReverseV2":{const i=O("axis",n,e,t),s=O("x",n,e,t);return[r.reverse(s,i)]}case"Slice":{const i=O("begin",n,e,t),s=O("size",n,e,t);return[r.slice(O("x",n,e,t),i,s)]}case"StridedSlice":{const i=O("begin",n,e,t),s=O("end",n,e,t),o=O("strides",n,e,t),a=O("beginMask",n,e,t),l=O("endMask",n,e,t),c=O("ellipsisMask",n,e,t),u=O("newAxisMask",n,e,t),d=O("shrinkAxisMask",n,e,t),h=O("x",n,e,t);return[r.stridedSlice(h,i,s,o,a,l,c,u,d)]}case"Pack":return yn(()=>{const i=O("axis",n,e,t),s=O("tensors",n,e,t),o=s[0].shape,a=r.squeeze(s[0]).shape,l=s.map(c=>{const u=Zs(c.shape,o);if(!u&&!Zs(r.squeeze(c).shape,a))throw new Error("the input tensors shape does not match");return u?c:r.reshape(c,o)});return[r.stack(l,i)]});case"Unpack":{const i=O("axis",n,e,t),s=O("tensor",n,e,t);return r.unstack(s,i)}case"Tile":{const i=O("reps",n,e,t);return[r.tile(O("x",n,e,t),i)]}case"Split":case"SplitV":{const i=O("axis",n,e,t),s=O("numOrSizeSplits",n,e,t),o=O("x",n,e,t);return r.split(o,s,i)}case"ScatterNd":{const i=O("indices",n,e,t),s=O("values",n,e,t),o=O("shape",n,e,t);return[r.scatterND(i,s,o)]}case"GatherNd":{const i=O("x",n,e,t),s=O("indices",n,e,t);return[r.gatherND(i,s)]}case"SparseToDense":{const i=O("sparseIndices",n,e,t),s=O("outputShape",n,e,t),o=O("sparseValues",n,e,t),a=O("defaultValue",n,e,t);return[r.sparseToDense(i,o,s,o.dtype===a.dtype?a:r.cast(a,o.dtype))]}case"TensorScatterUpdate":{const i=O("indices",n,e,t),s=O("values",n,e,t),o=O("tensor",n,e,t);return[r.tensorScatterUpdate(o,i,s)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dke=(n,e,t,r=Ji)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:i,outputValues:s,emptyRowIndicator:o,reverseIndexMap:a}=r.sparse.sparseFillEmptyRows(O("indices",n,e,t),O("values",n,e,t),O("denseShape",n,e,t),O("defaultValue",n,e,t));return[i,s,o,a]}case"SparseReshape":{const{outputIndices:i,outputShape:s}=r.sparse.sparseReshape(O("inputIndices",n,e,t),O("inputShape",n,e,t),O("newShape",n,e,t));return[i,s]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(O("data",n,e,t),O("indices",n,e,t),O("segmentIds",n,e,t))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(O("data",n,e,t),O("indices",n,e,t),O("segmentIds",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hke=(n,e,t,r=Ji)=>{switch(n.op){case"FFT":return[r.fft(O("x",n,e,t))];case"IFFT":return[r.ifft(O("x",n,e,t))];case"RFFT":return[r.rfft(O("x",n,e,t))];case"IRFFT":return[r.irfft(O("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fke=(n,e,t,r=Ji)=>{switch(n.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(O("input",n,e,t),O("pattern",n,e,t),O("rewrite",n,e,t),O("replaceGlobal",n,e,t))];case"StringNGrams":{const{nGrams:i,nGramsSplits:s}=r.string.stringNGrams(O("data",n,e,t),O("dataSplits",n,e,t),O("separator",n,e,t),O("nGramWidths",n,e,t),O("leftPad",n,e,t),O("rightPad",n,e,t),O("padWidth",n,e,t),O("preserveShortSequences",n,e,t));return[i,s]}case"StringSplit":{const{indices:i,values:s,shape:o}=r.string.stringSplit(O("input",n,e,t),O("delimiter",n,e,t),O("skipEmpty",n,e,t));return[i,s,o]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(O("input",n,e,t),O("numBuckets",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pke=(n,e,t,r=Ji)=>{switch(n.op){case"Cast":return[r.cast(O("x",n,e,t),O("dtype",n,e,t))];case"ExpandDims":{const i=O("axis",n,e,t);return[r.expandDims(O("x",n,e,t),i)]}case"Squeeze":{const i=O("axis",n,e,t);return[r.squeeze(O("x",n,e,t),i)]}case"Reshape":return[r.reshape(O("x",n,e,t),O("shape",n,e,t))];case"EnsureShape":return[r.ensureShape(O("x",n,e,t),O("shape",n,e,t))];case"MirrorPad":return[r.mirrorPad(O("x",n,e,t),O("padding",n,e,t),O("mode",n,e,t))];case"PadV2":case"Pad":return[r.pad(O("x",n,e,t),O("padding",n,e,t),O("constantValue",n,e,t))];case"SpaceToBatchND":{const i=O("blockShape",n,e,t),s=O("paddings",n,e,t);return[r.spaceToBatchND(O("x",n,e,t),i,s)]}case"BatchToSpaceND":{const i=O("blockShape",n,e,t),s=O("crops",n,e,t);return[r.batchToSpaceND(O("x",n,e,t),i,s)]}case"DepthToSpace":{const i=O("blockSize",n,e,t),s=O("dataFormat",n,e,t).toUpperCase();return[r.depthToSpace(O("x",n,e,t),i,s)]}case"BroadcastTo":return[r.broadcastTo(O("x",n,e,t),O("shape",n,e,t))];case"BroadcastArgs":return[r.broadcastArgs(O("s0",n,e,t),O("s1",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t4(n,e,t,r,i=yn){const s=((o,a,l)=>{switch(o.category){case"arithmetic":return i(()=>VNe(o,a,l));case"basic_math":return i(()=>WNe(o,a,l));case"control":return YNe(o,a,l);case"convolution":return i(()=>ZNe(o,a,l));case"creation":return i(()=>QNe(o,a,l));case"dynamic":return JNe(o,a,l);case"evaluation":return i(()=>eke(o,a,l));case"image":return i(()=>ike(o,a,l));case"graph":return i(()=>tke(o,a,l));case"logical":return i(()=>ske(o,a,l));case"matrices":return i(()=>oke(o,a,l));case"normalization":return i(()=>ake(o,a,l));case"ragged":return i(()=>lke(o,a,l));case"reduction":return i(()=>cke(o,a,l));case"slice_join":return i(()=>uke(o,a,l));case"sparse":return i(()=>dke(o,a,l));case"spectral":return i(()=>hke(o,a,l));case"string":return i(()=>fke(o,a,l));case"transformation":return i(()=>pke(o,a,l));case"hash_table":return rke(o,a,l,r);case"custom":const c=PX(o.op);if(c&&c.customExecutor)return c.customExecutor(new jNe(o,a,l));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,e,t);return pf(s)?s.then(o=>[].concat(o)):[].concat(s)}class n4{constructor(e={},t={},r={},i={},s){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=r,this.functionMap=i,this.parseNodeNameCache=s,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const r=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r4(n,e,t,r){const i=new Set,s=[];let o=null,a=null;const l=new Set,c=new Set(Object.keys(n).map(h=>po(h)[0]));r=r||[];const u=new Set(r.map(h=>po(h.name)[0])),d=[...e];for(;d.length>0;){const h=d.pop();if((Sh(h)||Ske(h)||_ke(h))&&o==null&&(o=h,a=o.children.map(f=>f.name).filter(f=>i.has(f))),i.add(h.name),t[h.name]==null&&!c.has(h.name)&&!u.has(h.name)){if(h.inputs.length===0){s.push(h.name);continue}h.inputs.forEach(f=>{l.has(f.name)||(l.add(f.name),d.push(f))})}}return{inputs:n,outputs:e,usedNodes:i,missingInputs:s,dynamicNode:o,syncInputs:a}}function mke(n,e){const{usedNodes:t,inputs:r}=e,i=Object.keys(r).map(v=>po(v)[0]).map(v=>n.nodes[v]),s=n.initNodes||[],o=v=>t.has(typeof v=="string"?v:v.name);function a(v){return[...new Map(v.map(y=>[y.name,y])).values()]}const l=a([...i,...n.weights,...s]).filter(o),c=a([...l,...Object.values(n.nodes)]).filter(o),u=new Map(c.map(v=>[v.name,v])),d={};for(const v of c){d[v.name]=d[v.name]||0;for(const y of v.children)o(y)||(d[y.name]=Number.POSITIVE_INFINITY),d[y.name]=(d[y.name]||0)+1}const h=Object.entries(d).filter(([,v])=>v===0).map(([v])=>v),f=[...h];for(;h.length>0;){const v=h.pop(),y=u.get(v);for(const b of y.children.filter(o))--d[b.name]===0&&(f.push(b.name),h.push(b.name))}const p=f.map(v=>u.get(v)),x=gke(p,l);return yke(x,l),x}function gke(n,e){const t=new Map(n.map(o=>[o.name,o])),r=e.map(o=>o.name),i=new Set(r);for(;r.length>0;){const o=r.pop(),a=t.get(o);for(const l of a.children)!t.has(l.name)||i.has(l.name)||(i.add(l.name),r.push(l.name))}return n.filter(o=>i.has(o.name))}class V1 extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function yke(n,e){const t=new Map(n.map((a,l)=>[a.name,l])),r=new Set(e.map(a=>a.name)),i=a=>r.has(typeof a=="string"?a:a.name),s=new Set(n.map(a=>a.name)),o=a=>s.has(typeof a=="string"?a:a.name);for(const a of n){for(const l of a.children.filter(o)){if(!t.has(l.name))throw new V1(`Child ${l.name} of node ${a.name} is unreachable.`);if(t.get(a.name)>t.get(l.name))throw new V1(`Node ${a.name} is scheduled to run after its child ${l.name}.`)}if(!i(a))for(const l of a.inputs){if(!t.has(l.name))throw new V1(`Input ${l.name} of node ${a.name} is unreachable.`);if(t.get(l.name)>t.get(a.name))throw new V1(`Node ${a.name} is scheduled to run before its input ${l.name}.`)}}}function vke(n){const e=new Map(n.map((a,l)=>[a.name,l])),t=Number.MAX_SAFE_INTEGER,r=n.map((a,l)=>Sh(a)?t:l),i=a=>{const l=r[e.get(a.name)];return l??-1},s=n.map((a,l)=>a.children.map(i).reduce((c,u)=>Math.max(c,u),r[l])),o=new Map;for(let a=0;a<n.length;++a){const l=s[a];if(l===t)continue;const c=n[a],u=n[l];o.has(u.name)||o.set(u.name,[]),o.get(u.name).push(c)}return o}const xke=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),wke=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),bke=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Sh(n){return xke.has(n.op)}function Ske(n){return wke.has(n.op)}function _ke(n){return bke.has(n.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WS{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(r=>e[r].map(i=>i.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new WS(e.functions[r],this)})}getCompilationKey(e,t){const r=e.map(s=>s.name).sort(),i=t.map(s=>s.name).sort();return r.join(this.SEPARATOR)+"--"+i.join(this.SEPARATOR)}compile(e,t){const r=r4(e,t,this.weightMap,this._initNodes),{missingInputs:i,dynamicNode:s,syncInputs:o}=r;if(s!=null)throw new Error(`This execution contains the node '${s.name}', which has the dynamic op '${s.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(i.length>0){const c=t.map(d=>d.name),u=Object.keys(e);throw new Error(`Cannot compute the outputs [${c}] from the provided inputs [${u}]. Missing the following inputs: [${i}]`)}const a=mke(this.graph,r),l=vke(a);return{orderedNodes:a,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const t=e.clone();return Rl(t),t}cloneTensorList(e){return e?e.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([t,r])=>[t,this.cloneTensorList(r)]))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const i=r.map(h=>this.graph.nodes[po(h)[0]]),s=t.map(h=>po(h)[0]),o=new Set(s);let a=s.map(h=>this.graph.nodes[h]);a.length===0&&(a=this._outputs);const l=this.getCompilationKey(i,a);let c=this.compiledMap.get(l);c==null&&(c=this.compile(e,a),this.compiledMap.set(l,c));try{this.keepIntermediateTensors=rn().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const u={},d={};return yn(()=>{const h=new n4(this.weightMap,u,d,this.functionExecutorMap,this.parseNodeNameCache),f=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(y=>{const[b,S]=po(y,h),_=[];_[S]=e[y],f[b]=_,this.keepIntermediateTensors&&(this.clonedTensorsMap[b]=this.cloneTensorList(_))});const p=this.getFrozenTensorIds(f),{orderedNodes:x,nodeLiveUntilMap:v}=c;for(const y of x){if(f[y.name])continue;const b=t4(y,f,h,this._resourceManager);if(pf(b))throw new Error(`The execution of the op '${y.op}' returned a promise. Please use model.executeAsync() instead.`);f[y.name]=b,this.keepIntermediateTensors&&(this.clonedTensorsMap[y.name]=this.cloneTensorList(b)),this.checkTensorForDisposalWithNodeLiveUntilInfo(y,f,h,p,o,v.get(y.name))}return this.parent==null&&h.dispose(p),t.map(y=>Zi(y,f,h))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(i=>i.id)));return new Set(t)}checkTensorForDisposal(e,t,r,i,s,o,a){if(!(Sh(t)||o.has(e))){for(const l of r[e])l!=null&&(a[l.id]=(a[l.id]||0)+t.children.length);for(const l of t.inputs){if(Sh(l))continue;const c=Yz(l.name,r,i);if(c!=null)for(const u of c){if(!u||u.kept||s.has(u.id))continue;const d=a[u.id];d===1?(u.dispose(),delete a[u.id]):d!=null&&a[u.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,r,i,s,o){function a(l){return Sh(l)||s.has(l.name)}if(!(Sh(e)||o==null))for(const l of o){if(a(l))continue;const c=Yz(l.name,t,r);for(const u of c)!u||u.kept||i.has(u.id)||u.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const t of e)t&&!t.isDisposed&&t.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t,r=!1,i={},s={}){this.disposeIntermediateTensors(),r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=rn().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const o=new n4(this.weightMap,i,s,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,o,t,r),l=t.map(h=>Zi(h,a,o)),c=l.map(h=>h.id),u=Object.keys(e).map(h=>e[h].id),d=new Set([...c,...u,...this.weightIds]);return Object.values(a).forEach(h=>{h.forEach(f=>{f&&!f.isDisposed&&!d.has(f.id)&&f.dispose()})}),this.parent==null&&o.dispose(d),l}async executeFunctionAsync(e,t,r){const i=e.reduce((s,o,a)=>(s[this.inputs[a].name]=o,s),{});return this._executeAsync(i,this.outputNodes,!0,t,r)}async executeWithControlFlow(e,t,r,i){const s=Object.keys(e),o=s.map(_=>this.graph.nodes[po(_)[0]]),a=r.map(_=>po(_)[0]),l=new Set(a);let c=a.map(_=>this.graph.nodes[_]);c.length===0&&(c=this._outputs);const{usedNodes:u,missingInputs:d,dynamicNode:h,syncInputs:f}=r4(e,c,this.weightMap,this._initNodes),p=[...o,...this.graph.weights,...this._initNodes||[]].map(_=>({node:_,contexts:t.currentContext})),x=Object.assign({},this.weightMap);Object.keys(e).forEach(_=>{const[T,M]=po(_),k=[];k[M]=e[_],x[T]=k});const v={},y=this.getFrozenTensorIds(x),b={};for(;p.length>0;){const _=this.processStack(o,p,t,x,b,y,l,v,u);await Promise.all(_)}h==null&&!i&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const S=c.filter(_=>!Sh(_)&&!Zi(_.name,x,t)).map(_=>_.name);if(S.length>0){let _="";throw h!=null&&(_=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${f}]`),new Error(`Cannot compute the outputs [${S}] from the provided inputs [${s}]. Consider providing the following inputs: [${d}]. ${_}`)}return x}processStack(e,t,r,i,s,o,a,l,c){const u=[];for(;t.length>0;){const d=t.pop();r.currentContext=d.contexts;let h="";if(d.node.op==="Enter"&&O("isConstant",d.node,i,r)&&([h]=Sc(d.node.name,r)),i[d.node.name]==null){const f=t4(d.node,i,r,this._resourceManager);h||([h]=Sc(d.node.name,r));const p=r.currentContext;pf(f)?u.push(f.then(x=>(i[h]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(x)),r.currentContext=p,this.checkTensorForDisposal(h,d.node,i,r,o,a,l),this.processChildNodes(d.node,t,r,i,s,c),x))):(i[h]=f,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(f)),this.checkTensorForDisposal(h,d.node,i,r,o,a,l),this.processChildNodes(d.node,t,r,i,s,c))}else this.processChildNodes(d.node,t,r,i,s,c)}return u}processChildNodes(e,t,r,i,s,o){e.children.forEach(a=>{const[l]=Sc(a.name,r);s[l]||!o.has(a.name)||(a.op==="Merge"?a.inputNames.some(c=>!!Zi(c,i,r))&&(s[l]=!0,t.push({contexts:r.currentContext,node:a})):a.inputNames.every(c=>!!Zi(c,i,r))&&(s[l]=!0,t.push({contexts:r.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const r=e[t],[i]=po(t),s=this.graph.nodes[i];if(s.attrParams.shape&&s.attrParams.shape.value){const o=s.attrParams.shape.value,a=o.length===r.shape.length&&r.shape.every((l,c)=>o[c]===-1||o[c]===l);te(a,()=>`The shape of dict['${s.name}'] provided in model.execute(dict) must be [${o}], but was [${r.shape}]`)}s.attrParams.dtype&&s.attrParams.dtype.value&&te(r.dtype===s.attrParams.dtype.value,()=>`The dtype of dict['${s.name}'] provided in model.execute(dict) must be ${s.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){var t,r;const i={};for(const s in e){const o=(r=(t=this._signature)===null||t===void 0?void 0:t.inputs)===null||r===void 0?void 0:r[s];o!=null?i[o.name]=e[s]:i[s]=e[s]}return i}checkInputs(e){const t=Object.keys(e).filter(r=>{const[i]=po(r);return this.graph.nodes[i]==null});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(t=>{var r,i;const s=(i=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||i===void 0?void 0:i[t];return s!=null?s.name:t},{})}checkOutputs(e){e.forEach(t=>{const[r]=po(t);if(!this.graph.nodes[r])throw new Error(`The output '${t}' is not found in the graph`)})}}class Eke{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cke="?tfjs-format=file",Tke="model.json";class Mke{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},r=AX){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=r,t==null&&(this.loadOptions={}),this.resourceManager=new Eke}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return pf(e)?e.then(t=>t.getWeightStream==null?this.loadSync(t):this.loadStreaming(t)):this.loadSync(e)}loadSync(e){const t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const t=await bq(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;const r=this.artifacts.modelTopology;let i=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const s=this.artifacts.userDefinedMetadata;s.signature!=null&&(i=s.signature),s.structuredOutputKeys!=null&&(this.structuredOutputKeys=s.structuredOutputKeys)}if(this.signature=i,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new WS(Zz.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const s=Zz.Instance.transformGraph(e.modelInitializer);this.initializer=new WS(s),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const t=e instanceof ei?[e]:e,r={};return t.forEach((i,s)=>r[this.structuredOutputKeys[s]]=i),r}return e}predict(e,t){const r=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(r)}async predictAsync(e,t){const r=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(r)}normalizeInputs(e){var t;if(!(e instanceof ei)&&!Array.isArray(e)){const s=(t=this.signature)===null||t===void 0?void 0:t.inputs;if(s!=null)for(const o in s){const a=s[o];a.resourceId!=null&&(e[o]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const r=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${e.length} input tensors provided.`);let i=0;return this.inputNodes.reduce((s,o)=>{var a,l,c;const u=(c=(l=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||l===void 0?void 0:l[o])===null||c===void 0?void 0:c.resourceId;return u!=null?s[o]=this.resourceIdToCapturedInput[u]:s[o]=e[i++],s},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const t=this.initializerSignature.outputs,r=Object.keys(t);for(let i=0;i<r.length;i++){const s=r[i],o=t[s];this.resourceIdToCapturedInput[o.resourceId]=e[i]}}}execute(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const r=this.executor.execute(e,t);return r.length>1?r:r[0]}async executeAsync(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const r=await this.executor.executeAsync(e,t);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,r)=>(t[r]=[e[r]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&fr(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function rg(n,e={},t=AX){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof n=="string"&&(n=Ake(n));const r=new Mke(n,e,t);return await r.load(),r}function Ake(n){return n.endsWith("/")||(n=n+"/"),`${n}${Tke}${Cke}`}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ta=rn();ta.registerFlag("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE",()=>15);ta.registerFlag("WEBGPU_CPU_FORWARD",()=>!0);ta.registerFlag("WEBGPU_MATMUL_PROGRAM_TYPE",()=>-1);ta.registerFlag("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE",()=>!0);ta.registerFlag("WEBGPU_USE_LOW_POWER_GPU",()=>!1);ta.registerFlag("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e3);ta.registerFlag("WEBGPU_USE_PROFILE_TOOL",()=>!1);ta.registerFlag("WEBGPU_IMPORT_EXTERNAL_TEXTURE",()=>!0);ta.registerFlag("WEBGPU_USE_NAIVE_CONV2D_DEBUG",()=>!1);ta.registerFlag("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL",()=>-1);ta.registerFlag("WEBGPU_CONV_SEPARATE_IM2COL_SHADER",()=>!1);ta.registerFlag("WEBGPU_PRINT_SHADER",()=>"");ta.registerFlag("WEBGPU_ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nke{constructor(e){e&&(this.vendor=e.vendor,this.architecture=e.architecture,this.intelGPUGeneration=this.getIntelGPUGeneration())}getIntelGPUGeneration(){if(this.isIntel()){if(this.architecture.startsWith("gen"))return Number(this.architecture.match(/\d+/));if(this.architecture.startsWith("xe"))return 12}return 0}isIntel(){return this.vendor==="intel"}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kke{constructor(e){this.device=e,this.numUsedBuffers=0,this.numFreeBuffers=0,this.freeBuffers=new Map,this.usedBuffers=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}acquireBuffer(e,t,r=!1,i=!0){let s;const o=i4(e,t);return i?(this.freeBuffers.has(o)||this.freeBuffers.set(o,[]),this.freeBuffers.get(o).length>0?(s=this.freeBuffers.get(o).pop(),this.numFreeBuffers--):(s=this.device.createBuffer({size:e,usage:t,mappedAtCreation:r}),this.numBytesAllocated+=e)):(s=this.device.createBuffer({size:e,usage:t,mappedAtCreation:r}),this.numBytesAllocated+=e),this.usedBuffers.has(o)||this.usedBuffers.set(o,[]),this.usedBuffers.get(o).push(s),this.numUsedBuffers++,this.numBytesUsed+=e,s}releaseBuffer(e,t=!0){if(this.freeBuffers.size===0)return;const r=e.size,i=e.usage,s=i4(r,i),o=this.usedBuffers.get(s),a=o.indexOf(e);if(a<0)throw new Error("Cannot find the buffer in buffer manager");o[a]=o[o.length-1],o.pop(),this.numUsedBuffers--,this.numBytesUsed-=r,t?(this.freeBuffers.get(s).push(e),this.numFreeBuffers++):(e.destroy(),this.numBytesAllocated-=r)}getNumUsedBuffers(){return this.numUsedBuffers}getNumFreeBuffers(){return this.numFreeBuffers}dispose(){this.freeBuffers.forEach((e,t)=>{e.forEach(r=>{r.destroy()})}),this.usedBuffers.forEach((e,t)=>{e.forEach(r=>{r.destroy()})}),this.freeBuffers=new Map,this.usedBuffers=new Map,this.numUsedBuffers=0,this.numFreeBuffers=0,this.numBytesUsed=0,this.numBytesAllocated=0}}function i4(n,e){return`${n}_${e}`}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ike{constructor(e){this.device=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures=new Map,this.usedTextures=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}acquireTexture(e,t,r,i){const s=o4(r),o=e*t*s,a=s4(e,t,r,i);if(this.freeTextures.has(a)||this.freeTextures.set(a,[]),this.usedTextures.has(a)||this.usedTextures.set(a,[]),this.numBytesUsed+=o,this.numUsedTextures++,this.freeTextures.get(a).length>0){this.numFreeTextures--;const c=this.freeTextures.get(a).shift();return this.usedTextures.get(a).push(c),c}this.numBytesAllocated+=o;const l=this.device.createTexture({size:[e,t],format:r,usage:i});return this.usedTextures.get(a).push(l),l}releaseTexture(e){if(this.freeTextures.size===0)return;const t=e.width,r=e.height,i=e.format,s=e.usage,o=s4(t,r,i,s);this.freeTextures.has(o)||this.freeTextures.set(o,[]),this.freeTextures.get(o).push(e),this.numFreeTextures++,this.numUsedTextures--;const a=this.usedTextures.get(o),l=a.indexOf(e);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(l,1);const c=o4(i),u=t*r*c;this.numBytesUsed-=u}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){this.freeTextures.forEach((e,t)=>{e.forEach(r=>{r.destroy()})}),this.usedTextures.forEach((e,t)=>{e.forEach(r=>{r.destroy()})}),this.freeTextures=new Map,this.usedTextures=new Map,this.numUsedTextures=0,this.numFreeTextures=0,this.numBytesUsed=0,this.numBytesAllocated=0}}function s4(n,e,t,r){return`${n}_${e}_${t}_${r}`}function o4(n){if(n==="rgba8unorm")return 16;throw new Error(`${n} is not supported!`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rke(n,e){if(Math.max(...n)>5)throw new Error("Cannot symbolically compute strides for rank > 6 tensor.");const t=n.length,r="xyzwuv",i=n.map(o=>`${e}.${r[o]}`),s=new Array(t-1);s[t-2]=i[t-1];for(let o=t-3;o>=0;--o)s[o]=`(${s[o+1]} * ${i[o+1]})`;return s}const Ld=(n,e,t)=>t==="int32"?`atomicAdd(${n}, bitcast<i32>(${e}));`:`
          {
            var oldValue = 0;
            loop {
              let newValueF32 = bitcast<f32>(oldValue) + (${e});
              let newValue = bitcast<i32>(newValueF32);
              let res = atomicCompareExchangeWeak(${n}, oldValue, newValue);
              if res.exchanged {
                break;
              }
              oldValue = res.old_value;
            }
          }`;/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ig;(function(n){n[n.FROM_PIXELS=0]="FROM_PIXELS",n[n.DRAW=1]="DRAW"})(ig||(ig={}));const Pke=(n,e,t,r,i)=>{const s={dtype:r.dtype,shape:r.shape},o=Lke(t,s,e),a=n.createShaderModule({code:o,label:e.constructor.name});let l=rn().get("WEBGPU_PRINT_SHADER");if(l!==""){l=l.toLowerCase();const c=l.split(",");(l==="all"||c.some(u=>e.shaderKey.toLowerCase().includes(u)))&&(console.group(e.shaderKey),console.debug(o),console.groupEnd())}return i?n.createComputePipelineAsync({compute:{module:a,entryPoint:"_start"},label:e.constructor.name,layout:"auto"}):n.createComputePipeline({compute:{module:a,entryPoint:"_start"},label:e.constructor.name,layout:"auto"})},Mn=(n,e="f32")=>{switch(n){case 1:return`${e}`;case 2:return`vec2<${e}>`;case 3:return`vec3<${e}>`;case 4:return`vec4<${e}>`;default:throw new Error(`${n}-component ${e} is not supported.`)}};function pi(n){if(n<=1)return"i32";if(n===2)return"vec2<i32>";if(n===3)return"vec3<i32>";if(n===4)return"vec4<i32>";if(n===5)return"vec5";if(n===6)return"vec6";throw Error(`GPU for rank ${n} is not yet supported`)}function Lc(n){if(n===0)return"x";if(n===1)return"y";if(n===2)return"z";if(n===3)return"w";if(n===4)return"u";if(n===5)return"v";throw Error(`Index ${n} is not yet supported`)}function vt(...n){let e;switch(n.length){case 0:e=`
        fn main()
      `;break;case 1:e=`
        fn main(${n[0]} : i32)
      `;break;default:throw Error("Unreachable")}return e}function a4(n,e){let t;return t=`
     ${Dke(e)}
      fn _start(@builtin(local_invocation_id) LocalId : vec3<u32>,
                @builtin(global_invocation_id) GlobalId : vec3<u32>,
                @builtin(local_invocation_index) LocalIndex: u32,
                @builtin(workgroup_id) WorkgroupId : vec3<u32>,
                @builtin(num_workgroups) NumWorkgroups : vec3<u32>) {
        localId = LocalId;
        localIndex = LocalIndex;
        globalId = GlobalId;
        numWorkgroups = NumWorkgroups;
        workgroupId = WorkgroupId;
        ${n?"main(getGlobalIndex());":"main();"};
      }
    `,t}function Dke(n){return`
  @compute @workgroup_size(${n.workgroupSize[0]}, ${n.workgroupSize[1]}, ${n.workgroupSize[2]})
`}function Lke(n,e,t){const r=[],i=t.workgroupSize[0]*t.workgroupSize[1]*t.workgroupSize[2];if(t.outputComponent=t.outputComponent?t.outputComponent:1,r.push(`

      var<private> localId: vec3<u32>;
      var<private> localIndex: u32;
      var<private> globalId: vec3<u32>;
      var<private> numWorkgroups: vec3<u32>;
      var<private> workgroupId: vec3<u32>;

      // Only used when the y/z dimension of workgroup size is 1.
      fn getGlobalIndex() -> i32 {
        ${OX(t)?"  return i32(globalId.x);":`  return i32((workgroupId.z * numWorkgroups.x * numWorkgroups.y +
                workgroupId.y * numWorkgroups.x + workgroupId.x) * ${i}u +
                localIndex);
        `}
      }
    `),t.pixelsOpType!=null){const p=t.pixelsOpType===ig.FROM_PIXELS?`@group(0) @binding(0) var<storage, read_write> result: array<${_h(e.dtype,t.outputComponent)}>;`:`@group(0) @binding(1) var<storage, read> inBuf : array<${_h(n[0].dtype,t.outputComponent)}>;`,x=e.shape.length===3?"vec2<i32>":"i32";r.push(`
        struct Uniform {
          outShapeStrides : ${x},
          size            : i32,
          numChannels     : i32,
          alpha           : f32,
        };

        ${p}
        @group(0) @binding(2) var<uniform> uniforms: Uniform;
      `);const v=c4(t);return[l4,r.join(`
`),Cb(e.shape),t.getUserCode(),a4(v,t)].join(`
`)}let s,o,a="struct Uniforms { NAN : f32, INFINITY : f32, ";t.variableNames.forEach((p,x)=>{const v=pi(n[x].shape.length);a+=`${p.charAt(0).toLowerCase()+p.slice(1)}Shape : ${v}, `,s=n[x].shape.length-1,o=pi(s),a+=`${p.charAt(0).toLowerCase()+p.slice(1)}ShapeStrides: ${o}, `});const l=pi(e.shape.length);a+=`outShape : ${l}, `,s=e.shape.length-1,o=pi(s),a+=`
         outShapeStrides: ${o}, `,t.size&&(a+="size : i32, "),t.uniforms&&(a+=t.uniforms),a+="};",a=Wke(a),r.push(a),t.atomic?r.push(`
      @group(0) @binding(0) var<storage, read_write> result: array<atomic<i32>>;
    `):r.push(`
      @group(0) @binding(0) var<storage, read_write> result: array<${_h(e.dtype,t.outputComponent)}>;
    `),t.variableNames.forEach((p,x)=>{r.push(`
      @group(0) @binding(${1+x}) var<storage, read> ${p}: array<${t.variableComponents?_h(n[x].dtype,t.variableComponents[x]):_h(n[x].dtype,t.outputComponent)}>;
        `)}),a!==""&&r.push(`
      @group(0) @binding(${1+t.variableNames.length}) var<uniform> uniforms: Uniforms;
      `);const c=$ke(e.shape,t.dispatchLayout),u=[l4,r.join(`
`)+Fke,Cb(e.shape),c,jke(e.shape.length)];t.atomic||u.push(Vke(e.shape,e.dtype,t.outputComponent)),t.variableNames.forEach((p,x)=>{u.push(`${Cb(n[x].shape,p)}`)});const d=n.map((p,x)=>Bke(p,e.shape,t.variableComponents?t.variableComponents[x]:t.outputComponent,t.dispatchLayout.x.length===e.shape.length)).join(`
`);u.push(d),u.push(t.getUserCode());const h=c4(t);return u.push(a4(h,t)),u.join(`
`)}function Oke(n,e,t){let r=n.shaderKey;if(n.pixelsOpType!=null)return r;const i=[],s=[];e.forEach(u=>{i.push(u.shape),s.push(u.dtype)}),i.push(t.shape),s.push(t.dtype);const o=e.map(u=>zS(u.shape,t.shape)),a=e.map(u=>Zs(u.shape,t.shape)).join("_"),l=o.map(u=>u.join("_")).join(";"),c=OX(n)?"flatDispatch":"";return r+="_"+(n.workgroupSize?n.workgroupSize.join(","):"")+i.map(u=>u.length).join(",")+s.join(",")+n.variableNames.join(",")+l+a+c,r}const l4=`
  struct vec5 {x: i32, y: i32, z: i32, w: i32, u: i32};
  struct vec6 {x: i32, y: i32, z: i32, w: i32, u: i32, v: i32};

  // Checks whether coordinates lie within the bounds of the shape.
  fn coordsInBounds2D(coord : vec2<i32>, shape : vec2<i32>) -> bool {
    return all(coord >= vec2<i32>(0)) && all(coord < shape);
  }
  fn coordsInBounds3D(coord : vec3<i32>, shape : vec3<i32>) -> bool {
    return all(coord >= vec3<i32>(0)) && all(coord < shape);
  }
  fn coordsInBounds4D(coord : vec4<i32>, shape : vec4<i32>) -> bool {
    return all(coord >= vec4<i32>(0)) && all(coord < shape);
  }

  fn getIndexFromCoords1D(coord : i32, shape : i32) -> i32 {
    return coord;
  }
  fn getIndexFromCoords2D(coords : vec2<i32>, shape : vec2<i32>) -> i32 {
    return dot(coords, vec2<i32>(shape.y, 1));
  }
  fn getIndexFromCoords3D(coords : vec3<i32>, shape : vec3<i32>) -> i32 {
    return dot(coords, vec3<i32>(shape.y * shape.z, shape.z, 1));
  }
  fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
    return dot(coords, vec4<i32>(
        shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
  }
  fn getIndexFromCoords5D(coords : vec5, shape : vec5) -> i32 {
    let shapeStrides: vec5 = vec5(shape.y * shape.z * shape.w * shape.u, shape.z * shape.w * shape.u, shape.w * shape.u, shape.u, 1);
    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u;
  }
  fn getIndexFromCoords6D(coords : vec6, shape : vec6) -> i32 {
    let shapeStrides: vec6 = vec6(shape.y * shape.z * shape.w * shape.u * shape.v, shape.z * shape.w * shape.u * shape.v, shape.w * shape.u * shape.v, shape.u * shape.v, shape.v, 1);
    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u + coords.v*shapeStrides.v;
  }

  // NaN defination in IEEE 754-1985 is :
  //   - sign = either 0 or 1.
  //   - biased exponent = all 1 bits.
  //   - fraction = anything except all 0 bits (since all 0 bits represents infinity).
  // https://en.wikipedia.org/wiki/IEEE_754-1985#Representation_of_non-numbers
  fn isnan(val: f32) -> bool {
    let floatToUint: u32 = bitcast<u32>(val);
    return (floatToUint & 0x7fffffffu) > 0x7f800000u;
  }
  fn isnanVec4(val : vec4<f32>) -> vec4<bool> {
    let floatToUint: vec4<u32> = bitcast<vec4<u32>>(val);
    return (floatToUint & vec4<u32>(0x7fffffffu)) > vec4<u32>(0x7f800000u);
  }
`,Fke=`
  fn isinf(val: f32) -> bool {
    return abs(val) == uniforms.INFINITY;
  }
`;function Cb(n,e=""){const t=n.length,r=e!==""?`get${e.charAt(0).toUpperCase()+e.slice(1)}CoordsFromIndex`:"getCoordsFromIndex",i=e!==""?`${e.charAt(0).toLowerCase()+e.slice(1)}ShapeStrides`:"outShapeStrides";if(t<=1)return`fn ${r}(index : i32) -> i32 { return index; }`;const s=os(n),o=pi(t),a=[];for(let c=0;c<t;c++)a.push(`d${c}`);if(s.length===1)return`    fn ${r}(index : i32) -> vec2<i32> {
      let d0 = index / uniforms.${i}; let d1 = index - d0 * uniforms.${i};
      return vec2<i32>(d0, d1);
    }`;let l;return l="var index2 = index;"+s.map((c,u)=>{const d=`let ${a[u]} = index2 / uniforms.${i}.${Lc(u)}`,h=u===s.length-1?`let ${a[u+1]} = index2 - ${a[u]} * uniforms.${i}.${Lc(u)}`:`index2 = index2 - ${a[u]} * uniforms.${i}.${Lc(u)}`;return`${d}; ${h};`}).join(""),`
    fn ${r}(index : i32) -> ${o} {
      ${l}
      return ${o}(${a.join(",")});
    }
  `}function zke(n,e){const t=n.name,r=n.shape.length,i=pi(r),s="get"+t.charAt(0).toUpperCase()+t.slice(1),o=["d0","d1","d2","d3","d4","d5"].slice(0,r),a=o.map(u=>`${u} : i32`).join(", ");if(r<1)return`
      fn ${s}() -> ${Mn(e)} {
        return ${Mn(e)}(${t}[0]);
      }
    `;const l=`uniforms.${t.charAt(0).toLowerCase()+t.slice(1)}Shape`;let c=`${r}D`;return r===0&&(c="1D"),`
    fn ${s}(${a}) -> ${Mn(e)} {
      return ${Mn(e)}(${t}[getIndexFromCoords${c}(${i}(${o.join(",")}),
        ${l})${e===1?"":` / ${e}`}]);
    }
   `}function Uke(n,e,t,r){const i=n.name,s=i.charAt(0).toUpperCase()+i.slice(1),o="get"+s+"ByOutput",a=n.shape.length,l=e.length,c=pi(l);if(Zs(n.shape,e)&&r)return`
    fn ${o}Index(globalIndex : i32) -> ${Mn(t)} {
      return ${Mn(t)}(${i}[globalIndex]);
    }

    fn ${o}Coords(coords : ${c}) -> ${Mn(t)} {
      return ${Mn(t)}(${i}[${l>1?"getOutputIndexFromCoords(coords)":"coords"}${t===1?"":` / ${t}`}]);
    }
    `;const u=zS(n.shape,e),d=l-a;let h="";if(a===0)return`
    fn ${o}Index(globalIndex : i32) -> ${Mn(t)}{
      return get${s}();
    }

    fn ${o}Coords(coords : ${c}) -> ${Mn(t)}{
      return get${s}();
    }
  `;l<2&&u.length>=1?h="coords = 0;":h=u.map(v=>`coords.${Lc(v+d)} = 0;`).join(`
`);let f="";if(l<2&&a>0)f="coords";else if(l>1){const v=pi(a),y=n.shape.map((b,S)=>`coords.${Lc(S+d)}`).join(", ");f=`${v}(${y})`}else f="coords";const p=`uniforms.${i.charAt(0).toLowerCase()+i.slice(1)}Shape`,x=`${a}D`;return`
  fn ${o}Index(globalIndex : i32) -> ${Mn(t)} {
    var coords = getCoordsFromIndex(globalIndex);
    ${h}
    return ${Mn(t)}(${i}[getIndexFromCoords${x}(${f}, ${p})${t===1?"":` / ${t}`}]);
  }

  fn ${o}Coords(coordsIn : ${c}) -> ${Mn(t)} {
    var coords = coordsIn;
    ${h}
    return ${Mn(t)}(${i}[getIndexFromCoords${x}(${f}, ${p})${t===1?"":` / ${t}`}]);
  }
`}function Bke(n,e,t,r){let i=zke(n,t);return n.shape.length<=e.length&&(i+=Uke(n,e,t,r)),i}function $ke(n,e){const{x:t,y:r=[],z:i=[]}=e,s=n.length,o=t.length+r.length+i.length;if(o!==s)return"";if(t.length===s)return`fn getOutputCoords() -> ${pi(s)}{
    let globalIndex = getGlobalIndex();
    return getCoordsFromIndex(globalIndex);
  }
  `;let a="";const l=[t,r,i];for(let h=0;h<l.length;h++){const f=l[h];if(f.length!==0)if(f.length===1)a+=`let d${f[0]} = i32(globalId[${h}]);`;else{const p=Rke(f,"uniforms.outShape");a+=`var index${h} = i32(globalId[${h}]);`;for(let x=0;x<p.length;x++)a+=`let d${f[x]} = index${h} / ${p[x]};`,x===p.length-1?a+=`let d${f[x+1]} = index${h} - d${f[x]} * ${p[x]};`:a+=`index${h} = index${h} - d${f[x]} * ${p[x]};`}}const c=[];for(let h=0;h<o;h++)c.push(`d${h}`);const u=pi(o);let d=`fn getOutputCoords() -> ${u} {
  ${a}
`;return c.length===0?d+=`return ${u}(0); }`:d+=`return ${u}(${c.join(",")}); }`,d}function jke(n){let e="";switch(n){case 0:case 1:e+=`
        fn getOutputIndexFromCoords(coords : i32) -> i32 {
          return coords;
        }
        `;break;case 2:e+=`
        fn getOutputIndexFromCoords(coords : vec2<i32>) -> i32 {
          return dot(coords, vec2<i32>(uniforms.outShapeStrides, 1));
        }
        `;break;case 3:e+=`
        fn getOutputIndexFromCoords(coords : vec3<i32>) -> i32 {
          return dot(coords, vec3<i32>(uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, 1));
        }
        `;break;case 4:e+=`
        fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
          return dot(coords, vec4<i32>(
            uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, uniforms.outShapeStrides.z, 1));
        }
        `;break;case 5:e+=`
        fn getOutputIndexFromCoords(coords : vec5) -> i32 {
          return coords.x * uniforms.outShapeStrides.x +
              coords.y * uniforms.outShapeStrides.y +
              coords.z * uniforms.outShapeStrides.z +
              coords.w * uniforms.outShapeStrides.w +
              coords.u;
        }
        `;break;case 6:e+=`
        fn getOutputIndexFromCoords(coords : vec6) -> i32 {
          return coords.x * uniforms.outShapeStrides.x +
              coords.y * uniforms.outShapeStrides.y +
              coords.z * uniforms.outShapeStrides.z +
              coords.w * uniforms.outShapeStrides.w +
              coords.u * uniforms.outShapeStrides.u +
              coords.v;
        }
        `;break;default:te(!1,()=>`Unsupported ${n}D shape`);break}return e}function OX(n){return n.dispatch[1]===1&&n.dispatch[2]===1}function _h(n,e=1){if(n==="float32")return Mn(e,"f32");if(n==="int32"||n==="bool")return Mn(e,"i32");throw new Error(`type ${n} is not supported.`)}function Vke(n,e,t){const r=n.length,i=_h(e,t);let s=`fn setOutputAtIndex(flatIndex : i32, value : ${Mn(t)}) {
      result[flatIndex] = ${i}(value);
    }

    fn setOutputAtIndexI32(flatIndex : i32, value : ${Mn(t,"i32")}) {
      result[flatIndex] = ${i}(value);
    }
    `;if(r>=2){const o=["d0","d1","d2","d3","d4","d5"].slice(0,r),a=pi(r);s+=`
      fn setOutputAtCoords(${o.map(l=>`${l} : i32`).join(", ")}, value : ${Mn(t)}) {
        let flatIndex = getOutputIndexFromCoords(${a}(${o.join(", ")}));
        setOutputAtIndex(flatIndex${t===1?"":` / ${t}`}, value);
      }
      fn setOutputAtCoordsI32(${o.map(l=>`${l} : i32`).join(", ")}, value : ${Mn(t,"i32")}) {
        let flatIndex = getOutputIndexFromCoords(${a}(${o.join(", ")}));
        setOutputAtIndexI32(flatIndex${t===1?"":` / ${t}`}, value);
      }
    `}return s}function Wke(n){const e=/(\w+)\s*:\s*vec(5|6)/g;n=n.replace(e,r=>"@align(16) "+r);const t=/vec(5|6)\s*,\s*(\w+)/g;return n=n.replace(t,(r,i,s)=>`vec${i}, @align(16) ${s}`),n}function c4(n){return!(n.dispatchLayout.hasOwnProperty("y")&&n.dispatchLayout.y.length!==0||n.dispatchLayout.hasOwnProperty("z")&&n.dispatchLayout.z.length!==0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kh=n=>{let e=1;for(let t=0;t<n.length;t++)e*=n[t];return e};function xt(n,e,t=[1,1,1],r=[1,1,1]){const[i,s,o]=[Math.ceil(Kh(n.x.map(a=>e[a]))/(t[0]*r[0])),n.y?Math.ceil(Kh(n.y.map(a=>e[a]))/(t[1]*r[1])):1,n.z?Math.ceil(Kh(n.z.map(a=>e[a]))/(t[2]*r[2])):1];return[i,s,o]}function Hke(n,e,t,r=!1){const i=[8,8,1],s=[4,4,1];return r||(n<=8&&(s[1]=1),e<=16&&t<=16&&(i[0]=4)),{workgroupSize:i,elementsPerThread:s}}function FX(n,e,t=!1){if(t)return[8,8,1];const r=Kh(n.x.map(s=>e[s])),i=Kh(n.y.map(s=>e[s]));return r<=4?[4,16,1]:i<=4?[16,4,1]:[16,16,1]}function zX(n,e,t=!1){if(t)return[4,4,1];const r=Kh(n.x.map(s=>e[s])),i=Kh(n.y.map(s=>e[s]));return r<=4?[1,2,1]:i<=4?[2,1,1]:[2,2,1]}function Nt(n){return{x:n.map((e,t)=>t)}}function u4(n){if(n==="float32"||n==="int32"||n==="bool"||n==="string")return 4;if(n==="complex64")return 8;throw new Error(`Unknown dtype ${n}`)}function UX(){return!!(typeof globalThis<"u"&&globalThis.navigator&&globalThis.navigator.gpu)}function BX(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&te(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGPU backend.`)})}var _l;(function(n){n[n.MatMulReduceProgram=0]="MatMulReduceProgram",n[n.MatMulSplitKProgram=1]="MatMulSplitKProgram",n[n.MatMulSmallOutputSizeProgram=2]="MatMulSmallOutputSizeProgram",n[n.MatMulPackedProgram=3]="MatMulPackedProgram",n[n.MatMulMax=4]="MatMulMax"})(_l||(_l={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gke=rn().getNumber("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD"),qke=(n,e)=>{const t=n.limits.maxComputeWorkgroupsPerDimension,r=e.dispatchLayout,i=e.dispatch;if(i.every(o=>o<=t))return i;te(i[0]>t&&r.y===void 0&&r.z===void 0,()=>"Dispatch size exceeds WebGPU limits in Y or Z dimension.");let s=Math.ceil(Math.sqrt(i[0]));return s>t?(s=Math.ceil(Math.cbrt(i[0])),te(s<=t,()=>"Total dispatch size exceeds WebGPU maximum."),[s,s,s]):[s,s,1]};class Dg extends g8{nextDataId(){return Dg.nextDataId++}constructor(e,t){if(super(),this.commandQueueOwnedIds=new WeakSet,this.dispatchCountInPass=0,this.disposed=!1,this.downloadWaitMs=0,this.tensorDataPendingDisposal=[],this.queryResolveBuffer=null,this.querySet=null,this.querySetCount=2,this.stagingPendingDisposal=[],this.uniformPendingDisposal=[],this.uploadWaitMs=0,this.hasReadSyncWarned=!1,this.hasTimestampQueryWarned=!1,!UX())throw new Error("WebGPU is not supported on this device");this.pipelineCache={},this.device=e,this.queue=e.queue,this.commandEncoder=null,this.computePassEncoder=null,this.adapterInfo=new Nke(t),this.supportTimestampQuery=this.device.features.has("timestamp-query"),this.thresholdToIncreaseWorkgroups=this.adapterInfo.intelGPUGeneration>=12?16:8,this.bufferManager=new kke(this.device),this.textureManager=new Ike(this.device),this.tensorMap=new Pxe(this,Cm()),rn().getBool("WEBGPU_USE_PROFILE_TOOL")&&(this.dummyCanvas=document.createElement("canvas"),this.dummyCanvas.width=1,this.dummyCanvas.height=1,this.dummyContext=this.dummyCanvas.getContext("webgpu"),this.dummyContext.configure({device:e,format:"bgra8unorm"}),document.body.appendChild(this.dummyCanvas))}floatPrecision(){return 32}disposeData(e,t=!1){if(!this.tensorMap.has(e))return!0;const r=this.tensorMap.get(e);return t?r.refCount=0:r.refCount--,r.refCount>0?!1:(r.complexTensorInfos!=null&&(this.disposeData(r.complexTensorInfos.real.dataId),this.disposeData(r.complexTensorInfos.imag.dataId)),this.commandQueueOwnedIds.has(e)?(this.tensorDataPendingDisposal.push(e),!0):(this.releaseResource(e),this.tensorMap.delete(e),!0))}memory(){return{numBytesInGPU:this.bufferManager.numBytesUsed,numBytesAllocatedInGPU:this.bufferManager.numBytesAllocated,unreliable:!1}}releaseResource(e){const t=this.tensorMap.get(e);if(!(!t||!t.resource)){if(t.external){t.resource=null;return}t.resource instanceof GPUBuffer?this.bufferManager.releaseBuffer(t.resource):t.resource instanceof GPUTexture&&this.textureManager.releaseTexture(t.resource),t.resource=null}}refCount(e){return this.tensorMap.has(e)?this.tensorMap.get(e).refCount:0}incRef(e){const t=this.tensorMap.get(e);t.refCount++}decRef(e){if(this.tensorMap.has(e)){const t=this.tensorMap.get(e);t.refCount--}}write(e,t,r){if(r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={id:this.nextDataId()};return this.tensorMap.set(i,{dtype:r,shape:t,values:e,refCount:1}),i}move(e,t,r,i,s){if(i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.tensorMap.set(e,{dtype:i,shape:r,values:t,refCount:s})}submitQueue(){this.queue.submit([this.commandEncoder.finish()]),this.commandEncoder=null,this.dispatchCountInPass=0,this.commandQueueOwnedIds=new WeakSet,this.tensorDataPendingDisposal.forEach(e=>{this.releaseResource(e),this.tensorMap.delete(e)}),this.uniformPendingDisposal.forEach(e=>this.bufferManager.releaseBuffer(e)),this.stagingPendingDisposal.forEach(e=>this.bufferManager.releaseBuffer(e,!1)),this.tensorDataPendingDisposal=[],this.uniformPendingDisposal=[],this.stagingPendingDisposal=[]}ensureCommandEncoderReady(){this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder())}endComputePassEncoder(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}async checkCompileCompletionAsync(){let e;try{e=await Promise.all(Object.values(this.pipelineCache))}catch(t){throw new Error(t.message)}Object.keys(this.pipelineCache).map((t,r)=>{this.pipelineCache[t]=e[r]})}async getBufferData(e){if(rn().getBool("WEBGPU_ENGINE_COMPILE_ONLY"))return console.warn("The data may be invalid since WEBGPU_ENGINE_COMPILE_ONLY is true, this can only be called when WEBGPU_ENGINE_COMPILE_ONLY is false"),null;const t=e.size,r=this.bufferManager.acquireBuffer(t,GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(e,0,r,0,t),this.submitQueue(),await r.mapAsync(GPUMapMode.READ);const i=r.getMappedRange().slice(0);return r.unmap(),r!=null&&this.bufferManager.releaseBuffer(r),rn().getBool("WEBGPU_USE_PROFILE_TOOL")&&(te(this.dummyContext!==void 0,()=>"Fail to get context for profiling tool"),this.dummyContext.getCurrentTexture()),i}convertAndCacheOnCPU(e,t){const r=this.tensorMap.get(e);return r.values=t,r.values}readSync(e){const t=this.tensorMap.get(e),{values:r,complexTensorInfos:i}=t;if(r!=null||t.dtype==="string")return r;if(t.dtype==="complex64"){const x=this.readSync(i.real.dataId),v=this.readSync(i.imag.dataId),y=mT(Hz(x,v).buffer,"float32");return this.convertAndCacheOnCPU(e,y),y}this.hasReadSyncWarned||(this.hasReadSyncWarned=!0,console.warn("The performance of synchronously reading data from GPU to CPU is poor on the webgpu backend, please use asynchronous APIs instead."));const s=["opaque","premultiplied"],o=t.resource,a=o.size;te(a%4===0,()=>"Because there is 4 bytes for one pixel, buffer size must be multiple of 4.");const l=a/4,c=new ArrayBuffer(a),u=256,d=256,h=s.map(x=>new OffscreenCanvas(u,d)),f=new OffscreenCanvas(u,d);this.endComputePassEncoder(),h.map((x,v)=>{const y=x.getContext("webgpu");return y.configure({device:this.device,format:"bgra8unorm",usage:GPUTextureUsage.COPY_DST,alphaMode:s[v]}),y.getCurrentTexture()}).map((x,v)=>{const y=u*4,b=(P,z,I)=>{this.ensureCommandEncoderReady(),this.commandEncoder.copyBufferToTexture({buffer:o,bytesPerRow:y,offset:I},{texture:x},{width:P,height:z}),this.submitQueue();const L=f.getContext("2d",{willReadFrequently:!0});L.clearRect(0,0,P,z),L.drawImage(h[v],0,0);const W=L.getImageData(0,0,P,z).data,q=s[v],$=new Uint8ClampedArray(c,I,P*z*4);for(let ne=0;ne<$.length;ne+=4)if(q==="premultiplied")$[ne+3]=W[ne+3];else{const Y=W[ne];$[ne]=W[ne+2],$[ne+1]=W[ne+1],$[ne+2]=Y}},S=Math.floor(l/(u*d));let _=u,T=d,M=0;for(let P=0;P<S;P++)b(_,T,M),M+=u*d*4;const k=l%(u*d);T=Math.floor(k/u),T>0&&(b(_,T,M),M+=T*(u*4)),_=k%u,_>0&&b(_,1,M)});const p=mT(c,t.dtype);return this.convertAndCacheOnCPU(e,p),p}async read(e){if(!this.tensorMap.has(e))throw new Error(`Tensor ${e} was not registered!`);const t=this.tensorMap.get(e),{values:r}=t;if(r!=null)return r;let i;if(t.dtype==="complex64"){const s=await Promise.all([this.read(t.complexTensorInfos.real.dataId),this.read(t.complexTensorInfos.imag.dataId)]),o=s[0],a=s[1];i=Hz(o,a)}else{const s=await this.getBufferData(t.resource);i=mT(s,t.dtype)}return this.convertAndCacheOnCPU(e,i),i}copyBuffer(e){const t=e.size,r=e.usage,i=this.bufferManager.acquireBuffer(t,r);return this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(e,0,i,0,t),this.submitQueue(),i}createTensorFromGPUData(e,t,r){let i=e.buffer;if(r==="complex64")throw new Error("Cannot write to a complex64 dtype. ");const s={id:this.nextDataId()};this.tensorMap.set(s,{dtype:r,shape:t,values:null,refCount:1,external:e.zeroCopy});const o=this.tensorMap.get(s),a=u4(o.dtype)*gt(o.shape);if(e.buffer.size<a)throw new Error(`GPUBuffer size(${e.buffer.size}) is smaller than tensor size(${a})!`);if((e.buffer.usage&(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))!==(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))throw new Error("GPUBuffer.usage should include GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC!");return e.zeroCopy!==!0&&(i=this.copyBuffer(i)),o.resource=i,Cm().makeTensorFromDataId(s,t,r,this)}readToGPU(e){const t=this.tensorMap.get(e),{values:r,dtype:i,shape:s,resource:o}=t;if(i==="complex64")throw new Error("Does not support reading buffer for complex64 dtype.");if(o==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const a=o,l=a.size,c=a.usage,u=this.bufferManager.acquireBuffer(l,c);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(o,0,u,0,l),this.submitQueue();const d=this.makeTensorInfo(s,i),h=Cm().makeTensorFromTensorInfo(d),f=this.tensorMap.get(d.dataId);return f.resource=u,{tensorRef:h,buffer:u}}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const r=t.map(i=>Qm(i));return Fr(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Fr(e.shape,e.dtype,t)}async time(e){!this.supportTimestampQuery&&!this.hasTimestampQueryWarned&&(console.warn("This device doesn't support timestamp-query extension. Start Chrome browser with flag --enable-dawn-features=allow_unsafe_apis to try it again. Otherwise, zero will be shown for the kernel time when profiling mode is enabled."),this.hasTimestampQueryWarned=!0);const t=this.activeTimers,r=[];let i=!1;this.programTimersStack==null?(this.programTimersStack=r,i=!0):this.activeTimers.push(r),this.activeTimers=r,e();const s=mf(this.activeTimers.map(c=>c.query)).filter(c=>c!=null),o=mf(this.activeTimers.map(c=>c.name)).filter(c=>c!=null);this.activeTimers=t,i&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},l=await Promise.all(s);return a.kernelMs=Dxe(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:o[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", "),this.uploadWaitMs=0,this.downloadWaitMs=0,a}makeTensorInfo(e,t,r){return t==="string"&&r!=null&&r.length>0&&g2(r[0])&&(r=r.map(s=>qh(s))),{dataId:this.write(r,e,t),shape:e,dtype:t}}tensorToBinding(e){if(!e)return null;const r=this.tensorMap.get(e.dataId).resource;return r instanceof GPUBuffer?{buffer:r}:r instanceof GPUTexture?r.createView():r}uploadToGPU(e){const t=this.tensorMap.get(e);if(t.resource!=null)return;const r=u4(t.dtype)*gt(t.shape);let i;const s=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;if(t.values){if(i=this.bufferManager.acquireBuffer(r,s,!0),i.mapState==="unmapped"){const o=this.bufferManager.acquireBuffer(r,GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC,!0,!1),a=o.getMappedRange();t.dtype==="int32"||t.dtype==="bool"?new Int32Array(a).set(t.values):new Float32Array(a).set(t.values),o.unmap(),this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(o,0,i,0,r),this.stagingPendingDisposal.push(o)}else{const o=i.getMappedRange();t.dtype==="int32"||t.dtype==="bool"?new Int32Array(o).set(t.values):new Float32Array(o).set(t.values),i.unmap()}t.values=null}else i=this.bufferManager.acquireBuffer(r,s);t.resource=i}makeUniforms(e){let t=0,r=0;const i=[];let s=1;e.forEach(l=>{l.data.length===0&&(l.data=[1]);let c;switch(l.data.length){case 1:c=4;break;case 2:c=8;break;case 3:c=16;break;case 4:c=16;break;case 5:c=16;break;case 6:c=16;break;default:te(!1,()=>`Unsupported ${l.data.length}D shape`)}(r===5||r===6)&&(c=16),c>s&&(s=c),t=Math.ceil(t/c)*c,r=l.data.length,i.push(t),t+=l.data.length*4}),t=Math.ceil(t/s)*s;const o=new ArrayBuffer(t);e.forEach((l,c)=>{const u=i[c];l.type==="int32"?new Int32Array(o,u,l.data.length).set(l.data):l.type==="uint32"?new Uint32Array(o,u,l.data.length).set(l.data):new Float32Array(o,u,l.data.length).set(l.data)});const a=this.bufferManager.acquireBuffer(t,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);return this.queue.writeBuffer(a,0,o,0,t),this.uniformPendingDisposal.push(a),{offset:0,size:t,buffer:a}}runWebGPUProgram(e,t,r,i,s){if(s||(s=this.makeTensorInfo(e.outputShape,r)),gt(s.shape)===0)return this.tensorMap.get(s.dataId).values=yd(s.dtype,0),s;this.uploadToGPU(s.dataId),e.dispatch=qke(this.device,e);const o=t.map((l,c)=>{if(l.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");return this.uploadToGPU(l.dataId),{dtype:this.tensorMap.get(l.dataId).dtype,shape:l.shape,name:e.variableNames[c]}});e.shaderKey=Oke(e,o,s);const a=rn().getBool("WEBGPU_ENGINE_COMPILE_ONLY");return e.shaderKey in this.pipelineCache||(this.pipelineCache[e.shaderKey]=Pke(this.device,e,o,s,a)),e.pipeline=this.pipelineCache[e.shaderKey],a||this.recordAndSubmit(e,s,t,i),s}recordAndSubmit(e,t,r,i){if(e.pipeline instanceof Promise)throw new Error("Please call checkCompileCompletionAsync to ensure parallel compilation is done!");let s=[],o=[];const a="int32";if(e.pixelsOpType==null){s.push({type:"float32",data:[NaN]},{type:"float32",data:[1/0]}),o=r.concat(t).map(f=>f.shape);const h="int32";o.map(f=>{s.push({type:h,data:f});const p=os(f);s.push({type:h,data:p})})}else{const h=os(t.shape);s.push({type:a,data:h})}if(e.size){const h=gt(e.outputShape);s.push({type:a,data:[e.outputComponent?h/e.outputComponent:h]})}i&&(s=[...s,...i]);const l=[this.tensorToBinding(t),...r.map(h=>this.tensorToBinding(h)),this.makeUniforms(s)];r.forEach(h=>{this.commandQueueOwnedIds.add(h.dataId)}),this.commandQueueOwnedIds.add(t.dataId);const c=this.device.createBindGroup({layout:e.pipeline.getBindGroupLayout(0),entries:l.map((h,f)=>({binding:f,resource:h}))}),u=this.activeTimers!=null;this.ensureCommandEncoderReady();const d={};u&&this.supportTimestampQuery?(this.endComputePassEncoder(),this.querySet==null&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.querySetCount})),d.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1},this.computePassEncoder=this.commandEncoder.beginComputePass(d)):this.computePassEncoder||(this.computePassEncoder=this.commandEncoder.beginComputePass(d)),this.computePassEncoder.setPipeline(e.pipeline),this.computePassEncoder.setBindGroup(0,c),this.computePassEncoder.dispatchWorkgroups(e.dispatch[0],e.dispatch[1],e.dispatch[2]),this.dispatchCountInPass++,(u||rn().get("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE")<=this.dispatchCountInPass||e.pixelsOpType===ig.DRAW)&&(this.endComputePassEncoder(),u?this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime()}):this.submitQueue())}async getQueryTime(){if(!this.supportTimestampQuery)return 0;this.queryResolveBuffer==null&&(this.queryResolveBuffer=this.bufferManager.acquireBuffer(this.querySetCount*8,GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST|GPUBufferUsage.QUERY_RESOLVE)),this.commandEncoder.resolveQuerySet(this.querySet,0,this.querySetCount,this.queryResolveBuffer,0);const e=this.bufferManager.acquireBuffer(this.querySetCount*8,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST);this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,this.querySetCount*8),this.submitQueue(),await e.mapAsync(GPUMapMode.READ);const t=new BigUint64Array(e.getMappedRange()),r=Number(t[1]-t[0])/1e6;return e.unmap(),this.bufferManager.releaseBuffer(e),r}shouldExecuteOnCPU(e,t=Gke){return rn().getBool("WEBGPU_CPU_FORWARD")&&e.every(r=>this.tensorMap.get(r.dataId).resource==null&&gt(r.shape)<t)}numDataIds(){return this.tensorMap.numDataIds()-this.tensorDataPendingDisposal.length}dispose(){this.disposed||(this.querySet!=null&&this.querySet.destroy(),this.bufferManager.dispose(),this.textureManager.dispose(),this.disposed=!0)}}Dg.nextDataId=0;/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */UX()&&Kwe("webgpu",async()=>{const n={powerPreference:rn().get("WEBGPU_USE_LOW_POWER_GPU")?"low-power":"high-performance"},e=await navigator.gpu.requestAdapter(n),t={},r=[];e.features.has("timestamp-query")&&r.push("timestamp-query"),e.features.has("bgra8unorm-storage")&&r.push(["bgra8unorm-storage"]),t.requiredFeatures=r;const i=e.limits;t.requiredLimits={maxComputeWorkgroupStorageSize:i.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:i.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:i.maxStorageBufferBindingSize,maxBufferSize:i.maxBufferSize,maxComputeWorkgroupSizeX:i.maxComputeWorkgroupSizeX,maxComputeInvocationsPerWorkgroup:i.maxComputeInvocationsPerWorkgroup};const s=await e.requestDevice(t),o="info"in e?e.info:"requestAdapterInfo"in e?await e.requestAdapterInfo():void 0;return new Dg(s,o)},3);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var pn;(function(n){n[n.ADD=0]="ADD",n[n.ATAN2=1]="ATAN2",n[n.COMPLEX_MULTIPLY_IMAG=2]="COMPLEX_MULTIPLY_IMAG",n[n.COMPLEX_MULTIPLY_REAL=3]="COMPLEX_MULTIPLY_REAL",n[n.DIV=4]="DIV",n[n.ELU_DER=5]="ELU_DER",n[n.EQUAL=6]="EQUAL",n[n.FLOOR_DIV=7]="FLOOR_DIV",n[n.GREATER=8]="GREATER",n[n.GREATER_EQUAL=9]="GREATER_EQUAL",n[n.LESS=10]="LESS",n[n.LESS_EQUAL=11]="LESS_EQUAL",n[n.LOGICAL_AND=12]="LOGICAL_AND",n[n.LOGICAL_OR=13]="LOGICAL_OR",n[n.MAX=14]="MAX",n[n.MIN=15]="MIN",n[n.MOD=16]="MOD",n[n.MUL=17]="MUL",n[n.NOT_EQUAL=18]="NOT_EQUAL",n[n.POW=19]="POW",n[n.PRELU=20]="PRELU",n[n.SQUARED_DIFFERENCE=21]="SQUARED_DIFFERENCE",n[n.SUB=22]="SUB"})(pn||(pn={}));const Xke="let resultTemp = a + b;",Kke="let resultTemp = atan2(a, b);",Yke="let resultTemp = areal * breal - aimag * bimag;",Zke="let resultTemp = areal * bimag + aimag * breal;",Qke="let resultTemp = a / b;",Jke="let resultTemp = select(a * (b + 1.0), a, b >= b - b);",eIe=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a == b);
`,tIe=`
  let remainder =
      select(a % b, round(a % b), (round(a) == a) & (round(b) == b));
  let quotient = (a - remainder) / b;
  let resultTemp =
      round(select(quotient, quotient - 1, sign(remainder) == -sign(b)));
`,nIe=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a > b);
`,rIe=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a >= b);
`,iIe=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a < b);
`,sIe=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a <= b);
`,oIe="return f32(a >= 1.0 && b >= 1.0);",aIe=`return (vec4<f32>(a >= vec4<f32>(1.0)) *
  vec4<f32>(b >= vec4<f32>(1.0)));`,lIe="return f32(a >= 1.0 || b >= 1.0);",cIe=`return min(vec4<f32>(a >= vec4<f32>(1.0)) +
  vec4<f32>(b >= vec4<f32>(1.0)), vec4<f32>(1.0));`,uIe="let resultTemp = max(a, b);",dIe="let resultTemp = min(a, b);",hIe=`
  let isNaN = b == 0.;
  var resultTemp = a % b;
  resultTemp = select((resultTemp + b) % b, resultTemp,
      (a < 0. && b < 0.) || (a >= 0. && b > 0.));
`,fIe=`
  let isNaN = !vec4<bool>(b);
  var resultTemp = vec4<f32>(a % b);
  if (!((a[0] < 0. && b[0] < 0.) || (a[0] >= 0. && b[0] > 0.))) {
    resultTemp[0] = (resultTemp[0] + b[0]) % b[0];
  }
  if (!((a[1] < 0. && b[1] < 0.) || (a[1] >= 0. && b[1] > 0.))) {
    resultTemp[1] = (resultTemp[1] + b[1]) % b[1];
  }
  if (!((a[2] < 0. && b[2] < 0.) || (a[2] >= 0. && b[2] > 0.))) {
    resultTemp[2] = (resultTemp[2] + b[2]) % b[2];
  }
  if (!((a[3] < 0. && b[3] < 0.) || (a[3] >= 0. && b[3] > 0.))) {
    resultTemp[3] = (resultTemp[3] + b[3]) % b[3];
  }
`,pIe="let resultTemp = a * b;",mIe=`
  var resultTemp = f32(a != b);
  let valueForNaN = 1.0;
`,gIe=`
  var resultTemp = vec4<f32>(a != b);
  let valueForNaN = 1.0;
`,yIe=`
  let isNaN = a < 0.0 && floor(b) < b;
  if (b == 0.0) {
    return 1.0;
  }
  var resultTemp = select(sign(a) * pow(abs(a), b), pow(abs(a), b),
      round(abs(b) % 2.0) != 1.0);
`,vIe=`
  let isModRound1Bool = vec4<i32>(round(abs(b) % vec4<f32>(2.0))) == vec4<i32>(1);
  let isModRound1 = vec4<f32>(isModRound1Bool);
  let multiplier = sign(a) * isModRound1 + (vec4<f32>(1.0) - isModRound1);
  var resultTemp = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  let isExpZero = b == vec4<f32>(0.0);
  if (isExpZero.r) {
    resultTemp.r = 1.0;
  }
  if (isExpZero.g) {
    resultTemp.g = 1.0;
  }
  if (isExpZero.b) {
    resultTemp.b = 1.0;
  }
  if (isExpZero.a) {
    resultTemp.a = 1.0;
  }
  let isNaN = (a < vec4<f32>(0.0)) & (floor(b) < b);
`,xIe="if (a < 0.0) { return b * a; }  return a;",wIe=`
  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));
  return (aLessThanZero * (b * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);
`,bIe="let resultTemp = (a - b) * (a - b);",SIe="let resultTemp = a - b;";function M3(n,e){let t;do{switch(n){case pn.ATAN2:t=Kke;break;case pn.MAX:t=uIe;break;case pn.MIN:t=dIe;break;case pn.MOD:t=e?fIe:hIe;break;case pn.NOT_EQUAL:t=e?gIe:mIe;break;case pn.POW:t=e?vIe:yIe;break;default:continue}let r,i,s;return e?(r="isnanVec4",i="vec4<f32>",s="vec4<bool>"):(r="isnan",i="f32",s="bool"),`
      let aIsNaN = ${r}(a);
      let aPostLegalization = select(a, ${i}(42), aIsNaN);
      let bIsNaN = ${r}(b);
      let bPostLegalization = select(b, ${i}(42), bIsNaN);
      let isNaN = false;
      let valueForNaN = uniforms.NAN;
      {
        let a = aPostLegalization;
        let b = bPostLegalization;
        ${t}
        return select(
            resultTemp, ${i}(valueForNaN),
            ${s}(isNaN) | aIsNaN | bIsNaN);
      }
    `}while(!1);switch(n){case pn.ADD:t=Xke;break;case pn.COMPLEX_MULTIPLY_IMAG:t=Zke;break;case pn.COMPLEX_MULTIPLY_REAL:t=Yke;break;case pn.DIV:t=Qke;break;case pn.ELU_DER:t=Jke;break;case pn.EQUAL:t=eIe;break;case pn.FLOOR_DIV:t=tIe;break;case pn.GREATER:t=nIe;break;case pn.GREATER_EQUAL:t=rIe;break;case pn.LESS:t=iIe;break;case pn.LESS_EQUAL:t=sIe;break;case pn.LOGICAL_AND:return e?aIe:oIe;case pn.LOGICAL_OR:return e?cIe:lIe;case pn.MUL:t=pIe;break;case pn.PRELU:return e?wIe:xIe;case pn.SQUARED_DIFFERENCE:t=bIe;break;case pn.SUB:t=SIe;break}return`
    ${t}
    return resultTemp;
  `}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ft;(function(n){n[n.ABS=0]="ABS",n[n.ACOS=1]="ACOS",n[n.ACOSH=2]="ACOSH",n[n.ASIN=3]="ASIN",n[n.ASINH=4]="ASINH",n[n.ATAN=5]="ATAN",n[n.ATANH=6]="ATANH",n[n.CEIL=7]="CEIL",n[n.COS=8]="COS",n[n.COSH=9]="COSH",n[n.ELU=10]="ELU",n[n.ERF=11]="ERF",n[n.EXP=12]="EXP",n[n.EXPM1=13]="EXPM1",n[n.FLOOR=14]="FLOOR",n[n.IS_FINITE=15]="IS_FINITE",n[n.IS_INF=16]="IS_INF",n[n.IS_NAN=17]="IS_NAN",n[n.LINEAR=18]="LINEAR",n[n.LOG=19]="LOG",n[n.LOG1P=20]="LOG1P",n[n.LOGICAL_NOT=21]="LOGICAL_NOT",n[n.NEG=22]="NEG",n[n.RELU=23]="RELU",n[n.RELU6=24]="RELU6",n[n.LEAKYRELU=25]="LEAKYRELU",n[n.RECIPROCAL=26]="RECIPROCAL",n[n.ROUND=27]="ROUND",n[n.RSQRT=28]="RSQRT",n[n.SELU=29]="SELU",n[n.SIGMOID=30]="SIGMOID",n[n.SIGN=31]="SIGN",n[n.SIN=32]="SIN",n[n.SINH=33]="SINH",n[n.SOFTPLUS=34]="SOFTPLUS",n[n.SQRT=35]="SQRT",n[n.SQUARE=36]="SQUARE",n[n.STEP=37]="STEP",n[n.TAN=38]="TAN",n[n.TANH=39]="TANH",n[n.TO_INT=40]="TO_INT"})(ft||(ft={}));const _Ie="return abs(a);",EIe=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  return acos(a);
`,CIe=`
  if (a < 1.) {
    return uniforms.NAN;
  }
  return acosh(a);
`,TIe=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  return asin(a);
`,MIe="return asinh(a);",AIe=`
  if (isnan(a)) {
    return uniforms.NAN;
  }
  return atan(a);
`,NIe=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  if (a == 1.) {
    return uniforms.INFINITY;
  }
  if (a == -1.) {
    return -uniforms.INFINITY;
  }
  return atanh(a);
`,kIe="return ceil(a);",IIe="return cos(a);",RIe=`
  let e2x = exp(-a);
  return (e2x + 1.0 / e2x) / 2.0;
`,PIe="return exp(a) - 1.0;",DIe="if (a >= 0.0) { return a; }  return (exp(a) - 1.0);",LIe=`
  var resFloat = exp(a) - vec4<f32>(1.0);
  if (a.r >= 0.0) {
    resFloat.r = a.r;
  }
  if (a.g >= 0.0) {
    resFloat.g = a.g;
  }
  if (a.b >= 0.0) {
    resFloat.b = a.b;
  }
  if (a.a >= 0.0) {
    resFloat.a = a.a;
  }
  return resFloat;
`,OIe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  let p = ${MAe};
  let a1 = ${AAe};
  let a2 = ${NAe};
  let a3 = ${kAe};
  let a4 = ${IAe};
  let a5 = ${RAe};

  let sign = sign(a);
  let absA = abs(a);
  let t = 1.0 / (1.0 + p * absA);
  return sign * (1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * exp(-absA * absA));
`,FIe="return exp(a);",zIe="return floor(a);",UIe="return f32(!isnan(a) && !isinf(a));",BIe="return f32(isinf(a));",$Ie="return f32(isnan(a));",jIe="return a;",VIe=`if (a < 0.0) { return uniforms.NAN; }
  return log(a);`,WIe=`
  if (isnan(a)) { return a; }
  return log(1.0 + a);
`,HIe="return f32(!(a >= 1.0));",GIe="return -a;",qIe="if (a < 0.0) { return uniforms.alpha * a; } return a;",XIe=`
  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));
  return (aLessThanZero * (uniforms.alpha * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);
`,KIe="return 1.0 / a;",YIe="return select(a, 0.0, a < 0.0);",ZIe="return clamp(a, 0.0, 6.0);",QIe="return clamp(a, vec4<f32>(0.0, 0.0, 0.0, 0.0), vec4<f32>(6.0, 6.0, 6.0, 6.0));",JIe=`
  return select(a, vec4<f32>(0.0), a < vec4<f32>(0.0));
`,eRe="return round(a);",tRe="return inverseSqrt(a);",nRe=`
  if (a >= 0.0) {
    return ${TAe} * a;
  } else {
    return ${CAe} * (exp(a) - 1.0);
  }
`,rRe="return 1.0 / (1.0 + exp(-1.0 * a));",iRe="return sign(a);",sRe="return sin(a);",oRe=`
  let e2x = exp(a);
  return (e2x - 1.0 / e2x) / 2.0;
`,aRe=`
  let epsilon = 1.1920928955078125e-7;
  let threshold = log(epsilon) + 2.0;

  let too_large = a > -threshold;
  let too_small = a < threshold;
  let exp_a = exp(a);

  if (too_large) {
    return a;
  } else if (too_small) {
    return exp_a;
  } else {
    return log(exp_a + 1.0);
  }
`,lRe="return sqrt(a);",cRe="return a * a;",uRe=`
  if (isnan(a)) {
    return a;
  }

  return select(uniforms.stepAlpha, 1.0, a > 0.0);
`,dRe="return tan(a);",hRe=`
  let e2x = exp(-2.0 * abs(a));
  return sign(a) * (1.0 - e2x) / (1.0 + e2x);
`,fRe="return f32(i32((a)));";function mh(n,e){switch(n){case ft.ABS:return _Ie;case ft.ACOS:return EIe;case ft.ACOSH:return CIe;case ft.ASIN:return TIe;case ft.ASINH:return MIe;case ft.ATAN:return AIe;case ft.ATANH:return NIe;case ft.COS:return IIe;case ft.COSH:return RIe;case ft.CEIL:return kIe;case ft.ELU:return e?LIe:DIe;case ft.ERF:return OIe;case ft.EXP:return FIe;case ft.EXPM1:return PIe;case ft.FLOOR:return zIe;case ft.IS_FINITE:return UIe;case ft.IS_INF:return BIe;case ft.IS_NAN:return $Ie;case ft.LINEAR:return jIe;case ft.LOG:return VIe;case ft.LOG1P:return WIe;case ft.LOGICAL_NOT:return HIe;case ft.NEG:return GIe;case ft.LEAKYRELU:return e?XIe:qIe;case ft.RECIPROCAL:return KIe;case ft.RELU:return e?JIe:YIe;case ft.RELU6:return e?QIe:ZIe;case ft.ROUND:return eRe;case ft.RSQRT:return tRe;case ft.SELU:return nRe;case ft.SIGMOID:return rRe;case ft.SIGN:return iRe;case ft.SIN:return sRe;case ft.SINH:return oRe;case ft.SOFTPLUS:return aRe;case ft.SQRT:return lRe;case ft.SQUARE:return cRe;case ft.STEP:return uRe;case ft.TAN:return dRe;case ft.TANH:return hRe;case ft.TO_INT:return fRe;default:throw new Error(`BinaryType ${n} is not implemented!`)}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jc(n,e=!1,t=!1,r=3){if(n===null)return"";let i="";if(n==="linear")i=mh(ft.LINEAR);else if(n==="relu")i=mh(ft.RELU,t);else if(n==="elu")i=mh(ft.ELU,t);else if(n==="relu6")i=mh(ft.RELU6,t);else if(n==="prelu")i=M3(pn.PRELU,t);else if(n==="sigmoid")i=mh(ft.SIGMOID,t);else if(n==="leakyrelu")i=mh(ft.LEAKYRELU,t);else throw new Error(`Activation ${n} has not been implemented for the WebGPU backend.`);const o=Mn(t?4:1);let a="";return e?a=`
      fn activation(a : ${o}, coords : vec${r}<i32>) -> ${o} {
        let b = getPreluActivationWeightsByOutputCoords(coords);
        ${i}
      }`:a=`
      fn activation(a : ${o}, coords : vec${r}<i32>) -> ${o} {
        ${i}
      }`,a}function Of(n,e){return`
      ${n?"value = value + getBiasByOutputCoords(coords);":""}
      ${e?"value = activation(value, coords);":""}
      `}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $X(n,e,t=!1,r=!1,i=!1,s=1){te(n&&s===1||!n,()=>`transposeA ${n} is not compatible with component size ${s}`);const o=`
      ${n?"value = getA(batch, col, row);":"value = getA(batch, row, col);"}

    `,a=e?"value = getB(batch, col, row);":"value = getB(batch, row, col);";return`
  fn mm_readA(batch: i32, row: i32, col: i32) -> ${Mn(s)} {
    var value = ${Mn(s)}(0.0);
    ${t&&i?o:`
    ${n?"if(row < uniforms.dimAOuter && col < uniforms.dimInner)":"if(row < uniforms.aShape[1] && col < uniforms.aShape[2])"}
    {
      ${o}
    }
    `}
    return value;
  }

  fn mm_readB(batch: i32, row: i32, col: i32) -> ${Mn(s)} {
    var value = ${Mn(s)}(0.0);
    ${a}
    return value;
  }
  `}function A3(n,e,t,r,i=!1,s=!1,o=!1,a=1){return`
  ${$X(t,r,i,s,o,a)}
  fn mm_write(batch: i32, row: i32, col: i32, valueIn: ${Mn(a)}) {
    ${i&&s?"":"if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)"}
    {
      var value = valueIn;
      let coords = vec3<i32>(batch, row, col);
      ${Of(n,e)}
      setOutputAtCoords(coords[0], coords[1], coords[2], value);
    }
  }
  `}const pRe=(n,e)=>n?`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          kStart + inputRow,
          globalRowStart + inputCol * ${e});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          globalRow + innerRow,
          kStart + inputCol * ${e});
        `,mRe=(n,e,t,r)=>{if(n)return`
      for (var k = 0; k < ${r}; k++) {
        let BCached0 = mm_Bsub[k][tileCol];
        let ACached0 = mm_Asub[k][localRow];
        for (var i = 0; i < ${t}; i++) {
          acc[i] = fma(BCached0, vec4<f32>(ACached0[i]), acc[i]);
        }
      }`;{let i="",s="";for(let o=0;o<e;o++)i+=`let BCached${o} = mm_Bsub[k * ${e} + ${o}][tileCol];`,s+=`acc[i] = fma(BCached${o}, vec4<f32>(ACached[${o}]), acc[i]);`;return`
      for (var k = 0; k < ${r/e}; k++) {
        ${i}
        for (var i = 0; i < ${t}; i++) {
          let ACached = mm_Asub[tileRow + i][k];
          ${s}
        }
      }`}};function A2(n,e,t=!1,r=32,i=!1,s=32,o=!1){const a=e[1]*n[1],l=e[0]*n[0],c=t?a:r,u=t?r:a,d=c/e[0],h=r/e[1],f=n[1],p=n[0];return te((t&&d===4&&n[1]===4||!t&&(d===3||d===4))&&c%e[0]===0&&r%e[1]===0&&n[0]===4,()=>`If transposeA ${t} is true, innerElementSize ${d} and workPerThread[1] ${n[1]} must be 4.
          Otherwise, innerElementSize ${d} must be 3 or 4.
      tileAWidth ${c} must be divisible by workgroupSize[0]${e[0]}. tileInner ${r} must be divisible by workgroupSize[1] ${e[1]}. colPerThread ${n[0]} must be 4.`),`
  var<workgroup> mm_Asub : array<array<vec${d}<f32>, ${c/d}>, ${u}>;
  var<workgroup> mm_Bsub : array<array<vec4<f32>, ${l/n[0]}>, ${r}>;

  ${vt()} {
    let localRow = i32(localId.y);
    let tileRow = localRow * ${f};
    let tileCol = i32(localId.x);

    let globalRow = i32(globalId.y) * ${f};
    let globalCol = i32(globalId.x) * ${p};
    let batch = ${i?"0":"i32(globalId.z)"};
    let batchA = ${i||!o?"batch":"batch % uniforms.aShape[0]"};
    let batchB = ${i||!o?"batch":"batch % uniforms.bShape[0]"};
    let globalRowStart = i32(workgroupId.y) * ${a};

    let numTiles = ${i?`${Math.ceil(s/r)}`:`(uniforms.dimInner - 1) / ${r} + 1`};
    var kStart = ${i?`i32(globalId.z) * ${s}`:"0"};

    var acc: array<vec4<f32>, ${f}>;

    // Loop over shared dimension.
    let tileRowB = localRow * ${h};
    for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        for (var innerRow = 0; innerRow < ${f}; innerRow++) {
            let inputRow = tileRow + innerRow;
            let inputCol = tileCol;
            ${pRe(t,d)}
        }

        // Load one tile of B into local memory.
        for (var innerRow = 0; innerRow < ${h}; innerRow++) {
            let inputRow = tileRowB + innerRow;
            let inputCol = tileCol;
            mm_Bsub[inputRow][inputCol] = mm_readB(batchB, kStart + inputRow, globalCol);
        }
        kStart = kStart + ${r};
        workgroupBarrier();

        // Compute acc values for a single thread.
        ${mRe(t,d,f,r)}
        workgroupBarrier();
    }

    for (var innerRow = 0; innerRow < ${f}; innerRow++) {
        mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
    }
  }`}const d4=n=>n?`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          kStart + inputRow,
          globalRowStart + inputCol);
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          globalRowStart + inputRow,
          kStart + inputCol);
        `,gRe=n=>n?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];";function N2(n,e,t=!1,r=32,i=!1,s=32,o=!1,a=!1){const l=n[1]*e[1],c=n[0]*e[0],u=t?l:r,d=t?r:l;te(d%e[1]===0&&u%e[0]===0&&r%e[1]===0,()=>`tileAHight ${d} must be divisible by workgroupSize[1]${e[1]}, tileAWidth ${u} must be divisible by workgroupSize[0]${e[0]}, tileInner ${r} must be divisible by workgroupSize[1]${e[1]}`);const h=d/e[1],f=u/e[0],p=r/e[1],x=n[1],v=n[0],y=o?`
      let localRow = i32(localId.y);
      let localCol = i32(localId.x);
      let globalRowStart = i32(workgroupId.y) * ${l};
      let globalColStart = i32(workgroupId.x) * ${c};

      // Loop over shared dimension.
      for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        for (var inputRow = localRow; inputRow < ${d}; inputRow = inputRow + ${e[1]}) {
          for (var inputCol = localCol; inputCol < ${u}; inputCol = inputCol + ${e[0]}) {
            ${d4(t)}
          }
        }
        // Load one tile of B into local memory.
        for (var inputRow = localRow; inputRow < ${r}; inputRow = inputRow + ${e[1]}) {
              for (var inputCol = localCol; inputCol < ${c}; inputCol = inputCol + ${e[0]}) {
            mm_Bsub[inputRow][inputCol] = mm_readB(batchB,
              kStart + inputRow,
              globalColStart + inputCol);
          }
        }
        kStart = kStart + ${r};
        workgroupBarrier();

        // Compute acc values for a single thread.
        var BCached : array<f32, ${v}>;
        for (var k = 0; k < ${r}; k++) {
          for (var inner = 0; inner < ${v}; inner++) {
            BCached[inner] = mm_Bsub[k][localCol + inner * ${e[0]}];
          }
          for (var innerRow = 0; innerRow < ${x}; innerRow++) {
            let ACached = ${t?`mm_Asub[k][localRow + innerRow * ${e[1]}];`:`mm_Asub[localRow + innerRow * ${e[1]}][k];`}
            for (var innerCol = 0; innerCol < ${v}; innerCol++) {
              acc[innerRow][innerCol] =
                  fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);
            }
          }
        }
        workgroupBarrier();
      }
      for (var innerRow = 0; innerRow < ${x}; innerRow++) {
        let gRow = globalRowStart + localRow + innerRow * ${e[1]};
        for (var innerCol = 0; innerCol < ${v}; innerCol++) {
          let gCol = globalColStart + localCol + innerCol * ${e[0]};
          mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
        }
      }
      `:`
  let tileRow = i32(localId.y) * ${x};
  let tileCol = i32(localId.x) * ${v};

  let globalRow = i32(globalId.y) * ${x};
  let globalCol = i32(globalId.x) * ${v};
  let globalRowStart = i32(workgroupId.y) * ${l};

  let tileRowA = i32(localId.y) * ${h};
  let tileColA = i32(localId.x) * ${f};
  let tileRowB = i32(localId.y) * ${p};
  // Loop over shared dimension.
  for (var t = 0; t < numTiles; t++) {
    // Load one tile of A into local memory.
    for (var innerRow = 0; innerRow < ${h}; innerRow++) {
      for (var innerCol = 0; innerCol < ${f}; innerCol++) {
        let inputRow = tileRowA + innerRow;
        let inputCol = tileColA + innerCol;
        ${d4(t)}
      }
    }

    // Load one tile of B into local memory.
    for (var innerRow = 0; innerRow < ${p}; innerRow++) {
      for (var innerCol = 0; innerCol < ${v}; innerCol++) {
        let inputRow = tileRowB + innerRow;
        let inputCol = tileCol + innerCol;
        mm_Bsub[inputRow][inputCol] = mm_readB(batchB,
          kStart + inputRow,
          globalCol + innerCol);
      }
    }
    kStart = kStart + ${r};
    workgroupBarrier();

    // Compute acc values for a single thread.
    var BCached : array<f32, ${v}>;
    for (var k = 0; k < ${r}; k++) {
      for (var inner = 0; inner < ${v}; inner++) {
        BCached[inner] = mm_Bsub[k][tileCol + inner];
      }

      for (var innerRow = 0; innerRow < ${x}; innerRow++) {
        ${gRe(t)}
        for (var innerCol = 0; innerCol < ${v}; innerCol++) {
          acc[innerRow][innerCol] =
              fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);
        }
      }
    }

    workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < ${x}; innerRow++) {
    for (var innerCol = 0; innerCol < ${v}; innerCol++) {
      mm_write(batch, globalRow + innerRow, globalCol + innerCol,
          acc[innerRow][innerCol]);
    }
  }
  `;return`
    var<workgroup> mm_Asub : array<array<f32, ${u}>, ${d}>;
    var<workgroup> mm_Bsub : array<array<f32, ${c}>, ${r}>;

    ${vt()} {
      let batch = ${i?"0":"i32(globalId.z)"};
      let batchA = ${i||!a?"batch":"batch % uniforms.aShape[0]"};
      let batchB = ${i||!a?"batch":"batch % uniforms.bShape[0]"};
      let numTiles = ${i?`${Math.ceil(s/r)}`:`(uniforms.dimInner - 1) / ${r} + 1`};
      var kStart = ${i?`i32(globalId.z) * ${s}`:"0"};

      var acc : array<array<f32, ${v}>, ${x}>;

      // Without this initialization strange values show up in acc.
      for (var innerRow = 0; innerRow < ${x}; innerRow++) {
        for (var innerCol = 0; innerCol < ${v}; innerCol++) {
          acc[innerRow][innerCol] = 0.0;
        }
      }
      ${y}
    }
  `}const yRe=n=>n?`
      mm_readA(batchA, colA, globalRow),
      mm_readA(batchA, colA + 1, globalRow),
      mm_readA(batchA, colA + 2, globalRow),
      mm_readA(batchA, colA + 3, globalRow)
  `:`
      mm_readA(batchA, globalRow, colA),
      mm_readA(batchA, globalRow, colA + 1),
      mm_readA(batchA, globalRow, colA + 2),
      mm_readA(batchA, globalRow, colA + 3)
  `;function vRe(n,e=!1){te(n[1]===1&&n[2]===1,()=>`A linear work group size is required. But got ${n}.`);const t=n[0]*4;return`
    var<workgroup> mm_Asub : array<vec4<f32>, ${n[0]}>;

    ${vt()} {
      let tileCol = i32(localId.x);
      let globalCol = i32(globalId.x);
      let globalRow = i32(globalId.y);

      let numTiles = (uniforms.dimInner - 1) / ${t} + 1;
      let batch = i32(globalId.z);
      let batchA = batch % uniforms.aShape[0];
      let batchB = batch % uniforms.bShape[0];
      // Without this initialization strange values show up in acc.
      var acc = 0.0;

      // Loop over shared dimension.
      for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        let colA = t * ${t} + tileCol * 4;
        mm_Asub[tileCol] = vec4<f32>(${yRe(e)});
        workgroupBarrier();

        // Compute acc values for a single thread.
        for (var k = 0; k < ${t/4}; k++) {
          let rowB = t * ${t} + k * 4;
          let BCached = vec4<f32>(mm_readB(batchB, rowB, globalCol),
                              mm_readB(batchB, rowB + 1, globalCol),
                              mm_readB(batchB, rowB + 2, globalCol),
                              mm_readB(batchB, rowB + 3, globalCol));

          let ACached = mm_Asub[k];
          acc = acc + dot(ACached, BCached);
        }

        workgroupBarrier();
      }

      mm_write(batch, globalRow, globalCol, acc);
    }
  `}class xRe{constructor(e,t,r=!1,i=!1,s=null,o=null,a=null,l=!1){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=t,this.dispatchLayout={x:[2],y:[1],z:[0]};const c=r?e[1]:e[2];if(this.isVec4=(c%4===0&&!r||t[1]%4===0&&r)&&t[2]%4===0&&!i,this.outputComponent=this.isVec4?4:1,this.isVectorA=t[1]===1&&!r,!this.isVec4&&this.isVectorA)this.elementsPerThread=[1,1,1],this.workgroupSize=[32,1,1];else{const h=Hke(t[1],c,t[2],r);this.workgroupSize=h.workgroupSize,this.elementsPerThread=h.elementsPerThread}this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread);const u=s!=null,d=a!=null;u&&this.variableNames.push("bias"),d&&this.variableNames.push("preluActivationWeights"),this.sequentialAccessByThreads=l,this.transposeA=r,this.transposeB=i,this.addBias=u,this.activation=o,this.hasPreluActivationWeights=d,[this.fitAOuter,this.fitBOuter,this.fitInner]=this.getShapeFit(t[1],t[2],c),this.shaderKey=`matMulPacked_${this.elementsPerThread}_${r}_${i}_${this.activation}_${this.fitAOuter}_${this.fitBOuter}_${this.fitInner}_${this.isVec4}_${this.isVectorA}_${this.sequentialAccessByThreads}`}getShapeFit(e,t,r){const i=this.workgroupSize[1]*this.elementsPerThread[1],s=this.workgroupSize[0]*this.elementsPerThread[0];!this.isVec4&&this.isVectorA?this.tileInner=this.workgroupSize[0]*4:this.tileInner=s;const o=e%i===0,a=t%s===0,l=r%this.tileInner===0;return[o,a,l]}getUserCode(){return`
      ${Jc(this.activation,this.hasPreluActivationWeights,this.isVec4)}
      ${A3(this.addBias,this.activation,!1,this.transposeB,this.fitAOuter,this.fitBOuter,this.fitInner,this.isVec4?4:1)}
      ${this.isVec4?A2(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,!0):this.isVectorA?vRe(this.workgroupSize,this.transposeA):N2(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,this.sequentialAccessByThreads,!0)}
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wRe(n){return`
    var<workgroup> sumValues : array<f32, ${n}>;
    ${vt()} {
      let coords = getOutputCoords();
      let batch = coords[0];
      let batchA = batch % uniforms.aShape[0];
      let batchB = batch % uniforms.bShape[0];
      let row = coords[1];
      let col = coords[2];
      var sum = 0.0;
      let Length = uniforms.dimInner;
      for (var k = i32(localId.x); k < Length; k = k + ${n}) {
        let dataA = mm_readA(batchA, row, k);
        let dataB = mm_readB(batchB, k, col);
        sum = sum + dataA * dataB;
      }
      sumValues[localId.x] = sum;
      workgroupBarrier();

      for(var currentSize = ${n/2}u; currentSize > 1u;
          currentSize = currentSize / 2u) {
        if (localId.x < currentSize)
        {
          sumValues[localId.x] = sumValues[localId.x] + sumValues[localId.x + currentSize];
        }
        workgroupBarrier();
      }

      if (localId.x == 0u) {
        sum = sumValues[0] + sumValues[1];
        mm_write(batch, row, col, sum);
      }
    }
  `}class bRe{constructor(e,t=!1,r=!1,i=null,s=null,o=null){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[256,1,1],this.outputShape=e,this.dispatchLayout={x:[],y:[1,2],z:[0]},this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize);const a=i!=null,l=o!=null;a&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),this.transposeA=t,this.transposeB=r,this.addBias=a,this.activation=s,this.hasPreluActivationWeights=l,this.shaderKey=`matMulReduce_${this.activation}_${t}_${r}`}getUserCode(){return`
      ${Jc(this.activation,this.hasPreluActivationWeights)}
      ${A3(this.addBias,this.activation,this.transposeA,this.transposeB)}
      ${wRe(this.workgroupSize[0])}
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SRe(n){const e=n[1],t=n[0],r=e>t?e:t;return`
  var<workgroup> mm_Asub : array<array<f32, ${r}>, ${e}>;
  var<workgroup> mm_Bsub : array<array<f32, ${t}>, ${r}>;

  // If the output size is small for matrix multiplication, avoid to use vec4
  // and handle some elements per thread to optimally utilize the ALU.
  // Read data from global memory to registers firstly, then store them into
  // shared memory, so it is instruction-Level parallelism for arithmetic
  // operations and others handle IO operations between barrier api, makes ALU
  // and load/store units work simultaneously, could improves the performance.
  ${vt()} {
    let tileRow = i32(localId.y);
    let tileCol = i32(localId.x);
    let globalRow = i32(globalId.y);
    let globalCol = i32(globalId.x);
    let batch = i32(globalId.z);
    let batchA = batch % uniforms.aShape[0];
    let batchB = batch % uniforms.bShape[0];

    // uniforms.dimInner should be greater than 0.
    let numTiles = (uniforms.dimInner - 1) / ${r} + 1;
    var acc = 0.0;

    var globalColA = tileCol;
    var globalRowB = 0;
    var regA = mm_readA(batchA, globalRow, globalColA);
    var regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);
    var regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);
    globalColA = globalColA + ${r};
    globalRowB = globalRowB + ${r};

    for (var t = 0; t < numTiles; t = t + 1) {
      mm_Asub[tileRow][tileCol] = regA;
      mm_Bsub[2 * tileRow][tileCol] = regB0;
      mm_Bsub[2 * tileRow + 1][tileCol] = regB1;

      workgroupBarrier();

      regA = mm_readA(batchA, globalRow, globalColA);
      regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);
      regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);
      globalColA = globalColA + ${r};
      globalRowB = globalRowB + ${r};

      for (var k = 0; k < ${r}; k = k + 1) {
        acc = acc + mm_Asub[tileRow][k] * mm_Bsub[k][tileCol];
      }
      workgroupBarrier();
    }

    mm_write(batch, globalRow, globalCol, acc);
  }
  `}class _Re{constructor(e,t,r,i=!1,s=!1,o=null,a=null,l=null){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[16,8,1],this.outputShape=r,this.dispatchLayout={x:[2],y:[1],z:[0]},this.dispatch=[Math.ceil(r[2]/this.workgroupSize[0]),Math.ceil(r[1]/this.workgroupSize[1]),r[0]];const c=o!=null;c&&this.variableNames.push("bias");const u=l!=null;u&&this.variableNames.push("preluActivationWeights"),this.transposeA=i,this.transposeB=s,this.addBias=c,this.activation=a,this.hasPreluActivationWeights=u,this.shaderKey=`matMulSmallOutputSize_${this.activation}_${i}_${s}`}getUserCode(){return`
      ${Jc(this.activation,this.hasPreluActivationWeights)}
      ${A3(this.addBias,this.activation,this.transposeA,this.transposeB)}
      ${SRe(this.workgroupSize)}
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ERe{constructor(e,t,r=!1,i=!1){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[8,8,1],this.atomic=!0,this.splitedDimInner=128,te(e[0]===1,()=>"MatMulSplitKProgram only supports batch = 1."),this.outputShape=e,this.dispatchLayout={x:[2],y:[1],z:[0,3]};const s=(r&&this.outputShape[1]%4===0||!r&&t%4===0)&&this.outputShape[2]%4===0;this.elementsPerThread=[4,4,this.splitedDimInner],this.outputComponent=s?4:1,s||(this.outputShape[1]<16&&(this.elementsPerThread[1]=1),this.outputShape[2]<16&&(this.elementsPerThread[0]=1)),this.dispatch=xt(this.dispatchLayout,[this.outputShape[0],this.outputShape[1],this.outputShape[2],t],this.workgroupSize,this.elementsPerThread),this.transposeA=r,this.transposeB=i,this.shaderKey=`matMulSplitK_${r}_${i}_${this.elementsPerThread}_${this.outputComponent}`}getUserCode(){const e=this.outputComponent;return`
      ${$X(!1,this.transposeB,!1,!1,!1,e)}
      fn mm_write(batch: i32, row : i32, col : i32, value : ${Mn(e)}) {
        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {
          let coords = vec3<i32>(batch, row, col);
          let flatIndex = getOutputIndexFromCoords(coords);
          // The problem is that we should initialize output to zero before using.
          // Otherwise, the original value will be added to the result.
          for (var i = 0; i < ${e}; i = i + 1) {
            ${Ld("&result[flatIndex + i]",`${e>1?"value[i]":"value"}`,"float32")}
          }
        }
      }
      ${e===4?A2(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner):N2(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner)}
    `}}class CRe{constructor(e,t=null,r=null,i=null){this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=t!=null,this.hasPreluActivationWeights=i!=null,this.activation=r,this.addBias&&this.variableNames.push("bias"),this.hasPreluActivationWeights&&this.variableNames.push("preluActivationWeights"),this.shaderKey=`biasActivation_${r}`}getUserCode(){return`
    ${Jc(this.activation,this.hasPreluActivationWeights)}
    ${vt("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        var value = getXByOutputIndex(index);
        ${Of(this.addBias,this.activation)}
        setOutputAtIndex(index, value);
      }
    }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TRe{constructor(e){this.variableNames=[],this.outputShape=[],this.uniforms="value : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="fill"}getUserCode(){return`
    ${vt("index")} {
      if (index < uniforms.size) {
        setOutputAtIndex(index, uniforms.value);
      }
    }
  `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xs(n){const{backend:e,attrs:t}=n,{shape:r,value:i}=t;let{dtype:s}=t;if(s=s||vx(i),s==="string"){const o=zi(s,gt(r));return o.fill(i),e.makeTensorInfo(r,s,o)}else{const o=new TRe(r),a=[{type:"float32",data:[i]}];return e.runWebGPUProgram(o,[],s,a)}}const MRe={kernelName:v9,backendName:"webgpu",kernelFunc:Xs};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ht(n){const{inputs:e,attrs:t}=n,{x:r}=e,{shape:i}=t,s=gt(r.shape),o=Oxe(i,s),a=gt(o);return te(s===a,()=>`The new shape (${o}) has ${a} elements and the old shape (${r.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`),n.backend.incRef(r.dataId),{dataId:r.dataId,shape:o,dtype:r.dtype}}const ARe={kernelName:m7,backendName:"webgpu",kernelFunc:Ht};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k2({a:n,b:e,transposeA:t,transposeB:r,backend:i,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const c=n.shape.length,u=e.shape.length,d=t?n.shape[c-2]:n.shape[c-1],h=r?e.shape[u-1]:e.shape[u-2],f=t?n.shape[c-1]:n.shape[c-2],p=r?e.shape[u-2]:e.shape[u-1],x=n.shape.slice(0,-2),v=e.shape.slice(0,-2),y=gt(x),b=gt(v),_=_r(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);te(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${r} must match.`);const T=t?[y,d,f]:[y,f,d],M=r?[b,p,h]:[b,h,p],k=Ht({inputs:{x:n},backend:i,attrs:{shape:T}}),P=Ht({inputs:{x:e},backend:i,attrs:{shape:M}}),z=[k,P],I=Math.max(y,b),L=[k,P],W=[{type:"int32",data:[f]},{type:"int32",data:[p]},{type:"int32",data:[d]}];let q,$;const ne=[I,f,p];let Y=rn().get("WEBGPU_MATMUL_PROGRAM_TYPE");if(Y<0){const H=rn().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),X=H>0?H:i.thresholdToIncreaseWorkgroups,oe=I*Math.ceil(f/32)*Math.ceil(p/32);oe<=X||f<=8&&oe<=X*2?I*f*p<=128?Y=_l.MatMulReduceProgram:I===1&&h>=2e3?Y=_l.MatMulSplitKProgram:Y=_l.MatMulSmallOutputSizeProgram:Y=_l.MatMulPackedProgram}switch(Y){case _l.MatMulReduceProgram:q=new bRe(ne,t,r,s,l,o);break;case _l.MatMulSplitKProgram:{if($=Xs({backend:i,attrs:{shape:ne,value:0,dtype:n.dtype}}),q=new ERe(ne,h,t,r),s||l){$=i.runWebGPUProgram(q,L,n.dtype,W,$);const X=new CRe($.shape,s,l,o);let oe=null;const ve=[$];s&&ve.push(s),o&&ve.push(o),l==="leakyrelu"&&(oe=[{type:"float32",data:[a]}],X.uniforms+=" alpha : f32,");const Te=i.runWebGPUProgram(X,ve,$.dtype,oe);z.push($);const Xe=Ht({inputs:{x:Te},backend:i,attrs:{shape:_}});z.push(Te);for(const _e of z)i.disposeData(_e.dataId);return Xe}break}case _l.MatMulSmallOutputSizeProgram:q=new _Re(T,M,ne,t,r,s,l,o);break;case _l.MatMulPackedProgram:const H=i.adapterInfo.isIntel();q=new xRe(T,ne,t,r,s,l,o,H);break;default:throw new Error(`Unsupported MatMulProgramType ${Y}.`)}s&&L.push(s),o&&L.push(o),l==="leakyrelu"&&(W.push({type:"float32",data:[a]}),q.uniforms+=" alpha : f32,"),$=i.runWebGPUProgram(q,L,n.dtype,W,$);const we=Ht({inputs:{x:$},backend:i,attrs:{shape:_}});z.push($);for(const H of z)i.disposeData(H.dataId);return we}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NRe(n){const{inputs:e,backend:t,attrs:r}=n,{a:i,b:s,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r;return k2({a:i,b:s,transposeA:l,transposeB:c,backend:t,bias:o,preluActivationWeights:a,leakyreluAlpha:d,activation:u})}const kRe={kernelName:hN,backendName:"webgpu",kernelFunc:NRe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h4{constructor(e,t,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.workgroupSize=[128,1,1],this.size=!0,this.outputShape=_r(t,r),this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`binaryOpComplex_${e}`,this.op=e}getUserCode(){return`
      fn binaryOpComplex(
          areal : f32, aimag : f32, breal : f32, bimag : f32) -> f32 {
        ${M3(this.op,!1)}
      }

      ${vt("index")} {
        if(index < uniforms.size) {
          let areal = getARealByOutputIndex(index);
          let aimag = getAImagByOutputIndex(index);
          let breal = getBRealByOutputIndex(index);
          let bimag = getBImagByOutputIndex(index);
          setOutputAtIndex(index, binaryOpComplex(areal, aimag, breal, bimag));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HS{constructor(e,t,r){if(this.size=!0,this.variableNames=["A","B"],this.outputShape=_r(t,r),this.dispatchLayout=Nt(this.outputShape),this.op=e,this.useSharedMemoryWithA=t.length<=1&&r.length>1&&t[0]<128,this.useSharedMemoryWithB=r.length<=1&&t.length>1&&r[0]<128,this.useSharedMemoryWithA||this.useSharedMemoryWithB)this.outputComponent=1,this.variableComponents=[1,1],this.lastDimensionSize=this.useSharedMemoryWithB?r[0]:t[0],this.shaderKey=`binary_${e}_${this.lastDimensionSize}`,this.type="shared",this.workgroupSize=[256,1,1];else{const i=t.length>0&&t[t.length-1]%4===0,s=r.length>0&&r[r.length-1]%4===0;i&&s?(this.outputComponent=4,this.variableComponents=[4,4]):i&&(_z(r)||r[r.length-1]===1)||s&&(_z(t)||t[t.length-1]===1)?(this.outputComponent=4,this.variableComponents=i?[4,1]:[1,4]):(this.outputComponent=1,this.variableComponents=[1,1]),this.type="nonshared",this.shaderKey=`binary_${e}_${this.variableComponents}`,this.workgroupSize=[128,1,1]}this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.outputComponent,1,1])}getUserCode(){let e;const t=this.outputComponent===4?"vec4<f32>":"f32",r=`
    fn binaryOperation(a : ${t}, b : ${t}) -> ${t} {
      ${M3(this.op,this.outputComponent===4)}
    };
    `;if(this.type==="shared"){const i=this.lastDimensionSize>1?`coords[${this.outputShape.length-1}]`:"0",s=this.useSharedMemoryWithB?`let a = getAByOutputIndex(index);
          let b = sharedBuf[${i}];`:`let a = sharedBuf[${i}];
          let b = getBByOutputIndex(index);`;e=`
        ${r}
        var<workgroup> sharedBuf : array<f32, ${this.lastDimensionSize}>;
        ${vt("index")} {
          // Fill in the shared memory buffer.
          let localIndex = i32(localId.x);
          if(localIndex < ${this.lastDimensionSize}) {
            sharedBuf[localIndex] = f32(${this.useSharedMemoryWithB?"B":"A"}[localIndex]);
          }
          workgroupBarrier();

          if(index < uniforms.size) {
            let coords = getCoordsFromIndex(index);
            ${s}
            setOutputAtIndex(index, binaryOperation(a, b));
          }
        }
        `}else e=`
       ${r}
       ${vt("index")} {
         if (index < uniforms.size) {
           let coords = getCoordsFromIndex(index * ${this.outputComponent});
           let a = ${t}(getAByOutputCoords(coords));
           let b = ${t}(getBByOutputCoords(coords));
           setOutputAtIndex(index, binaryOperation(a, b));
         }
       }
       `;return e}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Co(n){const{inputs:e}=n,{x:t}=e;return n.backend.incRef(t.dataId),{dataId:t.dataId,shape:t.shape,dtype:t.dtype}}const IRe={kernelName:KR,backendName:"webgpu",kernelFunc:Co};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ff(n){const{inputs:e,backend:t}=n,{real:r,imag:i}=e,s=t.makeTensorInfo(r.shape,"complex64"),o=t.tensorMap.get(s.dataId),a=Co({inputs:{x:r},backend:t}),l=Co({inputs:{x:i},backend:t});return o.complexTensorInfos={real:a,imag:l},s}const RRe={kernelName:j8,backendName:"webgpu",kernelFunc:Ff};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lg{constructor(e,t,r=""){this.variableNames=["A"],this.size=!0;const i=128;this.workgroupSize=[i,1,1],this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.op=t,r!==""&&(this.uniforms=r),this.shaderKey=`unary_${t}`}getUserCode(){return`
      fn unaryOperation(a : f32) -> f32 {
        ${mh(this.op,!1)}
      }
      ${vt("index")} {
        if (index < uniforms.size) {
          let a = getAByOutputIndex(index);
          setOutputAtIndex(index, unaryOperation(a));
        }
      }
      `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function er({opType:n,cpuKernelImpl:e,dtype:t}){return({inputs:r,backend:i})=>{const{x:s}=r,o=i,a=t||s.dtype;if(o.shouldExecuteOnCPU([s])&&e!=null){const c=o.tensorMap.get(s.dataId),u=e(c.values,a);return o.makeTensorInfo(s.shape,a,u)}const l=new Lg(s.shape,n);return o.runWebGPUProgram(l,[s],a)}}function ji({opType:n,cpuKernelImpl:e,supportsComplex:t=!1,dtype:r}){return({inputs:i,backend:s})=>{const{a:o,b:a}=i,l=s;if(t&&o.dtype==="complex64"){const d=l.tensorMap.get(o.dataId),h=l.tensorMap.get(a.dataId);let f,p;if(n!==pn.MUL)[f,p]=[[d.complexTensorInfos.real,h.complexTensorInfos.real],[d.complexTensorInfos.imag,h.complexTensorInfos.imag]].map(v=>{const[y,b]=v,S={dataId:y.dataId,dtype:y.dtype,shape:o.shape},_={dataId:b.dataId,dtype:b.dtype,shape:a.shape},T=new HS(n,o.shape,a.shape);return l.runWebGPUProgram(T,[S,_],vd(y.dtype,b.dtype))});else{const v=new h4(pn.COMPLEX_MULTIPLY_REAL,o.shape,a.shape),y=new h4(pn.COMPLEX_MULTIPLY_IMAG,o.shape,a.shape),b=[{dataId:d.complexTensorInfos.real.dataId,dtype:d.complexTensorInfos.real.dtype,shape:o.shape},{dataId:d.complexTensorInfos.imag.dataId,dtype:d.complexTensorInfos.imag.dtype,shape:o.shape},{dataId:h.complexTensorInfos.real.dataId,dtype:h.complexTensorInfos.real.dtype,shape:a.shape},{dataId:h.complexTensorInfos.imag.dataId,dtype:h.complexTensorInfos.imag.dtype,shape:a.shape}];f=l.runWebGPUProgram(v,b,"float32"),p=l.runWebGPUProgram(y,b,"float32")}const x=Ff({inputs:{real:f,imag:p},backend:l});return l.disposeData(f.dataId),l.disposeData(p.dataId),x}const c=r||vd(o.dtype,a.dtype);if((o.dtype==="string"||a.dtype==="string"||l.shouldExecuteOnCPU([o,a]))&&e!=null){const d=l.tensorMap.get(o.dataId).values,h=l.tensorMap.get(a.dataId).values,f=o.dtype==="string"?jS(d):d,p=o.dtype==="string"?jS(h):h,[x,v]=e(o.shape,a.shape,f,p,c);return l.makeTensorInfo(v,c,x)}const u=new HS(n,o.shape,a.shape);return l.runWebGPUProgram(u,[o,a],c)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PRe(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function io(n){return(e,t,r,i,s)=>{const o=_r(e,t),a=o.length,l=os(o),c=gt(o),u=yd(s,c),d=e.length,h=t.length,f=os(e),p=os(t),x=zS(e,o),v=zS(t,o);if(x.length+v.length===0)for(let y=0;y<u.length;++y)u[y]=n(r[y%r.length],i[y%i.length]);else for(let y=0;y<u.length;++y){const b=HR(y,a,l),S=b.slice(-d);x.forEach(k=>S[k]=0);const _=uN(S,d,f),T=b.slice(-h);v.forEach(k=>T[k]=0);const M=uN(T,h,p);u[y]=n(r[_],i[M])}return[u,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DRe(n,e,t,r){if(r==="int32"){const i=Int32Array.from(n);return[e,"int32",i]}if(r==="bool"){const i=v2([0],t),[s,o]=io((a,l)=>a!==l?1:0)(e,[],n,i,"bool");return[o,"bool",s]}throw new Error(`Error in Cast: failed to cast ${t} to ${r}`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LRe=io((n,e)=>n+e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ORe(n,e,t,r,i){const s=gt(r),o=Hc(i,t);for(let a=0;a<n.length;a++){const l=n[a];if(l<0)throw new Error("Input x must be non-negative!");l>=i||(s>0?o[l]+=e[a]:o[l]+=1)}return o}function FRe(n,e,t,r=!1){const i=n.shape[0],s=n.shape[1],o=Fr([i,t],e.dtype);for(let a=0;a<i;a++)for(let l=0;l<s;l++){const c=n.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=t||(r?o.set(1,a,c):e.size>0?o.set(o.get(a,c)+e.get(a,l),a,c):o.set(o.get(a,c)+1,a,c))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zRe=io((n,e)=>n&e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eu(n){return(e,t,r)=>{const i=zi(t,e.length);for(let s=0;s<e.length;++s)i[s]=n(e[s],r);return i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const URe=eu(n=>Math.ceil(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BRe(n,e,t,r){const i=zi(t,gt(e));if(r&&t!=="string"){let s=0;n.forEach(o=>{const a=gt(o.shape);i.set(o.vals,s),s+=a})}else{let s=0;n.forEach(o=>{const a=t==="string"?jS(o.vals):o.vals;let l=0;for(let c=0;c<o.shape[0];++c){const u=c*e[1]+s;for(let d=0;d<o.shape[1];++d)i[u+d]=a[l++]}s+=o.shape[1]})}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Re=io((n,e)=>n===e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jRe=eu(n=>Math.exp(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VRe=eu(n=>Math.expm1(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WRe=eu(n=>Math.floor(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HRe=io((n,e)=>Math.floor(n/e));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GRe(n,e,t,r,i,s,o,a,l){const c=Fr([r,s],t);for(let u=0;u<r;u++){const d=[];let h=0;for(let f=0;f<i;f++){const p=n[u*i+f];h+=p*o[f],d.push(p)}if(h<0||h>=l/s)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let f=0;f<s;f++)c.values[u*s+f]=e.get(...e.indexToLoc(h*s+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qRe(n,e,t){const r=Fr(t,n.dtype);for(let i=0;i<r.size;++i){const o=r.indexToLoc(i).slice(),a=o[0],l=o[2],c=e.locToIndex([a,l]);o[2]=e.values[c];const u=n.locToIndex(o);0<=u&&u<n.values.length&&(r.values[i]=n.values[u])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XRe=io((n,e)=>n>e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KRe=io((n,e)=>n>=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YRe=io((n,e)=>n<e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZRe=io((n,e)=>n<=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QRe(n,e,t){const r=(e-n)/(t-1),i=Hc(t,"float32");i[0]=n;for(let s=1;s<i.length;s++)i[s]=i[s-1]+r;return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JRe=eu(n=>Math.log(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e3e(n,e,t,r){const i=yd(r,gt(t));for(let s=0;s<i.length;++s){const o=s*e;let a=n[o];for(let l=0;l<e;++l){const c=n[o+l];(Number.isNaN(c)||c>a)&&(a=c)}i[s]=a}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t3e=io((n,e)=>Math.max(n,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n3e=io((n,e)=>Math.min(n,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jX=io((n,e)=>n*e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r3e(n,e,t){const r=Nwe(-1,t);return jX([],e,r,n,t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i3e=io((n,e)=>n!==e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s3e(n,e,t,r,i){const s=e.length,o=gt(e),a=os(e),l=os(i),c=yd(t,gt(i));for(let u=0;u<o;++u){const d=HR(u,s,a),h=new Array(d.length);for(let p=0;p<h.length;p++)h[p]=d[r[p]];const f=uN(h,s,l);c[f]=n[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o3e(n,e,t,r){const[i,s]=_2(n,r),o=vd(e,"int32"),a=Hc(gt(i),o),l=gt(s);for(let c=0;c<a.length;++c){const u=c*l;let d=1;for(let h=0;h<l;++h)d*=t[u+h];a[c]=d}return{outVals:a,outShape:i,outDtype:o}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a3e(n,e,t){n.forEach((r,i)=>{if(r<0||r>=t){const s=HR(i,e.length,os(e)).join(",");throw new Error(`indices[${s}] = ${r} is not in [0, ${t})`)}})}function l3e(n,e){for(let t=0;t<n.length;++t){const r=n[t],i=t===n.length-1?e:n[t+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let s=1;s<r.length;++s)if(r[s-1]>r[s])throw new Error("Ragged splits must be sorted in ascending order")}}function c3e(n,e,t,r){const i=[];let s=0;const o=e.length-1+t.length,a=new Array(o).fill(null).map(()=>[0]);l3e(t,r);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let d=1;d<l+1;++d)a[c].push(d*u)}for(let c=0;c<n.length;++c){let u=n[c],d=n[c]+1;for(let h=0;h<t.length;++h){const f=t[h],p=h+e.length-1;if(p>=0){const x=a[p],v=x[x.length-1]-f[u];for(let y=u;y<d;++y)a[p].push(f[y+1]+v)}u=f[u],d=f[d]}d!==u&&(i.push([u,d]),s+=d-u)}return{outSplits:a,valueSlices:i,numValues:s}}function u3e(n){const e=[];for(let t=0;t<n.length;++t){const r=n[t].length,i=zi("int32",r);e.push(i),n[t].forEach((s,o)=>i[o]=s)}return e}function f4(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let r=e;r<n.length;r++)t[e-1]*=n[r];return t}function d3e(n,e,t,r,i,s){const o=f4(e,2)[1],a=f4(s,2)[1];let l=0;for(const c of t)for(let u=c[0];u<c[1];++u){for(let d=0;d<r;++d)i[l*a+d]=n[u*o+d];++l}}function h3e(n,e,t,r,i){const s=e.slice();s[0]=i;const o=zi(t,gt(s)),a=n.length,l=a===0?0:a/e[0];return d3e(n,e,r,l,o,s),[o,s]}function f3e(n,e,t,r,i,s,o,a){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(a3e(s,o,l),r.length===0)throw new Error("params.rank must be nonzero");const c=r[0],{outSplits:u,valueSlices:d,numValues:h}=c3e(s,o,n,c),f=u3e(u),p=h3e(t,r,i,d,h);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p4=2147483647;function p3e(n,e,t,r,i,s,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=i.length===0,c=o.length===0,u=[];a||u.push(e[0]),l||u.push(i[0]),c||u.push(o[0]);for(let v=1;v<u.length;++v)if(u[v]!==u[v-1])throw new Error("starts, limits, and deltas must have the same shape");const d=u.length===0?1:u[0],h=zi("int32",d+1);h[0]=0;for(let v=0;v<d;++v){const y=a?n[0]:n[v],b=l?r[0]:r[v],S=c?s[0]:s[v];if(S===0)throw new Error("Requires delta != 0");let _;if(S>0&&b<y||S<0&&b>y)_=0;else if(_=Math.ceil(Math.abs((b-y)/S)),_>p4)throw new Error(`Requires ((limit - start) / delta) <= ${p4}`);h[v+1]=h[v]+_}const f=h[d],p=zi(t,f);let x=0;for(let v=0;v<d;++v){const y=h[v+1]-h[v];let b=a?n[0]:n[v];const S=c?s[0]:s[v];for(let _=0;_<y;++_)p[x++]=b,b+=S}return[h,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var fa=Cl;class GS{constructor(e,t,r,i,s,o,a,l,c,u){this.shape=e,this.shapeShape=t,this.values=r,this.valuesShape=i,this.valuesDType=s,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=xAe(u),this.raggedRank=wAe(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===fa.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===fa.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case fa.VALUE_ROWIDS:return GS.getMaxWidthValueRowID(t);case fa.ROW_SPLITS:return GS.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${fa[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let r=0;for(let i=0;i<t-1;++i){const s=e[i+1]-e[i];s>r&&(r=s)}return r}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let r=0,i=e[0],s=0;for(let o=1;o<t;++o){const a=e[o];a!==i&&(i=a,s=Math.max(o-r,s),r=o)}return Math.max(t-r,s)}tensorShapeFromTensor(e,t,r=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return g4(e,r)}calculateOutputSize(e){const t=this.valuesShape,r=this.defaultValueShape;bAe(r,t);const i=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=vAe(this.raggedRank,i,t);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,t,r){const i=Math.min(e,r),s=[];let o=0;for(let a=0;a<i;++a,o+=t)s.push(o);for(let a=i;a<e;++a)s.push(-1);return te(s.length===e,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(e,t,r,i){const s=e.length,o=[];for(let a=0;a<s-1;++a){const l=e[a+1]-e[a];let c=Math.min(i,l),u=t[a];u===-1&&(c=0);for(let d=0;d<c;++d)o.push(u),u+=r;for(let d=0;d<l-c;++d)o.push(-1)}if(s>0&&o.length!==e[s-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,t,r,i){const s=e.length,o=[];if(s===0)return[];let a=0,l=e[0];if(l>=t.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${t.length}`);let c=t[l];o.push(c);for(let u=1;u<s;++u){const d=e[u];if(d===l)c>=0&&(++a,a<i?c+=r:c=-1);else{if(a=0,l=d,d>=t.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${t.length}`);c=t[d]}o.push(c)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,t,r,i){const s=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case fa.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,t,r,i);case fa.ROW_SPLITS:if(s.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(s,t,r,i);default:throw new Error(`Unsupported partition type: ${fa[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case fa.FIRST_DIM_SIZE:return e[0];case fa.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case fa.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${fa[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),r=this.calculateOutputSize(t),i=new Array(this.raggedRank+1);i[i.length-1]=1;for(let l=i.length-2;l>=0;--l)i[l]=i[l+1]*r[l+1];const s=g4(r,!1),o=zi(this.valuesDType,gt(s));if(i[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(t,i[0],r[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,i[c],r[c]);this.setOutput(this.raggedRank,l,o,s)}return[s,o]}setOutput(e,t,r,i){if(r.length===0)return;const s=this.values,o=r;let a=i.slice();a=a.slice(e+1);const l=gt(a),c=t.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;yn(()=>{const x=Ke(u,p);u=gv(x,a).dataSync()})}let d=0,h=0,f=0;for(let p=0;p<=c;++p){let x=p<c?t[p]:-1;if(x===f){++f;continue}if(h<f){const v=s.subarray(d*l),y=o.subarray(h*l),b=(f-h)*l;m4(y,v,b)}if(p>=c){const v=r.length;x=Math.floor(v/l)}if(x>f)if(this.defaultValue.length===1)o.subarray(f*l,x*l).fill(this.defaultValue[0]),f=x;else for(;x>f;){const v=o.slice(f*l);m4(v,u,l),++f}x<0?(d=p+1,h=f):(d=p,h=f,f=h+1)}}}function m4(n,e,t){for(let r=0;r<t;r++)n[r]=e[r]}function g4(n,e){const t=[];for(let r of n){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}t.push(r)}return t}function m3e(n,e,t,r,i,s,o,a,l,c){return new GS(n,e,t,r,i,s,o,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g3e(n,e,t,r){const i=n===e,s=n<e&&t<0,o=e<n&&t>1;if(i||s||o)return Hc(0,r);const a=Math.abs(Math.ceil((e-n)/t)),l=Hc(a,r);e<n&&t===1&&(t=-1),l[0]=n;for(let c=1;c<l.length;c++)l[c]=l[c-1]+t;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y3e=eu(n=>1/Math.sqrt(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v3e(n,e,t,r,i,s,o,a,l,c){const u=[r/i,i],d=n.values,h=e.values;if(r===0)return Fr(t,e.dtype);const f=l instanceof Jm?l:Fr(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<s;p++){const x=[];let v=0;for(let y=0;y<o;y++){const b=d[p*o+y];x.push(b),v+=b*a[y]}if(v<0||v>=r/i)throw new Error(`Invalid indices: ${x} does not index into ${t}`);for(let y=0;y<i;y++)c?f.values[v*i+y]+=h[p*i+y]:f.values[v*i+y]=e.rank===0?h[0]:h[p*i+y]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x3e=eu(n=>1/(1+Math.exp(-n)));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w3e(n,e,t,r,i){const s=hAe(r,e,t),o=gt(t),a=os(r);if(s){const d=fAe(e,a);return i==="string"?n.slice(d,d+o):n.subarray(d,d+o)}const l=i==="string"?jS(n):n,c=Fr(r,i,l),u=Fr(t,i);for(let d=0;d<u.size;++d){const h=u.indexToLoc(d),f=h.map((p,x)=>p+e[x]);u.set(c.get(...f),...h)}return i==="string"?eNe(u.values):u.values}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b3e(n,e,t,r,i,s,o){const a=e[0],l=s[0],c=new Array(l),u=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error($Ae(a));const v=zi(t,0),y=zi(i,0);return[v,[0,d],y,c,u]}let h=!0,f=0;const p=new Array(l).fill(0);for(let v=0;v<a;++v){const y=n[v*d];if(y<0)throw new Error(jAe(v,y));if(y>=l)throw new Error(VAe(v,y,l));++p[y],h=h&&y>=f,f=y}let x=!0;for(let v=0;v<l;++v){const y=p[v]===0;c[v]=y,x=x&&!y,p[v]=Math.max(p[v],1),v>0&&(p[v]+=p[v-1])}if(x&&h){const v=n,y=r;for(let b=0;b<a;++b)u[b]=b;return[v,[a,d],y,c,u]}else{const v=p[l-1],y=zi(t,v*d),b=zi(i,v),S=new Array(l).fill(0);for(let _=0;_<a;++_){const T=n[_*d],M=S[T],k=(T===0?0:p[T-1])+M;S[T]++;for(let P=0;P<d;++P)y[k*d+P]=n[_*d+P];b[k]=r[_],u[_]=k}for(let _=0;_<l;++_)if(S[_]===0){const M=_===0?0:p[_-1];y[M*d+0]=_;for(let k=1;k<d;++k)y[M*d+k]=0;b[M]=o}return[y,[v,d],b,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S3e(n,e,t,r,i){const s=gt(r),o=e[0],a=i.length,l=[];let c=1,u=-1;for(let v=0;v<a;++v){const y=i[v];if(y===-1){if(u!==-1)throw new Error(WAe(u,v));u=v,l.push(1)}else{if(y<0)throw new Error(HAe(v,y));c*=y,l.push(y)}}if(u!==-1){if(c<=0)throw new Error(GAe());const v=Math.trunc(s/c);if(c*v!==s)throw new Error(qAe(r,l));l[u]=v}if(gt(l)!==s)throw new Error(XAe(r,l));const h=r.length,f=[];if(h>0){f[h-1]=1;for(let v=h-2;v>=0;--v)f[v]=f[v+1]*r[v+1]}const p=[];if(a>0){p[a-1]=1;for(let v=a-2;v>=0;--v)p[v]=p[v+1]*l[v+1]}const x=zi(t,o*a);for(let v=0;v<o;++v){let y=0;for(let b=0;b<h;++b)y+=n[v*h+b]*f[b];for(let b=0;b<a;++b)x[v*a+b]=Math.trunc(y/p[b]),y%=p[b]}return[x,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _3e(n,e,t,r,i,s=!1,o=0){const a=r.length,l=[e[0],n.length/e[0]],c=l[1],d=a>0?i[a-1]+1:0;if(d<0)throw new Error(Xz());const h=e.slice();h[0]=d;const f=h.reduce((S,_)=>S*_,1),p=zi(t,f);if(a===0)return d>0&&p.fill(o),[p,h];if(d<=0)throw new Error(Xz());let x=0,v=1,y=0,b=i[x];for(;;){let S=0;if(v<a){if(S=i[v],b===S){++v;continue}if(b>=S)throw new Error(KAe())}if(b<0||b>=d)throw new Error(YAe(b,d));b>y&&p.fill(o,y*c,b*c);for(let _=x;_<v;++_){const T=r[_];if(T<0||T>=l[0])throw new Error(ZAe(_,r[_],l[0]));for(let M=0;M<c;M++)p[b*c+M]+=n[T*c+M]}if(s)for(let _=0;_<c;_++)p[b*c+_]/=v-x;if(x=v,++v,y=b+1,b=S,v>a)break}return y<d&&p.fill(o,y*c,d*c),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E3e=eu(n=>Math.sqrt(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C3e=io((n,e)=>{const t=n-e;return t*t});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T3e=eu((n,e)=>{const{pattern:t,replaceGlobal:r,rewrite:i}=e;return n.replace(new RegExp(t,r?"g":""),i)});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M3e(n,e,t,r){const i=Fr(n,e.dtype);for(let s=0;s<i.size;s++){const o=i.indexToLoc(s),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*t[l]+r[l];i.set(e.get(...a),...o)}return i}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A3e{constructor(e,t,r,i,s,o){this.separator=qh(e),this.nGramWidths=t,this.leftPad=qh(r),this.rightPad=qh(i),this.padWidth=s,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const r=this.getPadWidth(t);return Math.max(0,e+2*r-t+1)}createNGrams(e,t,r,i,s,o){for(let a=0;a<s;++a){const l=this.getPadWidth(o),c=Math.max(0,l-a),u=Math.max(0,l-(s-(a+1))),d=o-(c+u),h=t+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let b=0;b<d;++b)f+=e[h+b].length;f+=u*this.rightPad.length;const p=c+u+d-1;f+=p*this.separator.length,r[i+a]=new Uint8Array(f);const x=r[i+a];let v=0;const y=b=>b.forEach(S=>x[v++]=S);for(let b=0;b<c;++b)y(this.leftPad),y(this.separator);for(let b=0;b<d-1;++b)y(e[h+b]),y(this.separator);if(d>0){y(e[h+d-1]);for(let b=0;b<u;++b)y(this.separator),y(this.rightPad)}else{for(let b=0;b<u-1;++b)y(this.rightPad),y(this.separator);y(this.rightPad)}}}compute(e,t){const r=e.length,i=t.length;if(i>0){let l=t[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<i;++c){let u=t[c]>=l;if(u=u&&t[c]<=r,!u)throw new Error(`Invalid split value ${t[c]}, must be in [${l}, ${r}]`);l=t[c]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const s=i-1,o=zi("int32",i);if(r===0||i===0){const l=new Array(r);for(let c=0;c<=s;++c)o[c]=0;return[l,o]}o[0]=0;for(let l=1;l<=s;++l){const c=t[l]-t[l-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&u===0&&(u=1),o[l]=o[l-1]+u}const a=new Array(o[s]);for(let l=0;l<s;++l){const c=t[l];let u=o[l];if(this.nGramWidths.forEach(d=>{const h=t[l+1]-t[l],f=this.getNumNGrams(h,d);this.createNGrams(e,c,a,u,f,d),u+=f}),this.preserveShort&&u===o[l]){const d=t[l+1]-t[l];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(e,c,a,u,1,h)}}return[a,o]}}function N3e(n,e,t,r,i,s,o,a){return new A3e(t,r,i,s,o,a).compute(n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k3e(n,e,t,r){if(!n.length)return;if(e.length===0){for(let s=0;s<n.length;++s)r.push(n.subarray(s,s+1));return}if(e.length===1){const s=e[0];let o=n.indexOf(s);for(;o!==-1;){const a=n.subarray(0,o);(!t||a.length!==0)&&r.push(a),n=n.subarray(o+1),o=n.indexOf(s)}(!t||n.length!==0)&&r.push(n);return}let i=0;for(let s=0;s<n.length+1;s++)if(s===n.length||e.indexOf(n[s])!==-1){const o=n.subarray(i,s);(!t||o.length!==0)&&r.push(o),i=s+1}}function I3e(n,e,t){const r=n.length,i=[];let s=0,o=0;const a=new Array(r);for(let h=0;h<r;++h){const f=i.length;k3e(n[h],e,t,i);const p=i.length-f;a[h]=p,s+=p,o=Math.max(o,p)}const l=zi("int32",s*2),c=new Array(s),u=[r,o];let d=0;for(let h=0;h<r;++h)for(let f=0;f<a[h];++f)l[d*2]=h,l[d*2+1]=f,c[d]=i[d],++d;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R3e(n,e){const t=zi("int32",n.length);for(let r=0;r<n.length;++r)t[r]=Awe(n[r]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P3e=io((n,e)=>n-e);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D3e(n,e){const t=new Array(n.rank);for(let i=0;i<t.length;i++)t[i]=n.shape[i]*e[i];const r=Fr(t,n.dtype);for(let i=0;i<r.values.length;++i){const s=r.indexToLoc(i),o=new Array(n.rank);for(let l=0;l<o.length;l++)o[l]=s[l]%n.shape[l];const a=n.locToIndex(o);r.values[i]=n.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ky=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function VX(n,e,t=0,r=n.length-1){for(;r>t;){if(r-t>600){const a=r-t+1,l=e-t+1,c=Math.log(a),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),h=Math.max(t,Math.floor(e-l*u/a+d)),f=Math.min(r,Math.floor(e+(a-l)*u/a+d));VX(n,e,h,f)}const i=n[e];let s=t,o=r;for(Dy(n,t,e),Ky(n[r],i)>0&&Dy(n,t,r);s<o;){for(Dy(n,s,o),s++,o--;Ky(n[s],i)<0;)s=s+1;for(;Ky(n[o],i)>0;)o=o-1}Ky(n[t],i)===0?Dy(n,t,o):(o=o+1,Dy(n,o,r)),o<=e&&(t=o+1),e<=o&&(r=o-1)}}function L3e(n,e,t,r,i){const s=e[e.length-1],[o,a]=[n.length/s,s],l=yd(t,o*r),c=yd("int32",o*r);for(let d=0;d<o;d++){const h=d*a,f=n.subarray(h,h+a);let p=new Array(f.length);f.forEach((b,S)=>p[S]={value:b,index:S}),r<p.length&&(VX(p,r),p=p.slice(0,r)),i&&p.sort(Ky);const x=d*r,v=l.subarray(x,x+r),y=c.subarray(x,x+r);for(let b=0;b<r;b++)v[b]=p[b].value,y[b]=p[b].index}const u=e.slice();return u[u.length-1]=r,[Fr(u,t,l),Fr(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O3e(n,e,t,r){const i=ka(e,t)[0],s=[1,t[0],1];for(let p=0;p<i;p++)s[0]*=t[p];s[1]=t[i];for(let p=i+1;p<t.length;p++)s[2]*=t[p];const o=new Map,a=new Int32Array(t[i]),l=new Jm(s,r,n),c=[],u=s[0]===1&&s[2]===1;for(let p=0;p<t[i];p++){let x;if(u)x=n[p].toString();else{const y=[];for(let b=0;b<s[0];b++)for(let S=0;S<s[2];S++)y.push(l.get(b,p,S));x=y.join(",")}const v=o.get(x);if(v!=null)a[p]=v;else{const y=o.size;o.set(x,y),a[p]=y,c.push(p)}}const d=s.slice();d[1]=o.size;const h=new Jm(d,r);c.forEach((p,x)=>{for(let v=0;v<s[0];v++)for(let y=0;y<s[2];y++)h.set(l.get(v,p,y),v,x,y)});const f=t.slice();return f[i]=d[1],{outputValues:h.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F3e=Object.freeze(Object.defineProperty({__proto__:null,addImpl:LRe,bincountImpl:ORe,bincountReduceImpl:FRe,bitwiseAndImpl:zRe,castImpl:DRe,ceilImpl:URe,concatImpl:BRe,equalImpl:$Re,expImpl:jRe,expm1Impl:VRe,floorDivImpl:HRe,floorImpl:WRe,gatherNdImpl:GRe,gatherV2Impl:qRe,greaterEqualImpl:KRe,greaterImpl:XRe,lessEqualImpl:ZRe,lessImpl:YRe,linSpaceImpl:QRe,logImpl:JRe,maxImpl:e3e,maximumImpl:t3e,minimumImpl:n3e,multiplyImpl:jX,negImpl:r3e,notEqualImpl:i3e,prodImpl:o3e,raggedGatherImpl:f3e,raggedRangeImpl:p3e,raggedTensorToTensorImpl:m3e,rangeImpl:g3e,rsqrtImpl:y3e,scatterImpl:v3e,sigmoidImpl:x3e,simpleAbsImpl:PRe,sliceImpl:w3e,sparseFillEmptyRowsImpl:b3e,sparseReshapeImpl:S3e,sparseSegmentReductionImpl:_3e,sqrtImpl:E3e,squaredDifferenceImpl:C3e,staticRegexReplaceImpl:T3e,stridedSliceImpl:M3e,stringNGramsImpl:N3e,stringSplitImpl:I3e,stringToHashBucketFastImpl:R3e,subImpl:P3e,tileImpl:D3e,topKImpl:L3e,transposeImpl:s3e,uniqueImpl:O3e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:z3e,castImpl:U3e,ceilImpl:B3e,concatImpl:$3e,equalImpl:j3e,expImpl:V3e,expm1Impl:W3e,floorImpl:H3e,floorDivImpl:G3e,gatherNdImpl:q3e,gatherV2Impl:X3e,greaterEqualImpl:K3e,greaterImpl:Y3e,lessEqualImpl:Z3e,lessImpl:Q3e,logImpl:J3e,maxImpl:ePe,maximumImpl:tPe,minimumImpl:nPe,multiplyImpl:rPe,negImpl:iPe,notEqualImpl:sPe,prodImpl:oPe,rangeImpl:aPe,rsqrtImpl:lPe,scatterImpl:cPe,simpleAbsImpl:uPe,sliceImpl:dPe,stridedSliceImpl:hPe,stringNGramsImpl:fPe,subImpl:pPe,tileImpl:mPe,topKImpl:gPe,transposeImpl:yPe}=F3e;/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vPe=er({opType:ft.ABS,cpuKernelImpl:uPe}),xPe={kernelName:b8,backendName:"webgpu",kernelFunc:vPe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wPe=er({opType:ft.ACOS}),bPe={kernelName:S8,backendName:"webgpu",kernelFunc:wPe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SPe=er({opType:ft.ACOSH}),_Pe={kernelName:_8,backendName:"webgpu",kernelFunc:SPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EPe=ji({opType:pn.ADD,cpuKernelImpl:z3e,supportsComplex:!0}),CPe={kernelName:qR,backendName:"webgpu",kernelFunc:EPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TPe{constructor(e){this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e[0],this.variableNames=e.map((t,r)=>`T${r}`),this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="addN"}getUserCode(){const e=[];this.variableNames.forEach(i=>{e.push(`let v${i} = get${i}ByOutputCoords(coords);`)});const t=this.variableNames.map(i=>`v${i}`).join(" + ");return`
      ${vt("index")} {
        for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if (flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            ${e.join(`
        `)}
            setOutputAtIndex(flatIndex, ${t});
          }
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MPe(n){const{inputs:e,backend:t}=n,r=e;if(r.length===1)return Co({inputs:{x:r[0]},backend:t});const i=r.map(a=>a.dtype).reduce((a,l)=>vd(a,l)),s=r.map(a=>a.shape),o=new TPe(s);return t.runWebGPUProgram(o,r,i)}const APe={kernelName:E8,backendName:"webgpu",kernelFunc:MPe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NPe{constructor(e,t){this.variableNames=["A"],this.workgroupSize=[16,16,1];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[t[i]];this.outputShape=r,this.dispatchLayout={x:[0],y:[1]},this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize,[1,1,1]),this.shaderKey="transposeShared"}getUserCode(){te(this.workgroupSize[0]===this.workgroupSize[1],()=>`Must be a square tile, current tile shape is ${this.workgroupSize[0]} x ${this.workgroupSize[1]}`);const e=this.workgroupSize[0];return`
      var<workgroup> tile : array<array<f32, ${this.workgroupSize[0]+1}>, ${this.workgroupSize[0]}>;
      ${vt()} {
        var x = i32(workgroupId.x) * ${e} + i32(localId.x);
        var y = i32(workgroupId.y) * ${e} + i32(localId.y);
        let width = uniforms.outShape[0];
        let height = uniforms.outShape[1];
        if (x < width && y < height) {
          tile[localId.y][localId.x] = f32(A[y * width + x]);
        }
        workgroupBarrier();

        x = i32(workgroupId.y) * ${e} + i32(localId.x);
        y = i32(workgroupId.x) * ${e} + i32(localId.y);
        if (x < height && y < width) {
          setOutputAtIndex((y * height + x), tile[localId.x]
            [localId.y]);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kPe{constructor(e,t){this.variableNames=["A"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0;const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[t[i]];this.outputShape=r,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.newDim=t,this.shaderKey=`transpose_${t}`}getUserCode(){const e=pi(this.outputShape.length),t=WX(this.newDim);return`
      ${vt("index")} {
        for(var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if(flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            setOutputAtIndex(flatIndex, A[getIndexFromCoords${this.outputShape.length}D(
              ${e}(${t}), uniforms.aShape)]);
          }
        }
      }
    `}}function WX(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=new Array(e);for(let r=0;r<n.length;r++)t[n[r]]=`coords.${Lc(r)}`;return t.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xl(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{perm:s}=r,o=t,a=i.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=i.shape[s[u]];if(t.shouldExecuteOnCPU([i])){const d=o.tensorMap.get(i.dataId).values,h=yPe(d,i.shape,i.dtype,s,l);return t.makeTensorInfo(l,i.dtype,h)}if(i.shape.length===2&&Zs(s,[1,0])){const u=new NPe(i.shape,s);return o.runWebGPUProgram(u,[i],i.dtype)}const c=new kPe(i.shape,s);return o.runWebGPUProgram(c,[i],i.dtype)}const IPe={kernelName:bb,backendName:"webgpu",kernelFunc:Xl};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RPe{constructor(e,t,r){this.variableNames=["x"],this.uniforms="reduceSize : i32,",this.size=!0,this.inputShape=[e.batchSize,e.inSize];const[i]=_2(this.inputShape,[1]);this.outputShape=i.length===0?[1]:i,e.inSize>=32768&&r>=512?this.workgroupSize=[512,1,1]:e.inSize>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,[1,1,1]),this.reduceType=t,this.shaderKey=`reduce_${t}`}getUserCode(){let e="",t="0.0";const r=this.workgroupSize[0];this.reduceType==="min"||this.reduceType==="max"?(e=`
         if (isnan(candidate)) {
          bestValue = uniforms.NAN;
         } else if (!isnan(bestValue) && candidate ${this.reduceType==="min"?"<":">"} bestValue)
           {  bestValue = candidate; }`,t="f32(x[offset])"):this.reduceType==="sum"||this.reduceType==="mean"?e=" bestValue = bestValue + candidate; ":this.reduceType==="prod"?(e=" bestValue = bestValue * candidate; ",t="1.0"):this.reduceType==="all"?(e=" bestValue = f32(bestValue >= 1.0 && candidate >= 1.0); ",t="1.0"):this.reduceType==="any"&&(e=" bestValue = f32(bestValue >= 1.0 || candidate >= 1.0); ",t="0.0");const i=this.reduceType==="mean"?"setOutputAtIndex(outputIndex, bestValue / f32(uniforms.reduceSize));":"setOutputAtIndex(outputIndex, bestValue);";return`
       fn DIV_CEIL(a : u32, b : u32) -> u32 {
        return ((a - 1u) / b + 1u);
       }

       ${`
         var<workgroup> xBestValues : array<f32, ${r}>;
       `}
       fn getOffset(outputIndex : i32) -> i32 {
         let outputCoords = getCoordsFromIndex(outputIndex);
         let offset = ${this.outputShape.length===1?"outputCoords":"outputCoords[0]"} * uniforms.reduceSize;
          return offset;
       }
       ${vt("index")} {
         let outputIndex = index / ${r};
         let offset = getOffset(outputIndex);
         var bestValue = ${t};
         let Length = uniforms.reduceSize;
         let WorkPerThread = DIV_CEIL(u32(Length), ${r}u);
         for (var k = i32(localId.x); k < Length && outputIndex < uniforms.size;
             k = k + ${r}) {
           let candidate = f32(x[offset + k]);
           ${e}
         }
         xBestValues[localId.x] = bestValue;
         workgroupBarrier();

         var reduceSize = min(u32(Length), ${r}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (localId.x < currentSize) {
            let candidate = xBestValues[localId.x + interval];
            ${e}
            xBestValues[localId.x] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (localId.x == 0u && outputIndex < uniforms.size) {
          ${i}
        }
       }
     `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PPe={mean:"float32",all:"bool",any:"bool"};function zf(n,e,t,r,i){const s=n.shape.length,o=[],a=ka(e,n.shape);let l=a;const c=Sx(l,s);let u=n;c!=null&&(u=Xl({inputs:{x:n},attrs:{perm:c},backend:i}),l=_x(l.length,s),o.push(u)),n3(r,l,s);const[d,h]=_2(u.shape,l);let f=d;t&&(f=bx(d,a));let p;if((r==="max"||r==="prod")&&i.shouldExecuteOnCPU([u])){const x=i.tensorMap.get(u.dataId).values;switch(r){case"max":const v=ePe(x,gt(h),f,n.dtype);p=i.makeTensorInfo(f,n.dtype,v);break;case"prod":const{outVals:y,outShape:b,outDtype:S}=oPe(u.shape,u.dtype,x,l);p=i.makeTensorInfo(b,S,y);break;default:throw new Error(`${r} CPU implementation is not yet supported.`)}}else{const x=gt(h),y=gt(u.shape)/x,b={windowSize:x,inSize:x,batchSize:y,outSize:1},S=PPe[r]||$we(n.dtype),_=[{type:"int32",data:[x]}],T=new RPe(b,r,i.device.limits.maxComputeWorkgroupSizeX),M=i.runWebGPUProgram(T,[u],S,_);o.push(M),p=Ht({inputs:{x:M},attrs:{shape:f},backend:i})}return o.forEach(x=>i.disposeData(x.dataId)),p}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DPe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{keepDims:s,axis:o}=r;return zf(i,o,s,"all",t)}const LPe={kernelName:C8,backendName:"webgpu",kernelFunc:DPe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OPe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{keepDims:s,axis:o}=r;return zf(i,o,s,"any",t)}const FPe={kernelName:T8,backendName:"webgpu",kernelFunc:OPe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HX{constructor(e,t,r){this.workgroupSize=[64,1,1],this.variableNames=["x"],this.uniforms="infinityValue : f32,",this.size=!0;const i=[t];this.op=r==="min"?"<":">";const[s,o]=_2(e,i);this.outputShape=s.length===0?[1]:s,this.dispatchLayout=Nt(this.outputShape),gt(o)<32?(this.type="plain",this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize)):(this.type="shared",this.dispatch=xt(this.dispatchLayout,this.outputShape,[1,1,1])),this.inputShape=e,this.shaderKey=`argMinMax_${this.op}_${this.type}`}getUserCode(){const e=this.workgroupSize[0],t=()=>this.inputShape.length===1?"uniforms.xShape":`uniforms.xShape.${Lc(this.inputShape.length-1)}`,r=()=>{let i="";if(this.outputShape.length===1)this.inputShape.length!==1&&(i+="outputCoords,");else for(let s=0;s<this.outputShape.length;s++)i+=`outputCoords.${Lc(s)},`;return i};return this.type==="shared"?`
      fn DIV_CEIL(a : u32, b : u32) -> u32 {
        return ((a - 1u) / b + 1u);
      }

      ${`
      var<workgroup> xBestIndices : array<i32, ${e}>;
      var<workgroup> xBestValues : array<f32, ${e}>;
    `}

      ${vt("index")} {
        let outputIndex = index / ${e};
        let reduceLength = ${t()};

        var bestIndex = i32(localId.x);
        var bestValue = uniforms.infinityValue;
        let outputCoords = getCoordsFromIndex(outputIndex);
        for (var k = i32(localId.x); k < reduceLength && outputIndex < uniforms.size;
            k = k + ${e}) {
          let candidate = getX(${r()} k);
          if (!isnan(candidate) && candidate ${this.op} bestValue) {
            bestValue = candidate;
            bestIndex = k;
          }
        }
        xBestValues[localId.x] = bestValue;
        xBestIndices[localId.x] = bestIndex;
        workgroupBarrier();

        var reduceSize = min(u32(reduceLength), ${e}u);
        for (var currentSize = reduceSize / 2u; reduceSize > 1u;
            currentSize = reduceSize / 2u) {
          let interval = DIV_CEIL(reduceSize, 2u);
          if (localId.x < currentSize) {
            let candidate = xBestValues[localId.x + interval];
            if (candidate ${this.op} bestValue) {
              bestValue = candidate;
              xBestValues[localId.x] = bestValue;
              xBestIndices[localId.x] = xBestIndices[localId.x + interval];
            }
          }
          reduceSize = interval;
          workgroupBarrier();
        }

        if (localId.x == 0u && outputIndex < uniforms.size) {
          setOutputAtIndexI32(outputIndex, xBestIndices[localId.x]);
        }
      }
    `:`
      ${vt("index")} {
        if (index < uniforms.size) {
          let outputCoords = getCoordsFromIndex(index);
          var bestIndex = 0;
          var bestValue = getX(${r()} 0);
          let reduceLength = ${t()};
          for (var i = 1; i < reduceLength; i++) {
            let candidate = getX(${r()} i);
            if (candidate ${this.op} bestValue) {
              bestValue = candidate;
              bestIndex = i;
            }
          }
          setOutputAtIndexI32(index, bestIndex);
        }
      }
      `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zPe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:s}=r;let o=ka(s,i.shape);const a=Sx(o,i.shape.length);let l=i;const c=[];a!=null&&(l=Xl({inputs:{x:i},backend:t,attrs:{perm:a}}),c.push(l),o=_x(o.length,l.shape.length)),n3("argMax",[o[0]],l.shape.length);const u=new HX(l.shape,o[0],"max"),d=[{type:"float32",data:[Number.NEGATIVE_INFINITY]}],h=t.runWebGPUProgram(u,[l],"int32",d);return c.forEach(f=>t.disposeData(f.dataId)),h}const UPe={kernelName:M8,backendName:"webgpu",kernelFunc:zPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BPe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:s}=r;let o=ka(s,i.shape);const a=Sx(o,i.shape.length);let l=i;const c=[];a!=null&&(l=Xl({inputs:{x:i},backend:t,attrs:{perm:a}}),c.push(l),o=_x(o.length,l.shape.length)),n3("argMin",[o[0]],l.shape.length);const u=new HX(l.shape,o[0],"min"),d=[{type:"float32",data:[Number.POSITIVE_INFINITY]}],h=t.runWebGPUProgram(u,[l],"int32",d);return c.forEach(f=>t.disposeData(f.dataId)),h}const $Pe={kernelName:A8,backendName:"webgpu",kernelFunc:BPe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jPe=er({opType:ft.ASIN}),VPe={kernelName:N8,backendName:"webgpu",kernelFunc:jPe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WPe=er({opType:ft.ASINH}),HPe={kernelName:k8,backendName:"webgpu",kernelFunc:WPe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GPe=er({opType:ft.ATAN}),qPe={kernelName:I8,backendName:"webgpu",kernelFunc:GPe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XPe=ji({opType:pn.ATAN2}),KPe={kernelName:P8,backendName:"webgpu",kernelFunc:XPe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YPe=er({opType:ft.ATANH}),ZPe={kernelName:R8,backendName:"webgpu",kernelFunc:YPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QPe{constructor(e){this.variableNames=["x"],this.uniforms="strides : vec2<i32>,",this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="poolWithFilterSizeEqualsOne"}getUserCode(){return`
      ${vt("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let batch = coords[0];
          let d = coords[3];

          let xRCCorner = coords.yz * uniforms.strides;
          let xRCorner = xRCCorner.x;
          let xCCorner = xRCCorner.y;

          let value = getX(batch, xRCorner, xCCorner, d);
          setOutputAtIndex(index, value);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F0{constructor(e,t,r=!1,i=!1,s=!1){if(this.variableNames=["x"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, convDims : vec2<i32>, filterDims : vec2<i32>,",this.workgroupSize=[128,1,1],this.size=!0,t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");this.outputShape=e.outShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=t,this.computePositions=r,this.flattenPositions=i,this.includeBatchIndex=s,this.shaderKey=`pool2D_${t}_${r}_${i}_${s}`}getUserCode(){let e;this.poolType==="avg"?e="resultValue = resultValue + value; count = count + 1.0;":this.computePositions?e=`let currMaxValue = mix(value, maxValue, maxValueFound);
      if (value >= currMaxValue) {
        maxValue = value;
        maxValueFound = 1.0;
        maxPosition = ${this.flattenPositions?this.includeBatchIndex?"((batch * uniforms.xShape[1] + xR) * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"(xR * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"wR * uniforms.filterDims.y + wC"};
      }`:e="resultValue = max(value, resultValue);";let t="resultValue";return this.poolType==="avg"&&(t="resultValue / max(count, 1.0)"),`
      ${vt("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
          let batch = coords[0];
          let d = coords[3];
          let xRCCorner = vec2<i32>(coords.yz) * uniforms.strides - uniforms.pads;
          let xRCorner = xRCCorner.x;
          let xCCorner = xRCCorner.y;

          ${this.computePositions?`var maxValue = 0.0;
            var maxValueFound = 0.0;
            var maxPosition = 0;`:`var resultValue = ${this.poolType==="avg"?"0.0":"-1.0 / pow(10.0, -20.0)"};`}

          var count = 0.0;
          for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + uniforms.dilations.x) {
            let xR = xRCorner + wR;

            if (xR < 0 || xR >= uniforms.convDims.x) {
              continue;
            }

            for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + uniforms.dilations.y) {
              let xC = xCCorner + wC;
              if (xC < 0 || xC >= uniforms.convDims.y) {
                continue;
              }

              let value = getX(batch, xR, xC, d);
              ${e}
            }
          }

          ${this.computePositions?"setOutputAtIndexI32(index, maxPosition);":`setOutputAtIndex(index, ${t});`}
        }
      }
    `}}class N3{constructor(e,t,r=!1,i=!1,s=!1){if(this.variableNames=["x"],this.uniforms="strides : vec3<i32>, pads : vec3<i32>, convDims : vec3<i32>, filterDims : vec3<i32>,",this.workgroupSize=[128,1,1],this.size=!0,t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");this.outputShape=e.outShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=t,this.computePositions=r,this.flattenPositions=i,this.includeBatchIndex=s,this.shaderKey=`pool3D_${t}_${r}_${i}_${s}`}getUserCode(){let e;this.poolType==="avg"?e="resultValue += value; count += 1.0;":this.computePositions?e=`let currMaxValue = mix(value, maxValue, maxValueFound);
      if (value >= currMaxValue) {
        maxValue = value;
        maxValueFound = 1.0;
        maxPosition = ${this.flattenPositions?this.includeBatchIndex?"(((batch * uniforms.xShape.y + xD) * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"((xD * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"wD * uniforms.filterDims.y * uniforms.filterDims.y + wR * uniforms.filterDims.z + wC"};
      }`:e="resultValue = max(value, resultValue);";let t="resultValue";return this.poolType==="avg"&&(t="resultValue / max(count, 1.0)"),`
      ${vt("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let batch = coords.x;
          let ch = coords.u;

          let xCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;
          let xDCorner = xCorner.x;
          let xRCorner = xCorner.y;
          let xCCorner = xCorner.z;

          ${this.computePositions?`var maxValue = 0.0;
            var maxValueFound = 0.0;
            var maxPosition = 0;`:`var resultValue = ${this.poolType==="avg"?"0.0":"-1.0 / pow(10.0, -20.0)"};`}

          var count = 0.0;
          for (var wD = 0; wD < uniforms.filterDims.x; wD++) {
            let xD = xDCorner + wD;
            if (xD < 0 || xD >= uniforms.convDims.x) {
              continue;
            }

            for (var wR = 0; wR < uniforms.filterDims.y; wR++) {
              let xR = xRCorner + wR;
              if (xR < 0 || xR >= uniforms.convDims.y) {
                continue;
              }

              for (var wC = 0; wC < uniforms.filterDims.z; wC++) {
                let xC = xCCorner + wC;
                if (xC < 0 || xC >= uniforms.convDims.z) {
                  continue;
                }

                let value = getX(batch, xD, xR, xC, ch);
                ${e}
              }
            }
          }

          ${this.computePositions?"setOutputAtIndexI32(index, maxPosition);":`setOutputAtIndex(index, ${t});`}
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GX(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{reductionIndices:s,keepDims:o}=r;return zf(i,s,o,"max",t)}const JPe={kernelName:j9,backendName:"webgpu",kernelFunc:GX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qX(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{keepDims:s,axis:o}=r;return zf(i,o,s,"mean",t)}const eDe={kernelName:q9,backendName:"webgpu",kernelFunc:qX};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XX(n,e,t,r){if(e.filterWidth===1&&e.filterHeight===1&&Zs(e.inShape,e.outShape))return Co({inputs:{x:n},backend:r});if(e.filterWidth===e.inWidth&&e.filterHeight===e.inHeight&&e.batchSize===1&&e.padInfo.type==="VALID"){const o=n.shape.length,a=Ht({inputs:{x:n},backend:r,attrs:{shape:[n.shape[o-3]*n.shape[o-2],n.shape[o-1]]}});let l;t==="avg"?l=qX({inputs:{x:a},backend:r,attrs:{axis:0,keepDims:!1}}):(te(t==="max",()=>`Invalid pool type ${t}`),l=GX({inputs:{x:a},backend:r,attrs:{reductionIndices:0,keepDims:!1}}));const c=Ht({inputs:{x:l},backend:r,attrs:{shape:e.outShape}});return r.disposeData(a.dataId),r.disposeData(l.dataId),c}let i;const s=[{type:"int32",data:[e.strideHeight,e.strideWidth]}];return e.filterHeight===1&&e.filterWidth===1?i=new QPe(e):(t==="avg"?i=new F0(e,"avg"):(te(t==="max",()=>`Invalid pool type ${t}`),i=new F0(e,"max")),s.push({type:"int32",data:[e.padInfo.top,e.padInfo.left]},{type:"int32",data:[e.dilationHeight,e.dilationWidth]},{type:"int32",data:[e.inHeight,e.inWidth]},{type:"int32",data:[e.effectiveFilterHeight,e.effectiveFilterWidth]})),r.runWebGPUProgram(i,[n],n.dtype,s)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tDe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{filterSize:s,strides:o,pad:a,dimRoundingMode:l}=r,u=Ig(i.shape,s,o,1,a,l);return XX(i,u,"avg",t)}const nDe={kernelName:D8,backendName:"webgpu",kernelFunc:tDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rDe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{filterSize:s,strides:o,pad:a,dataFormat:l,dimRoundingMode:c}=r,u=[1,1,1],d=x2(i.shape,s,o,u,a,c,l),h=new N3(d,"avg"),f=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.front,d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.inDepth,d.inHeight,d.inWidth]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]}];return t.runWebGPUProgram(h,[i],i.dtype,f)}const iDe={kernelName:L8,backendName:"webgpu",kernelFunc:rDe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sDe{constructor(e){this.variableNames=["dy"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32, avgMultiplier : f32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool2DBackprop"}getUserCode(){return`
      ${vt("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d = coords[3];

        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;
        let dyRCorner = dyRCCorner.x;
        let dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR = wR + uniforms.dilations[0]) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims[1]; wC = wC + uniforms.dilations[1]) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }
            let idyC = i32(dyC);

            let dyValue = getDy(batch, idyR, idyC, d);

            dotProd = dotProd + dyValue * uniforms.avgMultiplier;
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}}class oDe{constructor(e){this.variableNames=["dy"],this.uniforms=`strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,
       outDepth : i32, outHeight : i32, outWidth : i32, avgMultiplier : f32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool3DBackprop"}getUserCode(){return`
      ${vt("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let ch = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyDCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {
          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);

          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {
            continue;
          }
          let idyD = i32(dyD);

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let dyValue = getDy(batch, idyD, idyR, idyC, ch);
              dotProd += dyValue * uniforms.avgMultiplier;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aDe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:i,input:s}=e,o=s,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=r,d=x2(o.shape,a,l,1,c,u),h=new oDe(d),f=1/(d.filterDepth*d.filterHeight*d.filterWidth),p=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.effectiveFilterDepth-1-d.padInfo.front,d.effectiveFilterHeight-1-d.padInfo.top,d.effectiveFilterWidth-1-d.padInfo.left]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]},{type:"int32",data:[d.outDepth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"float32",data:[f]}];return t.runWebGPUProgram(h,[i],o.dtype,p)}const lDe={kernelName:Zxe,backendName:"webgpu",kernelFunc:aDe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cDe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:i,input:s}=e,o=s;BX([i,s],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=r,u=Ig(o.shape,a,l,1,c),d=new sDe(u),h=1/(u.filterHeight*u.filterWidth),f=[{type:"int32",data:[u.strideHeight,u.strideWidth]},{type:"int32",data:[u.effectiveFilterHeight-1-u.padInfo.top,u.effectiveFilterWidth-1-u.padInfo.left]},{type:"int32",data:[u.dilationHeight,u.dilationWidth]},{type:"int32",data:[u.effectiveFilterHeight,u.effectiveFilterWidth]},{type:"int32",data:[u.outHeight]},{type:"int32",data:[u.outWidth]},{type:"float32",data:[h]}];return t.runWebGPUProgram(d,[i],o.dtype,f)}const uDe={kernelName:Yxe,backendName:"webgpu",kernelFunc:cDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dDe(n){const{inputs:e,backend:t,attrs:r}=n,{a:i,b:s}=e,{transposeA:o,transposeB:a}=r;return k2({a:i,b:s,transposeA:o,transposeB:a,backend:t})}const hDe={kernelName:O8,backendName:"webgpu",kernelFunc:dDe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fDe{constructor(e,t){this.variableNames=["source"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.rank=t.length,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.start=e,this.uniforms=`start : ${pi(e.length)}, `,this.shaderKey="slice"}getUserCode(){const e=pi(this.rank),t=pDe(this.rank);let r;return this.start.length===1?r=this.outputShape.map((s,o)=>"sourceLoc = uniforms.start + coords;"):r=this.outputShape.map((s,o)=>`sourceLoc.${VN[o]} = uniforms.start.${Lc(o)} + coords.${VN[o]};`),`
      ${vt("index")} {
        if (index < uniforms.size) {
          var sourceLoc : ${e};
          let coords = getCoordsFromIndex(index);
          ${r.join(`
`)}
          setOutputAtIndex(index, getSource(${t}));
        }
      }
    `}}const VN=["x","y","z","w","u","v"];function pDe(n){if(n===1)return"sourceLoc";if(n<=6)return VN.slice(0,n).map(e=>`sourceLoc.${e}`).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Og(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{begin:s,size:o}=r,[a,l]=pAe(i,s,o);if(uAe(i,a,l),t.shouldExecuteOnCPU([i])||i.dtype==="string"){const d=t.tensorMap.get(i.dataId),h=dPe(d.values,a,l,i.shape,i.dtype);return t.makeTensorInfo(l,i.dtype,h)}if(gt(l)===0)return t.makeTensorInfo(l,i.dtype,[]);const c=new fDe(a,l),u=[{type:"int32",data:a}];return t.runWebGPUProgram(c,[i],i.dtype,u)}const mDe={kernelName:M7,backendName:"webgpu",kernelFunc:Og};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gDe=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{blockShape:s,crops:o}=r;te(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGPU backend not implemented yet");const a=s.reduce((b,S)=>b*S),l=kX(i.shape,s,a),c=IX(l.length,s.length),u=RX(i.shape,s,a),d=_Ae(o,s.length),h=EAe(u,o,s.length),f=[],p=Ht({inputs:{x:i},backend:t,attrs:{shape:l}}),x=Xl({inputs:{x:p},backend:t,attrs:{perm:c}}),v=Ht({inputs:{x},backend:t,attrs:{shape:u}}),y=Og({inputs:{x:v},backend:t,attrs:{begin:d,size:h}});return f.push(p),f.push(x),f.push(v),f.forEach(b=>t.disposeData(b.dataId)),y},yDe={kernelName:F8,backendName:"webgpu",kernelFunc:gDe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vDe=`
  fn bincount_write(index: i32, value: f32) {
    ${Ld("&result[index]","value","float32")}
  }
`,xDe=`
  fn bincount_write(index: i32, value: f32) {
    atomicStore(&result[index], bitcast<i32>(value));
  }
`;class KX{constructor(e,t,r=!1){this.outputShape=[],this.variableNames=["x"],this.uniforms="binCountSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.hasWeights=!0,this.binaryOutput=!1,this.outputShape=e,this.rank=e.length,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.binaryOutput=r,r&&(this.atomic=!1),this.hasWeights=t,this.hasWeights&&this.variableNames.push("w"),this.shaderKey=`bincount_${this.hasWeights}_${this.binaryOutput}_${this.rank}`}getUserCode(){return`
    ${this.binaryOutput?xDe:vDe}
  ${vt("index")} {
    ${this.rank===1?`if (index < uniforms.xShape) {
      let indexVal = i32(getX(index));
      if (indexVal < uniforms.binCountSize) {
        let value = ${this.binaryOutput?1:this.hasWeights?"getW(index)":"1."};
        bincount_write(indexVal, value);
      }
    }`:`let coord = getCoordsFromIndex(index);
    if (coordsInBounds2D(coord, uniforms.xShape)) {
      let indexVal = i32(getX(coord[0], coord[1]));
      if (indexVal < uniforms.binCountSize) {
        let value = ${this.binaryOutput?1:this.hasWeights?"getW(coord[0], coord[1])":"1."};
        bincount_write(coord.x * uniforms.binCountSize + indexVal, value);
      }
    }`}
  }
  `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wDe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,weights:s}=e,{size:o}=r,a=gt(i.shape),c=gt(s.shape)>0,u=[o],d=s.dtype,h=Xs({backend:t,attrs:{shape:u,value:0,dtype:d}}),f=new KX([a],c),p=[{type:"int32",data:[o]}],x=c?[i,s]:[i];return t.runWebGPUProgram(f,x,d,p,h)}const bDe={kernelName:z8,backendName:"webgpu",kernelFunc:wDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SDe{constructor(e){this.outputShape=[],this.variableNames=["s0","s1"],this.uniforms="s0Size : i32, s1Size : i32, ",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e],this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="broadcastArgs"}getUserCode(){return`
  ${vt("index")} {
    if (index < uniforms.size) {
      var s0 = 1.0;
      var s1 = 1.0;
      let indexS0 = index - uniforms.size + uniforms.s0Size;
      let indexS1 = index - uniforms.size + uniforms.s1Size;
      if (indexS0 >= 0) {
        s0 = getS0(indexS0);
      }
      if (indexS1 >= 0) {
        s1 = getS1(indexS1);
      }

      if (s0 == 1.0) {
        setOutputAtIndex(index, s1);
      } else if (s1 == 1.0) {
        setOutputAtIndex(index, s0);
      } else if (s0 != s1) {
        setOutputAtIndex(index, uniforms.NAN);
      } else {
        setOutputAtIndex(index, s0);
      }
    }
  }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _De(n){const{inputs:e,backend:t}=n,{s0:r,s1:i}=e;if(t.shouldExecuteOnCPU([r,i])){const u=t.tensorMap.get(r.dataId),d=t.tensorMap.get(i.dataId),h=u.values,f=d.values,p=_r(Array.from(h),Array.from(f));return t.makeTensorInfo([p.length],"int32",Int32Array.from(p))}const s=gt(r.shape),o=gt(i.shape),a=Math.max(s,o),l=new SDe(a),c=[{type:"int32",data:[s]},{type:"int32",data:[o]}];return t.runWebGPUProgram(l,[r,i],"int32",c)}const EDe={kernelName:U8,backendName:"webgpu",kernelFunc:_De};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YX=ji({opType:pn.NOT_EQUAL,dtype:"bool",cpuKernelImpl:sPe}),CDe={kernelName:t7,backendName:"webgpu",kernelFunc:YX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ex(n){const{inputs:e,backend:t}=n,{input:r}=e,i=t.tensorMap.get(r.dataId);return Co({inputs:{x:i.complexTensorInfos.real},backend:t})}const TDe={kernelName:h7,backendName:"webgpu",kernelFunc:Ex};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MDe(n,e){const t=new Lg(n.shape,ft.TO_INT),r=e.runWebGPUProgram(t,[n],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WN(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{dtype:s}=r;if(s==="complex64"){if(i.dtype==="complex64")return Co({inputs:{x:i},backend:t});const o=bd(i.shape),a=WN({inputs:{x:i},backend:t,attrs:{dtype:"float32"}}),l=Ff({inputs:{real:a,imag:o},backend:t});return o.dispose(),t.disposeData(a.dataId),l}if(i.dtype==="complex64"){const o=Ex({inputs:{input:i},backend:t}),a=WN({inputs:{x:o},backend:t,attrs:{dtype:s}});return t.disposeData(o.dataId),a}if(!Bxe(i.dtype,s)){const o=Co({inputs:{x:i},backend:t});return{dataId:o.dataId,shape:o.shape,dtype:s}}if(t.shouldExecuteOnCPU([i])){const o=t.tensorMap.get(i.dataId).values,[a,l,c]=U3e(o,i.shape,i.dtype,s);return t.makeTensorInfo(a,l,c)}if(s==="int32")return MDe(i,t);if(s==="bool"){const o=t.makeTensorInfo([],"bool",yd("bool",1)),l=YX({inputs:{a:i,b:o},backend:t});return t.disposeData(o.dataId),l}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${s}`)}const ADe={kernelName:XR,backendName:"webgpu",kernelFunc:WN};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NDe=er({opType:ft.CEIL,cpuKernelImpl:B3e}),kDe={kernelName:B8,backendName:"webgpu",kernelFunc:NDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IDe{constructor(e){this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workPerThread=4,this.workgroupSize=[64,1,1],this.outputComponent=4,this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="clipVec4"}getUserCode(){return`
      ${vt("index")} {
        if(index < uniforms.size) {
          let value = getAByOutputIndex(index);
          var clampedValue = clamp(
              value, vec4<f32>(uniforms.minVal), vec4<f32>(uniforms.maxVal));
          clampedValue = select(clampedValue, value, isnanVec4(value));
          setOutputAtIndex(index, clampedValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RDe{constructor(e){this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="clip"}getUserCode(){return`
      ${vt("index")} {
        if(index < uniforms.size) {
          let value = getAByOutputIndex(index);
          if (isnan(value)) {
            setOutputAtIndex(index, value);
            return;
          }
          setOutputAtIndex(index, clamp(value, uniforms.minVal, uniforms.maxVal));
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PDe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{clipValueMin:s,clipValueMax:o}=r;let a;const l=[{type:"float32",data:[s]},{type:"float32",data:[o]}];return gt(i.shape)%4===0?a=new IDe(i.shape):a=new RDe(i.shape),t.runWebGPUProgram(a,[i],i.dtype,l)}const DDe={kernelName:$8,backendName:"webgpu",kernelFunc:PDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LDe{constructor(e){this.outputShape=[],this.variableNames=["real","imag"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="complexAbs"}getUserCode(){return`
    ${vt("index")} {
      if (index < uniforms.size) {
        let re = abs(getRealByOutputIndex(index));
        let im = abs(getImagByOutputIndex(index));
        let mx = max(re, im);

        // The length function in wgsl may be not underflow-safe on some GPUs.
        // So the safe solution is to ensure underflow-safety in all cases.
        setOutputAtIndex(index, select(mx * length(vec2<f32>(1, min(re, im)/mx)), 0.0, mx == 0.0));
      }
    }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y4(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function ODe(n){const{inputs:e,backend:t}=n,{x:r}=e,i=t.tensorMap.get(r.dataId),s=new LDe(r.shape),o=[y4(r,i.complexTensorInfos.real),y4(r,i.complexTensorInfos.imag)];return t.runWebGPUProgram(s,o,o[0].dtype)}const FDe={kernelName:V8,backendName:"webgpu",kernelFunc:ODe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zDe{constructor(e){this.uniforms="",this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=O0(e,1),this.variableNames=e.map((t,r)=>`T${r}`),this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.offsetLength=e.length-1;for(let t=0;t<this.offsetLength;t++)this.uniforms+=`offset${t} : i32,`;this.shaderKey="concat"}getUserCode(){const e=[];if(this.offsetLength>0){e.push("if (yC < uniforms.offset0){ setOutputAtCoords(coords.x, coords.y, getT0(yR, yC)); }");for(let s=1;s<this.offsetLength;s++)e.push(`else if (yC < uniforms.offset${[s]}){ setOutputAtCoords(coords.x, coords.y, getT${s}(yR, yC - uniforms.offset${s-1})); }`);const r=this.offsetLength,i=this.offsetLength-1;e.push(`else { setOutputAtCoords(coords.x, coords.y, getT${r}(yR, yC - uniforms.offset${i})); }`)}else e.push("setOutputAtCoords(coords.x, coords.y, getT0(yR, yC));");return`
      ${vt("index")} {
        for(var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if(flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            let yR = coords.x;
            let yC = coords.y;

            ${e.join(`
        `)}
          }
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I2(n){const{inputs:e,backend:t}=n,{input:r}=e,i=t.tensorMap.get(r.dataId);return Co({inputs:{x:i.complexTensorInfos.imag},backend:t})}const UDe={kernelName:A9,backendName:"webgpu",kernelFunc:I2};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yy(n,e,t){const r=n[0].dtype;if(r==="complex64"){const p=n.map(S=>Ex({inputs:{input:S},backend:t})),x=n.map(S=>I2({inputs:{input:S},backend:t})),v=Yy(p,e,t),y=Yy(x,e,t),b=Ff({inputs:{real:v,imag:y},backend:t});return p.forEach(S=>t.disposeData(S.dataId)),x.forEach(S=>t.disposeData(S.dataId)),t.disposeData(v.dataId),t.disposeData(y.dataId),b}let i=t.shouldExecuteOnCPU(n);if(r==="string"&&(i=!0),i){const p=n.map(T=>{const k=[-1,gt(T.shape.slice(e))];return Ht({inputs:{x:T},backend:t,attrs:{shape:k}})}),x=p.map(T=>({vals:t.readSync(T.dataId),shape:T.shape})),v=O0(p.map(T=>T.shape),1),y=p[0].shape[0]===1,b=$3e(x,v,r,y),S=O0(n.map(T=>T.shape),e),_=t.makeTensorInfo(S,r,b);return p.forEach(T=>t.disposeData(T.dataId)),_}const s=t.device.limits.maxStorageBuffersPerShaderStage-1;if(n.length>s){const p=[];for(let v=0;v<n.length;v+=s){const y=n.slice(v,v+s);p.push(Yy(y,e,t))}const x=Yy(p,e,t);for(const v of p)t.disposeData(v.dataId);return x}const{tensors2D:o,outShape:a}=BDe(n,e,t),l=o.map(p=>p.shape),c=new zDe(l),u=[],d=new Array(l.length-1);if(d.length>0){d[0]=l[0][1],u.push({type:"int32",data:[d[0]]});for(let p=1;p<d.length;p++)d[p]=d[p-1]+l[p][1],u.push({type:"int32",data:[d[p]]})}const h=t.runWebGPUProgram(c,o,o[0].dtype,u);o.forEach(p=>t.disposeData(p.dataId));const f=Ht({inputs:{x:h},backend:t,attrs:{shape:a}});return t.disposeData(h.dataId),f}function BDe(n,e,t){const r=O0(n.map(s=>s.shape),e);return{tensors2D:n.map(s=>Ht({inputs:{x:s},backend:t,attrs:{shape:[gt(s.shape.slice(0,e)),gt(s.shape.slice(e))]}})),outShape:r}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZX(n){const{inputs:e,backend:t,attrs:r}=n,{axis:i}=r,s=ka(i,e[0].shape)[0],o=e.map(c=>c.shape);yAe(o,s);const a=O0(e.map(c=>c.shape),s);if(gt(a)===0)return t.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>gt(c.shape)>0);return l.length===1?Co({inputs:{x:l[0]},backend:t}):Yy(l,s,t)}const $De={kernelName:W8,backendName:"webgpu",kernelFunc:ZX};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jDe(n,e,t,r,i=!1,s=null,o=!1,a=4,l=4,c=4){const u=z=>{switch(z){case 1:return"resData = f32(x[xIndex]);";case 3:return"resData = vec3<f32>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);";case 4:return"resData = vec4<f32>(x[xIndex / 4]);";default:throw new Error(`innerElementSize ${z} is not supported.`)}},d=z=>{switch(z){case 1:return"return f32(W[row * uniforms.wShape[3] + col]);";case 4:return"return vec4<f32>(W[(row * uniforms.wShape[3] + col) / 4]);";default:throw new Error(`innerElementSize ${z} is not supported.`)}},h=n?`
      let coord = vec4<i32>(batch, xRow, xCol, xCh);
      `:`
      let coord = vec4<i32>(batch, xCh, xRow, xCol);
      `,f=n?`
      let coords = vec4<i32>(
        batch,
        row / outWidth,
        row % outWidth,
        col);
      `:`
      let coords = vec4<i32>(
        batch,
        row,
        col / outWidth,
        col % outWidth);
      `,p=n?"uniforms.xShape[1]":"uniforms.xShape[2]",x=n?"uniforms.xShape[2]":"uniforms.xShape[3]",v=n?"row":"col",y=n?"col":"row",b=`
      let inChannels = uniforms.wShape[2];
      let outWidth = ${n?"uniforms.outShape[2]":"uniforms.outShape[3]"};
      let outRow = ${v} / outWidth;
      let outCol = ${v} % outWidth;

      let WRow = ${y} / (uniforms.filterDims[1] * inChannels);
      let WCol = ${y} / inChannels % uniforms.filterDims[1];
      let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * WRow - uniforms.pads[0];
      let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * WCol - uniforms.pads[1];
      let xCh = ${y} % inChannels;
      var resData = ${Mn(a)}(0.0);
      // The bounds checking is always needed since we use it to pad zero for
      // the 'same' padding type.
      if (xRow >= 0 && xRow < ${p} && xCol >= 0 && xCol < ${x}) {
        ${h}
        let xIndex = getIndexFromCoords4D(coord, uniforms.xShape);
        ${u(a)}
      }
      return resData;`,S=n?e&&r?`
      ${b}`:`
      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {
        ${b}
      }
      return ${Mn(a)}(0.0);`:r&&t?`
      ${b}`:`
      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {
        ${b}
      }
      return ${Mn(a)}(0.0);`,_=`${d(l)}`,T=Mn(c),M=Mn(n?a:l),k=Mn(n?l:a);return`
      ${Jc(s,o,c===4,4)}
      fn mm_readA(batch: i32, row : i32, col : i32) -> ${M} {
        ${n?S:_}
      }

      fn mm_readB(batch: i32, row : i32, col : i32) -> ${k} {
        ${n?_:S}
      }

      fn mm_write(batch: i32, row : i32, col : i32, valueIn : ${T}) {
        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)
        {
        var value = valueIn;
        let outWidth = ${n?"uniforms.outShape[2]":"uniforms.outShape[3]"};
        ${f}
        ${Of(i,s)}
        setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }`}class VDe{constructor(e,t,r,i,s=!1,o=null,a=!1,l=!1){this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=e.outShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.isVec4=((e.inChannels%4===0||e.inChannels%3===0)&&this.isChannelsLast||e.outWidth%4===0&&!this.isChannelsLast)&&e.outChannels%4===0,this.dispatchLayout=this.isChannelsLast?{x:[3],y:[1,2],z:[0]}:{x:[2,3],y:[1],z:[0]},this.workgroupSize=FX(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=zX(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4?(this.outputComponent=4,this.isChannelsLast&&e.inChannels%4!==0?(this.innerElementSize=3,this.variableComponents=[1,4]):(this.innerElementSize=4,this.variableComponents=[4,4]),s&&(this.variableNames.push("bias"),this.variableComponents.push(4)),a&&(this.variableNames.push("preluActivationWeights"),this.variableComponents.push(4))):(this.innerElementSize=this.elementsPerThread[0],s&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights")),this.sequentialAccessByThreads=l,this.addBias=s,this.activation=o,this.hasPreluActivationWeights=a,this.tileAOuter=this.workgroupSize[1]*this.elementsPerThread[1],this.tileBOuter=this.workgroupSize[0]*this.elementsPerThread[0],this.tileInner=Math.max(this.workgroupSize[0]*this.innerElementSize,this.workgroupSize[1]),this.fitAOuter=t%this.tileAOuter===0,this.fitBOuter=r%this.tileBOuter===0,this.fitInner=i%this.tileInner===0,this.shaderKey=`conv2DMM_${this.elementsPerThread}_${this.activation}}_${this.fitAOuter}_${this.fitBOuter}_${this.fitInner}_${this.isVec4}_${this.innerElementSize}_${this.isChannelsLast}_${this.sequentialAccessByThreads}`}getUserCode(){const e=this.isVec4?A2(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner):N2(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner,!1,null,this.sequentialAccessByThreads),t=this.isVec4?[this.innerElementSize,4,4]:[1,1,1];return`
    ${jDe(this.isChannelsLast,this.fitAOuter,this.fitBOuter,this.fitInner,this.addBias,this.activation,this.hasPreluActivationWeights,t[0],t[1],t[2])}
    ${e}
  `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WDe{constructor(e,t=!1,r=null,i=!1){this.variableNames=["x","W"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>,",this.workgroupSize=[4,4,8],this.outputShape=e.outShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.dispatchLayout=this.isChannelsLast?{x:[2],y:[1],z:[0,3]}:{x:[3],y:[2],z:[0,1]},this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=t,this.activation=r,this.hasPreluActivationWeights=i,t&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.shaderKey=`conv2dnaive_${this.activation}_${this.isChannelsLast}`}getUserCode(){return`
       ${Jc(this.activation,this.hasPreluActivationWeights,!1,4)}
       fn readInp(batch : i32, row : i32, col : i32, chan : i32) -> f32{
         let coords = vec4<i32>(batch, row, col, chan);
         if (coordsInBounds4D(coords, uniforms.xShape)) {
           return  getX(batch, row, col, chan);
         } else {
          return 0.0;
         }
       }
       fn readFilt(row : i32, col : i32, xChannel : i32, outChannel : i32) -> f32{
         let coords = vec4<i32>(row, col, xChannel, outChannel);
         if(coordsInBounds4D(coords, uniforms.wShape)) {
           return getW(row, col, xChannel, outChannel);
          } else {
            return 0.0;
          }
       }
       fn writeResult(batch : i32, row : i32, col : i32, chan : i32, valueIn : f32) {
         let coords = ${this.isChannelsLast?"vec4<i32>(batch, row, col, chan);":"vec4<i32>(batch, chan, row, col);"}
         if (coordsInBounds4D(coords, uniforms.outShape)) {
           var value = valueIn;
           ${Of(this.addBias,this.activation)}
           setOutputAtCoords(coords.x, coords.y, coords.z, coords.w, value);
         }
       }
       ${vt("index")} {
         let coords = getOutputCoords();
         let batch = coords[0];
         let outChannel = ${this.isChannelsLast?"coords[3];":"coords[1];"}
         let outRow = ${this.isChannelsLast?"coords[1];":"coords[2];"}
         let outCol = ${this.isChannelsLast?"coords[2];":"coords[3];"}
         var acc : f32 = 0.0;
         for (var row = 0; row < uniforms.filterDims[0]; row = row + 1) {
           for (var col = 0; col < uniforms.filterDims[1]; col = col + 1) {
             let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * row - uniforms.pads[0];
             let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * col - uniforms.pads[1];
             for (var xChannel = 0; xChannel < ${this.isChannelsLast?"uniforms.xShape[3];":"uniforms.xShape[1];"} xChannel = xChannel + 1) {
               ${this.isChannelsLast?"let v = readInp(batch, xRow, xCol, xChannel);":"let v = readInp(batch, xChannel, xRow, xCol);"}
               let f = readFilt(row, col, xChannel, outChannel);
               acc = acc + v * f;
             }
           }
         }
         writeResult(batch, outRow, outCol, outChannel, acc);
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HDe{constructor(e,t){this.variableNames=["x"],this.uniforms=`pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, outWidth : i32, itemsPerBlockRow : i32,
       inChannels : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=t,this.shaderKey=`im2col_${this.isChannelsLast}`}getUserCode(){const e=this.isChannelsLast?1:2,t=this.isChannelsLast?2:3,r=this.isChannelsLast?"coords[1]":"coords[2]",i=this.isChannelsLast?"coords[2]":"coords[1]",s=this.isChannelsLast?"getX(batch, xRow, xCol, ch)":"getX(batch, ch, xRow, xCol)";return`
    ${vt("index")} {
      let coords = getCoordsFromIndex(index);
      if(index < uniforms.size) {
        let batch = coords[0];
        let row = ${r};
        let col = ${i};
        let offsetY = (row / uniforms.outWidth) * uniforms.strides[0] - uniforms.pads[0];
        let xRow = offsetY + uniforms.dilations[0] * (col / uniforms.itemsPerBlockRow);
        var value = 0.0;
        if(xRow < uniforms.xShape[${e}] && xRow >= 0) {
          let offsetX = (row % uniforms.outWidth) * uniforms.strides[1] -
              uniforms.pads[1];
          let xCol = offsetX + uniforms.dilations[1] * ((col %
              uniforms.itemsPerBlockRow) / uniforms.inChannels);
          let ch = col % uniforms.inChannels;
          if(xCol < uniforms.xShape[${t}] && xCol >= 0) {
            value = ${s};
          }
        }
        setOutputAtIndex(index, value);
      }
    }
   `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qS(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function GDe({x:n,filter:e,convInfo:t,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:a=null}){const l=t.dataFormat==="channelsLast",c=!l,u=!1,d=l&&t.filterHeight===t.inHeight&&t.filterWidth===t.inWidth&&t.padInfo.type==="VALID",h=[];let f,p;if(d){const y=t.inHeight*t.inWidth*t.inChannels;f=Ht({inputs:{x:n},backend:r,attrs:{shape:[1,t.batchSize,y]}}),p=Ht({inputs:{x:e},backend:r,attrs:{shape:[1,y,t.outChannels]}})}else f=Ht({inputs:{x:n},backend:r,attrs:{shape:l?[t.batchSize,t.inHeight*t.inWidth,t.inChannels]:[t.batchSize,t.inChannels,t.inHeight*t.inWidth]}}),p=Ht({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}});if(h.push(f),h.push(p),s!=null){const y=qS(s.shape,l);y!=null&&(s=Ht({inputs:{x:s},backend:r,attrs:{shape:y}}),h.push(s))}if(i!=null){const y=qS(i.shape,l);y!=null&&(i=Ht({inputs:{x:i},backend:r,attrs:{shape:y}}),h.push(i))}const x=k2({a:l?f:p,b:l?p:f,transposeA:c,transposeB:u,backend:r,bias:i,activation:a,preluActivationWeights:s,leakyreluAlpha:o}),v=Ht({inputs:{x},backend:r,attrs:{shape:t.outShape}});h.push(x);for(const y of h)r.disposeData(y.dataId);return v}function qDe({x:n,filter:e,convInfo:t,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,strideWidth:d,strideHeight:h,padInfo:f,outWidth:p,outHeight:x,dilationWidth:v,dilationHeight:y,dataFormat:b}=t,S=b==="channelsLast",_=l*c*u,T=x*p,M=S?[t.batchSize,T,_]:[t.batchSize,_,T],k=new HDe(M,S),P=[{type:"int32",data:[f.top,f.left]},{type:"int32",data:[h,d]},{type:"int32",data:[y,v]},{type:"int32",data:[p]},{type:"int32",data:[u*l]},{type:"int32",data:[u]}],z=r.runWebGPUProgram(k,[n],n.dtype,P),I=[];I.push(z);const L=Ht({inputs:{x:e},backend:r,attrs:{shape:[1,_,-1]}});if(I.push(L),s!=null){const Y=qS(s.shape,S);Y!=null&&(s=Ht({inputs:{x:s},backend:r,attrs:{shape:Y}}),I.push(s))}if(i!=null){const Y=qS(i.shape,S);Y!=null&&(i=Ht({inputs:{x:i},backend:r,attrs:{shape:Y}}),I.push(i))}const $=k2({a:S?z:L,b:S?L:z,transposeA:!S,transposeB:!1,backend:r,bias:i,activation:a,preluActivationWeights:s,leakyreluAlpha:o}),ne=Ht({inputs:{x:$},backend:r,attrs:{shape:t.outShape}});I.push($);for(const Y of I)r.disposeData(Y.dataId);return ne}function QX({x:n,filter:e,convInfo:t,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:a=null}){const l=i!=null,c=s!=null,u=t.dataFormat==="channelsLast",d=u&&t.filterHeight===t.inHeight&&t.filterWidth===t.inWidth&&t.padInfo.type==="VALID",h=rn().getBool("WEBGPU_USE_NAIVE_CONV2D_DEBUG");if(!h&&(d||t.filterHeight===1&&t.filterWidth===1&&t.dilationHeight===1&&t.dilationWidth===1&&t.strideHeight===1&&t.strideWidth===1&&(t.padInfo.type==="SAME"||t.padInfo.type==="VALID")))return GDe({x:n,filter:e,convInfo:t,backend:r,bias:i,activation:a,preluActivationWeights:s,leakyreluAlpha:o});const f=rn().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),p=f>-1?f:r.thresholdToIncreaseWorkgroups,x=t.batchSize*Math.ceil(t.outHeight*t.outWidth/32)*Math.ceil(t.outChannels/32);if(rn().getBool("WEBGPU_CONV_SEPARATE_IM2COL_SHADER")||x<=p)return qDe({x:n,filter:e,convInfo:t,backend:r,bias:i,preluActivationWeights:s,leakyreluAlpha:o,activation:a});let v;const y=[t.padInfo.top,t.padInfo.left],b=[{type:"int32",data:[t.filterHeight,t.filterWidth]},{type:"int32",data:[...y]},{type:"int32",data:[t.strideHeight,t.strideWidth]},{type:"int32",data:[t.dilationHeight,t.dilationWidth]}];if(h)v=new WDe(t,l,a,c);else{const M=u?t.outHeight*t.outWidth:t.outChannels,k=u?t.outChannels:t.outHeight*t.outWidth,P=t.filterHeight*t.filterWidth*t.inChannels;b.push({type:"int32",data:[M]},{type:"int32",data:[k]},{type:"int32",data:[P]});const z=r.adapterInfo.isIntel();v=new VDe(t,M,k,P,l,a,c,z)}const S=[],_=[n,e];l&&(!u&&i.shape.length===1&&(i=Ht({inputs:{x:i},backend:r,attrs:{shape:[i.shape[0],1,1]}}),S.push(i)),_.push(i)),c&&(!u&&s.shape.length===1&&(s=Ht({inputs:{x:s},backend:r,attrs:{shape:[s.shape[0],1,1]}}),S.push(s)),_.push(s)),a==="leakyrelu"&&(b.push({type:"float32",data:[o]}),v.uniforms+=" alpha : f32,");const T=r.runWebGPUProgram(v,_,n.dtype,b);for(const M of S)r.disposeData(M.dataId);return T}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XDe(n){const{inputs:e,attrs:t,backend:r}=n,{x:i,filter:s}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=t,d=Rg(l),h=Ia(i.shape,s.shape,o,c,a,u,!1,d);return QX({x:i,filter:s,convInfo:h,backend:r})}const KDe={kernelName:H8,backendName:"webgpu",kernelFunc:XDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YDe{constructor(e){this.variableNames=["dy","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>,",this.workgroupSize=[64,1,1],this.size=!1,this.isVec4=!1,this.workPerThread=1,this.outputShape=e.inShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.isVec4=this.isChannelsLast&&e.outChannels%4===0&&e.inChannels%4===0,this.isVec4?(this.workPerThread=2,this.outputComponent=4,this.workgroupSize=[4,4,4],this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize,[4,this.workPerThread,1])):(this.size=!0,this.workPerThread=1,this.workgroupSize=[64,1,1],this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize)),this.shaderKey=`conv2DDerInput_${this.isChannelsLast}_${this.isVec4}_${this.workPerThread}`}getUserCode(){const e=this.isChannelsLast?1:2,t=this.isChannelsLast?2:3,r=this.isChannelsLast?3:1,i=`
    ${vt()} {
      let batch = i32(globalId.z) / uniforms.outShape[1];
      let r = i32(globalId.z) % uniforms.outShape[1];
      let c = i32(globalId.y) * ${this.workPerThread};
      let d1 = i32(globalId.x) * 4;

      let dyCorner = vec2<i32>(r, c) - uniforms.pads;

      // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
      // ? = to be determined. : = across all values in that axis.
      var dotProd: array<vec4<f32>, ${this.workPerThread}>;
      for (var i = 0; i < ${this.workPerThread}; i++) {
        dotProd[i] = vec4<f32>(0.0);
      }
      for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {
        let dyR = f32(dyCorner.x + wR) / f32(uniforms.strides.x);
        let wRPerm = uniforms.filterDims.x - 1 - wR;
        if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) ||
            fract(dyR) > 0.0) {
          continue;
        }
        let idyR = i32(dyR);

        for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {
          let dyC = f32(dyCorner.y + wC) / f32(uniforms.strides.y);
          let dyC2 = f32(dyCorner.y + 1 + wC) / f32(uniforms.strides.y);
          let wCPerm = uniforms.filterDims.y - 1 - wC;
          var bDyCVal = true;
          var bDyCVal2 = true;
          if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||
              fract(dyC) > 0.0) {
            bDyCVal = false;
          }
          if (dyC2 < 0.0 || dyC2 >= f32(uniforms.outBackprop[2]) ||
              fract(dyC2) > 0.0) {
            bDyCVal2 = false;
          }

          let idyC = i32(dyC);
          let idyC2 = i32(dyC2);
          if (bDyCVal && bDyCVal2) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[0] = dotProd[0] + tmpval;
              xValue = getDy(batch, idyR, idyC2, d2);
              dotProd[1] = dotProd[1] + vec4<f32>(dot(xValue, wValue0),
                                                  dot(xValue, wValue1),
                                                  dot(xValue, wValue2),
                                                  dot(xValue, wValue3));
            }
          } else if (bDyCVal) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[0] = dotProd[0] + tmpval;
            }
          } else if (bDyCVal2) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC2, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[1] = dotProd[1] + tmpval;
            }
          }
        }
      }

      for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
        let coords = vec4<i32>(batch, r, c + i, d1);
        if (coordsInBounds4D(coords, uniforms.outShape)) {
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], dotProd[i]);
        }
      }
    }
    `;return this.isVec4?`
    ${i}
    `:`
    ${vt("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d1 = coords[${r}];

        let dyCorner = vec2<i32>(coords[${e}], coords[${t}]) - uniforms.pads;
        let dyRCorner = dyCorner.x;
        let dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {
          let dyR = (f32(dyRCorner) + f32(wR)) / f32(uniforms.strides.x);
          let wRPerm = uniforms.filterDims.x - 1 - wR;
          if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) || fract(dyR) > 0.0 ||
              wRPerm < 0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {
            let dyC = (f32(dyCCorner) + f32(wC)) / f32(uniforms.strides.y);
            let wCPerm = uniforms.filterDims.y - 1 - wC;
            if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||
                fract(dyC) > 0.0 || wCPerm < 0) {
              continue;
            }
            let idyC = i32(dyC);

            for (var d2 = 0; d2 < uniforms.outBackprop[3]; d2 = d2 + 1) {
              let xValue = ${this.isChannelsLast?"getDy(batch, idyR, idyC, d2)":"getDy(batch, d2, idyR, idyC)"};
              let wValue = getW(wRPerm, wCPerm, d1, d2);
              dotProd = dotProd + xValue * wValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}}class ZDe{constructor(e){this.variableNames=["x","dy"],this.uniforms="pads : vec2<i32>, strides : vec2<i32>, batchSize : i32, outHeight : i32, outWidth : i32, inHeight : i32, inWidth : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=e.dataFormat==="channelsLast",this.shaderKey=`conv2DDerFilter_${this.isChannelsLast}`}getUserCode(){return`
    ${vt("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wR = coords[0];
        let wC = coords[1];
        let d1 = coords[2];
        let d2 = coords[3];

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b = b + 1) {
          for (var yR = 0; yR < uniforms.outHeight; yR = yR + 1) {
            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];
            if (xR < 0 || xR >= uniforms.inHeight) {
              continue;
            }

            for (var yC = 0; yC < uniforms.outWidth; yC = yC + 1) {
              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];

              if (xC < 0 || xC >= uniforms.inWidth) {
                continue;
              }

              if (${this.isChannelsLast}) {
                let dyValue = getDy(b, yR, yC, d2);
                let xValue = getX(b, xR, xC, d1);
                dotProd = dotProd + xValue * dyValue;
              } else {
                let dyValue = getDy(b, d2, yR, yC);
                let xValue = getX(b, d1, xR, xC);
                dotProd = dotProd + xValue * dyValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}}class QDe{constructor(e){this.variableNames=["x","dy"],this.uniforms=`pads : vec3<i32>, strides : vec3<i32>, batchSize : i32, outDepth : i32,
       outHeight : i32, outWidth : i32, inDepth : i32, inHeight : i32, inWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerFilter"}getUserCode(){return`
    ${vt("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wF = coords.x;
        let wR = coords.y;
        let wC = coords.z;
        let d1 = coords.w;
        let d2 = coords.u;

        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b++) {
          for (var yF = 0; yF < uniforms.outDepth; yF++) {
            let xF = wF + yF * uniforms.strides[0] - uniforms.pads[0];
            if (xF < 0 || xF >= uniforms.inDepth) {
              continue;
            }

            for (var yR = 0; yR < uniforms.outHeight; yR++) {
              let xR = wR + yR * uniforms.strides[1] - uniforms.pads[1];
              if (xR < 0 || xR >= uniforms.inHeight) {
                continue;
              }

              for (var yC = 0; yC < uniforms.outWidth; yC++) {
                let xC = wC + yC * uniforms.strides[2] - uniforms.pads[2];
                if (xC < 0 || xC >= uniforms.inWidth) {
                  continue;
                }

                let dyValue = getDy(b, yF, yR, yC, d2);
                let xValue = getX(b, xF, xR, xC, d1);
                dotProd += xValue * dyValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}}class JDe{constructor(e){this.variableNames=["dy","W"],this.uniforms=`filterDims : vec3<i32>, pads : vec3<i32>, strides : vec3<i32>,
      outDepth : i32, outHeight : i32, outWidth : i32, outChannels : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerInput"}getUserCode(){return`
    ${vt("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let d1 = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyFCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        var dotProd = 0.0;
        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {
          let dyF = f32(dyFCorner + wF) / f32(uniforms.strides[0]);
          if (dyF < 0.0 || dyF >= f32(uniforms.outDepth) || fract(dyF) > 0.0) {
            continue;
          }
          let idyF = i32(dyF);

          let wFPerm = uniforms.filterDims[0] - 1 - wF;

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            let wRPerm = uniforms.filterDims[1] - 1 - wR;

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let wCPerm = uniforms.filterDims[2] - 1 - wC;

              for (var d2 = 0; d2 < uniforms.outChannels; d2++) {
                let xValue = getDy(batch, idyF, idyR, idyC, d2);
                let wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eLe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,dy:s}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=r,d=Rg(l),h=Ia(i.shape,u,o,1,a,c,!1,d),f=new ZDe(h),p=[{type:"int32",data:[h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.batchSize]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]},{type:"int32",data:[h.inHeight]},{type:"int32",data:[h.inWidth]}];return t.runWebGPUProgram(f,[i,s],i.dtype,p)}const tLe={kernelName:G8,backendName:"webgpu",kernelFunc:eLe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nLe(n=4){const e=s=>{switch(s){case 1:return"return W[getIndexFromCoords4D(coord, uniforms.wShape)];";case 4:return`
            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);
            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);
            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);
            let v0 = W[getIndexFromCoords4D(coord, uniforms.wShape)];
            let v1 = W[getIndexFromCoords4D(coord1, uniforms.wShape)];
            let v2 = W[getIndexFromCoords4D(coord2, uniforms.wShape)];
            let v3 = W[getIndexFromCoords4D(coord3, uniforms.wShape)];
            return vec4<f32>(v0, v1, v2, v3);
            `;default:throw new Error(`innerElementSize ${s} is not supported.`)}},r=`if (row < uniforms.dimAOuter && col < uniforms.dimInner) {
        ${`
      let outRow = row / uniforms.outShape[2];
      let outCol = row % uniforms.outShape[2];

      let WRow = col / (uniforms.filterDims[1] * uniforms.outBackprop[3]);
      let WCol = col / uniforms.outBackprop[3] % uniforms.filterDims[1];
      let xR = f32(outRow - uniforms.pads[0] + WRow) / f32(uniforms.strides[0]);
      let xC = f32(outCol - uniforms.pads[1] + WCol) / f32(uniforms.strides[1]);
      if (xR < 0.0 || xR >= f32(uniforms.outBackprop[1]) || fract(xR) > 0.0) {
        return ${Mn(n)}(0.0);
      }
      if (xC < 0.0 || xC >= f32(uniforms.outBackprop[2]) || fract(xC) > 0.0) {
        return ${Mn(n)}(0.0);
      }
      let coord = vec4<i32>(
          batch,
          i32(xR),
          i32(xC),
          col % uniforms.outBackprop[3]);
      return x[getIndexFromCoords4D(coord, uniforms.xShape)/${n}];`}
      }
      return ${Mn(n)}(0.0);`;return`
  fn mm_readA(batch: i32, row : i32, col : i32) -> ${Mn(n)} {
    ${r}
  }

  fn mm_readB(batch: i32, row : i32, col : i32) -> ${Mn(n)} {
    let coordX = uniforms.filterDims.x - 1 -
        row / (uniforms.filterDims[1] * uniforms.outBackprop[3]);
    let coordY = uniforms.filterDims.y - 1 -
        (row / uniforms.outBackprop[3]) % uniforms.filterDims[1];
    if (row < uniforms.dimInner && col < uniforms.dimBOuter &&
        coordX >= 0 && coordY >= 0) {
      let rowInner = row % uniforms.outBackprop[3];
      let coord = vec4<i32>(coordX, coordY, col, rowInner);
      ${e(n)}
    }
    return ${Mn(n)}(0.0);
  }

  fn mm_write(batch: i32, row : i32, col : i32, valueInput : ${Mn(n)}) {
    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {
      var value = valueInput;
      let outCoord = vec4<i32>(
          batch,
          row / uniforms.outShape[2],
          row % uniforms.outShape[2],
          col);
      result[getIndexFromCoords4D(outCoord, uniforms.outShape)/${n}] = value;
    }
  }`}class rLe{constructor(e){this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=e.inShape,te(e.dataFormat==="channelsLast",()=>"TODO: NCHW is unimplemented"),this.isVec4=e.inChannels%4===0&&e.outChannels%4===0,this.dispatchLayout={x:[3],y:[1,2],z:[0]},this.workgroupSize=FX(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=zX(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4&&(this.outputComponent=4,this.variableComponents=[4,1]),this.shaderKey=`conv2DDerInputMM_${this.isVec4}_${this.elementsPerThread}`}getUserCode(){const e=this.isVec4?A2(this.elementsPerThread,this.workgroupSize):N2(this.elementsPerThread,this.workgroupSize);return`
    ${nLe(this.isVec4?4:1)}
    ${e}
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iLe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:i,filter:s}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=r,d=Rg(c),h=Ia(o,s.shape,a,1,l,u,!1,d),f=[{type:"int32",data:[h.filterHeight,h.filterWidth]},{type:"int32",data:[h.filterHeight-1-h.padInfo.top,h.filterWidth-1-h.padInfo.left]},{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.batchSize,h.outHeight,h.outWidth,h.outChannels]}];let p;if(rn().getBool("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE")||h.dataFormat!=="channelsLast")p=new YDe(h);else{p=new rLe(h);const x=h.inHeight*h.inWidth,v=h.inChannels,y=h.filterHeight*h.filterWidth*h.outChannels;f.push({type:"uint32",data:[x]},{type:"uint32",data:[v]},{type:"uint32",data:[y]})}return t.runWebGPUProgram(p,[i,s],"float32",f)}const sLe={kernelName:q8,backendName:"webgpu",kernelFunc:iLe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oLe{constructor(e){this.variableNames=["x","W"],this.uniforms="filterDims: vec3<i32>, pads: vec3<i32>, strides: vec3<i32>, dilations: vec3<i32>,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3dnaive"}getUserCode(){return`
    ${vt("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let batch = coords.x;
        let d2 = coords.u;

        let xFRCCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;
        let xFCorner = xFRCCorner.x;
        let xRCorner = xFRCCorner.y;
        let xCCorner = xFRCCorner.z;

        let inputDepthNearestVec4 = (uniforms.xShape.u / 4) * 4;
        let inputDepthVec4Remainder = uniforms.xShape.u % 4;

        var dotProd = 0.0;
        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {
          let xF = xFCorner + wF * uniforms.dilations[0];
          if (xF < 0 || xF >= uniforms.xShape.y) {
            continue;
          }

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let xR = xRCorner + wR * uniforms.dilations[1];
            if (xR < 0 || xR >= uniforms.xShape.z) {
              continue;
            }

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let xC = xCCorner + wC * uniforms.dilations[2];
              if (xC < 0 || xC >= uniforms.xShape.w) {
                continue;
              }

              for (var d1 = 0; d1 < inputDepthNearestVec4; d1 += 4) {
                let xValues = vec4<f32>(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                let wValues = vec4<f32>(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (inputDepthVec4Remainder == 1) {
                dotProd += getX(batch, xF, xR, xC, inputDepthNearestVec4) *
                  getW(wF, wR, wC, inputDepthNearestVec4, d2);
              } else if (inputDepthVec4Remainder == 2) {
                let xValues = vec2<f32>(
                  getX(batch, xF, xR, xC, inputDepthNearestVec4),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1)
                );
                let wValues = vec2<f32>(
                  getW(wF, wR, wC, inputDepthNearestVec4, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (inputDepthVec4Remainder == 3) {
                let xValues = vec3<f32>(
                  getX(batch, xF, xR, xC, inputDepthNearestVec4),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2)
                );
                let wValues = vec3<f32>(
                  getW(wF, wR, wC, inputDepthNearestVec4, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }`}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aLe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,filter:s}=e,{strides:o,pad:a,dilations:l}=r,c=w2(i.shape,s.shape,o,l,a),u=[c.padInfo.front,c.padInfo.top,c.padInfo.left],d=[{type:"int32",data:[c.filterDepth,c.filterHeight,c.filterWidth]},{type:"int32",data:[...u]},{type:"int32",data:[c.strideDepth,c.strideHeight,c.strideWidth]},{type:"int32",data:[c.dilationDepth,c.dilationHeight,c.dilationWidth]}],h=new oLe(c),f=vd(i.dtype,s.dtype);return t.runWebGPUProgram(h,[i,s],f,d)}const lLe={kernelName:X8,backendName:"webgpu",kernelFunc:aLe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cLe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,dy:s}=e,{strides:o,pad:a,filterShape:l}=r,c=w2(i.shape,l,o,1,a),u=new QDe(c),d=[{type:"int32",data:[c.padInfo.front,c.padInfo.top,c.padInfo.left]},{type:"int32",data:[c.strideDepth,c.strideHeight,c.strideWidth]},{type:"int32",data:[c.batchSize]},{type:"int32",data:[c.outDepth]},{type:"int32",data:[c.outHeight]},{type:"int32",data:[c.outWidth]},{type:"int32",data:[c.inDepth]},{type:"int32",data:[c.inHeight]},{type:"int32",data:[c.inWidth]}];return t.runWebGPUProgram(u,[i,s],s.dtype,d)}const uLe={kernelName:Jxe,backendName:"webgpu",kernelFunc:cLe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dLe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:i,filter:s}=e,{strides:o,pad:a,inputShape:l}=r,c=w2(l,s.shape,o,1,a),u=new JDe(c),d=[{type:"int32",data:[c.filterDepth,c.filterHeight,c.filterWidth]},{type:"int32",data:[c.filterDepth-1-c.padInfo.front,c.filterHeight-1-c.padInfo.top,c.filterWidth-1-c.padInfo.left]},{type:"int32",data:[c.strideDepth,c.strideHeight,c.strideWidth]},{type:"int32",data:[c.outDepth]},{type:"int32",data:[c.outHeight]},{type:"int32",data:[c.outWidth]},{type:"int32",data:[c.outChannels]}];return t.runWebGPUProgram(u,[i,s],i.dtype,d)}const hLe={kernelName:K8,backendName:"webgpu",kernelFunc:dLe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fLe=er({opType:ft.COS}),pLe={kernelName:Y8,backendName:"webgpu",kernelFunc:fLe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mLe=er({opType:ft.COSH}),gLe={kernelName:Z8,backendName:"webgpu",kernelFunc:mLe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yLe{constructor(e,t,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.uniforms="extrapolationValue : f32,",this.workgroupSize=[64,1,1],this.size=!0;const[s]=t;this.outputShape=[s,r[0],r[1],e],this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.methodId=i==="bilinear"?1:0,this.cropHeightBiggerThan1=this.outputShape[1]>1,this.cropWidthBiggerThan1=this.outputShape[2]>1,this.shaderKey=`cropAndResize_${this.methodId}_${this.cropHeightBiggerThan1}_${this.cropWidthBiggerThan1}`}getUserCode(){const[e,t]=["f32(uniforms.imageShape[1] - 1)","f32(uniforms.imageShape[2] - 1)"],[r,i,s]=this.cropHeightBiggerThan1?[`(${e} / f32(uniforms.outShape[1] - 1))`,"(y2-y1) * height_ratio",`y1*${e} + f32(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${e}`],[o,a,l]=this.cropWidthBiggerThan1?[`(${t} / f32(uniforms.outShape[2] - 1))`,"(x2-x1) * width_ratio",`x1*${t} + f32(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${t}`];return`
    ${vt("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let height_ratio = f32(${r});
        let width_ratio = f32(${o});
        let b = coords[0];
        let y = coords[1];
        let x = coords[2];
        let d = coords[3];
        // get box vals
        let y1 = getBoxes(b, 0);
        let x1 = getBoxes(b, 1);
        let y2 = getBoxes(b, 2);
        let x2 = getBoxes(b, 3);
        // get image in batch index
        let bInd = i32(round(getBoxInd(b)));
        if(bInd < 0 || bInd >= uniforms.outShape[0]) {
          return;
        }
        let height_scale = ${i};
        let width_scale = ${a};
        let in_y = ${s};
        if( in_y < 0.0 || in_y > ${e} ) {
          setOutputAtIndex(index, uniforms.extrapolationValue);
          return;
        }
        let in_x = ${l};
        if( in_x < 0.0 || in_x > ${t} ) {
          setOutputAtIndex(index, uniforms.extrapolationValue);
          return;
        }
        let sourceFracIndexCR = vec2<f32>(in_x,in_y);
        if(${this.methodId} == 1) {
          // Compute the four integer indices.
          let sourceFloorCR = vec2<i32>(sourceFracIndexCR);
          let sourceCeilCR = vec2<i32>(ceil(sourceFracIndexCR));
          let topLeft = getImage(bInd, sourceFloorCR.y, sourceFloorCR.x, d);
          let bottomLeft = getImage(bInd, sourceCeilCR.y, sourceFloorCR.x, d);
          let topRight = getImage(bInd, sourceFloorCR.y, sourceCeilCR.x, d);
          let bottomRight = getImage(bInd, sourceCeilCR.y, sourceCeilCR.x, d);
          let fracCR = sourceFracIndexCR - vec2<f32>(sourceFloorCR);
          let top = topLeft + (topRight - topLeft) * fracCR.x;
          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          let newValue = top + (bottom - top) * fracCR.y;
          setOutputAtIndex(index, newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          let sourceNearestCR = vec2<i32>(floor(
            sourceFracIndexCR + vec2<f32>(0.5,0.5)));
          let newValue = getImage(
            bInd, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutputAtIndex(index, newValue);
        }
      }
    }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vLe=n=>{const{inputs:e,backend:t,attrs:r}=n,{image:i,boxes:s,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=r,u=new yLe(i.shape[3],s.shape,a,l),d=[{type:"float32",data:[c]}];return t.runWebGPUProgram(u,[i,s,o],"float32",d)},xLe={kernelName:e9,backendName:"webgpu",kernelFunc:vLe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var z0;(function(n){n.Prod="*",n.Sum="+"})(z0||(z0={}));class v4{constructor(e,t,r,i){this.variableNames=["x"],this.uniforms="index : f32,",this.size=!0,this.workgroupSize=[128,1,1],this.outputShape=t,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.exclusive=r,this.reverse=i,this.op=e,this.shaderKey=`cum_${this.op}_${this.exclusive}_${this.reverse}`}getUserCode(){const e=this.outputShape.length,t=this.op===z0.Prod?"1.0":"0.0",r=this.exclusive?t:`getX(${x4(e,"coords",this.op)})`,i=this.outputShape[this.outputShape.length-1];let s="",o="";return this.exclusive?(s=this.reverse?`end != ${i-1}`:"end != 0",o=this.reverse?"end + 1":"end - 1"):(s=this.reverse?`end + pow2 < ${i}`:"end >= pow2",o=this.reverse?"end + pow2":"end - pow2"),`
      ${vt("index")} {
       if (index < uniforms.size) {
         var coords = getCoordsFromIndex(index);

         let end = ${w4(e,"coords",this.op)};
         var val = ${r};
         let pow2 = i32(pow(2.0, uniforms.index));
         if (${s}) {
           let idx = ${o};
           ${w4(e,"coords",this.op)} = idx;
           val ${this.op}= getX(${x4(e,"coords",this.op)});
         }
         setOutputAtIndex(index, val);
       }
      }
    `}}function x4(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function w4(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw Error(`Cumulative ${t} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JX(n,e,t,r,i,s){const o=e.shape.length,a=Sx([r],o);let l=e;a!=null&&(l=Xl({inputs:{x:e},backend:t,attrs:{perm:a}}));const c=_x(1,o)[0];if(c!==o-1)throw new Error(`WebGPU cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const u=l.shape[c];let d=Co({inputs:{x:l},backend:t});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const f=new v4(n,l.shape,!1,s),p=d,x=[{type:"float32",data:[h]}];d=t.runWebGPUProgram(f,[d],d.dtype,x),t.disposeData(p.dataId)}if(i){const h=new v4(n,l.shape,i,s),f=d,p=[{type:"float32",data:[0]}];d=t.runWebGPUProgram(h,[d],d.dtype,p),t.disposeData(f.dataId)}if(a!=null){const h=Vq(a),f=Xl({inputs:{x:d},backend:t,attrs:{perm:h}});return t.disposeData(d.dataId),t.disposeData(l.dataId),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wLe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:s,exclusive:o,reverse:a}=r;return JX(z0.Prod,i,t,s,o,a)}const bLe={kernelName:Q8,backendName:"webgpu",kernelFunc:wLe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SLe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:s,exclusive:o,reverse:a}=r;return JX(z0.Sum,i,t,s,o,a)}const _Le={kernelName:J8,backendName:"webgpu",kernelFunc:SLe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ELe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,weights:s}=e,{size:o,binaryOutput:a}=r,l=i.shape.length===1,u=gt(s.shape)>0,d=s.dtype,h=l?[i.shape[0]]:[i.shape[0],i.shape[1]],f=l?[o]:[i.shape[0],o],p=Xs({backend:t,attrs:{shape:f,value:0,dtype:d}}),x=new KX(h,u,a),v=[{type:"int32",data:[o]}],y=u?[i,s]:[i];return t.runWebGPUProgram(x,y,d,v,p)}const CLe={kernelName:t9,backendName:"webgpu",kernelFunc:ELe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TLe{constructor(e,t){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.uniforms="blockSize : i32,",this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`depthToSpace_${t}`,this.dataFormat=t}getUserCode(){return`
      ${vt("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let h = ${this.getHeightCoordString()};
          let w = ${this.getWidthCoordString()};
          let d = ${this.getDepthCoordString()};

          let in_h = h / uniforms.blockSize;
          let offset_h = h % uniforms.blockSize;
          let in_w = w / uniforms.blockSize;
          let offset_w = w % uniforms.blockSize;
          let offset_d = (offset_h * uniforms.blockSize + offset_w) *
            ${this.getOutputDepthSize()};
          let in_d = d + offset_d;

          let rlt = ${this.getInputSamplingString()};
          setOutputAtIndex(index, rlt);
        }
      }`}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?"uniforms.outShape[3]":"uniforms.outShape[1]"}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MLe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{blockSize:s,dataFormat:o}=r,a=i.shape[0],l=o==="NHWC"?i.shape[1]:i.shape[2],c=o==="NHWC"?i.shape[2]:i.shape[3],u=o==="NHWC"?i.shape[3]:i.shape[1],d=l*s,h=c*s,f=u/(s*s),p=o==="NHWC"?[a,d,h,f]:[a,f,d,h],x=[{type:"int32",data:[s]}],v=new TLe(p,o);return t.runWebGPUProgram(v,[i],i.dtype,x)}const ALe={kernelName:n9,backendName:"webgpu",kernelFunc:MLe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NLe{constructor(e,t,r,i=!1,s=null,o=!1){this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>,",this.workgroupSize=[16,16,1],this.outputShape=e,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.addBias=i,this.activation=s,this.hasPreluActivation=o,this.filterHeight=t,this.filterWidth=r,this.shaderKey=`depthwiseNCHW_${this.activation}_${this.filterHeight}_${this.filterWidth}`}getUserCode(){const e=this.filterWidth*this.filterHeight,t=this.workgroupSize[0]*this.workgroupSize[1]*this.workgroupSize[2],r=this.workgroupSize[1]+this.filterHeight-1,i=this.workgroupSize[0]+this.filterWidth-1;return`
      ${Jc(this.activation,this.hasPreluActivation,!1,4)}

      var<workgroup> mm_Asub : array<array<f32, ${i}>, ${r}>;
      var<workgroup> mm_Bsub : array<array<f32, ${this.filterWidth}>, ${this.filterHeight}>;
      fn readX(batch : i32, channel : i32, row : i32, col : i32) -> f32 {
        var value = 0.0;
        if (row >=0 && row < uniforms.inDims[0] && col >=0 && col < uniforms.inDims[1])
        {
          value = getX(batch, channel, row, col);
        }
        return value;
      }

      ${vt()} {
        let coords = getOutputCoords();
        let batch = coords[0];
        let xRCCorner = vec2<i32>(coords.zw) - uniforms.pads;
        let channelMul = uniforms.wShape[3];
        let d1 = coords[1] / channelMul;
        let q = coords[1] % channelMul;

        let inputRowStart = xRCCorner.x;
        let inputColStart = xRCCorner.y;

        let localRow = i32(localId.y);
        let localCol = i32(localId.x);

        // Load one tile of X into local memory.
        for (var inputRow = localRow; inputRow < ${r}; inputRow = inputRow + ${this.workgroupSize[1]}) {
          for (var inputCol = localCol; inputCol < ${i}; inputCol = inputCol + ${this.workgroupSize[0]}) {
            let rowOffset = inputRow - localRow;
            let colOffset = inputCol - localCol;
            mm_Asub[inputRow][inputCol] = readX(batch, d1, inputRowStart + rowOffset, inputColStart + colOffset);
          }
        }

        // Load one tile of W into local memory.
        var wIndex = i32(localIndex);
        ${e<t?`if (wIndex < ${e})`:`for(; wIndex < ${e}; wIndex = wIndex + ${t})`}

        {
          let wRow = wIndex / ${this.filterWidth};
          let wCol = wIndex % ${this.filterWidth};
          mm_Bsub[wRow][wCol] = getW(wRow, wCol, d1, q);
        }

        workgroupBarrier();

        var value = 0.0;
        for (var wR = 0; wR < ${this.filterHeight}; wR = wR + 1) {
          for (var wC = 0; wC < ${this.filterWidth}; wC = wC + 1) {
            let xVal = mm_Asub[localRow + wR][localCol + wC];
            let wVal = mm_Bsub[wR][wC];
            value = fma(xVal, wVal, value);
          }
        }
        ${Of(this.addBias,this.activation)}
        if (coordsInBounds4D(coords, uniforms.outShape)) {
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eK{constructor(e,t=!1,r=null,i=!1){this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>, virtualWidth : i32,",this.workgroupSize=[64,1,1],this.workPerThread=4,this.outputComponent=4,this.outputShape=e.outShape,this.virtualWidth=Math.ceil(this.outputShape[2]/this.workPerThread)*this.workPerThread;const s=[this.outputShape[0],this.outputShape[1],this.virtualWidth,this.outputShape[3]];this.dispatchLayout=Nt(s),this.dispatch=xt(this.dispatchLayout,s,this.workgroupSize,[this.outputComponent*this.workPerThread,1,1]),te(e.dataFormat==="channelsLast",()=>"TODO: NCHW is unimplemented"),t&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.convInfo=e,this.addBias=t,this.activation=r,this.hasPreluActivation=i,this.shaderKey=`depthwiseVec4_${r}_${this.convInfo.filterHeight}_${this.convInfo.filterWidth}_${this.convInfo.strideHeight}_${this.convInfo.strideWidth}_${this.workPerThread}`}getUserCode(){const e=(this.workPerThread-1)*this.convInfo.strideWidth+this.convInfo.filterWidth,t=this.convInfo.strideHeight,r=this.convInfo.strideWidth;return`
      ${Jc(this.activation,this.hasPreluActivation,!0,4)}
      fn readX(batch : i32, row : i32, col : i32, channel : i32) -> vec4<f32> {
        var value = vec4<f32>(0.0);
        if (col >=0 && col < uniforms.inDims[1]) {
          value = getX(batch, row, col, channel);
        }
        return value;
      }

      ${vt("index")} {
        let width0 = uniforms.outShape[3] / ${this.outputComponent};
        let d1 = (index % width0) * ${this.outputComponent};
        var index1 = index / width0;
        let width1 = uniforms.virtualWidth / ${this.workPerThread};
        let c = (index1 % width1) * ${this.workPerThread};
        index1 = index1 / width1;
        let r = index1 % uniforms.outShape[1];
        let batch = index1 / uniforms.outShape[1];

        let xRCCorner = vec2<i32>(r, c) * vec2<i32>(${t}, ${r}) - uniforms.pads;

        let xRCorner = xRCCorner.x;
        let xCCorner = xRCCorner.y;
        var xVals : array<vec4<f32>, ${e}>;
        var dotProd : array<vec4<f32>, ${this.workPerThread}>;
        for (var i = 0; i < ${this.workPerThread}; i++) {
          dotProd[i] = vec4<f32>(0.0);
        }

        // Use constant instead of uniform can give better performance.
        for (var wR = 0; wR < ${this.convInfo.filterHeight}; wR = wR + 1) {
          let xR = xRCorner + wR;
          if (xR >=0 && xR < uniforms.inDims[0]) {
            for (var i = 0; i < ${e}; i++) {
              xVals[i] = readX(batch, xR, xCCorner + i, d1);
            }
            for (var wC = 0; wC < ${this.convInfo.filterWidth}; wC = wC + 1) {
              let wValue = getW(wR, wC, d1, 0);
              for (var i = 0; i < ${this.workPerThread}; i++) {
                dotProd[i] = fma(xVals[i * ${r} + wC], wValue, dotProd[i]);
              }
            }
          }
        }

        for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let coords = vec4<i32>(batch, r, c + i, d1);
          if (coordsInBounds4D(coords, uniforms.outShape)) {
            var value = dotProd[i];
            ${Of(this.addBias,this.activation)}
            setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
          }
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tK{constructor(e,t=!1,r=null,i=!1){this.variableNames=["x","W"],this.uniforms=`pads : vec2<i32>, inDims : vec2<i32>, filterHeight : i32,
      filterWidth : i32, strides : vec2<i32>, dilations : vec2<i32>,`,this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=e.dataFormat==="channelsLast",t&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.convInfo=e,this.addBias=t,this.activation=r,this.hasPreluActivation=i,this.shaderKey=`depthwise_${this.activation}_${this.isChannelsLast}`}getUserCode(){const e=this.isChannelsLast?"getX(batch, xR, xC, d1);":"getX(batch, d1, xR, xC);";return`
      ${Jc(this.activation,this.hasPreluActivation,!1,4)}

      ${vt("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let batch = coords[0];
          let xRCCorner = vec2<i32>(coords.${this.isChannelsLast?"yz":"zw"}) * uniforms.strides - uniforms.pads;
          let d2 = coords[${this.isChannelsLast?3:1}];
          let channelMul = uniforms.wShape[3];
          let d1 = d2 / channelMul;
          let q = d2 % channelMul;

          let inputRowStart = xRCCorner.x;
          let inputColStart = xRCCorner.y;
          let inputRowEnd = inputRowStart + uniforms.filterHeight *
              uniforms.dilations[0];
          let inputColEnd = inputColStart + uniforms.filterWidth *
              uniforms.dilations[1];

          // Convolve x(?, ?, d1)|x(d1, ?, ?) with w(:, :, d1, q) to get
          // y(yR, yC, d2)|y(d2, yR, yC). ? = to be determined. : = across all
          // values in that axis. x(?, ?, d1) and y(yR, yC, d2) is for NHWC.
          // x(d1, ?, ?) and y(d2, yR, yC) is for NCHW.
          var value = 0.0;

          // Extract if checking out of for loop for performance.
          if (inputRowStart >= 0 && inputColStart >= 0 &&
            inputRowEnd < uniforms.inDims[0] &&
                inputColEnd < uniforms.inDims[1]) {
              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {
                let xR = inputRowStart + wR * uniforms.dilations[0];

                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {
                  let xC = inputColStart + wC * uniforms.dilations[1];

                  let xVal = ${e};
                  let wVal = getW(wR, wC, d1, q);
                  value = value + xVal * wVal;
                }
              }
            } else {
              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {
                let xR = inputRowStart + wR * uniforms.dilations[0];

                if (xR < 0 || xR >= uniforms.inDims[0]) {
                  continue;
                }

                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {
                  let xC = inputColStart + wC * uniforms.dilations[1];

                  if (xC < 0 || xC >= uniforms.inDims[1]) {
                    continue;
                  }

                  let xVal = ${e};
                  let wVal = getW(wR, wC, d1, q);
                  value = value + xVal * wVal;
                }
              }
            }
            ${Of(this.addBias,this.activation)}
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kLe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,filter:s}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=r,d=Rg(l);let h=c;h==null&&(h=[1,1]);const f=Ia(i.shape,s.shape,o,h,a,u,!0,d),p=[{type:"int32",data:[f.padInfo.top,f.padInfo.left]},{type:"int32",data:[f.inHeight,f.inWidth]}],x=f.dataFormat==="channelsLast";let v;return!x&&f.inHeight>16&&f.inWidth>16&&f.strideHeight===1&&f.strideWidth===1&&f.dilationWidth===1&&f.dilationHeight===1&&f.inChannels===f.outChannels?v=new NLe(f.outShape,f.filterHeight,f.filterWidth):x&&f.outHeight>4&&f.outWidth>4&&f.strideWidth<=2&&f.inChannels===f.outChannels&&f.dilationHeight===1&&f.dilationWidth===1&&f.inChannels%4===0?(v=new eK(f),p.push({type:"int32",data:[v.virtualWidth]})):(v=new tK(f),p.push({type:"int32",data:[f.filterHeight]},{type:"int32",data:[f.filterWidth]},{type:"int32",data:[f.strideHeight,f.strideWidth]},{type:"int32",data:[f.dilationHeight,f.dilationWidth]})),t.runWebGPUProgram(v,[i,s],i.dtype,p)}const ILe={kernelName:r9,backendName:"webgpu",kernelFunc:kLe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RLe{constructor(e){this.variableNames=["x","dy"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>, outHeight : i32,
      outWidth : i32, inHeight : i32, inWidth : i32, batchSize : i32, channelMul : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_filter"}getUserCode(){return`
      ${vt("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wR = coords[0];
        let wC = coords[1];
        let d1 = coords[2];
        let dm = coords[3];
        let d2 = d1 * uniforms.channelMul + dm;

        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b++) {
          for (var yR = 0; yR < uniforms.outHeight; yR++) {
            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];

            if (xR < 0 || xR >= uniforms.inHeight) {
              continue;
            }

            for (var yC = 0; yC < uniforms.outWidth; yC++) {
              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];

              if (xC < 0 || xC >= uniforms.inWidth) {
                continue;
              }

              let dyValue = getDy(b, yR, yC, d2);
              let xValue = getX(b, xR, xC, d1);
              dotProd += xValue * dyValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}}class PLe{constructor(e){this.variableNames=["dy","W"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32, channelMul : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_input"}getUserCode(){return`
      ${vt("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d1 = coords[3];
        let dyCorner = coords.yz - uniforms.pads;
        let dyRCorner = dyCorner.x;
        let dyCCorner = dyCorner.y;

        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }

          let idyR = i32(dyR);
          let wRPerm = uniforms.filterDims[0] - 1 - wR;

          for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }

            let idyC = i32(dyC);
            let wCPerm = uniforms.filterDims[1] - 1 - wC;

            for (var dm = 0; dm < uniforms.channelMul; dm++) {
              let d2 = d1 * uniforms.channelMul + dm;
              let xValue = getDy(batch, idyR, idyC, d2);
              let wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DLe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,dy:s}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=r,d=Ia(i.shape,u,o,a,l,c,!0),h=new RLe(d),f=[{type:"int32",data:[d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.filterHeight,d.filterWidth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"int32",data:[d.inHeight]},{type:"int32",data:[d.inWidth]},{type:"int32",data:[d.batchSize]},{type:"int32",data:[d.outChannels/d.inChannels]}];return t.runWebGPUProgram(h,[i,s],"float32",f)}const LLe={kernelName:i9,backendName:"webgpu",kernelFunc:DLe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OLe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:i,filter:s}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=r,d=Ia(u,s.shape,o,a,l,c,!0),h=new PLe(d),f=[{type:"int32",data:[d.strideHeight,d.strideWidth]},{type:"int32",data:[d.filterHeight-1-d.padInfo.top,d.filterWidth-1-d.padInfo.left]},{type:"int32",data:[d.filterHeight,d.filterWidth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"int32",data:[d.outChannels/d.inChannels]}];return t.runWebGPUProgram(h,[i,s],i.dtype,f)}const FLe={kernelName:s9,backendName:"webgpu",kernelFunc:OLe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zLe{constructor(e){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,e],this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="diag"}getUserCode(){return`
      ${vt("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let value = select(0.0, getX(coords[0]), coords[0] == coords[1]);
          setOutputAtIndex(index, value);
        }
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ULe(n){const{inputs:e,backend:t}=n,{x:r}=e,i=[...r.shape,...r.shape],s=gt(r.shape),o=Ht({inputs:{x:r},backend:t,attrs:{shape:[s]}}),a=new zLe(s),l=t.runWebGPUProgram(a,[o],o.dtype),c=Ht({inputs:{x:l},backend:t,attrs:{shape:i}});return t.disposeData(o.dataId),t.disposeData(l.dataId),c}const BLe={kernelName:o9,backendName:"webgpu",kernelFunc:ULe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Le{constructor(e){this.variableNames=["x","w"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="dilation2d"}getUserCode(){return`
       ${vt("index")} {
         if (index < uniforms.size) {
           let neg_infinity = -3.4e38;
           let coords = getOutputCoords();
           let batch = coords.x;
           let d1 = coords.w;
           let outTopLeftCorner = coords.yz * uniforms.strides - uniforms.pads;
           let hBeg = outTopLeftCorner.x;
           let wBeg = outTopLeftCorner.y;

           var curVal = neg_infinity;
           for (var h = 0; h < uniforms.filterDims[0]; h = h + 1) {
             let hIn = hBeg + h * uniforms.dilations[0];

             if (hIn >= 0 && hIn < uniforms.xShape[1]) {
               for (var w = 0; w < uniforms.filterDims[1]; w = w + 1) {
                 let wIn = wBeg + w * uniforms.dilations[1];

                 if (wIn >= 0 && wIn < uniforms.xShape[2]) {
                   let val = getX(batch, hIn, wIn, d1) + getW(h, w, d1);
                   if (val > curVal) {
                     curVal = val;
                   }
                 }
               }
             }
           }

           setOutputAtIndex(index, curVal);
         }
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jLe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,filter:s}=e,{strides:o,pad:a,dilations:l}=r,c=e3(i.shape,s.shape,o,a,"NHWC",l),u=[c.padInfo.top,c.padInfo.left],d=[{type:"int32",data:[c.filterHeight,c.filterWidth]},{type:"int32",data:[...u]},{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]}],h=new $Le(c);return t.runWebGPUProgram(h,[i,s],i.dtype,d)}const VLe={kernelName:a9,backendName:"webgpu",kernelFunc:jLe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WLe{constructor(e,t){if(this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e.inShape,this.dispatchLayout=Nt(e.outShape),this.dispatch=xt(this.dispatchLayout,e.outShape,this.workgroupSize),t!=="float32"&&t!=="int32")throw new Error(`Dilation2DBackpropInput only supports float32 and int32
          types, does not support ${t} type.`);this.type=t,this.shaderKey="dilation2DBackpropInput"}getUserCode(){return`
       ${vt("index")} {
         if (index < uniforms.dySize) {
           let coords = getDyCoordsFromIndex(index);
           let b = coords[0];
           let r = coords[1];
           let c = coords[2];
           let d = coords[3];

           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;
           var curVal = -3.4e38;  // neg_infinity
           var xRMax = 0;
           var xCMax = 0;

           // In the case of multiple argmax branches, we only back-propagate
           // along the last branch, i.e., the one with largest value of
           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling
           // backward routines.
           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
             let xR = dyCorner.x + wR * uniforms.dilations[0];

             if (xR >= 0 && xR < uniforms.xShape[1]) {
               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
                 let xC = dyCorner.y + wC * uniforms.dilations[1];

                 if (xC >= 0 && xC < uniforms.xShape[2]) {
                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);
                   if (val > curVal) {
                     curVal = val;
                     xRMax = xR;
                     xCMax = xC;
                   }
                 }
               }
             }
           }

           let flatIndexIn = d + uniforms.xShape[3] *
               (xCMax + uniforms.xShape[2] * (xRMax + uniforms.xShape[1] * b));
           let value = getDy(b, r, c, d);
           ${Ld("&result[flatIndexIn]","value",this.type)}
         }
       }
     `}}class HLe{constructor(e,t,r){if(this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e.filterShape,this.dispatchLayout=Nt(e.outShape),this.dispatch=xt(this.dispatchLayout,e.outShape,this.workgroupSize),r!=="float32"&&r!=="int32")throw new Error(`Dilation2DBackpropFilter only supports float32 and int32
          types, does not support ${r} type.`);this.type=r,this.shaderKey="dilation2DBackpropFilter"}getUserCode(){return`
       ${vt("index")} {
         if (index < uniforms.dySize) {
           let coords = getDyCoordsFromIndex(index);
           let b = coords[0];
           let r = coords[1];
           let c = coords[2];
           let d = coords[3];

           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;
           var curVal = -3.4e38;  // neg_infinity
           var wRMax = 0;
           var wCMax = 0;

           // In the case of multiple argmax branches, we only back-propagate
           // along the last branch, i.e., the one with largest value of
           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling
           // backward routines.
           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
             let xR = dyCorner.x + wR * uniforms.dilations[0];

             if (xR >= 0 && xR < uniforms.xShape[1]) {
               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
                 let xC = dyCorner.y + wC * uniforms.dilations[1];

                 if (xC >= 0 && xC < uniforms.xShape[2]) {
                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);
                   if (val > curVal) {
                     curVal = val;
                     wRMax = wR;
                     wCMax = wC;
                   }
                 }
               }
             }
           }

           let flatIndexIn = d + uniforms.wShape[2] * (wCMax + wRMax * uniforms.wShape[1]);
           let value = getDy(b, r, c, d);
           ${Ld("&result[flatIndexIn]","value",this.type)}
         }
       }
     `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GLe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,filter:s,dy:o}=e,{strides:a,pad:l,dilations:c}=r,u=e3(i.shape,s.shape,a,l,"NHWC",c),d=s.dtype,h=new HLe(u,s.shape,d),f=[{type:"int32",data:[u.filterHeight,u.filterWidth]},{type:"int32",data:[u.padInfo.top,u.padInfo.left]},{type:"int32",data:[u.strideHeight,u.strideWidth]},{type:"int32",data:[u.dilationHeight,u.dilationWidth]},{type:"int32",data:[gt(u.outShape)]}],p=Xs({backend:t,attrs:{shape:s.shape,value:0,dtype:d}});return t.runWebGPUProgram(h,[i,s,o],d,f,p)}const qLe={kernelName:twe,backendName:"webgpu",kernelFunc:GLe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XLe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,filter:s,dy:o}=e,{strides:a,pad:l,dilations:c}=r,u=e3(i.shape,s.shape,a,l,"NHWC",c),d=i.dtype,h=new WLe(u,d),f=[{type:"int32",data:[u.filterHeight,u.filterWidth]},{type:"int32",data:[u.padInfo.top,u.padInfo.left]},{type:"int32",data:[u.strideHeight,u.strideWidth]},{type:"int32",data:[u.dilationHeight,u.dilationWidth]},{type:"int32",data:[gt(u.outShape)]}],p=Xs({backend:t,attrs:{shape:u.inShape,value:0,dtype:d}});return t.runWebGPUProgram(h,[i,s,o],d,f,p)}const KLe={kernelName:ewe,backendName:"webgpu",kernelFunc:XLe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YLe{constructor(e,t,r){this.variableNames=["Image"],this.uniforms="alpha: f32,",this.workgroupSize=[64,1,1],this.pixelsOpType=ig.DRAW,this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.type=t,this.textureFormat=r,this.shaderKey=`draw_${t}_${r}`}getUserCode(){let e;const t=this.type==="float32"?"value":"value / 255.0";return e=`
      if (uniforms.numChannels == 1) {
        rgba[0] = ${t};
        rgba[1] = ${t};
        rgba[2] = ${t};
      } else {
        rgba[d] = ${t};
      }`,`
       @group(0) @binding(0) var outImage : texture_storage_2d<${this.textureFormat}, write>;
       ${vt("index")} {
         if (index < uniforms.size) {
           var rgba = vec4<f32>(0.0, 0.0, 0.0, uniforms.alpha);
           for (var d = 0; d < uniforms.numChannels; d = d + 1) {
             let value = f32(inBuf[index * uniforms.numChannels + d]);
             ${e}
           }
           rgba.x = rgba.x * rgba.w;
           rgba.y = rgba.y * rgba.w;
           rgba.z = rgba.z * rgba.w;
           let coords = getCoordsFromIndex(index);
           textureStore(outImage, vec2<i32>(coords.yx), rgba);
         }
       }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use backend file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZLe(n){const{inputs:e,backend:t,attrs:r}=n,{image:i}=e,{canvas:s,options:o}=r,[a,l]=i.shape.slice(0,2),{imageOptions:c}=o||{},u=(c==null?void 0:c.alpha)||1,d=t.device.features.has("bgra8unorm-storage")?"bgra8unorm":"rgba8unorm",h=[a,l],f=new YLe(h,i.dtype,d);s.width=l,s.height=a;const p="webgpu";let x=s.getContext(p),v;x||(v=new OffscreenCanvas(l,a),x=v.getContext(p));const y=i.shape.length===3?i.shape[2]:1;x.configure({device:t.device,format:d,usage:GPUTextureUsage.STORAGE_BINDING,alphaMode:"premultiplied"});const b="int32",S=t.makeTensorInfo(h,b),_=t.tensorMap.get(S.dataId);_.resource=x.getCurrentTexture(),_.external=!0;const T=[{type:"uint32",data:[y]},{type:"float32",data:[u]}];if(t.runWebGPUProgram(f,[i],b,T,S),v){const M=s.getContext("2d");if(!M)throw new Error("Please make sure this canvas has only been used for 2d or webgpu context!");M.drawImage(v,0,0)}return t.disposeData(S.dataId),i}const QLe={kernelName:l9,backendName:"webgpu",kernelFunc:ZLe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nK=ji({opType:pn.MUL,cpuKernelImpl:rPe,supportsComplex:!0}),JLe={kernelName:J9,backendName:"webgpu",kernelFunc:nK};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rK(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:s,keepDims:o}=r;return zf(i,s,o,"sum",t)}const eOe={kernelName:D7,backendName:"webgpu",kernelFunc:rK};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tOe(n){const{inputs:e,backend:t,attrs:r}=n,{equation:i}=r,s=e,{allDims:o,summedDims:a,idDims:l}=DAe(i,s.length);OAe(o.length,l,s);const{path:c,steps:u}=FAe(a,l),d=u.length;let h=null,f=o.length;const p=[];for(let x=0;x<d;++x){for(const v of u[x]){const{permutationIndices:y,expandDims:b}=LAe(f,l[v]);let S;zAe(y)?S=s[v]:(S=Xl({inputs:{x:s[v]},backend:t,attrs:{perm:y}}),p.push(S));const _=S.shape.slice();for(let T=0;T<b.length;++T)_.splice(b[T],0,1);Zs(S.shape,_)||(S=Ht({inputs:{x:S},backend:t,attrs:{shape:_}}),p.push(S)),h===null?h=S:(h=nK({inputs:{a:S,b:h},backend:t}),p.push(h))}x<d-1&&(c[x]>=0&&(h=rK({inputs:{x:h},backend:t,attrs:{axis:c[x]-(o.length-f),keepDims:!1}}),p.push(h)),f--)}for(const x of p)x!==h&&t.disposeData(x.dataId);return h}const nOe={kernelName:u9,backendName:"webgpu",kernelFunc:tOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rOe=er({opType:ft.ELU}),iOe={kernelName:d9,backendName:"webgpu",kernelFunc:rOe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sOe=n=>{const{inputs:e,backend:t}=n,{dy:r,y:i}=e,s=new HS(pn.ELU_DER,r.shape,i.shape);return t.runWebGPUProgram(s,[r,i],r.dtype)},oOe={kernelName:nwe,backendName:"webgpu",kernelFunc:sOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aOe=ji({opType:pn.EQUAL,dtype:"bool",cpuKernelImpl:j3e}),lOe={kernelName:f9,backendName:"webgpu",kernelFunc:aOe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cOe=er({opType:ft.ERF}),uOe={kernelName:h9,backendName:"webgpu",kernelFunc:cOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dOe=er({opType:ft.EXP,cpuKernelImpl:V3e,dtype:"float32"}),hOe={kernelName:p9,backendName:"webgpu",kernelFunc:dOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HN(n){const{inputs:e,attrs:t,backend:r}=n,{dim:i}=t,{input:s}=e,o=s.shape.length,a=s.shape.slice();let l=i;return i<0&&(te(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),Ht({inputs:{x:s},backend:r,attrs:{shape:a}})}const fOe={kernelName:m9,backendName:"webgpu",kernelFunc:HN};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pOe=er({opType:ft.EXPM1,cpuKernelImpl:W3e}),mOe={kernelName:g9,backendName:"webgpu",kernelFunc:pOe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b4{constructor(e,t){this.variableNames=["real","imag"],this.outputShape=[],this.uniforms="exponentMultiplier : f32, denominator: f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.component=e,this.shaderKey=`fft_${e}`}getUserCode(){return`
    fn unaryOpComplex(real: f32, expR: f32, imag: f32, expI: f32) -> f32 {
      ${this.component==="real"?"return real * expR - imag * expI;":"return real * expI + imag * expR;"}
    }

    fn mulMatDFT(batch: i32, index: i32) -> f32 {
      let indexRatio = f32(index) / f32(uniforms.realShape[1]);
      let exponentMultiplierTimesIndexRatio =
          uniforms.exponentMultiplier * indexRatio;

      var result = 0.0;

      for (var i = 0; i < uniforms.realShape[1]; i = i + 1) {
        // x = (-2|2 * PI / N) * index * i;
        let x = exponentMultiplierTimesIndexRatio * f32(i);
        let expR = cos(x);
        let expI = sin(x);
        let real = getReal(batch, i);
        let imag = getImag(batch, i);

        result = result +
            unaryOpComplex(real, expR, imag, expI) / uniforms.denominator;
      }

      return result;
    }

    ${vt("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        setOutputAtIndex(index, mulMatDFT(coords[0], coords[1]));
      }
    }
  `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iK(n,e,t){const r=t.tensorMap.get(n.dataId),i=gt(n.shape),s=n.shape[n.shape.length-1],o=i/s,a=[],l=Ht({inputs:{x:n},backend:t,attrs:{shape:[o,s]}});a.push(l);const c=l.shape,u=new b4("real",c),d=new b4("imag",c),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:c},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:c}],f=e?2*Math.PI:-2*Math.PI,p=e?c[1]:1,x=[{type:"float32",data:[f]},{type:"float32",data:[p]}],v=t.runWebGPUProgram(u,h,"float32",x);a.push(v);const y=t.runWebGPUProgram(d,h,"float32",x);a.push(y);const b=Ff({inputs:{real:v,imag:y},backend:t});a.push(b);const S=Ht({inputs:{x:b},backend:t,attrs:{shape:n.shape}});return a.forEach(_=>t.disposeData(_.dataId)),S}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gOe(n){const{inputs:e,backend:t}=n,{input:r}=e;return iK(r,!1,t)}const yOe={kernelName:y9,backendName:"webgpu",kernelFunc:gOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vOe{constructor(e){this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="flipLeftRight"}getUserCode(){return`
      ${vt("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let coordX = uniforms.xShape[2] - coords[2] - 1;
          let outputValue = getX(coords[0], coords[1], coordX, coords[3]);
          setOutputAtIndex(index, outputValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xOe={kernelName:x9,backendName:"webgpu",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,r=e,i=new vOe(t.shape);return r.runWebGPUProgram(i,[t],t.dtype)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wOe=er({opType:ft.FLOOR,cpuKernelImpl:H3e}),bOe={kernelName:w9,backendName:"webgpu",kernelFunc:wOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SOe=ji({opType:pn.FLOOR_DIV,cpuKernelImpl:G3e,dtype:"int32"}),_Oe={kernelName:b9,backendName:"webgpu",kernelFunc:SOe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EOe{constructor(e,t,r=!1){this.pixelsOpType=ig.FROM_PIXELS,this.outputShape=[0],this.variableNames=[],this.workgroupSize=[256,1,1],this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize,[t,1,1]),this.importVideo=r,this.shaderKey=`fromPixels_${this.importVideo}`}getUserCode(){const e=this.importVideo?"textureLoad(src, vec2<i32>(coords.yx));":"textureLoad(src, vec2<i32>(coords.yx), 0)";return`
      @binding(1) @group(0) var src: ${this.importVideo?"texture_external":"texture_2d<f32>"};
      ${vt("index")} {
        let flatIndex = index * uniforms.numChannels;
        if (flatIndex < uniforms.size) {
          let coords = getCoordsFromIndex(flatIndex);
          let values = ${e};
          for (var i = 0; i < uniforms.numChannels; i = i + 1) {
            result[flatIndex + i] = i32(floor(255.0 * values[i]));
          }
        }
      }
  `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use backend file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const COe={kernelName:dN,backendName:"webgpu",kernelFunc:TOe};let Dp,_T=rn().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function TOe(n){const{inputs:e,backend:t,attrs:r}=n;let{pixels:i}=e;const{numChannels:s}=r;if(i==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");const o=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,l=typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas,c=typeof ImageBitmap<"u"&&i instanceof ImageBitmap,[u,d]=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],h=[d,u,s],f=rn().getBool("WEBGPU_IMPORT_EXTERNAL_TEXTURE")&&o,p=o||a;if(c||l||p){let b;if(f)b=t.device.importExternalTexture({source:i});else{if(p){const q=rn().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Dp==null||q!==_T)&&(_T=q,Dp=document.createElement("canvas").getContext("2d",{willReadFrequently:_T})),Dp.canvas.width=u,Dp.canvas.height=d,Dp.drawImage(i,0,0,u,d),i=Dp.canvas}const I=GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING,W=t.textureManager.acquireTexture(h[1],h[0],"rgba8unorm",I);t.queue.copyExternalImageToTexture({source:i},{texture:W},[h[1],h[0]]),b=W}const S=gt(h),_=os(h),T=new EOe(h,s,f),M=[{type:"uint32",data:[S]},{type:"uint32",data:[s]},{type:"uint32",data:[..._]}],k=t.makeTensorInfo([d,u],"int32"),P=t.tensorMap.get(k.dataId);P.resource=b;const z=t.runWebGPUProgram(T,[k],"int32",M);return t.disposeData(k.dataId),z}const x=i.data;let v=x;if(s!=null&&s!==4){v=new Uint8Array(i.width*i.height*s);const b=x.length;let S=0;for(let _=0;_<b;_++)_%4<s&&(v[S++]=x[_])}const y=t.makeTensorInfo(h,"int32",new Int32Array(v));return t.uploadToGPU(y.dataId),y}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MOe{constructor(e,t,r,i,s){this.uniforms="varianceEpsilon : f32,",this.workgroupSize=[128,1,1],this.size=!0,this.variableNames=["x","mean","variance"],_r(e,t),_r(e,r),this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),i!=null&&(_r(e,i),this.variableNames.push("offset")),s!=null&&(_r(e,s),this.variableNames.push("scale")),this.offsetShape=i,this.scaleShape=s,this.shaderKey="batchNorm"}getUserCode(){let e="0.0";this.offsetShape!=null&&(e="getOffsetByOutputIndex(index)");let t="1.0";return this.scaleShape!=null&&(t="getScaleByOutputIndex(index)"),`
      ${vt("index")} {
        if (index < uniforms.size)
        {
          let xValue = getXByOutputIndex(index);
          let meanValue = getMeanByOutputIndex(index);
          let varianValue = getVarianceByOutputIndex(index);
          let offsetValue = ${e};
          let scaleValue = ${t};
          let inv = scaleValue * inverseSqrt(varianValue + f32(uniforms.varianceEpsilon));
          setOutputAtIndex(index,dot(vec3<f32>(xValue, -meanValue, offsetValue), vec3<f32>(inv, inv, 1.0)));
        }
      }
  `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AOe={kernelName:S9,backendName:"webgpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r,scale:i,offset:s,mean:o,variance:a}=n,{varianceEpsilon:l}=e,c=t,u=[r,o,a];let d=null;s!=null&&(d=s.shape,u.push(s));let h=null;i!=null&&(h=i.shape,u.push(i));const f=new MOe(r.shape,o.shape,a.shape,d,h),p=[{type:"float32",data:[l]}];return c.runWebGPUProgram(f,u,r.dtype,p)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NOe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,filter:s,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=r,x=Rg(u),v=Ia(i.shape,s.shape,l,d,c,h,!1,x);return QX({x:i,filter:s,convInfo:v,backend:t,bias:o,preluActivationWeights:a,leakyreluAlpha:p,activation:f})}const kOe={kernelName:fN,backendName:"webgpu",kernelFunc:NOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IOe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,filter:s,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=r;let p=u;p==null&&(p=[1,1]),te(nc(l,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${p}'`);const x=Ia(i.shape,s.shape,l,p,c,d,!0),v=[i,s],y=o!=null,b=a!=null;y&&v.push(o),b&&v.push(a);const S=[{type:"int32",data:[x.padInfo.top,x.padInfo.left]},{type:"int32",data:[x.inHeight,x.inWidth]}];let _;return x.outHeight>4&&x.outWidth>4&&x.strideWidth<=2&&x.inChannels===x.outChannels&&x.dilationHeight===1&&x.dilationWidth===1&&x.inChannels%4===0?(_=new eK(x,y,h,b),S.push({type:"int32",data:[_.virtualWidth]})):(_=new tK(x,y,h,b),S.push({type:"int32",data:[x.filterHeight]},{type:"int32",data:[x.filterWidth]},{type:"int32",data:[x.strideHeight,x.strideWidth]},{type:"int32",data:[x.dilationHeight,x.dilationWidth]})),h==="leakyrelu"&&(S.push({type:"float32",data:[f]}),_.uniforms+=" alpha : f32,"),t.runWebGPUProgram(_,v,"float32",S)}const ROe={kernelName:pN,backendName:"webgpu",kernelFunc:IOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class POe{constructor(e,t){this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`gathernd_${e}`,this.sliceDim=e,this.uniforms=`sliceDim : i32, strides : ${pi(e)},`}getUserCode(){let e;return this.sliceDim>1?e="uniforms.strides[j]":e="uniforms.strides",`
      ${vt("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          var flattenIndex = 0;
          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {
            let indexTemp = i32(round(getIndices(coords[0], j)));
            let strideNum = ${e};
            flattenIndex = flattenIndex + indexTemp * strideNum;
          }

          setOutputAtIndex(index, getA(flattenIndex, coords[1]));
        }
      }
      `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DOe(n){const{inputs:e,backend:t}=n,{params:r,indices:i}=e,s=i.shape,o=s[s.length-1],a=gt(r.shape),[l,c,u,d]=lAe(r,i),h=Ht({inputs:{x:i},backend:t,attrs:{shape:[c,o]}}),f=Ht({inputs:{x:r},backend:t,attrs:{shape:[gt(r.shape)/u,u]}});if(t.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const b=t.readSync(i.dataId),S=t.bufferSync(r),_=q3e(b,S,r.dtype,c,o,u,d,r.shape,a);return t.makeTensorInfo(l,r.dtype,_.values)}const p=new POe(o,[c,u]),x=[{type:"int32",data:[o]},{type:"int32",data:d}],v=t.runWebGPUProgram(p,[f,h],f.dtype,x),y=Ht({inputs:{x:v},backend:t,attrs:{shape:l}});return t.disposeData(h.dataId),t.disposeData(f.dataId),t.disposeData(v.dataId),y}const LOe={kernelName:E9,backendName:"webgpu",kernelFunc:DOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OOe{constructor(e,t){this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.slice(),this.aShape=e,this.outputShape=t,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="gather"}getUserCode(){const e=FOe(this.aShape);return`
      ${vt("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          let indexZ = i32(getIndices(resRC.x, resRC.z));
          let inBounds = select(0.0, 1.0, indexZ >= 0 && indexZ < uniforms.aShape[2]);
          setOutputAtIndex(index, inBounds * getA(${e}));
        }
      }
    `}}function FOe(n){const e=["resRC.x","resRC.y","resRC.z","resRC.w"],t=[];for(let r=0;r<n.length;r++)r===2?t.push("indexZ"):t.push(`${e[r]}`);return t.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sK(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,indices:s}=e,{axis:o,batchDims:a}=r,l=ka(o,i.shape)[0],c=JAe(i,s,l,a),u=gt(s.shape),d=[],h=Ht({inputs:{x:i},backend:t,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=Ht({inputs:{x:s},backend:t,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(h),d.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(t.shouldExecuteOnCPU([i,s])){const S=t.tensorMap.get(f.dataId).values,_=Fr(f.shape,f.dtype,S),M=t.tensorMap.get(h.dataId).values,k=Fr(h.shape,h.dtype,M),P=X3e(k,_,p);return d.forEach(z=>t.disposeData(z.dataId)),t.makeTensorInfo(c.outputShape,P.dtype,P.values)}const x=new OOe(h.shape,p),v=t.runWebGPUProgram(x,[h,f],h.dtype);d.push(v);const y=Ht({inputs:{x:v},backend:t,attrs:{shape:c.outputShape}});return d.forEach(b=>t.disposeData(b.dataId)),y}const zOe={kernelName:_9,backendName:"webgpu",kernelFunc:sK};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UOe=ji({opType:pn.GREATER,cpuKernelImpl:Y3e,dtype:"bool"}),BOe={kernelName:C9,backendName:"webgpu",kernelFunc:UOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Oe=ji({opType:pn.GREATER_EQUAL,dtype:"bool",cpuKernelImpl:K3e}),jOe={kernelName:T9,backendName:"webgpu",kernelFunc:$Oe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VOe(n){const{inputs:e,backend:t}=n,{input:r}=e;return iK(r,!0,t)}const WOe={kernelName:M9,backendName:"webgpu",kernelFunc:VOe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HOe=er({opType:ft.IS_FINITE,dtype:"bool"}),GOe={kernelName:N9,backendName:"webgpu",kernelFunc:HOe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qOe=er({opType:ft.IS_INF,dtype:"bool"}),XOe={kernelName:k9,backendName:"webgpu",kernelFunc:qOe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KOe=er({opType:ft.IS_NAN,dtype:"bool"}),YOe={kernelName:I9,backendName:"webgpu",kernelFunc:KOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZOe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{alpha:s}=r,o=[{type:"float32",data:[s]}],a=new Lg(i.shape,ft.LEAKYRELU,"alpha : f32,");return t.runWebGPUProgram(a,[i],"float32",o)}const QOe={kernelName:R9,backendName:"webgpu",kernelFunc:ZOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JOe=ji({opType:pn.LESS,dtype:"bool",cpuKernelImpl:Q3e}),eFe={kernelName:P9,backendName:"webgpu",kernelFunc:JOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tFe=ji({opType:pn.LESS_EQUAL,dtype:"bool",cpuKernelImpl:Z3e}),nFe={kernelName:D9,backendName:"webgpu",kernelFunc:tFe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rFe{constructor(e){this.variableNames=[],this.outputShape=[],this.uniforms="start : f32, step : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e],this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="linSpace"}getUserCode(){return`
      ${vt("index")} {
        if (index < uniforms.size) {
          setOutputAtIndex(index, uniforms.start + f32(index) * uniforms.step);
        }
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iFe(n){const{backend:e,attrs:t}=n,{start:r,stop:i,num:s}=t,o=(i-r)/(s-1),a=new rFe(s),l=[{type:"float32",data:[r]},{type:"float32",data:[o]}];return e.runWebGPUProgram(a,[],"float32",l)}const sFe={kernelName:L9,backendName:"webgpu",kernelFunc:iFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oFe=er({opType:ft.LOG,cpuKernelImpl:J3e}),aFe={kernelName:O9,backendName:"webgpu",kernelFunc:oFe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lFe=er({opType:ft.LOG1P}),cFe={kernelName:F9,backendName:"webgpu",kernelFunc:lFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uFe=ji({opType:pn.LOGICAL_AND,dtype:"bool"}),dFe={kernelName:z9,backendName:"webgpu",kernelFunc:uFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hFe=er({opType:ft.LOGICAL_NOT}),fFe={kernelName:U9,backendName:"webgpu",kernelFunc:hFe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pFe=ji({opType:pn.LOGICAL_OR}),mFe={kernelName:B9,backendName:"webgpu",kernelFunc:pFe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oK=`
  var powValue = 0.0;
  let basis = uniforms.bias + uniforms.alpha * sum;
  if (uniforms.beta == 0.5) {
    powValue = inverseSqrt(basis);
  } else if (uniforms.beta == 1.0) {
    powValue = 1.0 / basis;
  } else {
    powValue = exp(log(basis) * (-uniforms.beta));
  }
`;class gFe{constructor(e){this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn"}getUserCode(){return`
    ${vt("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let b = coords[0];
        let r = coords[1];
        let c = coords[2];
        let d = coords[3];

        let x = getX(b, r, c, d);
        var sum = 0.0;
        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {
          let idx = d + i;
          if (idx >= 0 && idx < uniforms.xShape[3]) {
            let z = getX(b, r, c, idx);
            sum = sum + z * z;
          }
        }
        ${oK}

        setOutputAtIndex(index, x * powValue);
      }
    }
  `}}class yFe{constructor(e,t){this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[256,1,1],this.maxAllowRadius=16,te(t<=this.maxAllowRadius,()=>`Radius must be less than or equal to ${this.maxAllowRadius}, current radius is ${t}`),this.outputShape=e,this.elementsPerWorkgroup=this.workgroupSize[0]-2*this.maxAllowRadius,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=xt(this.dispatchLayout,this.outputShape,[this.elementsPerWorkgroup,this.workgroupSize[1],this.workgroupSize[2]]),this.shaderKey="lrn_shared"}getUserCode(){return`
    var <workgroup>lrnSub: array<f32, ${this.workgroupSize[0]}>;
    const elementsPerWorkgroup = ${this.elementsPerWorkgroup};
    const maxAllowRadius = ${this.maxAllowRadius};

    ${vt()} {
      let localDepth = i32(localId.x);
      let workgroupDepth = i32(workgroupId.x) * elementsPerWorkgroup;
      let xDepth = workgroupDepth + localDepth - maxAllowRadius;
      let b = i32(globalId.z) / uniforms.xShape[1];
      let r = i32(globalId.z) - b * uniforms.xShape[1];
      let c = i32(globalId.y);
      let d = workgroupDepth + localDepth;

      var x = 0.0;
      if (xDepth >= 0 && xDepth < uniforms.xShape[3]) {
        x = getX(b, r, c, xDepth);
      }
      lrnSub[localDepth] = x;
      workgroupBarrier();

      if (localDepth < elementsPerWorkgroup && d < uniforms.outShape[3]) {
        var sum = 0.0;
        let index = localDepth + maxAllowRadius;
        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {
          let z = lrnSub[index + i];
          sum = sum + z * z;
        }
        ${oK}

        setOutputAtCoords(b, r, c, d, lrnSub[index] * powValue);
      }
    } `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vFe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{depthRadius:s,bias:o,alpha:a,beta:l}=r;let c;s>16?c=new gFe(i.shape):c=new yFe(i.shape,s);const u=[{type:"int32",data:[s]},{type:"float32",data:[o]},{type:"float32",data:[a]},{type:"float32",data:[l]}];return t.runWebGPUProgram(c,[i],i.dtype,u)}const xFe={kernelName:$9,backendName:"webgpu",kernelFunc:vFe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wFe{constructor(e){this.outputShape=[],this.variableNames=["inputImage","outputImage","dy"],this.uniforms="depthRadius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn_grad"}getUserCode(){return`
    ${vt("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let b = coords[0];
        let r = coords[1];
        let c = coords[2];

        let MIN_DEPTH_BEGIN = 0;
        let MAX_DEPTH_END = uniforms.outShape[3];
        var result = 0.0;
        for (var d = MIN_DEPTH_BEGIN; d < MAX_DEPTH_END; d++) {
          let depthBegin = max(MIN_DEPTH_BEGIN, d - uniforms.depthRadius);
          let depthEnd = min(MAX_DEPTH_END, d + uniforms.depthRadius + 1);

          var norm = 0.0;
          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {
            if (k < depthBegin) {
              continue;
            } else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            } else {
              break;
            }
          }

          norm = uniforms.alpha * norm + uniforms.bias;

          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {
            if (k < depthBegin) {
              continue;
            } else if (k >= depthBegin && k < depthEnd) {
              var dyi = -2.0 * uniforms.alpha * uniforms.beta
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d) / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * uniforms.beta);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            } else {
              break;
            }
          }
        }

        setOutputAtIndex(index, result);
      }
    }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bFe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,y:s,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=r,d=new wFe(i.shape),h=[{type:"int32",data:[a]},{type:"float32",data:[l]},{type:"float32",data:[c]},{type:"float32",data:[u]}];return t.runWebGPUProgram(d,[i,s,o],i.dtype,h)}const SFe={kernelName:rwe,backendName:"webgpu",kernelFunc:bFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Fe=ji({opType:pn.MAX,cpuKernelImpl:tPe}),EFe={kernelName:V9,backendName:"webgpu",kernelFunc:_Fe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CFe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{filterSize:s,strides:o,pad:a,dimRoundingMode:l}=r,u=Ig(i.shape,s,o,1,a,l);return XX(i,u,"max",t)}const TFe={kernelName:W9,backendName:"webgpu",kernelFunc:CFe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MFe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{filterSize:s,strides:o,pad:a,dataFormat:l,dimRoundingMode:c}=r,u=[1,1,1],d=x2(i.shape,s,o,u,a,c,l),h=new N3(d,"max"),f=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.front,d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.inDepth,d.inHeight,d.inWidth]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]}];return t.runWebGPUProgram(h,[i],i.dtype,f)}const AFe={kernelName:H9,backendName:"webgpu",kernelFunc:MFe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NFe{constructor(e){this.variableNames=["dy","maxPos"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool2DBackprop"}getUserCode(){return`
      ${vt("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d = coords[3];

        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;
        let dyRCorner = dyRCCorner.x;
        let dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] - 1;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR += uniforms.dilations[0]) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims[1]; wC += uniforms.dilations[1]) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }
            let idyC = i32(dyC);

            let dyValue = getDy(batch, idyR, idyC, d);
            let maxPosValue = lastIndex - i32(getMaxPos(batch, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            let curPosValue = wR * uniforms.filterDims[1] + wC;
            let mask = select(0.0, 1.0, maxPosValue == curPosValue);
            dotProd += dyValue * mask;
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}}class kFe{constructor(e){this.variableNames=["dy","maxPos"],this.uniforms=`strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,
      outDepth : i32, outHeight : i32, outWidth : i32`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool3DBackprop"}getUserCode(){return`
      ${vt("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let ch = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyDCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] * uniforms.filterDims[2] - 1;

        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {
          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);

          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {
            continue;
          }
          let idyD = i32(dyD);

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let dyValue = getDy(batch, idyD, idyR, idyC, ch);
              let maxPosValue = lastIndex - i32(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              let curPosValue = wD * uniforms.filterDims[1] * uniforms.filterDims[2] + wR * uniforms.filterDims[2] + wC;
              let mask = select(0.0, 1.0, maxPosValue == curPosValue);
              dotProd += dyValue * mask;
            }
          }
        }

        setOutputAtIndex(index, dotProd);
      }
    }
    `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IFe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:i,input:s}=e,o=s,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=r,d=[1,1,1],h=x2(o.shape,a,l,d,c,u),f=new N3(h,"max",!0);let p=[{type:"int32",data:[h.strideDepth,h.strideHeight,h.strideWidth]},{type:"int32",data:[h.padInfo.front,h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.inDepth,h.inHeight,h.inWidth]},{type:"int32",data:[h.effectiveFilterDepth,h.effectiveFilterHeight,h.effectiveFilterWidth]}];const x=t.runWebGPUProgram(f,[o],"int32",p),v=new kFe(h);p=[{type:"int32",data:[h.strideDepth,h.strideHeight,h.strideWidth]},{type:"int32",data:[h.effectiveFilterDepth-1-h.padInfo.front,h.effectiveFilterHeight-1-h.padInfo.top,h.effectiveFilterWidth-1-h.padInfo.left]},{type:"int32",data:[h.effectiveFilterDepth,h.effectiveFilterHeight,h.effectiveFilterWidth]},{type:"int32",data:[h.outDepth]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]}];const y=t.runWebGPUProgram(v,[i,x],o.dtype,p);return t.disposeData(x.dataId),y}const RFe={kernelName:swe,backendName:"webgpu",kernelFunc:IFe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PFe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:i,input:s,output:o}=e,a=s;BX([s,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=r,h=Ig(a.shape,l,c,1,u,d),f=new F0(h,"max",!0);let p=[{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.dilationHeight,h.dilationWidth]},{type:"int32",data:[h.inHeight,h.inWidth]},{type:"int32",data:[h.effectiveFilterHeight,h.effectiveFilterWidth]}];const x=t.runWebGPUProgram(f,[a],"int32",p),v=new NFe(h);p=[{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.effectiveFilterHeight-1-h.padInfo.top,h.effectiveFilterWidth-1-h.padInfo.left]},{type:"int32",data:[h.dilationHeight,h.dilationWidth]},{type:"int32",data:[h.effectiveFilterHeight,h.effectiveFilterWidth]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]}];const y=t.runWebGPUProgram(v,[i,x],a.dtype,p);return t.disposeData(x.dataId),y}const DFe={kernelName:iwe,backendName:"webgpu",kernelFunc:PFe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LFe(n){const{inputs:e,backend:t,attrs:r}=n,{filterSize:i,strides:s,pad:o,includeBatchInIndex:a}=r,{x:l}=e;te(l.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${l.shape.length}.`);const c=[1,1];te(nc(s,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);const u=Ig(l.shape,i,s,c,o),d=[{type:"int32",data:[u.strideHeight,u.strideWidth]},{type:"int32",data:[u.padInfo.top,u.padInfo.left]},{type:"int32",data:[u.dilationHeight,u.dilationWidth]},{type:"int32",data:[u.inHeight,u.inWidth]},{type:"int32",data:[u.effectiveFilterHeight,u.effectiveFilterWidth]}];let h=new F0(u,"max",!1);const f=t.runWebGPUProgram(h,[l],l.dtype,d);h=new F0(u,"max",!0,!0,a);const p=t.runWebGPUProgram(h,[l],"int32",d);return[f,p]}const OFe={kernelName:G9,backendName:"webgpu",kernelFunc:LFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FFe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:s,keepDims:o}=r;return zf(i,s,o,"min",t)}const zFe={kernelName:X9,backendName:"webgpu",kernelFunc:FFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UFe=ji({opType:pn.MIN,cpuKernelImpl:nPe}),BFe={kernelName:K9,backendName:"webgpu",kernelFunc:UFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Fe{constructor(e,t,r){this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.map((i,s)=>i[0]+e[s]+i[1]),this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=e,t.map((i,s)=>{this.uniforms+=` pad${s} : vec2<i32>,`}),this.offset=r==="reflect"?0:1,this.shaderKey=`mirrorPad_${r}`}getUserCode(){const e=this.xShape.length,t=this.xShape.map((c,u)=>`uniforms.pad${u}[0]`).join(","),r=this.xShape.map((c,u)=>`uniforms.pad${u}[0] + uniforms.xShape${e>1?`[${u}]`:""}`).join(","),i=e===1?"start":"start[i]",s=e===1?"end":"end[i]",o=e===1?"outC":"outC[i]",a=pi(e),l=e>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,e):"coords";return`
      ${vt("index")} {
        if (index < uniforms.size) {
          let start = ${a}(${t});
          let end = ${a}(${r});
          var outC = getCoordsFromIndex(index);
          for (var i = 0; i < ${e}; i = i + 1) {
            if (${o} < ${i}) {
              ${o} = ${i} * 2 - ${o} - ${this.offset};
            } else if(${o} >= ${s}) {
              ${o} = (${s} - 1) * 2 - ${o} + ${this.offset};
            }
          }
          let coords = outC - start;
          setOutputAtIndex(index, getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jFe={kernelName:Y9,backendName:"webgpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{paddings:i,mode:s}=e,o=t,a=i.map(u=>({type:"int32",data:[u[0],u[1]]})),l=new $Fe(r.shape,i,s);return o.runWebGPUProgram(l,[r],r.dtype,a)}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VFe=ji({opType:pn.MOD}),WFe={kernelName:Z9,backendName:"webgpu",kernelFunc:VFe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HFe{constructor(e,t){this.variableNames=["probs"],this.outputShape=[],this.uniforms="seed : f32, numOutcomes: i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,t],this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="multinomial"}getUserCode(){return`
    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    fn random (seed : f32, resultUV : vec2<f32>) -> f32 {
      let HASHSCALE1 = 443.8975;
      let p = resultUV * seed;
      var p3  = fract(vec3<f32>(p.xyx) * HASHSCALE1);
      p3 = p3 + dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${vt("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let batch = coords[0];

        let resUV = vec2<f32>(f32(coords[1]) / f32(uniforms.outShape[1]),
            f32(coords[0]) / f32(uniforms.outShape[0]));
        let r = random(uniforms.seed, resUV);
        var cdf = 0.0;
        for (var i = 0; i < uniforms.numOutcomes - 1; i = i + 1) {
          cdf = cdf + getProbs(batch, i);

          if (r < cdf) {
            setOutputAtIndexI32(index, i);
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutputAtIndexI32(index, uniforms.numOutcomes - 1);
      }
    }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GFe{constructor(e){this.variableNames=["logits"],this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=[this.outputShape[0],1,1],this.outputShape[1]>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.shaderKey="softmax"}getUserCode(){return`
    var<workgroup> buf : array<f32, ${this.workgroupSize[0]}>;
    var<workgroup> rowMaxShared : f32;
    var<workgroup> rowSumShared : f32;
    const blockSize = ${this.workgroupSize[0]};
    ${vt("index")} {
      let row = index / blockSize;
      let tid = i32(localId.x);
      let cols = uniforms.outShape[1];

      var threadMax = -3.402823e+38f;
      for (var col = tid; col < cols; col += blockSize) {
        let value = getLogits(row, col);
        threadMax = max(threadMax, value);
      }
      if (tid < cols) {
        buf[tid] = threadMax;
      }
      workgroupBarrier();

      var reduceSize = min(cols, blockSize);
      for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
        reduceSize = currSize + (reduceSize & 1);
        if (tid < currSize) {
          buf[tid] = max(buf[tid], buf[tid + reduceSize]);
        }
        workgroupBarrier();
      }

      if (tid == 0) {
        rowMaxShared = buf[0];
      }
      workgroupBarrier();

      var threadSum = 0.0;
      for (var col = tid; col < cols; col += blockSize) {
        let subExp = exp(getLogits(row, col) - rowMaxShared);
        threadSum += subExp;
      }
      buf[tid] = threadSum;
      workgroupBarrier();

      for (var currSize = blockSize >> 1;  currSize > 0; currSize = currSize >> 1) {
        if (tid < currSize) {
          buf[tid] = buf[tid] + buf[tid + currSize];
        }
        workgroupBarrier();
      }

      if (tid == 0) {
        rowSumShared = buf[0];
      }
      workgroupBarrier();

      for (var col = tid; col < cols; col += blockSize) {
        let value = exp(getLogits(row, col) - rowMaxShared) / rowSumShared;
        setOutputAtCoords(row, col, value);
      }
  }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aK(n){const{inputs:e,backend:t,attrs:r}=n,{logits:i}=e,{dim:s}=r,o=Ht({inputs:{x:i},backend:t,attrs:{shape:[gt(i.shape)/i.shape[s],i.shape[s]]}}),a=new GFe(o.shape),l=t.runWebGPUProgram(a,[o],i.dtype),c=Ht({inputs:{x:l},backend:t,attrs:{shape:i.shape}});return t.disposeData(o.dataId),t.disposeData(l.dataId),c}const qFe={kernelName:F7,backendName:"webgpu",kernelFunc:aK};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XFe(n){const{inputs:e,backend:t,attrs:r}=n,{logits:i}=e,{numSamples:s,seed:o,normalized:a}=r,l=a?i:aK({inputs:{logits:i},backend:t,attrs:{dim:i.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new HFe(c,s),h=[{type:"float32",data:[o]},{type:"int32",data:[u]}],f=t.runWebGPUProgram(d,[l],"int32",h);return a||t.disposeData(l.dataId),f}const KFe={kernelName:Q9,backendName:"webgpu",kernelFunc:XFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YFe(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])){const s=t.tensorMap.get(r.dataId),[o,a]=iPe(s.values,r.shape,r.dtype);return t.makeTensorInfo(a,r.dtype,o)}const i=new Lg(r.shape,ft.NEG);return t.runWebGPUProgram(i,[r],r.dtype)}const ZFe={kernelName:e7,backendName:"webgpu",kernelFunc:YFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QFe(n){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:i,scores:s}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r,c=t.readSync(i.dataId),u=t.readSync(s.dataId),{selectedIndices:d}=wX(c,u,o,a,l);return t.makeTensorInfo([d.length],"int32",new Int32Array(d))}const JFe={kernelName:n7,backendName:"webgpu",kernelFunc:QFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eze(n){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:i,scores:s}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=r,u=t.readSync(i.dataId),d=t.readSync(s.dataId),h=o,f=a,p=l,x=c,{selectedIndices:v,selectedScores:y}=bX(u,d,h,f,p,x);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const tze={kernelName:r7,backendName:"webgpu",kernelFunc:eze};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nze{constructor(e,t){this.variableNames=["x"],this.uniforms="onValue : f32, offValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,t],this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="onehot"}getUserCode(){return`
      ${vt("index")} {
        if(index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          setOutputAtIndex(index, mix(uniforms.offValue, uniforms.onValue,
                                      f32(i32(round(getX(coords.x))) == coords.y)));
        }
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rze(n){const{inputs:e,backend:t,attrs:r}=n,{indices:i}=e,{dtype:s,depth:o,onValue:a,offValue:l}=r,c=gt(i.shape),u=new nze(c,o),d=Ht({inputs:{x:i},backend:t,attrs:{shape:[c]}}),h=[{type:"float32",data:[a]},{type:"float32",data:[l]}],f=t.runWebGPUProgram(u,[d],s,h);t.disposeData(d.dataId);const p=[...i.shape,o],x=Ht({inputs:{x:f},backend:t,attrs:{shape:p}});return t.disposeData(f.dataId),x}const ize={kernelName:s7,backendName:"webgpu",kernelFunc:rze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XS(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="complex64"){const i=Ex({inputs:{input:r},backend:t}),s=XS({inputs:{x:i},backend:t}),o=I2({inputs:{input:r},backend:t}),a=XS({inputs:{x:o},backend:t}),l=Ff({inputs:{real:s,imag:a},backend:t});return t.disposeData(i.dataId),t.disposeData(s.dataId),t.disposeData(o.dataId),t.disposeData(a.dataId),l}else return Xs({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:t})}const sze={kernelName:Z7,backendName:"webgpu",kernelFunc:XS};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lK(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const i=Ex({inputs:{input:r},backend:t}),s=lK({inputs:{x:i},backend:t}),o=I2({inputs:{input:r},backend:t}),a=XS({inputs:{x:o},backend:t}),l=Ff({inputs:{real:s,imag:a},backend:t});return t.disposeData(i.dataId),t.disposeData(s.dataId),t.disposeData(o.dataId),t.disposeData(a.dataId),l}else return Xs({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:t})}const oze={kernelName:i7,backendName:"webgpu",kernelFunc:lK};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aze(n){const{inputs:e,backend:t,attrs:r}=n,{axis:i}=r;if(e.length===1)return HN({inputs:{input:e[0]},backend:t,attrs:{dim:i}});const s=e[0].shape,o=e[0].dtype;e.forEach(u=>{Jo(s,u.shape,"All tensors passed to stack must have matching shapes"),te(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=HN({inputs:{input:u},backend:t,attrs:{dim:i}});return a.push(d),d}),c=ZX({inputs:l,backend:t,attrs:{axis:i}});return a.forEach(u=>t.disposeData(u.dataId)),c}const lze={kernelName:o7,backendName:"webgpu",kernelFunc:aze};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cK(n,e=!1){const t=n.length,r=pi(t),i=n.map((d,h)=>`uniforms.pad${h}[0]`).join(","),s=n.map((d,h)=>`uniforms.pad${h}[0] + uniforms.xShape${t>1?`[${h}]`:""}`).join(","),o=t>1?`${r}(${i})`:`${i}`,a=t>1?`${r}(${s})`:`${s}`,l=t>1?"any(paddedCoords < start)":"paddedCoords < start",c=t>1?"any(paddedCoords >= end)":"paddedCoords >= end",u=t>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,t):"coords";return`
        let start = ${o};
        let end = ${a};
        if (${l} || ${c}) {
          setOutputAtIndex(index, ${e?0:"uniforms.constantValue"});
        } else {
          let coords = paddedCoords - start;
          setOutputAtIndex(index, getX(${u}));
        }
  `}class cze{constructor(e,t){this.variableNames=["x"],this.uniforms="constantValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.map((r,i)=>r[0]+e[i]+r[1]),this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),t.map((r,i)=>{this.uniforms+=` pad${i} : vec2<i32>,`}),this.xShape=e,this.shaderKey="pad"}getUserCode(){return`
      ${vt("index")} {
        if (index < uniforms.size) {
          let paddedCoords = getCoordsFromIndex(index);
          ${cK(this.xShape)}
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uze=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{paddings:s,constantValue:o}=r;if(s.every(c=>Zs(c,[0,0])))return Co({inputs:{x:i},backend:t});if(gt(i.shape)===0){const c=s.map((u,d)=>u[0]+i.shape[d]+u[1]);return Xs({backend:t,attrs:{shape:c,value:o,dtype:i.dtype}})}const a=[{type:"float32",data:[o]}];s.map(c=>a.push({type:"int32",data:[c[0],c[1]]}));const l=new cze(i.shape,s);return t.runWebGPUProgram(l,[i],i.dtype,a)},dze={kernelName:a7,backendName:"webgpu",kernelFunc:uze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hze=ji({opType:pn.POW}),fze={kernelName:l7,backendName:"webgpu",kernelFunc:hze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pze(n){const{inputs:e,backend:t}=n,{x:r,alpha:i}=e,s=new HS(pn.PRELU,r.shape,i.shape);return t.runWebGPUProgram(s,[r,i],"float32")}const mze={kernelName:c7,backendName:"webgpu",kernelFunc:pze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gze(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:s,keepDims:o}=r;return zf(i,s,o,"prod",t)}const yze={kernelName:u7,backendName:"webgpu",kernelFunc:gze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vze=n=>{const{backend:e,attrs:t}=n,{start:r,stop:i,step:s,dtype:o}=t,a=aPe(r,i,s,o);return e.makeTensorInfo([a.length],o,a)},xze={kernelName:d7,backendName:"webgpu",kernelFunc:vze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wze=ji({opType:pn.DIV}),bze={kernelName:c9,backendName:"webgpu",kernelFunc:wze};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sze=er({opType:ft.RECIPROCAL}),_ze={kernelName:f7,backendName:"webgpu",kernelFunc:Sze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eze=er({opType:ft.RELU}),Cze={kernelName:p7,backendName:"webgpu",kernelFunc:Eze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tze=er({opType:ft.RELU6}),Mze={kernelName:v7,backendName:"webgpu",kernelFunc:Tze};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Aze{constructor(e,t,r){this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, halfPixelCenters : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e[0],t,r,e[3]],this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="resizeBilinear"}getUserCode(){return`
      ${vt("index")} {
        if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let d = coords[3];
          let rc = coords.yz;

          let effectiveInSize = vec2<f32>(
            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveOutSize = vec2<f32>(
            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveInputOverOutputRatioRC =
              effectiveInSize / effectiveOutSize;

          // Fractional source index
          let sourceFracIndexRC =
            (vec2<f32>(rc) + vec2<f32>(uniforms.halfPixelCenters)) *
            effectiveInputOverOutputRatioRC - vec2<f32>(uniforms.halfPixelCenters);

          // Compute the four integer indices.
          let sourceFloorRC = vec2<i32>(sourceFracIndexRC);
          let sourceCeilRC = vec2<i32>(
            min(vec2<f32>(uniforms.xShape.yz) - vec2<f32>(1.0), ceil(sourceFracIndexRC)));

          let topLeft = getX(b, sourceFloorRC.x, sourceFloorRC.y, d);
          let bottomLeft = getX(b, sourceCeilRC.x, sourceFloorRC.y, d);
          let topRight = getX(b, sourceFloorRC.x, sourceCeilRC.y, d);
          let bottomRight = getX(b, sourceCeilRC.x, sourceCeilRC.y, d);

          let fracRC = sourceFracIndexRC - vec2<f32>(sourceFloorRC);

          let top = topLeft + (topRight - topLeft) * fracRC.y;
          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
          let newValue = top + (bottom - top) * fracRC.x;

          setOutputAtIndex(index, newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nze(n){const{inputs:e,backend:t,attrs:r}=n,{images:i}=e,{alignCorners:s,size:o,halfPixelCenters:a}=r,[l,c]=o,u=s&&l>1?1:0,d=s&&c>1?1:0,f=[{type:"float32",data:[u,d]},{type:"float32",data:[a?.5:0]}],p=new Aze(i.shape,l,c);return t.runWebGPUProgram(p,[i],"float32",f)}const kze={kernelName:y7,backendName:"webgpu",kernelFunc:Nze};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ize{constructor(e,t){this.variableNames=["dy"],this.uniforms=`effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, heightScale : f32, widthScale : f32,
       invHeightScale : f32, invWidthScale : f32, winHeight : i32, winWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=t,this.shaderKey=`resizeBilinearBackprop_${t}`}getUserCode(){return`
      ${vt("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let b = coords[0];
          let d = coords[3];
          let r = coords[1];
          let c = coords[2];

          var accumulator = 0.0;

          // Compute bounds for where in dy we will look
          let startRLerp = floor(f32(r) * uniforms.invHeightScale);
          let startDyR = i32(startRLerp - f32(uniforms.winHeight / 2));

          let startCLerp = floor(f32(c) * uniforms.invWidthScale);
          let startDyC = i32(startCLerp - f32(uniforms.winWidth / 2));

          // Loop over dy
          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {
            let dyR = startDyR + dyROffset;

            // Guard against the window exceeding the bounds of dy
            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {
              continue;
            }

            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {
              let dyC = startDyC + dyCOffset;

              // Guard against the window exceeding the bounds of dy
              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {
                continue;
              }

              let dxR = f32(dyR) * uniforms.heightScale;
              let topDxRIndex = i32(floor(dxR));
              let bottomDxRIndex = i32(min(ceil(dxR), f32(uniforms.outShape[1] - 1)));
              let dxRLerp = dxR - f32(topDxRIndex);
              let inverseDxRLerp = 1.0 - dxRLerp;

              let dxC = f32(dyC) * uniforms.widthScale;
              let leftDxCIndex = i32(floor(dxC));
              let rightDxCIndex = i32(min(ceil(dxC), f32(uniforms.outShape[2] - 1)));
              let dxCLerp = dxC - f32(leftDxCIndex);
              let inverseDxCLerp = 1.0 - dxCLerp;

              if (r == topDxRIndex && c == leftDxCIndex) {
                // topLeft
                accumulator +=
                  getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
              }

              if (r == topDxRIndex && c == rightDxCIndex) {
                // topRight
                accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
              }

              if (r == bottomDxRIndex && c == leftDxCIndex) {
                // bottomLeft
                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
              }

              if (r == bottomDxRIndex && c == rightDxCIndex) {
                // bottomRight
                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
              }
            }
          }
          // End loop over dy

          setOutputAtIndex(index, accumulator);
        }
      }
    `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rze(n){const{inputs:e,backend:t,attrs:r}=n,{images:i,dy:s}=e,{alignCorners:o}=r,[,a,l]=i.shape,[,c,u]=s.shape,d=[o&&c>1?a-1:a,o&&u>1?l-1:l],h=[o&&c>1?c-1:c,o&&u>1?u-1:u],f=d[0]/h[0],p=d[1]/h[1],x=1/f,v=1/p,y=Math.ceil(x)*2+2,b=Math.ceil(v)*2+2,S=new Ize(i.shape,o),_=[{type:"int32",data:d},{type:"int32",data:h},{type:"float32",data:[f]},{type:"float32",data:[p]},{type:"float32",data:[x]},{type:"float32",data:[v]},{type:"int32",data:[y]},{type:"int32",data:[b]}];return t.runWebGPUProgram(S,[s],s.dtype,_)}const Pze={kernelName:dwe,backendName:"webgpu",kernelFunc:Rze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dze{constructor(e,t,r,i){this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, roundBase : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e[0],t,r,e[3]],this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.halfPixelCenters=i,this.shaderKey=`resizeNearest_${i}`}getUserCode(){let e;return this.halfPixelCenters?e="max((vec2<f32>(rc) + vec2<f32>(0.5)) * effectiveInputOverOutputRatioRC, vec2<f32>(0.0))":e="vec2<f32>(rc) * effectiveInputOverOutputRatioRC",`
      ${vt("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let d = coords[3];
          let rc = coords.yz;

          let effectiveInSize = vec2<f32>(
            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveOutSize = vec2<f32>(
            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveInputOverOutputRatioRC =
              effectiveInSize / effectiveOutSize;

          // Fractional source index
          let sourceFracIndexRC = ${e};

          // Compute the coordinators of nearest neighbor point.
          let inputShapeRC = vec2<f32>(f32(uniforms.xShape.y), f32(uniforms.xShape.z));
          let sourceNearestRC = vec2<i32>(
            min(inputShapeRC - 1.0, floor(sourceFracIndexRC + uniforms.roundBase)));
          let newValue = getX(b, sourceNearestRC.x, sourceNearestRC.y, d);

          setOutputAtIndex(index, newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lze(n){const{inputs:e,backend:t,attrs:r}=n,{images:i}=e,{alignCorners:s,halfPixelCenters:o,size:a}=r,[l,c]=a,u=s&&l>1?1:0,d=s&&c>1?1:0,f=[{type:"float32",data:[u,d]},{type:"float32",data:[s?.5:0]}],p=new Dze(i.shape,l,c,o);return t.runWebGPUProgram(p,[i],i.dtype,f)}const Oze={kernelName:g7,backendName:"webgpu",kernelFunc:Lze};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fze{constructor(e,t){this.variableNames=["dy"],this.uniforms=`effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, invHeightScale : f32, invWidthScale : f32,
       winHeight : i32, winWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=t,this.shaderKey=`resizeNearestNeigborBackprop_${t}`}getUserCode(){return`
      ${vt("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let b = coords[0];
          let d = coords[3];
          let r = coords[1];
          let c = coords[2];

          var accumulator = 0.0;

          // Compute bounds for where in dy we will look
          let startRLerp = floor(f32(r) * uniforms.invHeightScale);
          let startDyR = i32(floor(startRLerp - f32(uniforms.winHeight / 2)));

          let startCLerp = floor(f32(c) * uniforms.invWidthScale);
          let startDyC = i32(floor(startCLerp - f32(uniforms.winWidth / 2)));

          // Loop over dy
          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {
            let dyR = startDyR + dyROffset;

            // Guard against the window exceeding the bounds of dy
            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {
              continue;
            }

            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {
              let dyC = startDyC + dyCOffset;

              // Guard against the window exceeding the bounds of dy
              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {
                continue;
              }

              let sourceFracRow = f32(uniforms.effectiveXSize[0]) *
                  (f32(dyR) / f32(uniforms.effectiveYSize[0]));

              let sourceFracCol = f32(uniforms.effectiveXSize[1]) *
                  (f32(dyC) / f32(uniforms.effectiveYSize[1]));

              let sourceNearestRow =
                  i32(min(f32(uniforms.outShape[1] - 1),
                  ${this.alignCorners?"floor(sourceFracRow + 0.5)":"floor(sourceFracRow)"}));

              let sourceNearestCol =
                  i32(min(f32(uniforms.outShape[2] - 1),
                  ${this.alignCorners?"floor(sourceFracCol + 0.5)":"floor(sourceFracCol)"}));

              if (r == sourceNearestRow && c == sourceNearestCol) {
                accumulator += getDy(b, dyR, dyC, d);
              }
            }
          }
          // End loop over dy

          setOutputAtIndex(index, accumulator);
        }
      }
    `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zze(n){const{inputs:e,backend:t,attrs:r}=n,{images:i,dy:s}=e,{alignCorners:o}=r,[,a,l]=i.shape,[,c,u]=s.shape,d=[o&&c>1?a-1:a,o&&u>1?l-1:l],h=[o&&c>1?c-1:c,o&&u>1?u-1:u],f=d[0]/h[0],p=d[1]/h[1],x=1/f,v=1/p,y=Math.ceil(x)*2+2,b=Math.ceil(v)*2+2,S=new Fze(i.shape,o),_=[{type:"int32",data:d},{type:"int32",data:h},{type:"float32",data:[x]},{type:"float32",data:[v]},{type:"int32",data:[y]},{type:"int32",data:[b]}];return t.runWebGPUProgram(S,[s],s.dtype,_)}const Uze={kernelName:uwe,backendName:"webgpu",kernelFunc:zze};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bze{constructor(e){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=" axis : vec4<i32>,",this.shaderKey="reverse"}getUserCode(){return`
      
      // Using uniform variables as judging conditions, so the function has
      // coherent execution within all threads.
      fn getReverseCoords(coords : vec4<i32>) -> vec4<i32> {
        var reverseCoords = coords;
        if (uniforms.axis[0] == 1) {
          reverseCoords[0] = uniforms.xShape[0] - coords[0] - 1;
        }
        if (uniforms.axis[1] == 1) {
          reverseCoords[1] = uniforms.xShape[1] - coords[1] - 1;
        }
        if (uniforms.axis[2] == 1) {
          reverseCoords[2] = uniforms.xShape[2] - coords[2] - 1;
        }
        if (uniforms.axis[3] == 1) {
          reverseCoords[3] = uniforms.xShape[3] - coords[3] - 1;
        }

        return reverseCoords;
      }
    
      ${vt("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let reverseCoords = getReverseCoords(coords);
          setOutputAtIndex(index, getX(reverseCoords[0],
              reverseCoords[1], reverseCoords[2], reverseCoords[3]));
        }
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ze(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{dims:s}=r,o=i.shape.length;if(o===0)return Co({inputs:{x:i},backend:t});const a=i.shape,l=[1,1,1,1];a.forEach((v,y)=>{const b=y+4-o;l[b]=v});const c=ka(s,i.shape),u=[0,0,0,0];c.forEach(v=>{const y=v+4-o;u[y]=1});const d=[{type:"int32",data:u}],h=Ht({inputs:{x:i},backend:t,attrs:{shape:l}}),f=new Bze(l),p=t.runWebGPUProgram(f,[h],h.dtype,d);t.disposeData(h.dataId);const x=Ht({inputs:{x:p},backend:t,attrs:{shape:a}});return t.disposeData(p.dataId),x}const jze={kernelName:x7,backendName:"webgpu",kernelFunc:$ze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vze{constructor(e,t){this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=`centerX : f32, centerY : f32, sinRadians : f32,
          cosRadians : f32,`,this.shaderKey="rotate",this.outputShape=e,typeof t=="number"?(this.uniforms+=" fillValue : f32,",this.fillSnippet="var outputValue = uniforms.fillValue;",this.shaderKey+="_float"):(this.uniforms+=" fillValue : vec3<f32>,",this.fillSnippet="var outputValue = uniforms.fillValue[coords[3]];",this.shaderKey+="_vec3")}getUserCode(){return`
        ${vt("index")} {
          if (index < uniforms.size) {
            let coords = getCoordsFromIndex(index);
            let coordXFloat = (f32(coords[2]) - uniforms.centerX) *
                uniforms.cosRadians - (f32(coords[1]) - uniforms.centerY) *
                uniforms.sinRadians;
            let coordYFloat = (f32(coords[2]) - uniforms.centerX) *
                uniforms.sinRadians + (f32(coords[1]) - uniforms.centerY) *
                uniforms.cosRadians;
            let coordX = i32(round(coordXFloat + uniforms.centerX));
            let coordY = i32(round(coordYFloat + uniforms.centerY));
            ${this.fillSnippet}
            if(coordX >= 0 && coordX < uniforms.xShape[2] && coordY >= 0 &&
                coordY < uniforms.xShape[1]) {
              outputValue = getX(coords[0], coordY, coordX, coords[3]);
            }
            setOutputAtIndex(index, outputValue);
          }
        }
      `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wze={kernelName:J7,backendName:"webgpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,{radians:i,fillValue:s,center:o}=e,a=t,l=new Vze(r.shape,s),[c,u]=SAe(o,r.shape[1],r.shape[2]),d=[{type:"float32",data:[c]},{type:"float32",data:[u]},{type:"float32",data:[Math.sin(i)]},{type:"float32",data:[Math.cos(i)]}];return typeof s=="number"?d.push({type:"float32",data:[Number.parseFloat(s.toFixed(2))]}):d.push({type:"float32",data:s}),a.runWebGPUProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hze=er({opType:ft.ROUND}),Gze={kernelName:w7,backendName:"webgpu",kernelFunc:Hze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qze=er({opType:ft.RSQRT,cpuKernelImpl:lPe}),Xze={kernelName:b7,backendName:"webgpu",kernelFunc:qze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vv{constructor(e,t,r,i,s,o,a,l=!0){this.variableNames=["updates","indices"],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=o,this.type=a,this.sumDupeIndices=l,this.dispatchLayout=Nt(e),this.dispatch=xt(this.dispatchLayout,e,this.workgroupSize),this.sliceDimGreaterThanOne=t>1,this.shaderKey=`scatter_${r}_${i}_${this.sliceDimGreaterThanOne}_${a}_${l}_${s.length}`;const c=pi(s.length);this.uniforms=`sliceDim : i32, strides: ${c}, updatesSize: i32,`,this.updatesRank=i,this.indicesRank=r}getUserCode(){let e="";this.indicesRank===1?e="coords[0]":this.indicesRank===2&&(e="coords[0], j");const t=`getIndices(${e})`,r=this.sliceDimGreaterThanOne?"uniforms.strides[j]":"uniforms.strides";let i="",s="";this.dispatchLayout.x.length===1?(i="flattenedIndex",s=`
      fn getUpdatesCoordsFromFlatIndex(index : i32) -> i32 {
        return index;
      }
      `):this.dispatchLayout.x.length===2&&(i="vec2<i32>(flattenedIndex, coords[1])",s=`
      fn getUpdatesCoordsFromFlatIndex(index : i32) -> vec2<i32> {
        // N.B. |updates| could be a scalar tensor, conceptually representing a
        // 2D tensor with all values equal to that. By design, its size must be
        // the same as |outShape[1]| in one dimension, and |indicesShape[0]|
        // gives the other.
        let sliceSize = uniforms.outShape[1];
        let d0 = index / sliceSize;
        let d1 = index - d0 * sliceSize;
        return vec2<i32>(d0, d1);
      }
      `);const a=`getUpdates(${Array.from({length:this.updatesRank},(c,u)=>`coords[${u}]`).join(", ")})`;return`
    ${s}
      ${vt("index")} {
        if (index < uniforms.updatesSize) {
          let coords = getUpdatesCoordsFromFlatIndex(index);
          var flattenedIndex = 0;
          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {
            let indexInside = i32(round(${t}));
            flattenedIndex = flattenedIndex + indexInside * ${r};
          }
          let updateValue =
              ${_h(this.type)}(${a});
          let flatIndex = getOutputIndexFromCoords(${i});

          ${this.sumDupeIndices?Ld("&result[flatIndex]","updateValue",this.type):"atomicStore(&result[flatIndex], bitcast<i32>(updateValue));"}
        }
      }`}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kze(n){const{inputs:e,backend:t,attrs:r}=n,{indices:i,updates:s}=e,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=g3(s,i,o),h=[d/c,c];if(d===0)return t.makeTensorInfo(o,i.dtype);const f=Ht({inputs:{x:i},backend:t,attrs:{shape:[l,a]}}),p=Ht({inputs:{x:s},backend:t,attrs:{shape:[l,c]}}),x=p.dtype,v=Xs({backend:t,attrs:{shape:h,value:0,dtype:x}}),y=gt(p.shape),b=[{type:"int32",data:[a]},{type:"int32",data:u},{type:"int32",data:[y]}],S=new vv(p.shape,a,f.shape.length,p.shape.length,u,h,x),_=t.runWebGPUProgram(S,[p,f],x,b,v),T=Ht({inputs:{x:_},backend:t,attrs:{shape:o}});return t.disposeData(f.dataId),t.disposeData(p.dataId),t.disposeData(_.dataId),T}const Yze={kernelName:S7,backendName:"webgpu",kernelFunc:Kze};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zze{constructor(e,t){this.outputShape=[],this.variableNames=["sortedSequence","values"],this.uniforms="numInputs : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.side=t,this.shaderKey=`search_sorted_${t}`}getUserCode(){return`
      fn findBound(batch: i32, value: f32) -> i32 {
        var left = i32(0);
        var right = uniforms.numInputs;
        while (left < right) {
          var mid = (left + right) / 2;
          if (getSortedSequence(batch, mid) ${this.side==="left"?"<":"<="} value) {
            left = mid + 1;
          } else {
            right = mid;
          }
        }
        return right;
      }

      ${vt("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let value = getValuesByOutputIndex(index);
          setOutputAtIndexI32(index, findBound(coords[0], value));
        }
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qze(n){const{inputs:e,backend:t,attrs:r}=n,{sortedSequence:i,values:s}=e,{side:o}=r,a=new Zze([s.shape[0],s.shape[1]],o),l=[{type:"int32",data:[i.shape[1]]}];return t.runWebGPUProgram(a,[i,s],"int32",l)}const Jze={kernelName:E7,backendName:"webgpu",kernelFunc:Qze};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e4e{constructor(e,t,r){this.variableNames=["c","a","b"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.cRank=e,this.rank=r,this.shaderKey="select"}getUserCode(){let e,t;if(this.rank>4)throw Error(`Where for rank ${this.rank} is not yet supported`);if(this.rank===1)t="resRC",e="resRC";else{const i=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],o=[];for(let a=0;a<this.outputShape.length;a++)o.push(`${i[a]}`),a<this.cRank&&s.push(`${i[a]}`);e=s.join(),t=o.join()}return`
      ${vt("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          let cVal = getC(${e});
          if (cVal >= 1.0) {
            setOutputAtIndex(index, getA(${t}));
          } else {
            setOutputAtIndex(index, getB(${t}));
          }
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t4e(n){const{inputs:e,backend:t}=n,{condition:r,t:i,e:s}=e,o=new e4e(r.shape.length,i.shape,i.shape.length);return t.runWebGPUProgram(o,[r,i,s],vd(i.dtype,s.dtype))}const n4e={kernelName:C7,backendName:"webgpu",kernelFunc:t4e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r4e=er({opType:ft.SELU}),i4e={kernelName:T7,backendName:"webgpu",kernelFunc:r4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s4e=er({opType:ft.SIGMOID}),o4e={kernelName:I7,backendName:"webgpu",kernelFunc:s4e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a4e=er({opType:ft.SIGN}),l4e={kernelName:k7,backendName:"webgpu",kernelFunc:a4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c4e=er({opType:ft.SIN}),u4e={kernelName:A7,backendName:"webgpu",kernelFunc:c4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d4e=er({opType:ft.SINH}),h4e={kernelName:N7,backendName:"webgpu",kernelFunc:d4e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f4e=er({opType:ft.SOFTPLUS}),p4e={kernelName:R7,backendName:"webgpu",kernelFunc:f4e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m4e{constructor(e,t,r,i,s,o){this.variableNames=["x"],this.outputShape=[],this.uniforms="",this.workgroupSize=[64,1,1],this.size=!0;const a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[s[l]];this.outputShape=a,this.newDim=s,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=e,this.paddedXShape=t,this.uniforms+=`reshapedPaddedXShape : ${pi(i.length)}, paddedXShapeStrides : ${pi(o)}, `,r.map((l,c)=>{this.uniforms+=` pad${c} : vec2<i32>,`}),this.shaderKey=`spaceToBatchND_${s}`}getUserCode(){const e=pi(this.outputShape.length),t=WX(this.newDim);return`
      ${Cb(this.paddedXShape,"PaddedX")}
      ${vt("index")} {
        if(index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let switchedIndex = getIndexFromCoords${this.outputShape.length}D(${e}(${t}), uniforms.reshapedPaddedXShape);
          let paddedCoords = getPaddedXCoordsFromIndex(switchedIndex);
          ${cK(this.xShape,!0)}
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g4e=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{blockShape:s,paddings:o}=r;te(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGPU backend not implemented yet");const a=s.reduce((b,S)=>b*S),l=[[0,0]];l.push(...o);for(let b=1+s.length;b<i.shape.length;++b)l.push([0,0]);const c=l.map((b,S)=>b[0]+i.shape[S]+b[1]),u=kX(c,s,a,!1),d=IX(u.length,s.length,!1),h=RX(c,s,a,!1),f=os(c),p=new m4e(i.shape,c,l,u,d,f.length),x=[{type:"int32",data:u},{type:"int32",data:f}];l.map(b=>x.push({type:"int32",data:[b[0],b[1]]}));const v=t.runWebGPUProgram(p,[i],i.dtype,x),y=Ht({inputs:{x:v},backend:t,attrs:{shape:h}});return t.disposeData(v.dataId),y},y4e={kernelName:L7,backendName:"webgpu",kernelFunc:g4e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v4e{constructor(e,t,r){this.variableNames=["input","indices","segmentIds"],this.outputShape=[],this.uniforms="segmentSize : i32, sparseSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e,this.type=r,this.dispatchLayout=Nt([t]),this.dispatch=xt(this.dispatchLayout,[t],this.workgroupSize),this.shaderKey="sparseSegmentSum"}getUserCode(){return`
    ${vt("index")} {
      if (index < uniforms.sparseSize) {
        let indexInSegmentIds = index / uniforms.segmentSize;
        let indexInSegment = index % uniforms.segmentSize;
        let indexInInput = indices[indexInSegmentIds];
        let segmentId = segmentIds[indexInSegmentIds];

        let value = input[indexInInput * uniforms.segmentSize + indexInSegment];
        let outIndex = segmentId * uniforms.segmentSize + indexInSegment;
        ${Ld("&result[outIndex]","value",this.type)}
      }
    }
  `}}class x4e{constructor(e,t){this.variableNames=["segmentIds"],this.outputShape=[],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=[e],this.dispatchLayout=Nt(t),this.dispatch=xt(this.dispatchLayout,t,this.workgroupSize),this.shaderKey="sparseSegmentIdCountProgram"}getUserCode(){return`
    ${vt("index")} {
      if (index < uniforms.segmentIdsShape) {
        let segmentId = segmentIds[index];
        ${Ld("&result[segmentId]","1","int32")}
      }
    }
  `}}class w4e{constructor(e,t){this.variableNames=["segmentSum","sameSegmentIdCount"],this.outputShape=[],this.uniforms="segmentSize : i32",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.type=t,this.dispatchLayout=Nt(e),this.dispatch=xt(this.dispatchLayout,e,this.workgroupSize),this.shaderKey="sparseSegmentMean"}getUserCode(){return`
    ${vt("index")} {
      if (index < uniforms.size) {
        let segmentId = index / uniforms.segmentSize;
        let count = sameSegmentIdCount[segmentId];
        if (count != 0) {
          ${this.type==="float32"?"setOutputAtIndex(index, segmentSum[index] / f32(count));":"setOutputAtIndexI32(index, segmentSum[index] / count);"}
        }
      }
    }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uK(n,e,t,r=!1,i){const o=gt(n.shape)/n.shape[0],a=n.dtype,l=gt(e.shape),c=i.readSync(t.dataId),d=l>0?c[l-1]+1:0;let h;const f=n.shape.slice();f[0]=d;const p=l*o,x=Xs({backend:i,attrs:{shape:f,value:0,dtype:a}});h=new v4e(f,p,a);let v=[{type:"int32",data:[o]},{type:"int32",data:[p]}];const y=i.runWebGPUProgram(h,[n,e,t],a,v,x);if(r)return y;const b=Xs({backend:i,attrs:{shape:[d],value:0,dtype:"int32"}});h=new x4e(d,t.shape);const S=i.runWebGPUProgram(h,[t],"int32",null,b),_=Xs({backend:i,attrs:{shape:f,value:0,dtype:a}});h=new w4e(f,a),v=[{type:"int32",data:[o]}];const T=i.runWebGPUProgram(h,[y,S],a,v,_);return i.disposeData(y.dataId),i.disposeData(S.dataId),T}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b4e(n){const{inputs:e,backend:t}=n,{data:r,indices:i,segmentIds:s}=e;return uK(r,i,s,!1,t)}const S4e={kernelName:z7,backendName:"webgpu",kernelFunc:b4e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _4e(n){const{inputs:e,backend:t}=n,{data:r,indices:i,segmentIds:s}=e;return uK(r,i,s,!0,t)}const E4e={kernelName:U7,backendName:"webgpu",kernelFunc:_4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C4e{constructor(e,t){this.variableNames=["A"],this.workgroupSize=[64,1,1],this.size=!0;const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[i]*t[i];this.outputShape=r,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.rank=this.outputShape.length,this.shaderKey="tile"}getUserCode(){const e=T4e(this.rank,"uniforms.");return`
      ${vt("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          setOutputAtIndex(index, getA(${e}));
        }
      }
    `}}function T4e(n,e=""){if(n>=5)throw Error(`Tile for rank ${n} is not yet supported`);if(n===1)return`(resRC % ${e}aShape)`;const t=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<n;i++)r.push(`(${t[i]} % ${e}aShape[${i}])`);return r.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k3(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{reps:s}=r;if(t.shouldExecuteOnCPU([i])||i.dtype==="string"||i.shape.length>=5){const l=t.readSync(i.dataId),c=i.dtype==="string"?l.map(h=>Qm(h)):l,u=Fr(i.shape,i.dtype,c),d=mPe(u,s);return t.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new C4e(i.shape,s);return t.runWebGPUProgram(o,[i],i.dtype)}const M4e={kernelName:YR,backendName:"webgpu",kernelFunc:k3};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A4e(n){const{inputs:e,backend:t,attrs:r}=n,{sparseIndices:i,sparseValues:s,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=g3(s,i,a),f=!1;if(s.dtype==="string"){const P=t.bufferSync(i),z=t.bufferSync(s),I=Qm(t.readSync(o.dataId)[0]),L=cPe(P,z,a,h,u,c,l,d,I,f);return t.makeTensorInfo(a,L.dtype,L.values)}const p=[h/u,u],x=Ht({inputs:{x:i},backend:t,attrs:{shape:[c,l]}}),v=s.shape.length?Ht({inputs:{x:s},backend:t,attrs:{shape:[c,u]}}):Co({inputs:{x:s},backend:t}),y=v.dtype,b=t.makeTensorInfo([],y,Hc(1,y)),S=Ht({inputs:{x:o},backend:t,attrs:{shape:Array(p.length).fill(1)}}),_=k3({inputs:{x:S},backend:t,attrs:{reps:p}}),T=gt([c,u]),M=[{type:"int32",data:[l]},{type:"int32",data:d},{type:"int32",data:[T]}];switch(c){case 0:break;case 1:{const P=new vv([c,u],l,x.shape.length,v.shape.length,d,p,y,f);t.runWebGPUProgram(P,[v,x],y,M,_)}break;default:{const P=new vv([c,u],l,x.shape.length,b.shape.length,d,p,y,f);t.runWebGPUProgram(P,[b,x],y,M,_)}{const P=new vv([c,u],l,x.shape.length,v.shape.length,d,p,y);t.runWebGPUProgram(P,[v,x],y,M,_)}}const k=Ht({inputs:{x:_},backend:t,attrs:{shape:a}});return t.disposeData(x.dataId),t.disposeData(v.dataId),t.disposeData(S.dataId),t.disposeData(b.dataId),t.disposeData(_.dataId),k}const N4e={kernelName:B7,backendName:"webgpu",kernelFunc:A4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k4e(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{numOrSizeSplits:s,axis:o}=r,a=ka(o,i.shape)[0],l=BAe(i,s,a),c=i.shape.length,u=new Array(c).fill(0),d=i.shape.slice();return l.map(h=>{const f=[...d];f[a]=h;const p=Og({inputs:{x:i},backend:t,attrs:{begin:u,size:f}});return u[a]+=h,p})}const I4e={kernelName:O7,backendName:"webgpu",kernelFunc:k4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R4e=er({opType:ft.SQRT}),P4e={kernelName:P7,backendName:"webgpu",kernelFunc:R4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D4e={kernelName:pwe,backendName:"webgpu",kernelFunc:({inputs:n,backend:e})=>{const{x:t}=n,r=e,i=new Lg(t.shape,ft.SQUARE);return r.runWebGPUProgram(i,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L4e=ji({opType:pn.SQUARED_DIFFERENCE}),O4e={kernelName:$7,backendName:"webgpu",kernelFunc:L4e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F4e({inputs:n,attrs:e,backend:t}){const{x:r}=n,i=new Lg(r.shape,ft.STEP,"stepAlpha : f32,"),s=[{type:"float32",data:[e.alpha]}];return t.runWebGPUProgram(i,[r],r.dtype,s)}const z4e={kernelName:Q7,backendName:"webgpu",kernelFunc:F4e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U4e{constructor(e){this.variableNames=["x"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]);const t=pi(this.outputShape.length);this.uniforms=`begin : ${t},  strides : ${t}, `,this.shaderKey="stridedSlice"}getUserCode(){const e=this.outputShape.length;let t="";if(e===1)t="coords * uniforms.strides + uniforms.begin";else{let i=0;t=this.outputShape.map((s,o)=>(i++,this.outputShape.length===1?`coords * uniforms.strides[${o}] + uniforms.begin[${o}]`:`coords[${i-1}] * uniforms.strides[${o}] + uniforms.begin[${o}]`)).join(",")}return`
       ${vt("index")} {
         if (index < uniforms.size) {
           let coords = getCoordsFromIndex(index);
           setOutputAtIndex(index, getX(${t}));
         }
       }
     `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B4e(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{begin:s,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:f,finalShape:p,isIdentity:x,sliceDim0:v,isSimpleSlice:y,begin:b,end:S,strides:_}=mAe(i.shape,s,o,a,l,c,u,d,h);let T;if(x)T=Ht({inputs:{x:i},backend:t,attrs:{shape:p}});else if(v||y){te(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const M=dAe(b,S,_),k=Og({inputs:{x:i},backend:t,attrs:{begin:b,size:M}});T=Ht({inputs:{x:k},backend:t,attrs:{shape:p}}),t.disposeData(k.dataId)}else if(t.shouldExecuteOnCPU([i])){const k=t.readSync(i.dataId),P=Fr(i.shape,i.dtype,k),z=hPe(f,P,_,b);T=t.makeTensorInfo(p,i.dtype,z.values)}else{const k=new U4e(f),P=[{type:"int32",data:b},{type:"int32",data:_}],z=t.runWebGPUProgram(k,[i],i.dtype,P);T=Ht({inputs:{x:z},backend:t,attrs:{shape:p}}),t.disposeData(z.dataId)}return T}const $4e={kernelName:j7,backendName:"webgpu",kernelFunc:B4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j4e(n){const{inputs:e,backend:t,attrs:r}=n,{separator:i,nGramWidths:s,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:d}=e,h=t.readSync(u.dataId),f=t.readSync(d.dataId),[p,x]=fPe(h,f,i,s,o,a,l,c);return[t.makeTensorInfo([p.length],"string",p),t.makeTensorInfo(d.shape,"int32",x)]}const V4e={kernelName:V7,backendName:"webgpu",kernelFunc:j4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W4e=ji({opType:pn.SUB,cpuKernelImpl:pPe,supportsComplex:!0}),H4e={kernelName:W7,backendName:"webgpu",kernelFunc:W4e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G4e=er({opType:ft.TAN}),q4e={kernelName:H7,backendName:"webgpu",kernelFunc:G4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X4e=er({opType:ft.TANH}),K4e={kernelName:G7,backendName:"webgpu",kernelFunc:X4e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y4e(n){const{inputs:e,backend:t,attrs:r}=n,{tensor:i,indices:s,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=g3(o,s,i.shape),h=[d/c,c];if(d===0)return t.makeTensorInfo(i.shape,s.dtype);const f=[],p=Ht({inputs:{x:s},backend:t,attrs:{shape:[l,a]}});f.push(p);const x=Ht({inputs:{x:o},backend:t,attrs:{shape:[l,c]}});f.push(x);const v=Ht({inputs:{x:i},backend:t,attrs:{shape:h}});f.push(v);const y=k3({inputs:{x:v},backend:t,attrs:{reps:Array(h.length).fill(1)}}),b=new vv([l,c],a,p.shape.length,x.shape.length,u,h,i.dtype,!1),S=gt([l,c]),_=[{type:"int32",data:[a]},{type:"int32",data:u},{type:"int32",data:[S]}],T=t.runWebGPUProgram(b,[x,p],v.dtype,_,y);f.push(T);const M=Ht({inputs:{x:T},backend:t,attrs:{shape:i.shape}});return f.forEach(k=>t.disposeData(k.dataId)),M}const Z4e={kernelName:_7,backendName:"webgpu",kernelFunc:Y4e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q4e{constructor(e){this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=`inputSize : i32, firstPass : i32, negativeInf : f32,
        dir : i32, inc : i32,`,this.shaderKey="swap"}getUserCode(){return`
        ${vt("index")} {
          if (index < uniforms.size) {
            let outC = getCoordsFromIndex(index);
            let batch = outC[0];
            let elemIdx = outC[1];
            // We compare elements pair-wise within a group of size 2 * inc.
            // The comparing rule for each group alternates between ascending
            // and descending. Within each group, we compare each pair at
            // positions i and i+inc. To decide whether an element at position i
            // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
            // inc, it is in the first half of the group, we denote it as x0,
            // otherwise we denote it as x1.
            // For example, as shown in the Bitonic top K paper referenced
            // above, Figure5(a) shows that element[1] is in the second half of
            // the group when group size is 2, but it is in the first half of
            // the group when group size is 4.
            let isFirstInPair = elemIdx % (2 * uniforms.inc) < uniforms.inc;
            var i = 0;
            if (isFirstInPair) {
              i = elemIdx;
            } else {
              i = elemIdx - uniforms.inc;
            }

            var i0 = 0;
            if (uniforms.firstPass == 1) {
              i0 = i;
            } else {
              i0 = i32(getIndices(batch, i));
            }

            var i1 = 0;
            if (uniforms.firstPass == 1) {
              i1 = i + uniforms.inc;
            } else {
              i1 = i32(getIndices(batch, i + uniforms.inc));
            }

            var x0 = f32(0.0);
            var x1 = f32(0.0);
            if (i0 < uniforms.inputSize) {
              x0 = getX(batch, i0);
            } else {
              x0 = uniforms.negativeInf;
            }
            if (i1 < uniforms.inputSize) {
              x1 = getX(batch, i1);
            } else {
              x1 = uniforms.negativeInf;
            }

            let reverse = elemIdx % (2 * uniforms.dir) >= uniforms.dir;
            let isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
            if (reverse == isGreater) {
              // Elements in opposite order of direction
              let iTemp = i0;
              i0 = i1;
              i1 = iTemp;
            }
            if (isFirstInPair) {
              setOutputAtIndex(index, f32(i0));
            } else {
              setOutputAtIndex(index, f32(i1));
            }
          }
        }
      `}}class J4e{constructor(e){this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms="inputSize : i32, firstPass : i32, k : i32,",this.shaderKey="merge"}getUserCode(){return`
        ${vt("index")} {
          if (index < uniforms.size) {
            let outC = getCoordsFromIndex(index);
            let batch = outC[0];
            let elemIdx = outC[1];
            // The output size is half of the previous size.
            // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _
            // (k=4), we only need to output the indices at positions |, the
            // indices at positions _ can be thrown away, see Figure5(b) After
            // Phase 2 (Merge phase) in the Bitonic Top K paper referenced
            // above.
            // For example, the paper shows we only need to output the orange
            // bars. The output sequence should look like this | | | | | | | |.
            // Because the sequence is halved, to map the output index back to
            // the previous sequence to find the corresponding value, we need
            // to double the index. When we double the index, we basically
            // interpolate a position, so 2i looks like
            // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k
            // position of each 2k positions by - elemIdx % k. E.g. for output
            // at index 4,5,6,7, we want to get the corresponding element at
            // original index 8,9,10,11, for output at index 8,9,10,11,
            // we want to get the corresponding element at original index
            // 16,17,18,19, so on and so forth.

            var i = 0;
            if (elemIdx < uniforms.k) {
              i = elemIdx;
            } else {
              i = elemIdx * 2 - elemIdx % uniforms.k;
            }
            var i0 = 0;
            if (uniforms.firstPass == 1) {
              i0 = i;
            } else {
              i0 = i32(getIndices(batch, i));
            }
            var i1 = 0;
            if (uniforms.firstPass == 1) {
              i1 = i + uniforms.k;
            } else {
              i1 = i32(getIndices(batch, i + uniforms.k));
            }

            let x0 = getX(batch, i0);
            var x1 = f32(0.0);
            if (i1 < uniforms.inputSize) {
              x1 = getX(batch, i1);
            } else {
              x1 = x0;
            }

            if (x0 >= x1) {
              setOutputAtIndex(index, f32(i0));
            } else {
              setOutputAtIndex(index, f32(i1));
            }
          }
        }
      `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lp(n,e){e!==null&&n.disposeData(e.dataId)}function S4(n){let e=1;for(;e<n;)e*=2;return e}function eUe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{k:s,sorted:o}=r,a=i.shape,l=a[a.length-1];if(t.shouldExecuteOnCPU([i])){const T=t.readSync(i.dataId),[M,k]=gPe(T,a,i.dtype,s,o);return[t.makeTensorInfo(M.shape,M.dtype,M.values),t.makeTensorInfo(k.shape,k.dtype,k.values)]}if(s===0)return a[a.length-1]=0,[t.makeTensorInfo(a,i.dtype,[]),t.makeTensorInfo(a,"int32",[])];if(l===1)return[i,Xs({attrs:{shape:a,dtype:"int32",value:0},backend:t})];const u=gt(a)/l,d=Ht({inputs:{x:i},attrs:{shape:[u,l]},backend:t}),h=S4(s),f=S4(l);let p=null;const x=()=>p===null?[d,d]:[d,p],v=(T,M,k)=>{const P=x(),z=new Q4e(k),L=[{type:"int32",data:[l]},{type:"int32",data:[p===null?1:0]},{type:"float32",data:[Number.NEGATIVE_INFINITY]},{type:"int32",data:[T]},{type:"int32",data:[M]}],W=p;p=t.runWebGPUProgram(z,P,"int32",L),Lp(t,W)};for(let T=1;T<h;T*=2){const M=T*2;for(let k=T;k>=1;k/=2)v(M,k,[u,f])}for(let T=f;T>h;T/=2){const M=x(),k=new J4e([u,T/2]),z=[{type:"int32",data:[l]},{type:"int32",data:[p===null?1:0]},{type:"int32",data:[h]}],I=p;p=t.runWebGPUProgram(k,M,"int32",z),Lp(t,I);const L=h/2,W=L*2;for(let q=L;q>=1;q/=2)v(W,q,p.shape)}let y=p;p=Og({inputs:{x:p},backend:t,attrs:{begin:0,size:[u,s]}}),Lp(t,y);let b=sK({inputs:{x:d,indices:p},backend:t,attrs:{axis:1,batchDims:1}});Lp(t,d);const S=a.slice(0,-1);S.push(s),y=p,p=Ht({inputs:{x:p},attrs:{shape:S},backend:t}),Lp(t,y);const _=b;return b=Ht({inputs:{x:b},attrs:{shape:S},backend:t}),Lp(t,_),[b,p]}const tUe={kernelName:q7,backendName:"webgpu",kernelFunc:eUe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nUe{constructor(e){this.variableNames=["Image","Transforms"],this.uniforms="interpolationModeId : i32, fillModeId : i32, fillValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="transform"}getUserCode(){return`
          fn mapCoord(outCoord : f32, len : f32) -> f32{
            var inCoord = outCoord;
            if(uniforms.fillModeId == 2) {
              if (inCoord < 0.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz2 = 2.0 * len;
                  if (inCoord < sz2) {
                    inCoord = sz2 * f32(i32(f32(-inCoord / sz2))) +
                    inCoord;
                  }
                  if (inCoord < -len) {
                    inCoord = inCoord + sz2;
                  } else {
                    inCoord = -inCoord - 1.0;
                  }
                }
              } else if (inCoord > len - 1.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz2 = 2.0 * len;
                  inCoord = inCoord - sz2 * f32(i32(f32(inCoord / sz2)));
                  if (inCoord >= len) {
                    inCoord = sz2 - inCoord - 1.0;
                  }
                }
              }
              return clamp(inCoord, 0.0, len - 1.0);
            } else if (uniforms.fillModeId == 3) {
              if (inCoord < 0.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz = len - 1.0;
                  inCoord = inCoord + len * (f32(i32(f32(-inCoord / sz))) + 1.0);
                }
              } else if (inCoord > len - 1.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz = len - 1.0;
                  inCoord = inCoord - len * f32(i32(f32(inCoord / sz)));
                }
              }
              return clamp(inCoord, 0.0, len - 1.0);
            } else if (uniforms.fillModeId == 4) {
              return clamp(outCoord, 0.0, len - 1.0);
            }
            return outCoord;
          }
          fn readWithFillValue(batch : i32, coordY : i32, coordX : i32,
            channel : i32) -> f32 {
            var outputValue : f32;
            if (0 <= coordY && coordY < uniforms.imageShape[1] && 0 <= coordX && coordX < uniforms.imageShape[2]) {
                outputValue = getImage(batch, coordY, coordX, channel);
            } else {
              outputValue = uniforms.fillValue;
            }
            return outputValue;
          }

          ${vt("index")} {
            if (index < uniforms.size) {
              let coords = getCoordsFromIndex(index);
              var outputValue : f32;
              let batch = coords[0];
              let x = coords[2];
              let y = coords[1];
              let channel = coords[3];
              let xf = f32(x);
              let yf = f32(y);
              let a1 = getTransforms(batch, 0);
              let a2 = getTransforms(batch, 1);
              let a3 = getTransforms(batch, 2);
              let b1 = getTransforms(batch, 3);
              let b2 = getTransforms(batch, 4);
              let b3 = getTransforms(batch, 5);
              let c1 = getTransforms(batch, 6);
              let c2 = getTransforms(batch, 7);
              let projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = uniforms.fillValue;
              } else {
                let inX = (a1 * xf + a2 * yf + a3) / projection;
                let inY = (b1 * xf + b2 * yf + b3) / projection;
                let mapX = mapCoord(inX, f32(uniforms.imageShape[2]));
                let mapY = mapCoord(inY, f32(uniforms.imageShape[1]));

                if (uniforms.interpolationModeId == 1) {
                  let coordY = i32(round(mapY));
                  let coordX = i32(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  let yFloor = floor(mapY);
                  let xFloor = floor(mapX);
                  let yCeil = yFloor + 1.0;
                  let xCeil = xFloor + 1.0;
                  let valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, i32(yFloor), i32(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, i32(yFloor), i32(xCeil), channel);
                  let valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, i32(yCeil), i32(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, i32(yCeil), i32(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutputAtIndex(index, outputValue);
            }
          }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rUe(n){const{inputs:e,backend:t,attrs:r}=n,{image:i,transforms:s}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=r,[u,d,h,f]=i.shape,[p,x]=c??[d,h],v=[u,p,x,f],y=new nUe(v),b=o==="nearest"?1:2;let S;switch(a){case"constant":S=1;break;case"reflect":S=2;break;case"wrap":S=3;break;case"nearest":S=4;break;default:S=1;break}const _=[{type:"int32",data:[b]},{type:"int32",data:[S]},{type:"float32",data:[l]}];return t.runWebGPUProgram(y,[i,s],"float32",_)}const iUe={kernelName:X7,backendName:"webgpu",kernelFunc:rUe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sUe(n){const{inputs:e,backend:t,attrs:r}=n,{value:i}=e;let{axis:s}=r;s<0&&(s+=i.shape.length);const o=i,a=o.shape.length,l=i.shape[s],c=new Array(a-1);let u=0;for(let x=0;x<a;x++)x!==s&&(c[u++]=o.shape[x]);const d=[],h=new Array(a).fill(0),f=o.shape.slice();f[s]=1;const p=new Array(l);for(let x=0;x<p.length;x++){h[s]=x;const v=Og({inputs:{x:o},backend:t,attrs:{begin:h,size:f}}),y=Ht({inputs:{x:v},backend:t,attrs:{shape:c}});p[x]=y,d.push(v)}return d.forEach(x=>t.disposeData(x.dataId)),p}const oUe={kernelName:K7,backendName:"webgpu",kernelFunc:sUe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aUe{constructor(e,t,r){if(this.outputShape=[],this.variableNames=["x","segmentIds"],this.uniforms="numSegments : i32, xSize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=t,this.dispatchLayout=Nt(e),this.dispatch=xt(this.dispatchLayout,e,this.workgroupSize),r!=="float32"&&r!=="int32")throw new Error(`UnsortedSegmentSum only supports float32 and int32
              types, does not support ${r} type.`);this.type=r,this.shaderKey="unsortedSegmentSum"}getUserCode(){return`
    ${vt("index")} {
      if (index < uniforms.xSize) {
        let coords = getXCoordsFromIndex(index);
        let b = coords[0];
        let inCol = coords[1];

        let segmentId = i32(getSegmentIds(inCol));
        if (segmentId >= 0) {
          let flatIndex = b * uniforms.numSegments + segmentId % uniforms.numSegments;
          let value = getX(b, inCol);

          ${Ld("&result[flatIndex]","value",this.type)}
        }
      }
    }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lUe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,segmentIds:s}=e,{numSegments:o}=r,a=i.shape.length,l=[];let c=0;const u=Sx([c],a);let d=i;u!=null&&(d=Xl({inputs:{x:i},backend:t,attrs:{perm:u}}),l.push(d),c=_x(1,a)[0]);const h=QAe(d.shape,c,o),f=gt([d.shape[c]]),p=Ht({inputs:{x:d},backend:t,attrs:{shape:[-1,f]}});l.push(p);const x=i.dtype,v=[p.shape[0],o],y=Xs({backend:t,attrs:{shape:v,value:0,dtype:x}}),b=new aUe(p.shape,v,x),S=[{type:"int32",data:[o]},{type:"int32",data:[gt(p.shape)]}],_=t.runWebGPUProgram(b,[p,s],x,S,y),T=Ht({inputs:{x:_},backend:t,attrs:{shape:h}});l.push(_);let M=T;if(u!=null){l.push(T);const k=Vq(u);M=Xl({inputs:{x:M},backend:t,attrs:{perm:k}})}return l.forEach(k=>t.disposeData(k.dataId)),M}const cUe={kernelName:Y7,backendName:"webgpu",kernelFunc:lUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uUe=[kRe,xPe,bPe,_Pe,CPe,APe,LPe,FPe,UPe,$Pe,VPe,HPe,qPe,KPe,ZPe,nDe,iDe,lDe,uDe,hDe,yDe,bDe,EDe,ADe,kDe,DDe,RRe,FDe,$De,KDe,tLe,sLe,lLe,uLe,hLe,pLe,gLe,xLe,bLe,_Le,CLe,ALe,LLe,FLe,ILe,BLe,VLe,qLe,KLe,QLe,nOe,iOe,oOe,lOe,uOe,hOe,fOe,mOe,yOe,MRe,xOe,COe,bOe,_Oe,AOe,kOe,ROe,LOe,zOe,BOe,jOe,IRe,WOe,UDe,GOe,XOe,YOe,QOe,eFe,nFe,sFe,cFe,aFe,dFe,fFe,mFe,xFe,SFe,JPe,EFe,TFe,DFe,AFe,RFe,OFe,eDe,zFe,BFe,jFe,WFe,KFe,JLe,ZFe,JFe,tze,CDe,ize,oze,lze,dze,fze,mze,yze,xze,TDe,bze,_ze,Cze,Mze,ARe,kze,Pze,Oze,Uze,jze,Wze,Gze,Xze,Yze,Jze,n4e,i4e,o4e,l4e,u4e,h4e,mDe,z4e,$4e,V4e,qFe,p4e,y4e,S4e,E4e,N4e,I4e,P4e,D4e,O4e,H4e,eOe,q4e,K4e,Z4e,M4e,tUe,iUe,IPe,oUe,cUe,sze];for(const n of uUe)wwe(n);/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var dK=function(n,e){return(dK=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])})(n,e)};function hK(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}dK(n,e),n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Er=function(){return(Er=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}).apply(this,arguments)};function Zn(n,e,t,r){return new(t||(t=Promise))(function(i,s){function o(c){try{l(r.next(c))}catch(u){s(u)}}function a(c){try{l(r.throw(c))}catch(u){s(u)}}function l(c){var u;c.done?i(c.value):(u=c.value,u instanceof t?u:new t(function(d){d(u)})).then(o,a)}l((r=r.apply(n,[])).next())})}function Qn(n,e){var t,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(c){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,r=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(i=o.trys,!((i=i.length>0&&i[i.length-1])||u[0]!==6&&u[0]!==2)){o=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){o.label=u[1];break}if(u[0]===6&&o.label<i[1]){o.label=i[1],i=u;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(u);break}i[2]&&o.ops.pop(),o.trys.pop();continue}u=e.call(n,o)}catch(d){u=[6,d],r=0}finally{t=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,c])}}}function Fh(n,e,t){if(t||arguments.length===2)for(var r,i=0,s=e.length;i<s;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return n.concat(r||Array.prototype.slice.call(e))}var Kl=["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"],U0=["nose","left_eye_inner","left_eye","left_eye_outer","right_eye_inner","right_eye","right_eye_outer","left_ear","right_ear","mouth_left","mouth_right","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_pinky","right_pinky","left_index","right_index","left_thumb","right_thumb","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle","left_heel","right_heel","left_foot_index","right_foot_index"];function KS(n){return n instanceof SVGAnimatedLength?n.baseVal.value:n}function fK(n){return Zn(this,void 0,void 0,function(){var e,t;return Qn(this,function(r){switch(r.label){case 0:return e=document.createElement("canvas"),n instanceof ei?[4,C3(n,e)]:[3,2];case 1:return r.sent(),[3,3];case 2:e.width=KS(n.width),e.height=KS(n.height),t=e.getContext("2d"),n instanceof ImageData?t.putImageData(n,0,0):t.drawImage(n,0,0),r.label=3;case 3:return[2,e]}})})}function pK(n){return Zn(this,void 0,void 0,function(){var e,t,r,i,s,o;return Qn(this,function(a){switch(a.label){case 0:return n instanceof ei?(e=n.shape.slice(0,2),t=e[0],r=e[1],i=ImageData.bind,[4,C3(n)]):[3,2];case 1:return[2,new(i.apply(ImageData,[void 0,a.sent(),r,t]))];case 2:return s=document.createElement("canvas"),o=s.getContext("2d"),s.width=KS(n.width),s.height=KS(n.height),o.drawImage(n,0,0),[2,o.getImageData(0,0,s.width,s.height)]}})})}function dUe(n){return Zn(this,void 0,void 0,function(){var e,t;return Qn(this,function(r){switch(r.label){case 0:return n instanceof SVGImageElement||n instanceof OffscreenCanvas?[4,fK(n)]:[3,2];case 1:return t=r.sent(),[3,3];case 2:t=n,r.label=3;case 3:return e=t,[2,NX(e,4)]}})})}function mK(n){if(n<0||n>=256)throw new Error("Mask value must be in range [0, 255] but got ".concat(n));if(!Number.isInteger(n))throw new Error("Mask value must be an integer but got ".concat(n))}var Fy={runtime:"mediapipe",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,modelType:"full"},hUe=function(){function n(e){this.mask=e}return n.prototype.toCanvasImageSource=function(){return Zn(this,void 0,void 0,function(){return Qn(this,function(e){return[2,this.mask]})})},n.prototype.toImageData=function(){return Zn(this,void 0,void 0,function(){return Qn(this,function(e){return[2,pK(this.mask)]})})},n.prototype.toTensor=function(){return Zn(this,void 0,void 0,function(){return Qn(this,function(e){return[2,dUe(this.mask)]})})},n.prototype.getUnderlyingType=function(){return"canvasimagesource"},n}();function fUe(n){return mK(n),"person"}var pUe=function(){function n(e){var t,r=this;switch(this.width=0,this.height=0,this.selfieMode=!1,this.poseSolution=new kxe.Pose({locateFile:function(i,s){if(e.solutionPath){var o=e.solutionPath.replace(/\/+$/,"");return"".concat(o,"/").concat(i)}return"".concat(s,"/").concat(i)}}),e.modelType){case"lite":t=0;break;case"heavy":t=2;break;case"full":default:t=1}this.poseSolution.setOptions({modelComplexity:t,smoothLandmarks:e.enableSmoothing,enableSegmentation:e.enableSegmentation,smoothSegmentation:e.smoothSegmentation,selfieMode:this.selfieMode}),this.poseSolution.onResults(function(i){if(r.height=i.image.height,r.width=i.image.width,i.poseLandmarks==null)r.poses=[];else{var s=r.translateOutput(i.poseLandmarks,i.poseWorldLandmarks);i.segmentationMask&&(s.segmentation={maskValueToLabel:fUe,mask:new hUe(i.segmentationMask)}),r.poses=[s]}})}return n.prototype.translateOutput=function(e,t){var r=this,i={keypoints:e.map(function(s,o){return{x:s.x*r.width,y:s.y*r.height,z:s.z,score:s.visibility,name:U0[o]}})};return t!=null&&(i.keypoints3D=t.map(function(s,o){return{x:s.x,y:s.y,z:s.z,score:s.visibility,name:U0[o]}})),i},n.prototype.estimatePoses=function(e,t,r){return Zn(this,void 0,void 0,function(){var i,s;return Qn(this,function(o){switch(o.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.poseSolution.setOptions({selfieMode:this.selfieMode})),e instanceof ei?(s=ImageData.bind,[4,C3(e)]):[3,2];case 1:return i=new(s.apply(ImageData,[void 0,o.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:i=e,o.label=3;case 3:return e=i,[4,this.poseSolution.send({image:e},r)];case 4:return o.sent(),[2,this.poses]}})})},n.prototype.dispose=function(){this.poseSolution.close()},n.prototype.reset=function(){this.poseSolution.reset()},n.prototype.initialize=function(){return this.poseSolution.initialize()},n}();function mUe(n){return Zn(this,void 0,void 0,function(){var e,t;return Qn(this,function(r){switch(r.label){case 0:return e=function(i){if(i==null)return Er({},Fy);var s=Er({},i);return s.runtime="mediapipe",s.enableSegmentation==null&&(s.enableSegmentation=Fy.enableSegmentation),s.enableSmoothing==null&&(s.enableSmoothing=Fy.enableSmoothing),s.smoothSegmentation==null&&(s.smoothSegmentation=Fy.smoothSegmentation),s.modelType==null&&(s.modelType=Fy.modelType),s}(n),[4,(t=new pUe(e)).initialize()];case 1:return r.sent(),[2,t]}})})}function sg(n){return n instanceof ei?{height:n.shape[0],width:n.shape[1]}:{height:n.height,width:n.width}}function gK(n){return n-2*Math.PI*Math.floor((n+Math.PI)/(2*Math.PI))}function I3(n){return n instanceof ei?n:NX(n)}function yK(n,e,t){return GN(t,"inputResolution"),[1/t.width*n[0][0]*e.width,1/t.height*n[0][1]*e.width,n[0][3]*e.width,1/t.width*n[1][0]*e.height,1/t.height*n[1][1]*e.height,n[1][3]*e.height,0,0]}function GN(n,e){te(n.width!==0,function(){return"".concat(e," width cannot be 0.")}),te(n.height!==0,function(){return"".concat(e," height cannot be 0.")})}function ET(n,e,t){var r=t.rotationVectorStartKeypointIndex,i=t.rotationVectorEndKeypointIndex,s=n.locationData,o=s.relativeKeypoints[r].x*e.width,a=s.relativeKeypoints[r].y*e.height,l=s.relativeKeypoints[i].x*e.width,c=s.relativeKeypoints[i].y*e.height,u=2*Math.sqrt((l-o)*(l-o)+(c-a)*(c-a)),d=function(h,f,p){var x,v=h.locationData,y=p.rotationVectorStartKeypointIndex,b=p.rotationVectorEndKeypointIndex;x=p.rotationVectorTargetAngle?p.rotationVectorTargetAngle:Math.PI*p.rotationVectorTargetAngleDegree/180;var S=v.relativeKeypoints[y].x*f.width,_=v.relativeKeypoints[y].y*f.height,T=v.relativeKeypoints[b].x*f.width,M=v.relativeKeypoints[b].y*f.height;return gK(x-Math.atan2(-(M-_),T-S))}(n,e,t);return{xCenter:o/e.width,yCenter:a/e.height,width:u/e.width,height:u/e.height,rotation:d}}function vK(n){if(n.length!==16)throw new Error("Array length must be 16 but got ".concat(n.length));return[[n[0],n[1],n[2],n[3]],[n[4],n[5],n[6],n[7]],[n[8],n[9],n[10],n[11]],[n[12],n[13],n[14],n[15]]]}function CT(n,e,t,r,i,s,o){return n[e][i]*(n[t][s]*n[r][o]-n[t][o]*n[r][s])}function ws(n,e,t){var r=(e+1)%4,i=(e+2)%4,s=(e+3)%4,o=(t+1)%4,a=(t+2)%4,l=(t+3)%4;return CT(n,r,i,s,o,a,l)+CT(n,i,s,r,o,a,l)+CT(n,s,r,i,o,a,l)}function _4(n,e,t){t===void 0&&(t={ignoreRotation:!1});for(var r=[],i=0,s=n;i<s.length;i++){var o=s[i],a=o.x-.5,l=o.y-.5,c=t.ignoreRotation?0:e.rotation,u=Math.cos(c)*a-Math.sin(c)*l,d=Math.sin(c)*a+Math.cos(c)*l;u=u*e.width+e.xCenter,d=d*e.height+e.yCenter;var h=o.z*e.width,f=Er({},o);f.x=u,f.y=d,f.z=h,r.push(f)}return r}function xK(n,e){var t=function(r,i,s,o){var a=i-r,l=o-s,c=l/a;return{scale:c,offset:s-r*c}}(0,255,e[0],e[1]);return yn(function(){return Xt(lt(n,t.scale),t.offset)})}function qN(n,e,t){var r,i,s,o,a,l,c,u,d,h,f,p,x,v,y=e.outputTensorSize,b=e.keepAspectRatio,S=e.borderMode,_=e.outputTensorFloatRange,T=sg(n),M=function(z,I){return I?{xCenter:I.xCenter*z.width,yCenter:I.yCenter*z.height,width:I.width*z.width,height:I.height*z.height,rotation:I.rotation}:{xCenter:.5*z.width,yCenter:.5*z.height,width:z.width,height:z.height,rotation:0}}(T,t),k=function(z,I,L){if(L===void 0&&(L=!1),!L)return{top:0,left:0,right:0,bottom:0};var W=I.height,q=I.width;GN(I,"targetSize"),GN(z,"roi");var $,ne,Y=W/q,we=z.height/z.width,H=0,X=0;return Y>we?($=z.width,ne=z.width*Y,X=(1-we/Y)/2):($=z.height/Y,ne=z.height,H=(1-Y/we)/2),z.width=$,z.height=ne,{top:X,left:H,right:H,bottom:X}}(M,y,b),P=(r=M,i=T.width,s=T.height,o=!1,a=r.width,l=r.height,c=o?-1:1,u=Math.cos(r.rotation),d=Math.sin(r.rotation),h=r.xCenter,f=r.yCenter,p=1/i,x=1/s,(v=new Array(16))[0]=a*u*c*p,v[1]=-l*d*p,v[2]=0,v[3]=(-.5*a*u*c+.5*l*d+h)*p,v[4]=a*d*c*x,v[5]=l*u*x,v[6]=0,v[7]=(-.5*l*u-.5*a*d*c+f)*x,v[8]=0,v[9]=0,v[10]=a*p,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,vK(v));return{imageTensor:yn(function(){var z=I3(n),I=Ca(yK(P,T,y),[1,8]),L=S==="zero"?"constant":"nearest",W=Xh.transform(Fo(Cr(z,"float32")),I,"bilinear",L,0,[y.height,y.width]);return _!=null?xK(W,_):W}),padding:k,transformationMatrix:P}}function E4(n,e,t,r){return r===1?.5*(n+e):n+(e-n)*t/(r-1)}function gUe(n){return yn(function(){var e=function(i){return yn(function(){return[Rn(i,[0,0,0],[1,-1,1]),Rn(i,[0,0,1],[1,-1,-1])]})}(n),t=e[0],r=e[1];return{boxes:mr(r),logits:mr(t)}})}function wK(n){return n!=null&&n.currentTime!=null}function C4(n){for(var e={locationData:{relativeKeypoints:[]}},t=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER,o=0;o<n.length;++o){var a=n[o];t=Math.min(t,a.x),r=Math.max(r,a.x),i=Math.min(i,a.y),s=Math.max(s,a.y),e.locationData.relativeKeypoints.push({x:a.x,y:a.y})}return e.locationData.relativeBoundingBox={xMin:t,yMin:i,xMax:r,yMax:s,width:r-t,height:s-i},e}function yUe(n,e,t,r){return Zn(this,void 0,void 0,function(){var i,s,o,a,l;return Qn(this,function(c){switch(c.label){case 0:return n.sort(function(u,d){return Math.max.apply(Math,d.score)-Math.max.apply(Math,u.score)}),i=Ca(n.map(function(u){return[u.locationData.relativeBoundingBox.yMin,u.locationData.relativeBoundingBox.xMin,u.locationData.relativeBoundingBox.yMax,u.locationData.relativeBoundingBox.xMax]})),s=is(n.map(function(u){return u.score[0]})),[4,Xh.nonMaxSuppressionAsync(i,s,e,t)];case 1:return[4,(o=c.sent()).array()];case 2:return a=c.sent(),l=n.filter(function(u,d){return a.indexOf(d)>-1}),fr([i,s,o]),[2,l]}})})}function bK(n,e){return n.map(function(t){var r=Er(Er({},t),{x:t.x*e.width,y:t.y*e.height});return t.z!=null&&(r.z=t.z*e.width),r})}function vUe(n,e,t){return Zn(this,void 0,void 0,function(){var r,i,s,o,a,l,c,u,d,h,f,p,x,v,y,b,S,_,T,M,k,P,z,I;return Qn(this,function(L){switch(L.label){case 0:if(r=mr(e,[0]),i=r.shape,s=i[0],o=i[1],a=i[2],n.length!==a)throw new Error("Expected heatmap to have same number of channels as the number of landmarks. But got landmarks length: "+"".concat(n.length,", heatmap length: ").concat(a));return l=[],[4,r.buffer()];case 1:for(c=L.sent(),u=0;u<n.length;u++)if(d=n[u],h=Er({},d),l.push(h),f=Math.trunc(h.x*o),p=Math.trunc(h.y*s),!(f<0||f>=o||p<0||f>=s)){for(x=Math.trunc((t.kernelSize-1)/2),v=Math.max(0,f-x),y=Math.min(o,f+x+1),b=Math.max(0,p-x),S=Math.min(s,p+x+1),_=0,T=0,M=0,k=0,P=b;P<S;++P)for(z=v;z<y;++z)I=c.get(P,z,u),_+=I,k=Math.max(k,I),T+=z*I,M+=P*I;k>=t.minConfidenceToRefine&&_>0&&(h.x=T/o/_,h.y=M/s/_)}return r.dispose(),[2,l]}})})}function T4(n,e){var t=e.left,r=e.top,i=e.left+e.right,s=e.top+e.bottom;return n.map(function(o){return Er(Er({},o),{x:(o.x-t)/(1-i),y:(o.y-r)/(1-s),z:o.z/(1-i)})})}function xUe(n,e,t){return M0()==="webgl"?function(r,i,s){var o=s.combineWithPreviousRatio.toFixed(2),a={variableNames:["prevMask","newMask"],outputShape:r.shape,userCode:`
  void main() {
      ivec2 coords = getOutputCoords();
      int height = coords[0];
      int width = coords[1];

      float prevMaskValue = getPrevMask(height, width);
      float newMaskValue = getNewMask(height, width);

      /*
      * Assume p := newMaskValue
      * H(p) := 1 + (p * log(p) + (1-p) * log(1-p)) / log(2)
      * uncertainty alpha(p) =
      *   Clamp(1 - (1 - H(p)) * (1 - H(p)), 0, 1) [squaring the
      * uncertainty]
      *
      * The following polynomial approximates uncertainty alpha as a
      * function of (p + 0.5):
      */
      const float c1 = 5.68842;
      const float c2 = -0.748699;
      const float c3 = -57.8051;
      const float c4 = 291.309;
      const float c5 = -624.717;
      float t = newMaskValue - 0.5;
      float x = t * t;

      float uncertainty =
        1.0 - min(1.0, x * (c1 + x * (c2 + x * (c3 + x * (c4 + x * c5)))));

      float outputValue = newMaskValue + (prevMaskValue - newMaskValue) *
                             (uncertainty * `.concat(o,`);

      setOutput(outputValue);
    }
`)},l=tg();return yn(function(){var c=l.compileAndRun(a,[r,i]);return Cm().makeTensorFromDataId(c.dataId,c.shape,c.dtype)})}(n,e,t):yn(function(){var r=Sn(e,.5),i=Ea(r),s=Sn(1,R0(1,lt(i,Xt(5.68842,lt(i,Xt(-.748699,lt(i,Xt(-57.8051,lt(i,Xt(291.309,lt(i,-624.717)))))))))));return Xt(e,lt(Sn(n,e),lt(s,t.combineWithPreviousRatio)))})}function wUe(n,e,t){return Zn(this,void 0,void 0,function(){var r,i,s,o,a;return Qn(this,function(l){switch(l.label){case 0:return r=n[0],i=n[1],s=function(c,u,d){return yn(function(){var h,f,p,x;d.reverseOutputOrder?(f=mr(Rn(c,[0,d.boxCoordOffset+0],[-1,1])),h=mr(Rn(c,[0,d.boxCoordOffset+1],[-1,1])),x=mr(Rn(c,[0,d.boxCoordOffset+2],[-1,1])),p=mr(Rn(c,[0,d.boxCoordOffset+3],[-1,1]))):(h=mr(Rn(c,[0,d.boxCoordOffset+0],[-1,1])),f=mr(Rn(c,[0,d.boxCoordOffset+1],[-1,1])),p=mr(Rn(c,[0,d.boxCoordOffset+2],[-1,1])),x=mr(Rn(c,[0,d.boxCoordOffset+3],[-1,1]))),f=Xt(lt(On(f,d.xScale),u.w),u.x),h=Xt(lt(On(h,d.yScale),u.h),u.y),d.applyExponentialOnBoxSize?(p=lt(qc(On(p,d.hScale)),u.h),x=lt(qc(On(x,d.wScale)),u.w)):(p=lt(On(p,d.hScale),u.h),x=lt(On(x,d.wScale),u.h));var v=Sn(h,On(p,2)),y=Sn(f,On(x,2)),b=Xt(h,On(p,2)),S=Xt(f,On(x,2)),_=Ui([Ke(v,[d.numBoxes,1]),Ke(y,[d.numBoxes,1]),Ke(b,[d.numBoxes,1]),Ke(S,[d.numBoxes,1])],1);if(d.numKeypoints)for(var T=0;T<d.numKeypoints;++T){var M=d.keypointCoordOffset+T*d.numValuesPerKeypoint,k=void 0,P=void 0;d.reverseOutputOrder?(k=mr(Rn(c,[0,M],[-1,1])),P=mr(Rn(c,[0,M+1],[-1,1]))):(P=mr(Rn(c,[0,M],[-1,1])),k=mr(Rn(c,[0,M+1],[-1,1])));var z=Xt(lt(On(k,d.xScale),u.w),u.x),I=Xt(lt(On(P,d.yScale),u.h),u.y);_=Ui([_,Ke(z,[d.numBoxes,1]),Ke(I,[d.numBoxes,1])],1)}return _})}(i,e,t),o=yn(function(){var c=r;return t.sigmoidScore?(t.scoreClippingThresh!=null&&(c=zq(r,-t.scoreClippingThresh,t.scoreClippingThresh)),c=Dc(c)):c}),[4,bUe(s,o,t)];case 1:return a=l.sent(),fr([s,o]),[2,a]}})})}function bUe(n,e,t){return Zn(this,void 0,void 0,function(){var r,i,s,o,a,l,c,u,d,h,f,p;return Qn(this,function(x){switch(x.label){case 0:return r=[],[4,n.data()];case 1:return i=x.sent(),[4,e.data()];case 2:for(s=x.sent(),o=0;o<t.numBoxes;++o)if(!(t.minScoreThresh!=null&&s[o]<t.minScoreThresh||(a=o*t.numCoords,l=SUe(i[a+0],i[a+1],i[a+2],i[a+3],s[o],t.flipVertically,o),(c=l.locationData.relativeBoundingBox).width<0||c.height<0))){if(t.numKeypoints>0)for((u=l.locationData).relativeKeypoints=[],d=t.numKeypoints*t.numValuesPerKeypoint,h=0;h<d;h+=t.numValuesPerKeypoint)f=a+t.keypointCoordOffset+h,p={x:i[f+0],y:t.flipVertically?1-i[f+1]:i[f+1]},u.relativeKeypoints.push(p);r.push(l)}return[2,r]}})})}function SUe(n,e,t,r,i,s,o){return{score:[i],ind:o,locationData:{relativeBoundingBox:{xMin:e,yMin:s?1-t:n,xMax:r,yMax:s?1-n:t,width:r-e,height:t-n}}}}function _Ue(n,e){return n==="none"?e:function(t){return 1/(1+Math.exp(-t))}(e)}function M4(n,e,t,r){return Zn(this,void 0,void 0,function(){var i,s,o,a,l,c,u,d;return Qn(this,function(h){switch(h.label){case 0:return t=t||e.flipHorizontally||!1,r=r||e.flipVertically||!1,i=n.size,s=i/e.numLandmarks,[4,n.data()];case 1:for(o=h.sent(),a=[],l=0;l<e.numLandmarks;++l)c=l*s,(d={x:0,y:0}).x=t?e.inputImageWidth-o[c]:o[c],s>1&&(d.y=r?e.inputImageHeight-o[c+1]:o[c+1]),s>2&&(d.z=o[c+2]),s>3&&(d.score=_Ue(e.visibilityActivation,o[c+3])),a.push(d);for(u=0;u<a.length;++u)(d=a[u]).x=d.x/e.inputImageWidth,d.y=d.y/e.inputImageHeight,d.z=d.z/e.inputImageWidth/(e.normalizeZ||1);return[2,a]}})})}function A4(n,e,t){var r=n.width,i=n.height,s=n.rotation;if(t.rotation==null&&t.rotationDegree==null||(s=function(c,u){return u.rotation!=null?c+=u.rotation:u.rotationDegree!=null&&(c+=Math.PI*u.rotationDegree/180),gK(c)}(s,t)),s===0)n.xCenter=n.xCenter+r*t.shiftX,n.yCenter=n.yCenter+i*t.shiftY;else{var o=(e.width*r*t.shiftX*Math.cos(s)-e.height*i*t.shiftY*Math.sin(s))/e.width,a=(e.width*r*t.shiftX*Math.sin(s)+e.height*i*t.shiftY*Math.cos(s))/e.height;n.xCenter=n.xCenter+o,n.yCenter=n.yCenter+a}{var l=Math.max(r*e.width,i*e.height);r=l/e.width,i=l/e.height}return n.width=r*t.scaleX,n.height=i*t.scaleY,n}function EUe(n,e){return n.map(function(t){var r=Er(Er({},t),{x:t.x/e.width,y:t.y/e.height});return t.z!=null&&(t.z=t.z/e.width),r})}var Uu=function(){function n(e){this.alpha=e,this.initialized=!1}return n.prototype.apply=function(e,t){var r;return this.initialized?r=t==null?this.storedValue+this.alpha*(e-this.storedValue):this.storedValue+this.alpha*t*Math.asinh((e-this.storedValue)/t):(r=e,this.initialized=!0),this.rawValue=e,this.storedValue=r,r},n.prototype.applyWithAlpha=function(e,t,r){return this.alpha=t,this.apply(e,r)},n.prototype.hasLastRawValue=function(){return this.initialized},n.prototype.lastRawValue=function(){return this.rawValue},n.prototype.reset=function(){this.initialized=!1},n}(),TT=function(){function n(e){this.frequency=e.frequency,this.minCutOff=e.minCutOff,this.beta=e.beta,this.thresholdCutOff=e.thresholdCutOff,this.thresholdBeta=e.thresholdBeta,this.derivateCutOff=e.derivateCutOff,this.x=new Uu(this.getAlpha(this.minCutOff)),this.dx=new Uu(this.getAlpha(this.derivateCutOff)),this.lastTimestamp=0}return n.prototype.apply=function(e,t,r){if(e==null)return e;var i=Math.trunc(t);if(this.lastTimestamp>=i)return e;this.lastTimestamp!==0&&i!==0&&(this.frequency=1/(1e-6*(i-this.lastTimestamp))),this.lastTimestamp=i;var s=this.x.hasLastRawValue()?(e-this.x.lastRawValue())*r*this.frequency:0,o=this.dx.applyWithAlpha(s,this.getAlpha(this.derivateCutOff)),a=this.minCutOff+this.beta*Math.abs(o),l=this.thresholdCutOff!=null?this.thresholdCutOff+this.thresholdBeta*Math.abs(o):null;return this.x.applyWithAlpha(e,this.getAlpha(a),l)},n.prototype.getAlpha=function(e){return 1/(1+this.frequency/(2*Math.PI*e))},n}(),XN=function(){function n(e){this.config=e}return n.prototype.apply=function(e,t,r){var i=this;if(e==null)return this.reset(),null;this.initializeFiltersIfEmpty(e);var s=1;if(!this.config.disableValueScaling){if(r<this.config.minAllowedObjectScale)return Fh([],e,!0);s=1/r}return e.map(function(o,a){var l=Er(Er({},o),{x:i.xFilters[a].apply(o.x,t,s),y:i.yFilters[a].apply(o.y,t,s)});return o.z!=null&&(l.z=i.zFilters[a].apply(o.z,t,s)),l})},n.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},n.prototype.initializeFiltersIfEmpty=function(e){var t=this;this.xFilters!=null&&this.xFilters.length===e.length||(this.xFilters=e.map(function(r){return new TT(t.config)}),this.yFilters=e.map(function(r){return new TT(t.config)}),this.zFilters=e.map(function(r){return new TT(t.config)}))},n}(),MT=function(){function n(e){this.config=e,this.window=[],this.lowPassFilter=new Uu(1),this.lastValue=0,this.lastValueScale=1,this.lastTimestamp=-1}return n.prototype.apply=function(e,t,r){if(e==null)return e;var i,s=Math.trunc(t);if(this.lastTimestamp>=s)return e;if(this.lastTimestamp===-1)i=1;else{for(var o=e*r-this.lastValue*this.lastValueScale,a=s-this.lastTimestamp,l=o,c=a,u=(1+this.window.length)*(1e6/30),d=0,h=this.window;d<h.length;d++){var f=h[d];if(c+f.duration>u)break;l+=f.distance,c+=f.duration}var p=l/(1e-6*c);i=1-1/(1+this.config.velocityScale*Math.abs(p)),this.window.unshift({distance:o,duration:a}),this.window.length>this.config.windowSize&&this.window.pop()}return this.lastValue=e,this.lastValueScale=r,this.lastTimestamp=s,this.lowPassFilter.applyWithAlpha(e,i)},n}(),CUe=function(){function n(e){this.config=e}return n.prototype.apply=function(e,t,r){var i=this;if(e==null)return this.reset(),null;var s=1;if(!this.config.disableValueScaling){if(r<this.config.minAllowedObjectScale)return Fh([],e,!0);s=1/r}return this.initializeFiltersIfEmpty(e),e.map(function(o,a){var l=Er(Er({},o),{x:i.xFilters[a].apply(o.x,t,s),y:i.yFilters[a].apply(o.y,t,s)});return o.z!=null&&(l.z=i.zFilters[a].apply(o.z,t,s)),l})},n.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},n.prototype.initializeFiltersIfEmpty=function(e){var t=this;this.xFilters!=null&&this.xFilters.length===e.length||(this.xFilters=e.map(function(r){return new MT(t.config)}),this.yFilters=e.map(function(r){return new MT(t.config)}),this.zFilters=e.map(function(r){return new MT(t.config)}))},n}(),AT=function(){function n(e){if(e.velocityFilter!=null)this.keypointsFilter=new CUe(e.velocityFilter);else{if(e.oneEuroFilter==null)throw new Error("Either configure velocityFilter or oneEuroFilter, but got "+"".concat(e,"."));this.keypointsFilter=new XN(e.oneEuroFilter)}}return n.prototype.apply=function(e,t,r,i,s){if(i===void 0&&(i=!1),e==null)return this.keypointsFilter.reset(),null;var o=s!=null?function(c,u){return(c.width*u.width+c.height*u.height)/2}(s,r):1,a=i?bK(e,r):e,l=this.keypointsFilter.apply(a,t,o);return i?EUe(l,r):l},n}(),N4=function(){function n(e){this.alpha=e.alpha}return n.prototype.apply=function(e){var t=this;if(e==null)return this.visibilityFilters=null,null;this.visibilityFilters!=null&&this.visibilityFilters.length===e.length||(this.visibilityFilters=e.map(function(a){return new Uu(t.alpha)}));for(var r=[],i=0;i<e.length;++i){var s=e[i],o=Er({},s);o.score=this.visibilityFilters[i].apply(s.score),r.push(o)}return r},n}(),TUe={interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:5,minScale:.1484375,maxScale:.75,inputSizeHeight:224,inputSizeWidth:224,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,32,32,32],aspectRatios:[1],fixedAnchorSize:!0},Op={runtime:"tfjs",modelType:"full",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/detector/1",landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"},MUe={maxPoses:1,flipHorizontal:!1},AUe={applyExponentialOnBoxSize:!1,flipVertically:!1,numBoxes:2254,numCoords:12,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:4,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:224,yScale:224,hScale:224,wScale:224,minScoreThresh:.5},NUe=.3,k4={shiftX:0,shiftY:0,scaleX:1.25,scaleY:1.25},kUe={outputTensorSize:{width:224,height:224},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},IUe={outputTensorSize:{width:256,height:256},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},RUe={numLandmarks:39,inputImageWidth:256,inputImageHeight:256,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},PUe={numLandmarks:39,inputImageWidth:1,inputImageHeight:1,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},DUe={kernelSize:7,minConfidenceToRefine:.5},I4={alpha:.1},LUe={oneEuroFilter:{frequency:30,minCutOff:.05,beta:80,derivateCutOff:1,minAllowedObjectScale:1e-6}},OUe={oneEuroFilter:{frequency:30,minCutOff:.01,beta:10,derivateCutOff:1,minAllowedObjectScale:1e-6}},FUe={oneEuroFilter:{frequency:30,minCutOff:.1,beta:40,derivateCutOff:1,minAllowedObjectScale:1e-6,disableValueScaling:!0}},zUe={activation:"none"},UUe={combineWithPreviousRatio:.7},BUe=function(){function n(e){this.mask=e}return n.prototype.toCanvasImageSource=function(){return Zn(this,void 0,void 0,function(){return Qn(this,function(e){return[2,fK(this.mask)]})})},n.prototype.toImageData=function(){return Zn(this,void 0,void 0,function(){return Qn(this,function(e){return[2,pK(this.mask)]})})},n.prototype.toTensor=function(){return Zn(this,void 0,void 0,function(){return Qn(this,function(e){return[2,this.mask]})})},n.prototype.getUnderlyingType=function(){return"tensor"},n}();function $Ue(n){return mK(n),"person"}var jUe=function(){function n(e,t,r,i,s,o){this.detectorModel=e,this.landmarkModel=t,this.enableSmoothing=r,this.enableSegmentation=i,this.smoothSegmentation=s,this.modelType=o,this.regionOfInterest=null,this.prevFilteredSegmentationMask=null,this.anchors=function(d){d.reduceBoxesInLowestLayer==null&&(d.reduceBoxesInLowestLayer=!1),d.interpolatedScaleAspectRatio==null&&(d.interpolatedScaleAspectRatio=1),d.fixedAnchorSize==null&&(d.fixedAnchorSize=!1);for(var h=[],f=0;f<d.numLayers;){for(var p=[],x=[],v=[],y=[],b=f;b<d.strides.length&&d.strides[b]===d.strides[f];){var S=E4(d.minScale,d.maxScale,b,d.strides.length);if(b===0&&d.reduceBoxesInLowestLayer)v.push(1),v.push(2),v.push(.5),y.push(.1),y.push(S),y.push(S);else{for(var _=0;_<d.aspectRatios.length;++_)v.push(d.aspectRatios[_]),y.push(S);if(d.interpolatedScaleAspectRatio>0){var T=b===d.strides.length-1?1:E4(d.minScale,d.maxScale,b+1,d.strides.length);y.push(Math.sqrt(S*T)),v.push(d.interpolatedScaleAspectRatio)}}b++}for(var M=0;M<v.length;++M){var k=Math.sqrt(v[M]);p.push(y[M]/k),x.push(y[M]*k)}var P=0,z=0;if(d.featureMapHeight.length>0)P=d.featureMapHeight[f],z=d.featureMapWidth[f];else{var I=d.strides[f];P=Math.ceil(d.inputSizeHeight/I),z=Math.ceil(d.inputSizeWidth/I)}for(var L=0;L<P;++L)for(var W=0;W<z;++W)for(var q=0;q<p.length;++q){var $={xCenter:(W+d.anchorOffsetX)/z,yCenter:(L+d.anchorOffsetY)/P,width:0,height:0};d.fixedAnchorSize?($.width=1,$.height=1):($.width=x[q],$.height=p[q]),h.push($)}f=b}return h}(TUe);var a=is(this.anchors.map(function(d){return d.width})),l=is(this.anchors.map(function(d){return d.height})),c=is(this.anchors.map(function(d){return d.xCenter})),u=is(this.anchors.map(function(d){return d.yCenter}));this.anchorTensor={x:c,y:u,w:a,h:l},this.prevFilteredSegmentationMask=this.enableSegmentation?Ca([],[0,0]):null}return n.prototype.estimatePoses=function(e,t,r){return Zn(this,void 0,void 0,function(){var i,s,o,a,l,c,u,d,h,f,p,x,v,y,b,S,_,T,M,k,P,z,I;return Qn(this,function(L){switch(L.label){case 0:return i=function(W){var q;if((q=W==null?MUe:Er({},W)).maxPoses==null&&(q.maxPoses=1),q.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(q.maxPoses,". Should be > 0."));if(q.maxPoses>1)throw new Error("Multi-pose detection is not implemented yet. Please set maxPoses to 1.");return q}(t),e==null?(this.reset(),[2,[]]):(this.maxPoses=i.maxPoses,this.timestamp=r!=null?1e3*r:wK(e)?1e6*e.currentTime:null,s=sg(e),o=yn(function(){return Cr(I3(e),"float32")}),(a=this.regionOfInterest)!=null?[3,2]:[4,this.detectPose(o)]);case 1:if((l=L.sent()).length===0)return this.reset(),o.dispose(),[2,[]];c=l[0],a=this.poseDetectionToRoi(c,s),L.label=2;case 2:return[4,this.poseLandmarksByRoi(a,o)];case 3:return u=L.sent(),o.dispose(),u==null?(this.reset(),[2,[]]):(d=u.landmarks,h=u.auxiliaryLandmarks,f=u.poseScore,p=u.worldLandmarks,x=u.segmentationMask,v=this.poseLandmarkFiltering(d,h,p,s),y=v.actualLandmarksFiltered,b=v.auxiliaryLandmarksFiltered,S=v.actualWorldLandmarksFiltered,_=this.poseLandmarksToRoi(b,s),this.regionOfInterest=_,T=this.smoothSegmentation&&x!=null?this.poseSegmentationFiltering(x):x,(M=y!=null?bK(y,s):null)!=null&&M.forEach(function(W,q){W.name=U0[q]}),(k=S)!=null&&k.forEach(function(W,q){W.name=U0[q]}),P={score:f,keypoints:M,keypoints3D:k},T!==null&&(z=yn(function(){var W=Fo(T,2),q=Sd(W,[[0,0],[0,0],[0,1]]);return rX(q,[[0,0],[0,0],[0,2]],"symmetric")}),this.smoothSegmentation||fr(T),I={maskValueToLabel:$Ue,mask:new BUe(z)},P.segmentation=I),[2,[P]])}})})},n.prototype.poseSegmentationFiltering=function(e){var t=this.prevFilteredSegmentationMask;return t.size===0?this.prevFilteredSegmentationMask=e:(this.prevFilteredSegmentationMask=xUe(t,e,UUe),fr(e)),fr(t),this.prevFilteredSegmentationMask},n.prototype.dispose=function(){this.detectorModel.dispose(),this.landmarkModel.dispose(),fr([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h,this.prevFilteredSegmentationMask])},n.prototype.reset=function(){this.regionOfInterest=null,this.enableSegmentation&&(fr(this.prevFilteredSegmentationMask),this.prevFilteredSegmentationMask=Ca([],[0,0])),this.visibilitySmoothingFilterActual=null,this.visibilitySmoothingFilterAuxiliary=null,this.landmarksSmoothingFilterActual=null,this.landmarksSmoothingFilterAuxiliary=null},n.prototype.detectPose=function(e){return Zn(this,void 0,void 0,function(){var t,r,i,s,o,a,l,c,u,d;return Qn(this,function(h){switch(h.label){case 0:return t=qN(e,kUe),r=t.imageTensor,i=t.padding,s=this.detectorModel.predict(r),o=gUe(s),a=o.boxes,[4,wUe([l=o.logits,a],this.anchorTensor,AUe)];case 1:return(c=h.sent()).length===0?(fr([r,s,l,a]),[2,c]):[4,yUe(c,this.maxPoses,NUe)];case 2:return u=h.sent(),d=function(f,p){f===void 0&&(f=[]);for(var x=p.left,v=p.top,y=p.left+p.right,b=p.top+p.bottom,S=0;S<f.length;S++){var _=f[S],T=_.locationData.relativeBoundingBox,M=(T.xMin-x)/(1-y),k=(T.yMin-v)/(1-b),P=T.width/(1-y),z=T.height/(1-b);T.xMin=M,T.yMin=k,T.width=P,T.height=z,T.xMax=M+P,T.yMax=k+z;var I=_.locationData.relativeKeypoints;I&&I.forEach(function(L){var W=(L.x-x)/(1-y),q=(L.y-v)/(1-b);L.x=W,L.y=q})}return f}(u,i),fr([r,s,l,a]),[2,d]}})})},n.prototype.poseDetectionToRoi=function(e,t){return A4(ET(e,t,{rotationVectorEndKeypointIndex:1,rotationVectorStartKeypointIndex:0,rotationVectorTargetAngleDegree:90}),t,k4)},n.prototype.poseLandmarksByRoi=function(e,t){return Zn(this,void 0,void 0,function(){var r,i,s,o,a,l,c,u,d,h,f,p,x,v;return Qn(this,function(y){switch(y.label){case 0:if(r=sg(t),i=qN(t,IUe,e),s=i.imageTensor,o=i.padding,a=i.transformationMatrix,this.modelType!=="lite"&&this.modelType!=="full"&&this.modelType!=="heavy")throw new Error("Model type must be one of lite, full or heavy,"+"but got ".concat(this.modelType));return l=["ld_3d","output_poseflag","activation_heatmap","world_3d"],this.enableSegmentation&&l.push("activation_segmentation"),c=this.landmarkModel.execute(s,l),[4,this.tensorsToPoseLandmarksAndSegmentation(c)];case 1:return(u=y.sent())==null?(fr(c),fr(s),[2,null]):(d=u.landmarks,h=u.auxiliaryLandmarks,f=u.poseScore,p=u.worldLandmarks,x=u.segmentationMask,[4,this.poseLandmarksAndSegmentationInverseProjection(r,e,o,a,d,h,p,x)]);case 2:return v=y.sent(),fr(c),fr(s),[2,Er({poseScore:f},v)]}})})},n.prototype.poseLandmarksAndSegmentationInverseProjection=function(e,t,r,i,s,o,a,l){return Zn(this,void 0,void 0,function(){var c,u,d,h,f,p;return Qn(this,function(x){return c=T4(s,r),u=T4(o,r),d=_4(c,t),h=_4(u,t),f=function(v,y){for(var b=[],S=0,_=v;S<_.length;S++){var T=_[S],M=T.x,k=T.y,P=y.rotation,z=Math.cos(P)*M-Math.sin(P)*k,I=Math.sin(P)*M+Math.cos(P)*k,L=Er({},T);L.x=z,L.y=I,b.push(L)}return b}(a,t),p=null,this.enableSegmentation&&(p=yn(function(){var v=l.shape,y=v[0],b=v[1],S=function(M){var k=vK(new Array(16).fill(0));k[0][0]=ws(M,0,0),k[1][0]=-ws(M,0,1),k[2][0]=ws(M,0,2),k[3][0]=-ws(M,0,3),k[0][2]=ws(M,2,0),k[1][2]=-ws(M,2,1),k[2][2]=ws(M,2,2),k[3][2]=-ws(M,2,3),k[0][1]=-ws(M,1,0),k[1][1]=ws(M,1,1),k[2][1]=-ws(M,1,2),k[3][1]=ws(M,1,3),k[0][3]=-ws(M,3,0),k[1][3]=ws(M,3,1),k[2][3]=-ws(M,3,2),k[3][3]=ws(M,3,3);for(var P=M[0][0]*k[0][0]+M[1][0]*k[0][1]+M[2][0]*k[0][2]+M[3][0]*k[0][3],z=0;z<k.length;z++)for(var I=0;I<k.length;I++)k[z][I]/=P;return k}(i),_=Ca(yK(S,{width:b,height:y},e),[1,8]),T=[1,y,b,1];return mr(Xh.transform(Ke(l,T),_,"bilinear","constant",0,[e.height,e.width]),[0,3])}),fr(l)),[2,{landmarks:d,auxiliaryLandmarks:h,worldLandmarks:f,segmentationMask:p}]})})},n.prototype.tensorsToPoseLandmarksAndSegmentation=function(e){return Zn(this,void 0,void 0,function(){var t,r,i,s,o,a,l,c,u,d,h,f,p;return Qn(this,function(x){switch(x.label){case 0:return t=e[0],r=e[1],i=e[2],s=e[3],o=this.enableSegmentation?e[4]:null,[4,r.data()];case 1:return(a=x.sent()[0])<.5?[2,null]:[4,M4(t,RUe)];case 2:return[4,vUe(x.sent(),i,DUe)];case 3:return l=x.sent(),c=l.slice(0,33),u=l.slice(33,35),[4,M4(s,PUe)];case 4:return d=x.sent(),h=d.slice(0,33),f=function(v,y,b){for(var S=[],_=0;_<v.length;_++){var T=Er({},y[_]);T.score=v[_].score,S.push(T)}return S}(c,h),p=this.enableSegmentation?function(v,y,b){return yn(function(){var S=mr(v,[0]),_=S.shape[2];if(_===1){var T=S;switch(y.activation){case"none":break;case"sigmoid":T=Dc(T);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported (".concat(y.activation,")"))}var M=T;return mr(M,[2])}throw new Error("Unsupported number of tensor channels ".concat(_))})}(o,zUe):null,[2,{landmarks:c,auxiliaryLandmarks:u,poseScore:a,worldLandmarks:f,segmentationMask:p}]}})})},n.prototype.poseLandmarksToRoi=function(e,t){return A4(ET(C4(e),t,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:90}),t,k4)},n.prototype.poseLandmarkFiltering=function(e,t,r,i){var s,o,a;if(this.timestamp!=null&&this.enableSmoothing){var l=ET(C4(t),i,{rotationVectorEndKeypointIndex:0,rotationVectorStartKeypointIndex:1,rotationVectorTargetAngleDegree:90});this.visibilitySmoothingFilterActual==null&&(this.visibilitySmoothingFilterActual=new N4(I4)),s=this.visibilitySmoothingFilterActual.apply(e),this.visibilitySmoothingFilterAuxiliary==null&&(this.visibilitySmoothingFilterAuxiliary=new N4(I4)),o=this.visibilitySmoothingFilterAuxiliary.apply(t),a=this.visibilitySmoothingFilterActual.apply(r),this.landmarksSmoothingFilterActual==null&&(this.landmarksSmoothingFilterActual=new AT(LUe)),s=this.landmarksSmoothingFilterActual.apply(s,this.timestamp,i,!0,l),this.landmarksSmoothingFilterAuxiliary==null&&(this.landmarksSmoothingFilterAuxiliary=new AT(OUe)),o=this.landmarksSmoothingFilterAuxiliary.apply(o,this.timestamp,i,!0,l),this.worldLandmarksSmoothingFilterActual==null&&(this.worldLandmarksSmoothingFilterActual=new AT(FUe)),a=this.worldLandmarksSmoothingFilterActual.apply(r,this.timestamp)}else s=e,o=t,a=r;return{actualLandmarksFiltered:s,auxiliaryLandmarksFiltered:o,actualWorldLandmarksFiltered:a}},n}();function VUe(n){return Zn(this,void 0,void 0,function(){var e,t,r,i,s,o;return Qn(this,function(a){switch(a.label){case 0:return e=function(l){var c=Er({},l??Op);if(c.enableSmoothing==null&&(c.enableSmoothing=Op.enableSmoothing),c.enableSegmentation==null&&(c.enableSegmentation=Op.enableSegmentation),c.smoothSegmentation==null&&(c.smoothSegmentation=Op.smoothSegmentation),c.modelType==null&&(c.modelType=Op.modelType),c.detectorModelUrl==null&&(c.detectorModelUrl=Op.detectorModelUrl),c.landmarkModelUrl==null)switch(c.modelType){case"lite":c.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/lite/2";break;case"heavy":c.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/heavy/2";break;case"full":default:c.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"}return c}(n),t=typeof e.detectorModelUrl=="string"&&e.detectorModelUrl.indexOf("https://tfhub.dev")>-1,r=typeof e.landmarkModelUrl=="string"&&e.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Promise.all([rg(e.detectorModelUrl,{fromTFHub:t}),rg(e.landmarkModelUrl,{fromTFHub:r})])];case 1:return i=a.sent(),s=i[0],o=i[1],[2,new jUe(s,o,e.enableSmoothing,e.enableSegmentation,e.smoothSegmentation,e.modelType)]}})})}var Yh,Vl,SK=function(){function n(e){(function(t){if(t.maxTracks<1)throw new Error("Must specify 'maxTracks' to be at least 1, but "+"encountered ".concat(t.maxTracks));if(t.maxAge<=0)throw new Error("Must specify 'maxAge' to be positive, but "+"encountered ".concat(t.maxAge));if(t.keypointTrackerParams!==void 0){if(t.keypointTrackerParams.keypointConfidenceThreshold<0||t.keypointTrackerParams.keypointConfidenceThreshold>1)throw new Error("Must specify 'keypointConfidenceThreshold' to be in the range [0, 1], but encountered "+"".concat(t.keypointTrackerParams.keypointConfidenceThreshold));if(t.keypointTrackerParams.minNumberOfKeypoints<1)throw new Error("Must specify 'minNumberOfKeypoints' to be at least 1, but "+"encountered ".concat(t.keypointTrackerParams.minNumberOfKeypoints));for(var r=0,i=t.keypointTrackerParams.keypointFalloff;r<i.length;r++){var s=i[r];if(s<=0)throw new Error("Must specify each keypoint falloff parameterto be positive "+"but encountered ".concat(s))}}})(e),this.tracks=[],this.maxTracks=e.maxTracks,this.maxAge=1e3*e.maxAge,this.minSimilarity=e.minSimilarity,this.nextID=1}return n.prototype.apply=function(e,t){this.filterOldTracks(t);var r=this.computeSimilarity(e);return this.assignTracks(e,r,t),this.updateTracks(t),e},n.prototype.getTracks=function(){return this.tracks.slice()},n.prototype.getTrackIDs=function(){return new Set(this.tracks.map(function(e){return e.id}))},n.prototype.filterOldTracks=function(e){var t=this;this.tracks=this.tracks.filter(function(r){return e-r.lastTimestamp<=t.maxAge})},n.prototype.assignTracks=function(e,t,r){for(var i=Array.from(Array(t[0].length).keys()),s=[],o=0,a=Array.from(Array(e.length).keys());o<a.length;o++){var l=a[o];if(i.length!==0){for(var c=-1,u=-1,d=0,h=i;d<h.length;d++){var f=h[d],p=t[l][f];p>=this.minSimilarity&&p>u&&(c=f,u=p)}if(c>=0){var x=this.tracks[c];x=Object.assign(x,this.createTrack(e[l],r,x.id)),e[l].id=x.id;var v=i.indexOf(c);i.splice(v,1)}else s.push(l)}else s.push(l)}for(var y=0,b=s;y<b.length;y++){l=b[y];var S=this.createTrack(e[l],r);this.tracks.push(S),e[l].id=S.id}},n.prototype.updateTracks=function(e){this.tracks.sort(function(t,r){return r.lastTimestamp-t.lastTimestamp}),this.tracks=this.tracks.slice(0,this.maxTracks)},n.prototype.createTrack=function(e,t,r){var i={id:r||this.nextTrackID(),lastTimestamp:t,keypoints:Fh([],e.keypoints,!0).map(function(s){return Er({},s)})};return e.box!==void 0&&(i.box=Er({},e.box)),i},n.prototype.nextTrackID=function(){var e=this.nextID;return this.nextID+=1,e},n.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.tracks=this.tracks.filter(function(r){return!e.includes(r.id)})},n.prototype.reset=function(){this.tracks=[]},n}(),WUe=function(n){function e(t){return n.call(this,t)||this}return hK(e,n),e.prototype.computeSimilarity=function(t){var r=this;return t.length===0||this.tracks.length===0?[[]]:t.map(function(i){return r.tracks.map(function(s){return r.iou(i,s)})})},e.prototype.iou=function(t,r){var i=Math.max(t.box.xMin,r.box.xMin),s=Math.max(t.box.yMin,r.box.yMin),o=Math.min(t.box.xMax,r.box.xMax),a=Math.min(t.box.yMax,r.box.yMax);if(i>=o||s>=a)return 0;var l=(o-i)*(a-s);return l/(t.box.width*t.box.height+r.box.width*r.box.height-l)},e}(SK),HUe=function(n){function e(t){var r=n.call(this,t)||this;return r.keypointThreshold=t.keypointTrackerParams.keypointConfidenceThreshold,r.keypointFalloff=t.keypointTrackerParams.keypointFalloff,r.minNumKeyoints=t.keypointTrackerParams.minNumberOfKeypoints,r}return hK(e,n),e.prototype.computeSimilarity=function(t){if(t.length===0||this.tracks.length===0)return[[]];for(var r=[],i=0,s=t;i<s.length;i++){for(var o=s[i],a=[],l=0,c=this.tracks;l<c.length;l++){var u=c[l];a.push(this.oks(o,u))}r.push(a)}return r},e.prototype.oks=function(t,r){for(var i=this.area(r.keypoints)+1e-6,s=0,o=0,a=0;a<t.keypoints.length;++a){var l=t.keypoints[a],c=r.keypoints[a];if(!(l.score<this.keypointThreshold||c.score<this.keypointThreshold)){o+=1;var u=Math.pow(l.x-c.x,2)+Math.pow(l.y-c.y,2),d=2*this.keypointFalloff[a];s+=Math.exp(-1*u/(2*i*Math.pow(d,2)))}}return o<this.minNumKeyoints?0:s/o},e.prototype.area=function(t){var r=this,i=t.filter(function(l){return l.score>r.keypointThreshold}),s=Math.min.apply(Math,Fh([1],i.map(function(l){return l.x}),!1)),o=Math.max.apply(Math,Fh([0],i.map(function(l){return l.x}),!1)),a=Math.min.apply(Math,Fh([1],i.map(function(l){return l.y}),!1));return(o-s)*(Math.max.apply(Math,Fh([0],i.map(function(l){return l.y}),!1))-a)},e}(SK);function GUe(n){switch(n){case Vl.BlazePose:return U0.reduce(function(e,t,r){return e[t]=r,e},{});case Vl.PoseNet:case Vl.MoveNet:return Kl.reduce(function(e,t,r){return e[t]=r,e},{});default:throw new Error("Model ".concat(n," is not supported."))}}(function(n){n.Keypoint="keypoint",n.BoundingBox="boundingBox"})(Yh||(Yh={})),function(n){n.MoveNet="MoveNet",n.BlazePose="BlazePose",n.PoseNet="PoseNet"}(Vl||(Vl={}));var R4=["SinglePose.Lightning","SinglePose.Thunder","MultiPose.Lightning"],_K={modelType:"SinglePose.Lightning",enableSmoothing:!0},P4={},D4={frequency:30,minCutOff:2.5,beta:300,derivateCutOff:2.5,thresholdCutOff:.5,thresholdBeta:5,disableValueScaling:!0},NT={maxTracks:18,maxAge:1e3,minSimilarity:.2,keypointTrackerParams:{keypointConfidenceThreshold:.3,keypointFalloff:[.026,.025,.025,.035,.035,.079,.079,.072,.072,.062,.062,.107,.107,.087,.087,.089,.089],minNumberOfKeypoints:4}},L4={maxTracks:18,maxAge:1e3,minSimilarity:.15,trackerParams:{}};function qUe(n,e,t,r){for(var i={},s=0,o=Kl;s<o.length;s++){var a=o[s];i[a]=[e[t[a]].y*r.height,e[t[a]].x*r.width]}if(function(b,S){return(b[S.left_hip].score>.2||b[S.right_hip].score>.2)&&(b[S.left_shoulder].score>.2||b[S.right_shoulder].score>.2)}(e,t)){var l=(i.left_hip[0]+i.right_hip[0])/2,c=(i.left_hip[1]+i.right_hip[1])/2,u=function(b,S,_,T,M){for(var k=["left_shoulder","right_shoulder","left_hip","right_hip"],P=0,z=0,I=0;I<k.length;I++)(ne=Math.abs(T-_[k[I]][0]))>P&&(P=ne),(Y=Math.abs(M-_[k[I]][1]))>z&&(z=Y);for(var L=0,W=0,q=0,$=Object.keys(_);q<$.length;q++){var ne,Y,we=$[q];b[S[we]].score<.2||((ne=Math.abs(T-_[we][0]))>L&&(L=ne),(Y=Math.abs(M-_[we][1]))>W&&(W=Y))}return[P,z,L,W]}(e,t,i,l,c),d=u[0],h=u[1],f=u[2],p=u[3],x=Math.max(1.9*h,1.9*d,1.2*f,1.2*p),v=[l-(x=Math.min(x,Math.max(c,r.width-c,l,r.height-l))),c-x];if(x>Math.max(r.width,r.height)/2)return KN(n==null,r);var y=2*x;return{yMin:v[0]/r.height,xMin:v[1]/r.width,yMax:(v[0]+y)/r.height,xMax:(v[1]+y)/r.width,height:(v[0]+y)/r.height-v[0]/r.height,width:(v[1]+y)/r.width-v[1]/r.width}}return KN(n==null,r)}function KN(n,e){var t,r,i,s;return n?e.width>e.height?(t=1,r=e.height/e.width,i=0,s=(e.width/2-e.height/2)/e.width):(t=e.width/e.height,r=1,i=(e.height/2-e.width/2)/e.height,s=0):e.width>e.height?(t=e.width/e.height,r=1,i=(e.height/2-e.width/2)/e.height,s=0):(t=1,r=e.height/e.width,i=0,s=(e.width/2-e.height/2)/e.width),{yMin:i,xMin:s,yMax:i+t,xMax:s+r,height:t,width:r}}function XUe(n){var e,t=n==null?_K:Er({},n);if(t.modelType==null)t.modelType="SinglePose.Lightning";else if(R4.indexOf(t.modelType)<0)throw new Error("Invalid architecture ".concat(t.modelType,". ")+"Should be one of ".concat(R4));if(t.enableSmoothing==null&&(t.enableSmoothing=!0),t.minPoseScore!=null&&(t.minPoseScore<0||t.minPoseScore>1))throw new Error("minPoseScore should be between 0.0 and 1.0");if(t.multiPoseMaxDimension!=null&&(t.multiPoseMaxDimension%32!=0||t.multiPoseMaxDimension<32))throw new Error("multiPoseMaxDimension must be a multiple of 32 and higher than 0");if(t.modelType==="MultiPose.Lightning"&&t.enableTracking==null&&(t.enableTracking=!0),t.modelType==="MultiPose.Lightning"&&t.enableTracking===!0)if(t.trackerType==null&&(t.trackerType=Yh.BoundingBox),t.trackerType===Yh.Keypoint)t.trackerConfig!=null?t.trackerConfig=function(r){var i=O4(NT,r);return i.keypointTrackerParams=Er({},NT.keypointTrackerParams),r.keypointTrackerParams!=null&&(r.keypointTrackerParams.keypointConfidenceThreshold!=null&&(i.keypointTrackerParams.keypointConfidenceThreshold=r.keypointTrackerParams.keypointConfidenceThreshold),r.keypointTrackerParams.keypointFalloff!=null&&(i.keypointTrackerParams.keypointFalloff=r.keypointTrackerParams.keypointFalloff),r.keypointTrackerParams.minNumberOfKeypoints!=null&&(i.keypointTrackerParams.minNumberOfKeypoints=r.keypointTrackerParams.minNumberOfKeypoints)),i}(t.trackerConfig):t.trackerConfig=NT;else{if(t.trackerType!==Yh.BoundingBox)throw new Error("Tracker type not supported by MoveNet");t.trackerConfig!=null?t.trackerConfig=(e=t.trackerConfig,O4(L4,e)):t.trackerConfig=L4}return t}function O4(n,e){var t={maxTracks:n.maxTracks,maxAge:n.maxAge,minSimilarity:n.minSimilarity};return e.maxTracks!=null&&(t.maxTracks=e.maxTracks),e.maxAge!=null&&(t.maxAge=e.maxAge),e.minSimilarity!=null&&(t.minSimilarity=e.minSimilarity),t}var KUe=function(){function n(e,t){this.moveNetModel=e,this.modelInputResolution={height:0,width:0},this.keypointIndexByName=GUe(Vl.MoveNet),t.modelType==="SinglePose.Lightning"?(this.modelInputResolution.width=192,this.modelInputResolution.height=192):t.modelType==="SinglePose.Thunder"&&(this.modelInputResolution.width=256,this.modelInputResolution.height=256),this.multiPoseModel=t.modelType==="MultiPose.Lightning",this.multiPoseModel||(this.keypointFilter=new XN(D4),this.cropRegionFilterYMin=new Uu(.9),this.cropRegionFilterXMin=new Uu(.9),this.cropRegionFilterYMax=new Uu(.9),this.cropRegionFilterXMax=new Uu(.9)),this.enableSmoothing=t.enableSmoothing,t.minPoseScore?this.minPoseScore=t.minPoseScore:this.minPoseScore=.25,t.multiPoseMaxDimension?this.multiPoseMaxDimension=t.multiPoseMaxDimension:this.multiPoseMaxDimension=256,this.enableTracking=t.enableTracking,this.multiPoseModel&&this.enableTracking&&(t.trackerType===Yh.Keypoint?this.tracker=new HUe(t.trackerConfig):t.trackerType===Yh.BoundingBox&&(this.tracker=new WUe(t.trackerConfig)),this.enableSmoothing&&(this.keypointFilterMap=new Map))}return n.prototype.runSinglePersonPoseModel=function(e){return Zn(this,void 0,void 0,function(){var t,r,i,s,o;return Qn(this,function(a){switch(a.label){case 0:if((t=this.moveNetModel.execute(e)).shape.length!==4||t.shape[0]!==1||t.shape[1]!==1||t.shape[2]!==17||t.shape[3]!==3)throw t.dispose(),new Error("Unexpected output shape from model: [".concat(t.shape,"]"));return M0()==="webgpu"?[3,1]:(r=t.dataSync(),[3,3]);case 1:return[4,t.data()];case 2:r=a.sent(),a.label=3;case 3:for(t.dispose(),i={keypoints:[],score:0},s=0,o=0;o<17;++o)i.keypoints[o]={y:r[3*o],x:r[3*o+1],score:r[3*o+2]},i.keypoints[o].score>.2&&(++s,i.score+=i.keypoints[o].score);return s>0&&(i.score/=s),[2,i]}})})},n.prototype.runMultiPersonPoseModel=function(e){return Zn(this,void 0,void 0,function(){var t,r,i,s,o,a,l,c;return Qn(this,function(u){switch(u.label){case 0:if((t=this.moveNetModel.execute(e)).shape.length!==3||t.shape[0]!==1||t.shape[2]!==56)throw t.dispose(),new Error("Unexpected output shape from model: [".concat(t.shape,"]"));return M0()==="webgpu"?[3,1]:(r=t.dataSync(),[3,3]);case 1:return[4,t.data()];case 2:r=u.sent(),u.label=3;case 3:for(t.dispose(),i=[],s=r.length/56,o=0;o<s;++o)for(i[o]={keypoints:[]},a=56*o+51,i[o].box={yMin:r[a],xMin:r[a+1],yMax:r[a+2],xMax:r[a+3],width:r[a+3]-r[a+1],height:r[a+2]-r[a]},l=56*o+55,i[o].score=r[l],i[o].keypoints=[],c=0;c<17;++c)i[o].keypoints[c]={y:r[56*o+3*c],x:r[56*o+3*c+1],score:r[56*o+3*c+2]};return[2,i]}})})},n.prototype.estimatePoses=function(e,t,r){return t===void 0&&(t=P4),Zn(this,void 0,void 0,function(){var i,s,o,a,l,c;return Qn(this,function(u){switch(u.label){case 0:return t=function(d){return d==null?P4:Er({},d)}(t),e==null?(this.reset(),[2,[]]):(r==null?wK(e)&&(r=1e6*e.currentTime):r*=1e3,i=I3(e),s=sg(i),o=Fo(i,0),e instanceof ei||i.dispose(),a=[],this.multiPoseModel?[3,2]:[4,this.estimateSinglePose(o,s,r)]);case 1:return a=u.sent(),[3,4];case 2:return[4,this.estimateMultiplePoses(o,s,r)];case 3:a=u.sent(),u.label=4;case 4:for(l=0;l<a.length;++l)for(c=0;c<a[l].keypoints.length;++c)a[l].keypoints[c].name=Kl[c],a[l].keypoints[c].y*=s.height,a[l].keypoints[c].x*=s.width;return[2,a]}})})},n.prototype.estimateSinglePose=function(e,t,r){return Zn(this,void 0,void 0,function(){var i,s,o,a,l=this;return Qn(this,function(c){switch(c.label){case 0:return this.cropRegion||(this.cropRegion=KN(this.cropRegion==null,t)),i=yn(function(){var u=Ca([[l.cropRegion.yMin,l.cropRegion.xMin,l.cropRegion.yMax,l.cropRegion.xMax]]),d=bd([1],"int32"),h=[l.modelInputResolution.height,l.modelInputResolution.width];return Cr(Xh.cropAndResize(e,u,d,h,"bilinear",0),"int32")}),e.dispose(),[4,this.runSinglePersonPoseModel(i)];case 1:if(s=c.sent(),i.dispose(),s.score<this.minPoseScore)return this.reset(),[2,[]];for(o=0;o<s.keypoints.length;++o)s.keypoints[o].y=this.cropRegion.yMin+s.keypoints[o].y*this.cropRegion.height,s.keypoints[o].x=this.cropRegion.xMin+s.keypoints[o].x*this.cropRegion.width;return r!=null&&this.enableSmoothing&&(s.keypoints=this.keypointFilter.apply(s.keypoints,r,1)),a=qUe(this.cropRegion,s.keypoints,this.keypointIndexByName,t),this.cropRegion=this.filterCropRegion(a),[2,[s]]}})})},n.prototype.estimateMultiplePoses=function(e,t,r){return Zn(this,void 0,void 0,function(){var i,s,o,a,l,c,u,d,h,f,p,x=this;return Qn(this,function(v){switch(v.label){case 0:return t.width>t.height?(s=this.multiPoseMaxDimension,o=Math.round(this.multiPoseMaxDimension*t.height/t.width),i=Xh.resizeBilinear(e,[o,s]),l=s,c=32*Math.ceil(o/32),a=Sd(i,[[0,0],[0,c-o],[0,0],[0,0]])):(s=Math.round(this.multiPoseMaxDimension*t.width/t.height),o=this.multiPoseMaxDimension,i=Xh.resizeBilinear(e,[o,s]),l=32*Math.ceil(s/32),c=o,a=Sd(i,[[0,0],[0,0],[0,l-s],[0,0]])),i.dispose(),e.dispose(),u=Cr(a,"int32"),a.dispose(),[4,this.runMultiPersonPoseModel(u)];case 1:for(d=v.sent(),u.dispose(),d=d.filter(function(y){return y.score>=x.minPoseScore}),f=0;f<d.length;++f)for(h=0;h<d[f].keypoints.length;++h)d[f].keypoints[h].y*=c/o,d[f].keypoints[h].x*=l/s;if(this.enableTracking&&(this.tracker.apply(d,r),this.enableSmoothing)){for(f=0;f<d.length;++f)this.keypointFilterMap.has(d[f].id)||this.keypointFilterMap.set(d[f].id,new XN(D4)),d[f].keypoints=this.keypointFilterMap.get(d[f].id).apply(d[f].keypoints,r,1);p=this.tracker.getTrackIDs(),this.keypointFilterMap.forEach(function(y,b){p.has(b)||x.keypointFilterMap.delete(b)})}return[2,d]}})})},n.prototype.filterCropRegion=function(e){if(e){var t=this.cropRegionFilterYMin.apply(e.yMin),r=this.cropRegionFilterXMin.apply(e.xMin),i=this.cropRegionFilterYMax.apply(e.yMax),s=this.cropRegionFilterXMax.apply(e.xMax);return{yMin:t,xMin:r,yMax:i,xMax:s,height:i-t,width:s-r}}return this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset(),null},n.prototype.dispose=function(){this.moveNetModel.dispose()},n.prototype.reset=function(){this.cropRegion=null,this.resetFilters()},n.prototype.resetFilters=function(){this.keypointFilter.reset(),this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset()},n}();function YUe(n){return n===void 0&&(n=_K),Zn(this,void 0,void 0,function(){var e,t,r,i;return Qn(this,function(s){switch(s.label){case 0:return e=XUe(n),r=!0,e.modelUrl?(r=typeof e.modelUrl=="string"&&e.modelUrl.indexOf("https://tfhub.dev")>-1,[4,rg(e.modelUrl,{fromTFHub:r})]):[3,2];case 1:return t=s.sent(),[3,4];case 2:return i=void 0,e.modelType==="SinglePose.Lightning"?i="https://tfhub.dev/google/tfjs-model/movenet/singlepose/lightning/4":e.modelType==="SinglePose.Thunder"?i="https://tfhub.dev/google/tfjs-model/movenet/singlepose/thunder/4":e.modelType==="MultiPose.Lightning"&&(i="https://tfhub.dev/google/tfjs-model/movenet/multipose/lightning/1"),[4,rg(i,{fromTFHub:r})];case 3:t=s.sent(),s.label=4;case 4:return M0()==="webgl"&&rn().set("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",0),[2,new KUe(t,e)]}})})}var F4={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:{height:257,width:257}},z4=["MobileNetV1","ResNet50"],U4={MobileNetV1:[8,16],ResNet50:[16]},ZUe=[8,16,32],B4={MobileNetV1:[.5,.75,1],ResNet50:[1]},$4=[1,2,4],j4={maxPoses:1,flipHorizontal:!1},QUe={maxPoses:5,flipHorizontal:!1,scoreThreshold:.5,nmsRadius:20},JUe=[-123.15,-115.9,-103.06];function kT(n){return Math.floor(n/2)}var eBe=function(){function n(e,t){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=t}return n.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},n.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},n.prototype.empty=function(){return this.numberOfElements===-1},n.prototype.size=function(){return this.numberOfElements+1},n.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},n.prototype.max=function(){return this.priorityQueue[0]},n.prototype.swim=function(e){for(;e>0&&this.less(kT(e),e);)this.exchange(e,kT(e)),e=kT(e)},n.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var t=2*e;if(t<this.numberOfElements&&this.less(t,t+1)&&t++,!this.less(e,t))break;this.exchange(e,t),e=t}},n.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},n.prototype.less=function(e,t){return this.getValueAt(e)<this.getValueAt(t)},n.prototype.exchange=function(e,t){var r=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[t],this.priorityQueue[t]=r},n}();function tBe(n,e,t,r,i,s){for(var o=s.shape,a=o[0],l=o[1],c=!0,u=Math.max(t-i,0),d=Math.min(t+i+1,a),h=u;h<d;++h){for(var f=Math.max(r-i,0),p=Math.min(r+i+1,l),x=f;x<p;++x)if(s.get(h,x,n)>e){c=!1;break}if(!c)break}return c}function nBe(n){return Zn(this,void 0,void 0,function(){return Qn(this,function(e){return[2,Promise.all(n.map(function(t){return t.buffer()}))]})})}function EK(n,e,t,r){return{y:r.get(n,e,t),x:r.get(n,e,t+17)}}function CK(n,e,t){var r=EK(n.heatmapY,n.heatmapX,n.id,t),i=r.y,s=r.x;return{x:n.heatmapX*e+s,y:n.heatmapY*e+i}}function TK(n,e,t,r){var i=t.x,s=t.y;return n.some(function(o){var a,l,c,u,d,h,f=o.keypoints;return a=s,l=i,c=f[r].y,u=f[r].x,(d=c-a)*d+(h=u-l)*h<=e})}var V4=Kl.reduce(function(n,e,t){return n[e]=t,n},{}),MK=[["nose","left_eye"],["left_eye","left_ear"],["nose","right_eye"],["right_eye","right_ear"],["nose","left_shoulder"],["left_shoulder","left_elbow"],["left_elbow","left_wrist"],["left_shoulder","left_hip"],["left_hip","left_knee"],["left_knee","left_ankle"],["nose","right_shoulder"],["right_shoulder","right_elbow"],["right_elbow","right_wrist"],["right_shoulder","right_hip"],["right_hip","right_knee"],["right_knee","right_ankle"]].map(function(n){var e=n[0],t=n[1];return[V4[e],V4[t]]}),IT=MK.map(function(n){return n[1]}),W4=MK.map(function(n){return n[0]});function H4(n,e,t){return n<e?e:n>t?t:n}function RT(n,e,t,r){return{y:H4(Math.round(n.y/e),0,t-1),x:H4(Math.round(n.x/e),0,r-1)}}function G4(n,e){return{x:n.x+e.x,y:n.y+e.y}}function q4(n,e,t,r,i,s,o,a){a===void 0&&(a=2);for(var l=r.shape,c=l[0],u=l[1],d={y:e.y,x:e.x},h=G4(d,function(b,S,_){var T=_.shape[2]/2;return{y:_.get(S.y,S.x,b),x:_.get(S.y,S.x,T+b)}}(n,RT(d,s,c,u),o)),f=0;f<a;f++){var p=RT(h,s,c,u),x=EK(p.y,p.x,t,i);h=G4({x:p.x*s,y:p.y*s},{x:x.x,y:x.y})}var v=RT(h,s,c,u),y=r.get(v.y,v.x,t);return{y:h.y,x:h.x,name:Kl[t],score:y}}function rBe(n,e,t,r,i,s){var o=e.shape[2],a=IT.length,l=new Array(o),c=n.part,u=n.score,d=CK(c,r,t);l[c.id]={score:u,name:Kl[c.id],y:d.y,x:d.x};for(var h=a-1;h>=0;--h){var f=IT[h],p=W4[h];l[f]&&!l[p]&&(l[p]=q4(h,l[f],p,e,t,r,s))}for(h=0;h<a;++h)f=W4[h],p=IT[h],l[f]&&!l[p]&&(l[p]=q4(h,l[f],p,e,t,r,i));return l}function iBe(n,e,t){return t.reduce(function(r,i,s){var o=i.y,a=i.x,l=i.score;return TK(n,e,{y:o,x:a},s)||(r+=l),r},0)/t.length}function sBe(n,e,t,r,i,s,o,a){return o===void 0&&(o=.5),a===void 0&&(a=20),Zn(this,void 0,void 0,function(){var l,c,u,d,h,f,p,x,v,y,b,S;return Qn(this,function(_){switch(_.label){case 0:return[4,nBe([n,e,t,r])];case 1:for(l=_.sent(),c=l[0],u=l[1],d=l[2],h=l[3],f=[],p=function(T,M,k){for(var P=k.shape,z=P[0],I=P[1],L=P[2],W=new eBe(z*I*L,function(we){return we.score}),q=0;q<z;++q)for(var $=0;$<I;++$)for(var ne=0;ne<L;++ne){var Y=k.get(q,$,ne);Y<T||tBe(ne,Y,q,$,M,k)&&W.enqueue({score:Y,part:{heatmapY:q,heatmapX:$,id:ne}})}return W}(o,1,c),x=a*a;f.length<s&&!p.empty();)v=p.dequeue(),y=CK(v.part,i,u),TK(f,x,y,v.part.id)||(b=rBe(v,c,u,i,d,h),S=iBe(f,x,b),f.push({keypoints:b,score:S}));return[2,f]}})})}function AK(){for(var n,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];switch(e.length){case 0:n="fn main() ";break;case 1:n="fn main(".concat(e[0]," : i32)");break;default:throw Error("Unreachable")}return n}var oBe=function(){function n(e){this.variableNames=["A","B"],this.size=!0,this.workgroupSize=[32,1,1],this.outputShape=[e[0],1],this.dispatchLayout=Nt(this.outputShape),this.dispatch=xt(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="getpointsConfidenceOp"}return n.prototype.getUserCode=function(){return`
        `.concat(AK("index"),` {
          if (index < uniforms.size) {
            let y = B[index * 2];
            let x = B[index * 2 + 1];
            let outIndex = y * uniforms.aShape.x * uniforms.aShape.z + x * uniforms.aShape.z + index;
            result[index] = A[outIndex];
          }
        }
        `)},n}();function aBe(n,e){if(tg()instanceof Dg)return function(t,r){var i=tg(),s=new oBe(r.shape),o=i.runWebGPUProgram(s,[t,r],"float32");return Cm().makeTensorFromTensorInfo(o)}(n,e);throw new Error("getPointsConfidenceWebGPU is not supported in this backend!")}var lBe=function(){function n(e){if(this.variableNames=["A","B"],this.size=!0,this.supportedLastDimension=2,e.length!==2||e[1]!==this.supportedLastDimension)throw new Error("GetOffsetVectorsProgram only supports shape of [x, ".concat(this.supportedLastDimension,"], but current shape is ").concat(e));this.workgroupSize=[32,1,1],this.outputShape=e;var t=[e[0],1];this.dispatchLayout=Nt(t),this.dispatch=xt(this.dispatchLayout,t,this.workgroupSize),this.shaderKey="GetOffsetVectors"}return n.prototype.getUserCode=function(){return`
    fn getOffsetPoint(y: i32, x: i32, index: i32) -> vec2<i32> {
      let outIndexY = y * uniforms.bShape.x * uniforms.bShape.y + x * uniforms.bShape.y + index;
      let outIndexX = outIndexY + uniforms.bShape.z;
      let outY = i32(B[outIndexY]);
      let outX = i32(B[outIndexX]);
      return vec2<i32>(outY, outX);
    }

    `.concat(AK("index"),` {
      if (index < uniforms.size) {
        let indexY = index * `).concat(this.supportedLastDimension,`;
        let indexX = indexY + 1;
        let heatmapY = A[indexY];
        let heatmapX = A[indexX];
        let out = getOffsetPoint(i32(heatmapY), i32(heatmapX), index);
        result[indexY] = f32(out[0]);
        result[indexX] = f32(out[1]);
      }
    }
    `)},n}();function cBe(n,e){if(tg()instanceof Dg)return function(t,r){var i=tg(),s=new lBe(t.shape),o=i.runWebGPUProgram(s,[t,r],"float32");return Cm().makeTensorFromTensorInfo(o)}(n,e);throw new Error("getOffsetVectorsGPU is not supported in this backend!")}function NK(n){var e=n.shape,t=e[0],r=e[1],i=e[2];return yn(function(){var s,o,a=Ke(n,[t*r,i]),l=Pq(a,0),c=Fo(On(l,zn(r,"int32")),1),u=Fo((s=l,o=r,yn(function(){var d=On(s,zn(o,"int32"));return Sn(s,lt(d,zn(o,"int32")))})),1);return Ui([c,u],1)})}function uBe(n,e,t){return yn(function(){var r=function(i,s){for(var o=[],a=0;a<Kl.length;a++){var l=i.get(a,0).valueOf(),c=i.get(a,1).valueOf(),u=dBe(l,c,a,s),d=u.x,h=u.y;o.push(h),o.push(d)}return Ca(o,[Kl.length,2])}(n,t);return Xt(Cr(lt(n.toTensor(),zn(e,"int32")),"float32"),r)})}function dBe(n,e,t,r){return{y:r.get(n,e,t),x:r.get(n,e,t+Kl.length)}}function hBe(n,e,t){return Zn(this,void 0,void 0,function(){var r,i,s,o,a,l,c,u,d,h;return Qn(this,function(f){switch(f.label){case 0:return r=0,i=NK(n),[4,Promise.all([n.buffer(),e.buffer(),i.buffer()])];case 1:return s=f.sent(),o=s[0],a=s[1],l=s[2],[4,(c=uBe(l,t,a)).buffer()];case 2:return u=f.sent(),d=Array.from(function(p,x){for(var v=x.shape[0],y=new Float32Array(v),b=0;b<v;b++){var S=x.get(b,0),_=x.get(b,1);y[b]=p.get(S,_,b)}return y}(o,l)),h=d.map(function(p,x){return r+=p,{y:u.get(x,0),x:u.get(x,1),score:p,name:Kl[x]}}),i.dispose(),c.dispose(),[2,{keypoints:h,score:r/h.length}]}})})}function fBe(n,e,t){return Zn(this,void 0,void 0,function(){var r,i,s;return Qn(this,function(o){return r=NK(n),i=function(a,l,c){return yn(function(){var u=cBe(a,c);return Xt(Cr(lt(a,zn(l,"int32")),"float32"),u)})}(r,t,e),s=aBe(n,r),[2,[i,s]]})})}function X4(n,e){return(n-1)%e==0}var K4="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",Y4="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";function Z4(n,e){return function(t,r){return(t-1)%r==0}(n,e)?n:Math.floor(n/e)*e+1}var Q4=function(){function n(e,t){this.posenetModel=e;var r=this.posenetModel.inputs[0].shape;te(r[1]===-1&&r[2]===-1,function(){return"Input shape [".concat(r[1],", ").concat(r[2],"] ")+"must both be equal to or -1"});var i,s,o=(i=t.inputResolution,s=t.outputStride,{height:Z4(i.height,s),width:Z4(i.width,s)});(function(a){te(ZUe.indexOf(a)>=0,function(){return"outputStride of ".concat(a," is invalid. ")+"It must be either 8 or 16."})})(t.outputStride),function(a,l){te(X4(a.height,l),function(){return"height of ".concat(a.height," is invalid for output stride ")+"".concat(l,".")}),te(X4(a.width,l),function(){return"width of ".concat(a.width," is invalid for output stride ")+"".concat(l,".")})}(o,t.outputStride),this.inputResolution=o,this.outputStride=t.outputStride,this.architecture=t.architecture}return n.prototype.estimatePoses=function(e,t){return t===void 0&&(t=j4),Zn(this,void 0,void 0,function(){return Qn(this,function(r){return[2,this.estimatePosesGPU(e,t,!1)]})})},n.prototype.estimatePosesGPU=function(e,t,r){return t===void 0&&(t=j4),r===void 0&&(r=!1),Zn(this,void 0,void 0,function(){var i,s,o,a,l,c,u,d,h,f,p,x,v,y,b,S,_,T;return Qn(this,function(M){switch(M.label){case 0:return i=function(k){var P=k;if(P.maxPoses==null&&(P.maxPoses=1),P.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(P.maxPoses,". Should be > 0."));if(P.maxPoses>1){if((P=Er(Er({},QUe),P)).scoreThreshold<0||P.scoreThreshold>1)throw new Error("Invalid scoreThreshold ".concat(P.scoreThreshold,". ")+"Should be in range [0.0, 1.0]");if(P.nmsRadius<=0)throw new Error("Invalid nmsRadius ".concat(P.nmsRadius,"."))}return P}(t),e==null?[2,r?[[],[]]:[]]:(this.maxPoses=i.maxPoses,s=qN(e,{outputTensorSize:this.inputResolution,keepAspectRatio:!0,borderMode:"replicate"}),o=s.imageTensor,a=s.padding,l=this.architecture==="ResNet50"?Xt(o,JUe):xK(o,[-1,1]),c=this.posenetModel.predict(l),this.architecture==="ResNet50"?(u=mr(c[2],[0]),d=mr(c[3],[0]),h=mr(c[0],[0]),f=mr(c[1],[0])):(u=mr(c[0],[0]),d=mr(c[1],[0]),h=mr(c[2],[0]),f=mr(c[3],[0])),p=Dc(d),this.maxPoses!==1?[3,5]:r?[4,fBe(p,u,this.outputStride)]:[3,2]);case 1:return v=M.sent(),b=v[0],y=v[1],x=[b,y],[3,4];case 2:return[4,hBe(p,u,this.outputStride)];case 3:b=M.sent(),x=[b],M.label=4;case 4:return[3,7];case 5:if(r)throw new Error("GPU renderer only supports single pose!");return[4,sBe(p,u,h,f,this.outputStride,this.maxPoses,i.scoreThreshold,i.nmsRadius)];case 6:x=M.sent(),M.label=7;case 7:if(r){if(i.flipHorizontal===!0)throw new Error("flipHorizontal is not supported!");S=this.getCanvasInfo(sg(e),this.inputResolution,a)}else T=sg(e),_=function(k,P,z,I){var L=P.height,W=P.width,q=L/(z.height*(1-I.top-I.bottom)),$=W/(z.width*(1-I.left-I.right)),ne=-I.top*z.height,Y=-I.left*z.width;if($===1&&q===1&&ne===0&&Y===0)return k;for(var we=0,H=k;we<H.length;we++)for(var X=0,oe=H[we].keypoints;X<oe.length;X++){var ve=oe[X];ve.x=(ve.x+Y)*$,ve.y=(ve.y+ne)*q}return k}(x,T,this.inputResolution,a),i.flipHorizontal&&(_=function(k,P){for(var z=0,I=k;z<I.length;z++)for(var L=0,W=I[z].keypoints;L<W.length;L++){var q=W[L];q.x=P.width-1-q.x}return k}(_,T));return o.dispose(),l.dispose(),fr(c),u.dispose(),d.dispose(),h.dispose(),f.dispose(),p.dispose(),[2,r?[x,S]:_]}})})},n.prototype.getCanvasInfo=function(e,t,r){var i=e.height,s=e.width,o=i/(t.height*(1-r.top-r.bottom)),a=s/(t.width*(1-r.left-r.right)),l=-r.top*t.height;return[-r.left*t.width,l,a,o,e.width,e.height]},n.prototype.dispose=function(){this.posenetModel.dispose()},n.prototype.reset=function(){},n}();function pBe(n){return n===void 0&&(n=F4),Zn(this,void 0,void 0,function(){var e,t,r,i,s;return Qn(this,function(o){switch(o.label){case 0:return(e=function(u){var d=u||F4;if(d.architecture==null&&(d.architecture="MobileNetV1"),z4.indexOf(d.architecture)<0)throw new Error("Invalid architecture ".concat(d.architecture,". ")+"Should be one of ".concat(z4));if(d.inputResolution==null&&(d.inputResolution={height:257,width:257}),d.outputStride==null&&(d.outputStride=16),U4[d.architecture].indexOf(d.outputStride)<0)throw new Error("Invalid outputStride ".concat(d.outputStride,". ")+"Should be one of ".concat(U4[d.architecture]," ")+"for architecture ".concat(d.architecture,"."));if(d.multiplier==null&&(d.multiplier=1),B4[d.architecture].indexOf(d.multiplier)<0)throw new Error("Invalid multiplier ".concat(d.multiplier,". ")+"Should be one of ".concat(B4[d.architecture]," ")+"for architecture ".concat(d.architecture,"."));if(d.quantBytes==null&&(d.quantBytes=4),$4.indexOf(d.quantBytes)<0)throw new Error("Invalid quantBytes ".concat(d.quantBytes,". ")+"Should be one of ".concat($4," ")+"for architecture ".concat(d.architecture,"."));if(d.architecture==="MobileNetV1"&&d.outputStride===32&&d.multiplier!==1)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return d}(n)).architecture!=="ResNet50"?[3,2]:(a=e.outputStride,l=e.quantBytes,c="model-stride".concat(a,".json"),t=l===4?Y4+"float/"+c:Y4+"quant".concat(l,"/")+c,[4,rg(e.modelUrl||t)]);case 1:return r=o.sent(),[2,new Q4(r,e)];case 2:return i=function(u,d,h){var f={1:"100",.75:"075",.5:"050"},p="model-stride".concat(u,".json");return h===4?K4+"float/".concat(f[d],"/")+p:K4+"quant".concat(h,"/").concat(f[d],"/")+p}(e.outputStride,e.multiplier,e.quantBytes),[4,rg(e.modelUrl||i)];case 3:return s=o.sent(),[2,new Q4(s,e)]}var a,l,c})})}function mBe(n,e){return Zn(this,void 0,void 0,function(){var t,r;return Qn(this,function(i){switch(n){case Vl.PoseNet:return[2,pBe(e)];case Vl.BlazePose:if(r=void 0,(t=e)!=null){if(t.runtime==="tfjs")return[2,VUe(e)];if(t.runtime==="mediapipe")return[2,mUe(e)];r=t.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' "+"or 'mediapipe', but got ".concat(r));case Vl.MoveNet:return[2,YUe(e)];default:throw new Error("".concat(n," is not a supported model name."))}})})}const gBe=({onScanComplete:n})=>{const e=N.useRef(null),t=N.useRef(null),r=N.useRef(null),[i,s]=N.useState(!1),[o,a]=N.useState(0);N.useEffect(()=>{if(!e.current||!t.current)return;const f=e.current,p=t.current,x=p.getContext("2d");if(!x)return;let v,y;return(async()=>{try{v=await mBe(Vl.MoveNet,{modelType:"thunder"}),y=await navigator.mediaDevices.getUserMedia({video:{width:1280,height:720}}),f.srcObject=y,f.play();const S=()=>{x&&f&&(x.drawImage(f,0,0,p.width,p.height),i&&l(x,p)),requestAnimationFrame(S)};f.onloadeddata=()=>{S()}}catch(S){console.error("Failed to initialize scanner:",S)}})(),()=>{y&&y.getTracks().forEach(S=>S.stop())}},[i]);const l=async(f,p)=>{const x=f.getImageData(0,0,p.width,p.height),v=c(x),y=u(v);a(b=>Math.min(b+1,100)),o>=100&&(s(!1),n==null||n(y))},c=f=>{const p=new Float32Array(f.data.length/4);for(let x=0;x<f.data.length;x+=4){const v=f.data[x],y=f.data[x+1],b=f.data[x+2];p[x/4]=(v+y+b)/765}return p},u=f=>{const p=new Pn,x=new Float32Array(f.length*3);for(let y=0;y<f.length;y++){const b=y%1280/1280-.5,S=.5-y/1280/720,_=f[y];x[y*3]=b,x[y*3+1]=S,x[y*3+2]=_}p.setAttribute("position",new pr(x,3));const v=new H_({size:.01,color:16777215});return new lR(p,v)},d=()=>{s(!0),a(0)},h=()=>{s(!1)};return w.jsxs("div",{ref:r,className:"relative w-full h-full",children:[w.jsx("video",{ref:e,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0}),w.jsx("canvas",{ref:t,className:"absolute top-0 left-0 w-full h-full",width:1280,height:720}),w.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-4",children:[w.jsx("button",{onClick:i?h:d,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:i?"Stop Scanning":"Start Scanning"}),i&&w.jsxs("div",{className:"px-4 py-2 bg-white text-black rounded-lg",children:["Progress: ",o,"%"]})]})]})},yBe=()=>{const[n,e]=N.useState("design"),[t,r]=N.useState(null),i=s=>{r(s),e("design")};return w.jsxs(w.Fragment,{children:[w.jsx(bl,{}),w.jsxs("div",{className:"h-[calc(100vh-64px)] flex flex-col",children:[w.jsx("div",{className:"bg-gray-800 text-white p-4",children:w.jsxs("div",{className:"flex gap-4",children:[w.jsx("button",{onClick:()=>e("design"),className:`px-4 py-2 rounded ${n==="design"?"bg-blue-500":"bg-gray-600"} hover:bg-opacity-90 transition-colors`,children:"Furniture Designer"}),w.jsx("button",{onClick:()=>e("scan"),className:`px-4 py-2 rounded ${n==="scan"?"bg-blue-500":"bg-gray-600"} hover:bg-opacity-90 transition-colors`,children:"3D Scanner"})]})}),w.jsx("main",{className:"flex-1",children:n==="design"?w.jsx(Nxe,{scannedPointCloud:t||void 0}):w.jsx(gBe,{onScanComplete:i})})]})]})};function vBe(){return w.jsx(p$,{children:w.jsx(xee,{children:w.jsx(yee,{children:w.jsx(wee,{children:w.jsx(aee,{children:w.jsx("div",{className:"min-h-screen bg-background text-foreground transition-colors",children:w.jsxs(FJ,{children:[w.jsx(Xi,{path:"/",element:w.jsxs(w.Fragment,{children:[w.jsx(bl,{}),w.jsx("main",{children:w.jsx(Pse,{})})]})}),w.jsx(Xi,{path:"/auth",element:w.jsxs(w.Fragment,{children:[w.jsx(bl,{}),w.jsx("main",{children:w.jsx(gae,{})})]})}),w.jsx(Xi,{path:"/pricing",element:w.jsxs(w.Fragment,{children:[w.jsx(bl,{}),w.jsx("main",{children:w.jsx(vae,{})})]})}),w.jsx(Xi,{path:"/dashboard",element:w.jsxs(Yd,{children:[w.jsx(bl,{}),w.jsx("main",{children:w.jsx(Pae,{})})]})}),w.jsx(Xi,{path:"/editor",element:w.jsxs(Yd,{children:[w.jsx(bl,{}),w.jsx("main",{children:w.jsx(tz,{})})]})}),w.jsx(Xi,{path:"/editor/:projectId",element:w.jsxs(Yd,{children:[w.jsx(bl,{}),w.jsx("main",{children:w.jsx(tz,{})})]})}),w.jsx(Xi,{path:"/materials",element:w.jsxs(Yd,{children:[w.jsx(bl,{}),w.jsx("main",{children:w.jsx(e0e,{})})]})}),w.jsx(Xi,{path:"/ai-assistant",element:w.jsxs(Yd,{children:[w.jsx(bl,{}),w.jsx("main",{children:w.jsx(o0e,{})})]})}),w.jsx(Xi,{path:"/billing",element:w.jsxs(Yd,{children:[w.jsx(bl,{}),w.jsx("main",{children:w.jsx(p0e,{})})]})}),w.jsxs(Xi,{path:"/admin/*",element:w.jsx(Yd,{adminOnly:!0,children:w.jsx(Ise,{})}),children:[w.jsx(Xi,{index:!0,element:w.jsx(m0e,{})}),w.jsx(Xi,{path:"materials",element:w.jsx(cxe,{})}),w.jsx(Xi,{path:"furniture",element:w.jsx(uxe,{})}),w.jsx(Xi,{path:"users",element:w.jsx(gz,{})}),w.jsx(Xi,{path:"subscriptions",element:w.jsx(gz,{})}),w.jsx(Xi,{path:"settings",element:w.jsx("div",{className:"p-8",children:"Настройки (в разработке)"})})]}),w.jsx(Xi,{path:"/design-studio",element:w.jsx(yBe,{})})]})})})})})})})}f$(document.getElementById("root")).render(w.jsx(N.StrictMode,{children:w.jsx(p$,{children:w.jsx(vBe,{})})}));
